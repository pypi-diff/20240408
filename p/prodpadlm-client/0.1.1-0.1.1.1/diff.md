# Comparing `tmp/prodpadlm_client-0.1.1.tar.gz` & `tmp/prodpadlm_client-0.1.1.1.tar.gz`

## filetype from file(1)

```diff
@@ -1 +1 @@
-gzip compressed data, was "prodpadlm_client-0.1.1.tar", last modified: Mon Apr  8 07:40:31 2024, max compression
+gzip compressed data, was "prodpadlm_client-0.1.1.1.tar", last modified: Mon Apr  8 07:48:09 2024, max compression
```

## Comparing `prodpadlm_client-0.1.1.tar` & `prodpadlm_client-0.1.1.1.tar`

### file list

```diff
@@ -1,14 +1,17 @@
-drwxrwxrwx   0        0        0        0 2024-04-08 07:40:31.301427 prodpadlm_client-0.1.1/
--rw-rw-rw-   0        0        0     1723 2024-04-08 07:40:31.300160 prodpadlm_client-0.1.1/PKG-INFO
--rw-rw-rw-   0        0        0     1413 2024-04-08 07:39:29.000000 prodpadlm_client-0.1.1/README.md
-drwxrwxrwx   0        0        0        0 2024-04-08 07:40:31.272554 prodpadlm_client-0.1.1/prodpadlm_client/
--rw-rw-rw-   0        0        0      107 2024-04-08 07:37:31.000000 prodpadlm_client-0.1.1/prodpadlm_client/__init__.py
--rw-rw-rw-   0        0        0    10747 2024-04-08 07:37:45.000000 prodpadlm_client-0.1.1/prodpadlm_client/client.py
-drwxrwxrwx   0        0        0        0 2024-04-08 07:40:31.297752 prodpadlm_client-0.1.1/prodpadlm_client.egg-info/
--rw-rw-rw-   0        0        0     1723 2024-04-08 07:40:30.000000 prodpadlm_client-0.1.1/prodpadlm_client.egg-info/PKG-INFO
--rw-rw-rw-   0        0        0      273 2024-04-08 07:40:31.000000 prodpadlm_client-0.1.1/prodpadlm_client.egg-info/SOURCES.txt
--rw-rw-rw-   0        0        0        1 2024-04-08 07:40:30.000000 prodpadlm_client-0.1.1/prodpadlm_client.egg-info/dependency_links.txt
--rw-rw-rw-   0        0        0       59 2024-04-08 07:40:30.000000 prodpadlm_client-0.1.1/prodpadlm_client.egg-info/requires.txt
--rw-rw-rw-   0        0        0       17 2024-04-08 07:40:30.000000 prodpadlm_client-0.1.1/prodpadlm_client.egg-info/top_level.txt
--rw-rw-rw-   0        0        0       42 2024-04-08 07:40:31.302438 prodpadlm_client-0.1.1/setup.cfg
--rw-rw-rw-   0        0        0      891 2024-04-08 07:39:48.000000 prodpadlm_client-0.1.1/setup.py
+drwxrwxrwx   0        0        0        0 2024-04-08 07:48:09.839354 prodpadlm_client-0.1.1.1/
+-rw-rw-rw-   0        0        0     1725 2024-04-08 07:48:09.838328 prodpadlm_client-0.1.1.1/PKG-INFO
+-rw-rw-rw-   0        0        0     1413 2024-04-08 07:39:29.000000 prodpadlm_client-0.1.1.1/README.md
+drwxrwxrwx   0        0        0        0 2024-04-08 07:48:09.812123 prodpadlm_client-0.1.1.1/prodpadlm_client/
+-rw-rw-rw-   0        0        0       49 2024-04-08 07:45:30.000000 prodpadlm_client-0.1.1.1/prodpadlm_client/__init__.py
+-rw-rw-rw-   0        0        0    10761 2024-04-08 07:45:56.000000 prodpadlm_client-0.1.1.1/prodpadlm_client/client.py
+drwxrwxrwx   0        0        0        0 2024-04-08 07:48:09.835507 prodpadlm_client-0.1.1.1/prodpadlm_client/resources/
+-rw-rw-rw-   0        0        0        0 2024-04-08 07:47:58.000000 prodpadlm_client-0.1.1.1/prodpadlm_client/resources/__init__.py
+-rw-rw-rw-   0        0        0     2801 2024-04-08 01:16:13.000000 prodpadlm_client-0.1.1.1/prodpadlm_client/resources/api.py
+drwxrwxrwx   0        0        0        0 2024-04-08 07:48:09.833019 prodpadlm_client-0.1.1.1/prodpadlm_client.egg-info/
+-rw-rw-rw-   0        0        0     1725 2024-04-08 07:48:09.000000 prodpadlm_client-0.1.1.1/prodpadlm_client.egg-info/PKG-INFO
+-rw-rw-rw-   0        0        0      346 2024-04-08 07:48:09.000000 prodpadlm_client-0.1.1.1/prodpadlm_client.egg-info/SOURCES.txt
+-rw-rw-rw-   0        0        0        1 2024-04-08 07:48:09.000000 prodpadlm_client-0.1.1.1/prodpadlm_client.egg-info/dependency_links.txt
+-rw-rw-rw-   0        0        0       59 2024-04-08 07:48:09.000000 prodpadlm_client-0.1.1.1/prodpadlm_client.egg-info/requires.txt
+-rw-rw-rw-   0        0        0       17 2024-04-08 07:48:09.000000 prodpadlm_client-0.1.1.1/prodpadlm_client.egg-info/top_level.txt
+-rw-rw-rw-   0        0        0       42 2024-04-08 07:48:09.839354 prodpadlm_client-0.1.1.1/setup.cfg
+-rw-rw-rw-   0        0        0      893 2024-04-08 07:45:20.000000 prodpadlm_client-0.1.1.1/setup.py
```

### Comparing `prodpadlm_client-0.1.1/PKG-INFO` & `prodpadlm_client-0.1.1.1/PKG-INFO`

 * *Files 1% similar despite different names*

```diff
@@ -1,10 +1,10 @@
 Metadata-Version: 2.1
 Name: prodpadlm_client
-Version: 0.1.1
+Version: 0.1.1.1
 Summary: Production LaunchPad for Language Models [Client] - ⚡ Ship Open Source LLMs to production faster and efficiently ⚡
 Author: Ayo Kehinde Samuel
 License: Apache 2.0
 Requires-Python: >=3.9.0
 Description-Content-Type: text/markdown
 
 # ProdPadLM - Client
```

### Comparing `prodpadlm_client-0.1.1/README.md` & `prodpadlm_client-0.1.1.1/README.md`

 * *Files identical despite different names*

### Comparing `prodpadlm_client-0.1.1/prodpadlm_client/client.py` & `prodpadlm_client-0.1.1.1/prodpadlm_client/client.py`

 * *Files 0% similar despite different names*

```diff
@@ -44,629 +44,630 @@
 000002b0: 7373 6167 652c 0d0a 290d 0a66 726f 6d20  ssage,..)..from 
 000002c0: 6c61 6e67 6368 6169 6e5f 636f 7265 2e70  langchain_core.p
 000002d0: 7964 616e 7469 635f 7631 2069 6d70 6f72  ydantic_v1 impor
 000002e0: 7420 4261 7365 4d6f 6465 6c2c 2046 6965  t BaseModel, Fie
 000002f0: 6c64 2c20 5365 6372 6574 5374 722c 2072  ld, SecretStr, r
 00000300: 6f6f 745f 7661 6c69 6461 746f 720d 0a0d  oot_validator...
 00000310: 0a66 726f 6d20 7072 6f64 7061 646c 6d5f  .from prodpadlm_
-00000320: 636c 6965 6e74 2069 6d70 6f72 7420 5072  client import Pr
-00000330: 6f64 5041 444c 4d5f 4150 490d 0a0d 0a0d  odPADLM_API.....
-00000340: 0a5f 6d65 7373 6167 655f 7479 7065 5f6c  ._message_type_l
-00000350: 6f6f 6b75 7073 203d 207b 2268 756d 616e  ookups = {"human
-00000360: 223a 2022 7573 6572 222c 2022 6169 223a  ": "user", "ai":
-00000370: 2022 6173 7369 7374 616e 7422 7d0d 0a0d   "assistant"}...
-00000380: 0a64 6566 205f 6d65 7267 655f 6d65 7373  .def _merge_mess
-00000390: 6167 6573 280d 0a20 2020 206d 6573 7361  ages(..    messa
-000003a0: 6765 733a 204c 6973 745b 4261 7365 4d65  ges: List[BaseMe
-000003b0: 7373 6167 655d 2c0d 0a29 202d 3e20 4c69  ssage],..) -> Li
-000003c0: 7374 5b55 6e69 6f6e 5b53 7973 7465 6d4d  st[Union[SystemM
-000003d0: 6573 7361 6765 2c20 4149 4d65 7373 6167  essage, AIMessag
-000003e0: 652c 2048 756d 616e 4d65 7373 6167 655d  e, HumanMessage]
-000003f0: 5d3a 0d0a 2020 2020 2222 224d 6572 6765  ]:..    """Merge
-00000400: 2072 756e 7320 6f66 2068 756d 616e 2f74   runs of human/t
-00000410: 6f6f 6c20 6d65 7373 6167 6573 2069 6e74  ool messages int
-00000420: 6f20 7369 6e67 6c65 2068 756d 616e 206d  o single human m
-00000430: 6573 7361 6765 7320 7769 7468 2063 6f6e  essages with con
-00000440: 7465 6e74 2062 6c6f 636b 732e 2222 2220  tent blocks.""" 
-00000450: 2023 206e 6f71 613a 2045 3530 310d 0a20   # noqa: E501.. 
-00000460: 2020 206d 6572 6765 643a 206c 6973 7420     merged: list 
-00000470: 3d20 5b5d 0d0a 2020 2020 666f 7220 6375  = []..    for cu
-00000480: 7272 2069 6e20 6d65 7373 6167 6573 3a0d  rr in messages:.
-00000490: 0a20 2020 2020 2020 2069 6620 6973 696e  .        if isin
-000004a0: 7374 616e 6365 2863 7572 722c 2054 6f6f  stance(curr, Too
-000004b0: 6c4d 6573 7361 6765 293a 0d0a 2020 2020  lMessage):..    
-000004c0: 2020 2020 2020 2020 6966 2069 7369 6e73          if isins
-000004d0: 7461 6e63 6528 6375 7272 2e63 6f6e 7465  tance(curr.conte
-000004e0: 6e74 2c20 7374 7229 3a0d 0a20 2020 2020  nt, str):..     
-000004f0: 2020 2020 2020 2020 2020 2063 7572 7220             curr 
-00000500: 3d20 4875 6d61 6e4d 6573 7361 6765 280d  = HumanMessage(.
-00000510: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00000520: 2020 2020 205b 0d0a 2020 2020 2020 2020       [..        
-00000530: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00000540: 7b0d 0a20 2020 2020 2020 2020 2020 2020  {..             
-00000550: 2020 2020 2020 2020 2020 2020 2020 2022                 "
-00000560: 7479 7065 223a 2022 746f 6f6c 5f72 6573  type": "tool_res
-00000570: 756c 7422 2c0d 0a20 2020 2020 2020 2020  ult",..         
-00000580: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00000590: 2020 2022 636f 6e74 656e 7422 3a20 6375     "content": cu
-000005a0: 7272 2e63 6f6e 7465 6e74 2c0d 0a20 2020  rr.content,..   
-000005b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000005c0: 2020 2020 2020 2020 2022 746f 6f6c 5f75           "tool_u
-000005d0: 7365 5f69 6422 3a20 6375 7272 2e74 6f6f  se_id": curr.too
-000005e0: 6c5f 6361 6c6c 5f69 642c 0d0a 2020 2020  l_call_id,..    
-000005f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00000600: 2020 2020 7d0d 0a20 2020 2020 2020 2020      }..         
-00000610: 2020 2020 2020 2020 2020 205d 0d0a 2020             ]..  
-00000620: 2020 2020 2020 2020 2020 2020 2020 290d                ).
-00000630: 0a20 2020 2020 2020 2020 2020 2065 6c73  .            els
-00000640: 653a 0d0a 2020 2020 2020 2020 2020 2020  e:..            
-00000650: 2020 2020 6375 7272 203d 2048 756d 616e      curr = Human
-00000660: 4d65 7373 6167 6528 6375 7272 2e63 6f6e  Message(curr.con
-00000670: 7465 6e74 290d 0a20 2020 2020 2020 206c  tent)..        l
-00000680: 6173 7420 3d20 6d65 7267 6564 5b2d 315d  ast = merged[-1]
-00000690: 2069 6620 6d65 7267 6564 2065 6c73 6520   if merged else 
-000006a0: 4e6f 6e65 0d0a 2020 2020 2020 2020 6966  None..        if
-000006b0: 2069 7369 6e73 7461 6e63 6528 6c61 7374   isinstance(last
-000006c0: 2c20 4875 6d61 6e4d 6573 7361 6765 2920  , HumanMessage) 
-000006d0: 616e 6420 6973 696e 7374 616e 6365 2863  and isinstance(c
-000006e0: 7572 722c 2048 756d 616e 4d65 7373 6167  urr, HumanMessag
-000006f0: 6529 3a0d 0a20 2020 2020 2020 2020 2020  e):..           
-00000700: 2069 6620 6973 696e 7374 616e 6365 286c   if isinstance(l
-00000710: 6173 742e 636f 6e74 656e 742c 2073 7472  ast.content, str
-00000720: 293a 0d0a 2020 2020 2020 2020 2020 2020  ):..            
-00000730: 2020 2020 6e65 775f 636f 6e74 656e 743a      new_content:
-00000740: 204c 6973 7420 3d20 5b7b 2274 7970 6522   List = [{"type"
-00000750: 3a20 2274 6578 7422 2c20 2274 6578 7422  : "text", "text"
-00000760: 3a20 6c61 7374 2e63 6f6e 7465 6e74 7d5d  : last.content}]
-00000770: 0d0a 2020 2020 2020 2020 2020 2020 656c  ..            el
-00000780: 7365 3a0d 0a20 2020 2020 2020 2020 2020  se:..           
-00000790: 2020 2020 206e 6577 5f63 6f6e 7465 6e74       new_content
-000007a0: 203d 206c 6173 742e 636f 6e74 656e 740d   = last.content.
-000007b0: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
-000007c0: 6973 696e 7374 616e 6365 2863 7572 722e  isinstance(curr.
-000007d0: 636f 6e74 656e 742c 2073 7472 293a 0d0a  content, str):..
-000007e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000007f0: 6e65 775f 636f 6e74 656e 742e 6170 7065  new_content.appe
-00000800: 6e64 287b 2274 7970 6522 3a20 2274 6578  nd({"type": "tex
-00000810: 7422 2c20 2274 6578 7422 3a20 6375 7272  t", "text": curr
-00000820: 2e63 6f6e 7465 6e74 7d29 0d0a 2020 2020  .content})..    
-00000830: 2020 2020 2020 2020 656c 7365 3a0d 0a20          else:.. 
-00000840: 2020 2020 2020 2020 2020 2020 2020 206e                 n
-00000850: 6577 5f63 6f6e 7465 6e74 2e65 7874 656e  ew_content.exten
-00000860: 6428 6375 7272 2e63 6f6e 7465 6e74 290d  d(curr.content).
-00000870: 0a20 2020 2020 2020 2020 2020 206c 6173  .            las
-00000880: 742e 636f 6e74 656e 7420 3d20 6e65 775f  t.content = new_
-00000890: 636f 6e74 656e 740d 0a20 2020 2020 2020  content..       
-000008a0: 2065 6c73 653a 0d0a 2020 2020 2020 2020   else:..        
-000008b0: 2020 2020 6d65 7267 6564 2e61 7070 656e      merged.appen
-000008c0: 6428 6375 7272 290d 0a20 2020 2072 6574  d(curr)..    ret
-000008d0: 7572 6e20 6d65 7267 6564 0d0a 0d0a 0d0a  urn merged......
-000008e0: 6465 6620 5f66 6f72 6d61 745f 6d65 7373  def _format_mess
-000008f0: 6167 6573 286d 6573 7361 6765 733a 204c  ages(messages: L
-00000900: 6973 745b 4261 7365 4d65 7373 6167 655d  ist[BaseMessage]
-00000910: 2920 2d3e 2054 7570 6c65 5b4f 7074 696f  ) -> Tuple[Optio
-00000920: 6e61 6c5b 7374 725d 2c20 4c69 7374 5b44  nal[str], List[D
-00000930: 6963 745d 5d3a 0d0a 2020 2020 2222 2246  ict]]:..    """F
-00000940: 6f72 6d61 7420 6d65 7373 6167 6573 2066  ormat messages f
-00000950: 6f72 2050 726f 6450 6164 4c4d 2e22 2222  or ProdPadLM."""
-00000960: 0d0a 0d0a 2020 2020 2222 220d 0a20 2020  ....    """..   
-00000970: 205b 0d0a 2020 2020 2020 2020 2020 2020   [..            
-00000980: 2020 2020 7b0d 0a20 2020 2020 2020 2020      {..         
-00000990: 2020 2020 2020 2020 2020 2022 726f 6c65             "role
-000009a0: 223a 205f 6d65 7373 6167 655f 7479 7065  ": _message_type
-000009b0: 5f6c 6f6f 6b75 7073 5b6d 2e74 7970 655d  _lookups[m.type]
-000009c0: 2c0d 0a20 2020 2020 2020 2020 2020 2020  ,..             
-000009d0: 2020 2020 2020 2022 636f 6e74 656e 7422         "content"
-000009e0: 3a20 5b5f 5072 6f64 5061 644c 4d4d 6573  : [_ProdPadLMMes
-000009f0: 7361 6765 436f 6e74 656e 7428 7465 7874  sageContent(text
-00000a00: 3d6d 2e63 6f6e 7465 6e74 292e 6469 6374  =m.content).dict
-00000a10: 2829 5d2c 0d0a 2020 2020 2020 2020 2020  ()],..          
-00000a20: 2020 2020 2020 7d0d 0a20 2020 2020 2020        }..       
-00000a30: 2020 2020 2020 2020 2066 6f72 206d 2069           for m i
-00000a40: 6e20 6d65 7373 6167 6573 0d0a 2020 2020  n messages..    
-00000a50: 2020 2020 2020 2020 5d0d 0a20 2020 2022          ]..    "
-00000a60: 2222 0d0a 2020 2020 7379 7374 656d 3a20  ""..    system: 
-00000a70: 4f70 7469 6f6e 616c 5b73 7472 5d20 3d20  Optional[str] = 
-00000a80: 4e6f 6e65 0d0a 2020 2020 666f 726d 6174  None..    format
-00000a90: 7465 645f 6d65 7373 6167 6573 3a20 4c69  ted_messages: Li
-00000aa0: 7374 5b44 6963 745d 203d 205b 5d0d 0a0d  st[Dict] = []...
-00000ab0: 0a20 2020 206d 6572 6765 645f 6d65 7373  .    merged_mess
-00000ac0: 6167 6573 203d 205f 6d65 7267 655f 6d65  ages = _merge_me
-00000ad0: 7373 6167 6573 286d 6573 7361 6765 7329  ssages(messages)
-00000ae0: 0d0a 2020 2020 666f 7220 692c 206d 6573  ..    for i, mes
-00000af0: 7361 6765 2069 6e20 656e 756d 6572 6174  sage in enumerat
-00000b00: 6528 6d65 7267 6564 5f6d 6573 7361 6765  e(merged_message
-00000b10: 7329 3a0d 0a20 2020 2020 2020 2069 6620  s):..        if 
-00000b20: 6d65 7373 6167 652e 7479 7065 203d 3d20  message.type == 
-00000b30: 2273 7973 7465 6d22 3a0d 0a20 2020 2020  "system":..     
-00000b40: 2020 2020 2020 2069 6620 6920 213d 2030         if i != 0
-00000b50: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
-00000b60: 2020 2072 6169 7365 2056 616c 7565 4572     raise ValueEr
-00000b70: 726f 7228 2253 7973 7465 6d20 6d65 7373  ror("System mess
-00000b80: 6167 6520 6d75 7374 2062 6520 6174 2062  age must be at b
-00000b90: 6567 696e 6e69 6e67 206f 6620 6d65 7373  eginning of mess
-00000ba0: 6167 6520 6c69 7374 2e22 290d 0a20 2020  age list.")..   
-00000bb0: 2020 2020 2020 2020 2069 6620 6e6f 7420           if not 
-00000bc0: 6973 696e 7374 616e 6365 286d 6573 7361  isinstance(messa
-00000bd0: 6765 2e63 6f6e 7465 6e74 2c20 7374 7229  ge.content, str)
-00000be0: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
-00000bf0: 2020 2072 6169 7365 2056 616c 7565 4572     raise ValueEr
-00000c00: 726f 7228 0d0a 2020 2020 2020 2020 2020  ror(..          
-00000c10: 2020 2020 2020 2020 2020 2253 7973 7465            "Syste
-00000c20: 6d20 6d65 7373 6167 6520 6d75 7374 2062  m message must b
-00000c30: 6520 6120 7374 7269 6e67 2c20 220d 0a20  e a string, ".. 
-00000c40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00000c50: 2020 2066 2269 6e73 7465 6164 2077 6173     f"instead was
-00000c60: 3a20 7b74 7970 6528 6d65 7373 6167 652e  : {type(message.
-00000c70: 636f 6e74 656e 7429 7d22 0d0a 2020 2020  content)}"..    
-00000c80: 2020 2020 2020 2020 2020 2020 290d 0a20              ).. 
-00000c90: 2020 2020 2020 2020 2020 2073 7973 7465             syste
-00000ca0: 6d20 3d20 6d65 7373 6167 652e 636f 6e74  m = message.cont
-00000cb0: 656e 740d 0a20 2020 2020 2020 2020 2020  ent..           
-00000cc0: 2063 6f6e 7469 6e75 650d 0a0d 0a20 2020   continue....   
-00000cd0: 2020 2020 2072 6f6c 6520 3d20 5f6d 6573       role = _mes
-00000ce0: 7361 6765 5f74 7970 655f 6c6f 6f6b 7570  sage_type_lookup
-00000cf0: 735b 6d65 7373 6167 652e 7479 7065 5d0d  s[message.type].
-00000d00: 0a20 2020 2020 2020 2063 6f6e 7465 6e74  .        content
-00000d10: 3a20 556e 696f 6e5b 7374 722c 204c 6973  : Union[str, Lis
-00000d20: 745b 4469 6374 5d5d 0d0a 0d0a 2020 2020  t[Dict]]....    
-00000d30: 2020 2020 6966 206e 6f74 2069 7369 6e73      if not isins
-00000d40: 7461 6e63 6528 6d65 7373 6167 652e 636f  tance(message.co
-00000d50: 6e74 656e 742c 2073 7472 293a 0d0a 2020  ntent, str):..  
-00000d60: 2020 2020 2020 2020 2020 2320 7061 7273            # pars
-00000d70: 6520 6173 2064 6963 740d 0a20 2020 2020  e as dict..     
-00000d80: 2020 2020 2020 2061 7373 6572 7420 6973         assert is
-00000d90: 696e 7374 616e 6365 280d 0a20 2020 2020  instance(..     
-00000da0: 2020 2020 2020 2020 2020 206d 6573 7361             messa
-00000db0: 6765 2e63 6f6e 7465 6e74 2c20 6c69 7374  ge.content, list
-00000dc0: 0d0a 2020 2020 2020 2020 2020 2020 292c  ..            ),
-00000dd0: 2022 5072 6f64 5061 644c 4d20 6d65 7373   "ProdPadLM mess
-00000de0: 6167 6520 636f 6e74 656e 7420 6d75 7374  age content must
-00000df0: 2062 6520 7374 7220 6f72 206c 6973 7420   be str or list 
-00000e00: 6f66 2064 6963 7473 220d 0a0d 0a20 2020  of dicts"....   
-00000e10: 2020 2020 2020 2020 2023 2070 6f70 756c           # popul
-00000e20: 6174 6520 636f 6e74 656e 740d 0a20 2020  ate content..   
-00000e30: 2020 2020 2020 2020 2063 6f6e 7465 6e74           content
-00000e40: 203d 205b 5d0d 0a20 2020 2020 2020 2020   = []..         
-00000e50: 2020 2066 6f72 2069 7465 6d20 696e 206d     for item in m
-00000e60: 6573 7361 6765 2e63 6f6e 7465 6e74 3a0d  essage.content:.
-00000e70: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00000e80: 2069 6620 6973 696e 7374 616e 6365 2869   if isinstance(i
-00000e90: 7465 6d2c 2073 7472 293a 0d0a 2020 2020  tem, str):..    
-00000ea0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00000eb0: 636f 6e74 656e 742e 6170 7065 6e64 280d  content.append(.
-00000ec0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00000ed0: 2020 2020 2020 2020 207b 0d0a 2020 2020           {..    
-00000ee0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00000ef0: 2020 2020 2020 2020 2274 7970 6522 3a20          "type": 
-00000f00: 2274 6578 7422 2c0d 0a20 2020 2020 2020  "text",..       
-00000f10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00000f20: 2020 2020 2022 7465 7874 223a 2069 7465       "text": ite
-00000f30: 6d2c 0d0a 2020 2020 2020 2020 2020 2020  m,..            
-00000f40: 2020 2020 2020 2020 2020 2020 7d0d 0a20              }.. 
-00000f50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00000f60: 2020 2029 0d0a 2020 2020 2020 2020 2020     )..          
-00000f70: 2020 2020 2020 656c 6966 2069 7369 6e73        elif isins
-00000f80: 7461 6e63 6528 6974 656d 2c20 6469 6374  tance(item, dict
-00000f90: 293a 0d0a 2020 2020 2020 2020 2020 2020  ):..            
-00000fa0: 2020 2020 2020 2020 6966 2022 7479 7065          if "type
-00000fb0: 2220 6e6f 7420 696e 2069 7465 6d3a 0d0a  " not in item:..
-00000fc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00000fd0: 2020 2020 2020 2020 7261 6973 6520 5661          raise Va
-00000fe0: 6c75 6545 7272 6f72 2822 4469 6374 2063  lueError("Dict c
-00000ff0: 6f6e 7465 6e74 2069 7465 6d20 6d75 7374  ontent item must
-00001000: 2068 6176 6520 6120 7479 7065 206b 6579   have a type key
-00001010: 2229 0d0a 2020 2020 2020 2020 2020 2020  ")..            
-00001020: 2020 2020 2020 2020 656c 6966 2069 7465          elif ite
-00001030: 6d5b 2274 7970 6522 5d20 3d3d 2022 746f  m["type"] == "to
-00001040: 6f6c 5f75 7365 223a 0d0a 2020 2020 2020  ol_use":..      
-00001050: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00001060: 2020 6974 656d 2e70 6f70 2822 7465 7874    item.pop("text
-00001070: 222c 204e 6f6e 6529 0d0a 2020 2020 2020  ", None)..      
-00001080: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00001090: 2020 636f 6e74 656e 742e 6170 7065 6e64    content.append
-000010a0: 2869 7465 6d29 0d0a 2020 2020 2020 2020  (item)..        
-000010b0: 2020 2020 2020 2020 2020 2020 656c 7365              else
-000010c0: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
-000010d0: 2020 2020 2020 2020 2020 2063 6f6e 7465             conte
-000010e0: 6e74 2e61 7070 656e 6428 6974 656d 290d  nt.append(item).
-000010f0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00001100: 2065 6c73 653a 0d0a 2020 2020 2020 2020   else:..        
-00001110: 2020 2020 2020 2020 2020 2020 7261 6973              rais
-00001120: 6520 5661 6c75 6545 7272 6f72 280d 0a20  e ValueError(.. 
-00001130: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00001140: 2020 2020 2020 2066 2243 6f6e 7465 6e74         f"Content
-00001150: 2069 7465 6d73 206d 7573 7420 6265 2073   items must be s
-00001160: 7472 206f 7220 6469 6374 2c20 696e 7374  tr or dict, inst
-00001170: 6561 6420 7761 733a 207b 7479 7065 2869  ead was: {type(i
-00001180: 7465 6d29 7d22 0d0a 2020 2020 2020 2020  tem)}"..        
-00001190: 2020 2020 2020 2020 2020 2020 290d 0a20              ).. 
-000011a0: 2020 2020 2020 2065 6c73 653a 0d0a 2020         else:..  
-000011b0: 2020 2020 2020 2020 2020 636f 6e74 656e            conten
-000011c0: 7420 3d20 6d65 7373 6167 652e 636f 6e74  t = message.cont
-000011d0: 656e 740d 0a0d 0a20 2020 2020 2020 2066  ent....        f
-000011e0: 6f72 6d61 7474 6564 5f6d 6573 7361 6765  ormatted_message
-000011f0: 732e 6170 7065 6e64 280d 0a20 2020 2020  s.append(..     
-00001200: 2020 2020 2020 207b 0d0a 2020 2020 2020         {..      
-00001210: 2020 2020 2020 2020 2020 2272 6f6c 6522            "role"
-00001220: 3a20 726f 6c65 2c0d 0a20 2020 2020 2020  : role,..       
-00001230: 2020 2020 2020 2020 2022 636f 6e74 656e           "conten
-00001240: 7422 3a20 636f 6e74 656e 742c 0d0a 2020  t": content,..  
-00001250: 2020 2020 2020 2020 2020 7d0d 0a20 2020            }..   
-00001260: 2020 2020 2029 0d0a 2020 2020 7265 7475       )..    retu
-00001270: 726e 2073 7973 7465 6d2c 2066 6f72 6d61  rn system, forma
-00001280: 7474 6564 5f6d 6573 7361 6765 730d 0a0d  tted_messages...
-00001290: 0a0d 0a0d 0a63 6c61 7373 2050 726f 6450  .....class ProdP
-000012a0: 6164 4c4d 4368 6174 2842 6173 6543 6861  adLMChat(BaseCha
-000012b0: 744d 6f64 656c 293a 0d0a 2020 0d0a 0d0a  tModel):..  ....
-000012c0: 2020 2020 636c 6173 7320 436f 6e66 6967      class Config
-000012d0: 3a0d 0a20 2020 2020 2020 2022 2222 436f  :..        """Co
-000012e0: 6e66 6967 7572 6174 696f 6e20 666f 7220  nfiguration for 
-000012f0: 7468 6973 2070 7964 616e 7469 6320 6f62  this pydantic ob
-00001300: 6a65 6374 2e22 2222 0d0a 0d0a 2020 2020  ject."""....    
-00001310: 2020 2020 616c 6c6f 775f 706f 7075 6c61      allow_popula
-00001320: 7469 6f6e 5f62 795f 6669 656c 645f 6e61  tion_by_field_na
-00001330: 6d65 203d 2054 7275 650d 0a0d 0a20 2020  me = True....   
-00001340: 205f 636c 6965 6e74 3a20 5072 6f64 5041   _client: ProdPA
-00001350: 444c 4d5f 4150 492e 436c 6965 6e74 203d  DLM_API.Client =
-00001360: 2046 6965 6c64 2864 6566 6175 6c74 3d4e   Field(default=N
-00001370: 6f6e 6529 0d0a 2020 2020 5f61 7379 6e63  one)..    _async
-00001380: 5f63 6c69 656e 743a 2050 726f 6450 4144  _client: ProdPAD
-00001390: 4c4d 5f41 5049 2e41 7379 6e63 436c 6965  LM_API.AsyncClie
-000013a0: 6e74 203d 2046 6965 6c64 2864 6566 6175  nt = Field(defau
-000013b0: 6c74 3d4e 6f6e 6529 0d0a 0d0a 2020 2020  lt=None)....    
-000013c0: 6d61 785f 746f 6b65 6e73 3a20 696e 7420  max_tokens: int 
-000013d0: 3d20 4669 656c 6428 6465 6661 756c 743d  = Field(default=
-000013e0: 3130 3234 2c20 616c 6961 733d 226d 6178  1024, alias="max
-000013f0: 5f74 6f6b 656e 735f 746f 5f73 616d 706c  _tokens_to_sampl
-00001400: 6522 290d 0a20 2020 2022 2222 4465 6e6f  e")..    """Deno
-00001410: 7465 7320 7468 6520 6e75 6d62 6572 206f  tes the number o
-00001420: 6620 746f 6b65 6e73 2074 6f20 7072 6564  f tokens to pred
-00001430: 6963 7420 7065 7220 6765 6e65 7261 7469  ict per generati
-00001440: 6f6e 2e22 2222 0d0a 0d0a 2020 2020 7465  on."""....    te
-00001450: 6d70 6572 6174 7572 653a 204f 7074 696f  mperature: Optio
-00001460: 6e61 6c5b 666c 6f61 745d 203d 204e 6f6e  nal[float] = Non
-00001470: 650d 0a20 2020 2022 2222 4120 6e6f 6e2d  e..    """A non-
-00001480: 6e65 6761 7469 7665 2066 6c6f 6174 2074  negative float t
-00001490: 6861 7420 7475 6e65 7320 7468 6520 6465  hat tunes the de
-000014a0: 6772 6565 206f 6620 7261 6e64 6f6d 6e65  gree of randomne
-000014b0: 7373 2069 6e20 6765 6e65 7261 7469 6f6e  ss in generation
-000014c0: 2e22 2222 0d0a 0d0a 2020 2020 746f 705f  ."""....    top_
-000014d0: 6b3a 204f 7074 696f 6e61 6c5b 696e 745d  k: Optional[int]
-000014e0: 203d 204e 6f6e 650d 0a20 2020 2022 2222   = None..    """
-000014f0: 4e75 6d62 6572 206f 6620 6d6f 7374 206c  Number of most l
-00001500: 696b 656c 7920 746f 6b65 6e73 2074 6f20  ikely tokens to 
-00001510: 636f 6e73 6964 6572 2061 7420 6561 6368  consider at each
-00001520: 2073 7465 702e 2222 220d 0a0d 0a20 2020   step."""....   
-00001530: 2074 6f70 5f70 3a20 4f70 7469 6f6e 616c   top_p: Optional
-00001540: 5b66 6c6f 6174 5d20 3d20 4e6f 6e65 0d0a  [float] = None..
-00001550: 2020 2020 2222 2254 6f74 616c 2070 726f      """Total pro
-00001560: 6261 6269 6c69 7479 206d 6173 7320 6f66  bability mass of
-00001570: 2074 6f6b 656e 7320 746f 2063 6f6e 7369   tokens to consi
-00001580: 6465 7220 6174 2065 6163 6820 7374 6570  der at each step
-00001590: 2e22 2222 0d0a 0d0a 2020 2020 6465 6661  ."""....    defa
-000015a0: 756c 745f 7265 7175 6573 745f 7469 6d65  ult_request_time
-000015b0: 6f75 743a 204f 7074 696f 6e61 6c5b 666c  out: Optional[fl
-000015c0: 6f61 745d 203d 204e 6f6e 650d 0a20 2020  oat] = None..   
-000015d0: 2022 2222 5469 6d65 6f75 7420 666f 7220   """Timeout for 
-000015e0: 7265 7175 6573 7473 2074 6f20 7072 6f64  requests to prod
-000015f0: 7061 646c 6d20 436f 6d70 6c65 7469 6f6e  padlm Completion
-00001600: 2041 5049 2e20 4465 6661 756c 7420 6973   API. Default is
-00001610: 2036 3030 2073 6563 6f6e 6473 2e22 2222   600 seconds."""
-00001620: 0d0a 0d0a 2020 2020 7072 6f64 7061 646c  ....    prodpadl
-00001630: 6d5f 6170 695f 7572 6c3a 2073 7472 0d0a  m_api_url: str..
-00001640: 0d0a 2020 2020 7072 6f64 7061 646c 6d5f  ..    prodpadlm_
-00001650: 6170 695f 6b65 793a 204f 7074 696f 6e61  api_key: Optiona
-00001660: 6c5b 5365 6372 6574 5374 725d 203d 204e  l[SecretStr] = N
-00001670: 6f6e 650d 0a0d 0a20 2020 2064 6566 6175  one....    defau
-00001680: 6c74 5f68 6561 6465 7273 3a20 4f70 7469  lt_headers: Opti
-00001690: 6f6e 616c 5b4d 6170 7069 6e67 5b73 7472  onal[Mapping[str
-000016a0: 2c20 7374 725d 5d20 3d20 4e6f 6e65 0d0a  , str]] = None..
-000016b0: 2020 2020 2222 2248 6561 6465 7273 2074      """Headers t
-000016c0: 6f20 7061 7373 2074 6f20 7468 6520 7072  o pass to the pr
-000016d0: 6f64 7061 646c 6d20 636c 6965 6e74 732c  odpadlm clients,
-000016e0: 2077 696c 6c20 6265 2075 7365 6420 666f   will be used fo
-000016f0: 7220 6576 6572 7920 4150 4920 6361 6c6c  r every API call
-00001700: 2e22 2222 0d0a 0d0a 2020 2020 6d6f 6465  ."""....    mode
-00001710: 6c5f 6b77 6172 6773 3a20 4469 6374 5b73  l_kwargs: Dict[s
-00001720: 7472 2c20 416e 795d 203d 2046 6965 6c64  tr, Any] = Field
-00001730: 2864 6566 6175 6c74 5f66 6163 746f 7279  (default_factory
-00001740: 3d64 6963 7429 0d0a 0d0a 2020 2020 7374  =dict)....    st
-00001750: 7265 616d 696e 673a 2062 6f6f 6c20 3d20  reaming: bool = 
-00001760: 4661 6c73 650d 0a20 2020 2022 2222 5768  False..    """Wh
-00001770: 6574 6865 7220 746f 2075 7365 2073 7472  ether to use str
-00001780: 6561 6d69 6e67 206f 7220 6e6f 742e 2222  eaming or not.""
-00001790: 220d 0a0d 0a20 2020 2040 7072 6f70 6572  "....    @proper
-000017a0: 7479 0d0a 2020 2020 6465 6620 5f6c 6c6d  ty..    def _llm
-000017b0: 5f74 7970 6528 7365 6c66 2920 2d3e 2073  _type(self) -> s
-000017c0: 7472 3a0d 0a20 2020 2020 2020 2022 2222  tr:..        """
-000017d0: 5265 7475 726e 2074 7970 6520 6f66 2063  Return type of c
-000017e0: 6861 7420 6d6f 6465 6c2e 2222 220d 0a20  hat model.""".. 
-000017f0: 2020 2020 2020 2072 6574 7572 6e20 2270         return "p
-00001800: 726f 6470 6164 6c6d 2d63 6861 7422 0d0a  rodpadlm-chat"..
-00001810: 0d0a 2020 2020 4072 6f6f 745f 7661 6c69  ..    @root_vali
-00001820: 6461 746f 7228 7072 653d 5472 7565 290d  dator(pre=True).
-00001830: 0a20 2020 2064 6566 2062 7569 6c64 5f65  .    def build_e
-00001840: 7874 7261 2863 6c73 2c20 7661 6c75 6573  xtra(cls, values
-00001850: 3a20 4469 6374 2920 2d3e 2044 6963 743a  : Dict) -> Dict:
-00001860: 0d0a 2020 2020 2020 2020 6578 7472 6120  ..        extra 
-00001870: 3d20 7661 6c75 6573 2e67 6574 2822 6d6f  = values.get("mo
-00001880: 6465 6c5f 6b77 6172 6773 222c 207b 7d29  del_kwargs", {})
-00001890: 0d0a 2020 2020 2020 2020 616c 6c5f 7265  ..        all_re
-000018a0: 7175 6972 6564 5f66 6965 6c64 5f6e 616d  quired_field_nam
-000018b0: 6573 203d 2067 6574 5f70 7964 616e 7469  es = get_pydanti
-000018c0: 635f 6669 656c 645f 6e61 6d65 7328 636c  c_field_names(cl
-000018d0: 7329 0d0a 2020 2020 2020 2020 7661 6c75  s)..        valu
-000018e0: 6573 5b22 6d6f 6465 6c5f 6b77 6172 6773  es["model_kwargs
-000018f0: 225d 203d 2062 7569 6c64 5f65 7874 7261  "] = build_extra
-00001900: 5f6b 7761 7267 7328 0d0a 2020 2020 2020  _kwargs(..      
-00001910: 2020 2020 2020 6578 7472 612c 2076 616c        extra, val
-00001920: 7565 732c 2061 6c6c 5f72 6571 7569 7265  ues, all_require
-00001930: 645f 6669 656c 645f 6e61 6d65 730d 0a20  d_field_names.. 
-00001940: 2020 2020 2020 2029 0d0a 2020 2020 2020         )..      
-00001950: 2020 7265 7475 726e 2076 616c 7565 730d    return values.
-00001960: 0a0d 0a20 2020 2040 726f 6f74 5f76 616c  ...    @root_val
-00001970: 6964 6174 6f72 2829 0d0a 2020 2020 6465  idator()..    de
-00001980: 6620 7661 6c69 6461 7465 5f65 6e76 6972  f validate_envir
-00001990: 6f6e 6d65 6e74 2863 6c73 2c20 7661 6c75  onment(cls, valu
-000019a0: 6573 3a20 4469 6374 2920 2d3e 2044 6963  es: Dict) -> Dic
-000019b0: 743a 0d0a 2020 2020 2020 2020 7072 6f64  t:..        prod
-000019c0: 7061 646c 6d5f 6170 695f 6b65 7920 3d20  padlm_api_key = 
-000019d0: 636f 6e76 6572 745f 746f 5f73 6563 7265  convert_to_secre
-000019e0: 745f 7374 7228 0d0a 2020 2020 2020 2020  t_str(..        
-000019f0: 2020 2020 7661 6c75 6573 2e67 6574 2822      values.get("
-00001a00: 7072 6f64 7061 646c 6d5f 6170 695f 6b65  prodpadlm_api_ke
-00001a10: 7922 2920 6f72 206f 732e 656e 7669 726f  y") or os.enviro
-00001a20: 6e2e 6765 7428 2270 726f 6470 6164 6c6d  n.get("prodpadlm
-00001a30: 5f41 5049 5f4b 4559 2229 206f 7220 2222  _API_KEY") or ""
-00001a40: 0d0a 2020 2020 2020 2020 290d 0a20 2020  ..        )..   
-00001a50: 2020 2020 2076 616c 7565 735b 2270 726f       values["pro
-00001a60: 6470 6164 6c6d 5f61 7069 5f6b 6579 225d  dpadlm_api_key"]
-00001a70: 203d 2070 726f 6470 6164 6c6d 5f61 7069   = prodpadlm_api
-00001a80: 5f6b 6579 0d0a 2020 2020 2020 2020 6170  _key..        ap
-00001a90: 695f 6b65 7920 3d20 7072 6f64 7061 646c  i_key = prodpadl
-00001aa0: 6d5f 6170 695f 6b65 792e 6765 745f 7365  m_api_key.get_se
-00001ab0: 6372 6574 5f76 616c 7565 2829 0d0a 2020  cret_value()..  
-00001ac0: 2020 2020 2020 6170 695f 7572 6c20 3d20        api_url = 
-00001ad0: 280d 0a20 2020 2020 2020 2020 2020 2076  (..            v
-00001ae0: 616c 7565 732e 6765 7428 2270 726f 6470  alues.get("prodp
-00001af0: 6164 6c6d 5f61 7069 5f75 726c 2229 0d0a  adlm_api_url")..
-00001b00: 2020 2020 2020 2020 2020 2020 6f72 206f              or o
-00001b10: 732e 656e 7669 726f 6e2e 6765 7428 2270  s.environ.get("p
-00001b20: 726f 6470 6164 6c6d 5f41 5049 5f55 524c  rodpadlm_API_URL
-00001b30: 2229 0d0a 2020 2020 2020 2020 290d 0a20  ")..        ).. 
-00001b40: 2020 2020 2020 200d 0a20 2020 2020 2020         ..       
-00001b50: 2076 616c 7565 735b 2270 726f 6470 6164   values["prodpad
-00001b60: 6c6d 5f61 7069 5f75 726c 225d 203d 2061  lm_api_url"] = a
-00001b70: 7069 5f75 726c 0d0a 0d0a 2020 2020 2020  pi_url....      
-00001b80: 2020 7661 6c75 6573 5b22 5f63 6c69 656e    values["_clien
-00001b90: 7422 5d20 3d20 5072 6f64 5041 444c 4d5f  t"] = ProdPADLM_
-00001ba0: 4150 492e 436c 6965 6e74 280d 0a20 2020  API.Client(..   
-00001bb0: 2020 2020 2020 2020 2061 7069 5f6b 6579           api_key
-00001bc0: 3d61 7069 5f6b 6579 2c0d 0a20 2020 2020  =api_key,..     
-00001bd0: 2020 2020 2020 2062 6173 655f 7572 6c3d         base_url=
-00001be0: 6170 695f 7572 6c2c 0d0a 2020 2020 2020  api_url,..      
-00001bf0: 2020 2020 2020 6465 6661 756c 745f 6865        default_he
-00001c00: 6164 6572 733d 7661 6c75 6573 2e67 6574  aders=values.get
-00001c10: 2822 6465 6661 756c 745f 6865 6164 6572  ("default_header
-00001c20: 7322 292c 0d0a 2020 2020 2020 2020 290d  s"),..        ).
-00001c30: 0a20 2020 2020 0d0a 2020 2020 2020 2020  .     ..        
-00001c40: 7661 6c75 6573 5b22 5f61 7379 6e63 5f63  values["_async_c
-00001c50: 6c69 656e 7422 5d20 3d20 5072 6f64 5041  lient"] = ProdPA
-00001c60: 444c 4d5f 4150 492e 4173 796e 6343 6c69  DLM_API.AsyncCli
-00001c70: 656e 7428 0d0a 2020 2020 2020 2020 2020  ent(..          
-00001c80: 2020 6170 695f 6b65 793d 6170 695f 6b65    api_key=api_ke
-00001c90: 792c 0d0a 2020 2020 2020 2020 2020 2020  y,..            
-00001ca0: 6261 7365 5f75 726c 3d61 7069 5f75 726c  base_url=api_url
-00001cb0: 2c0d 0a20 2020 2020 2020 2020 2020 2064  ,..            d
-00001cc0: 6566 6175 6c74 5f68 6561 6465 7273 3d76  efault_headers=v
-00001cd0: 616c 7565 732e 6765 7428 2264 6566 6175  alues.get("defau
-00001ce0: 6c74 5f68 6561 6465 7273 2229 2c0d 0a20  lt_headers"),.. 
-00001cf0: 2020 2020 2020 2029 0d0a 2020 2020 2020         )..      
-00001d00: 2020 7265 7475 726e 2076 616c 7565 730d    return values.
-00001d10: 0a0d 0a20 2020 2064 6566 205f 666f 726d  ...    def _form
-00001d20: 6174 5f70 6172 616d 7328 0d0a 2020 2020  at_params(..    
-00001d30: 2020 2020 7365 6c66 2c0d 0a20 2020 2020      self,..     
-00001d40: 2020 202a 2c0d 0a20 2020 2020 2020 206d     *,..        m
-00001d50: 6573 7361 6765 733a 204c 6973 745b 4261  essages: List[Ba
-00001d60: 7365 4d65 7373 6167 655d 2c0d 0a20 2020  seMessage],..   
-00001d70: 2020 2020 2073 746f 703a 204f 7074 696f       stop: Optio
-00001d80: 6e61 6c5b 4c69 7374 5b73 7472 5d5d 203d  nal[List[str]] =
-00001d90: 204e 6f6e 652c 0d0a 2020 2020 2020 2020   None,..        
-00001da0: 2a2a 6b77 6172 6773 3a20 4469 6374 2c0d  **kwargs: Dict,.
-00001db0: 0a20 2020 2029 202d 3e20 4469 6374 3a0d  .    ) -> Dict:.
-00001dc0: 0a20 2020 2020 2020 2023 2067 6574 2073  .        # get s
-00001dd0: 7973 7465 6d20 7072 6f6d 7074 2069 6620  ystem prompt if 
-00001de0: 616e 790d 0a20 2020 2020 2020 2073 7973  any..        sys
-00001df0: 7465 6d2c 2066 6f72 6d61 7474 6564 5f6d  tem, formatted_m
-00001e00: 6573 7361 6765 7320 3d20 5f66 6f72 6d61  essages = _forma
-00001e10: 745f 6d65 7373 6167 6573 286d 6573 7361  t_messages(messa
-00001e20: 6765 7329 0d0a 2020 2020 2020 2020 7274  ges)..        rt
-00001e30: 6e20 3d20 7b0d 0a20 2020 2020 2020 2020  n = {..         
-00001e40: 2020 2022 6d61 785f 746f 6b65 6e73 223a     "max_tokens":
-00001e50: 2073 656c 662e 6d61 785f 746f 6b65 6e73   self.max_tokens
-00001e60: 2c0d 0a20 2020 2020 2020 2020 2020 2022  ,..            "
-00001e70: 6d65 7373 6167 6573 223a 2066 6f72 6d61  messages": forma
-00001e80: 7474 6564 5f6d 6573 7361 6765 732c 0d0a  tted_messages,..
-00001e90: 2020 2020 2020 2020 2020 2020 2274 656d              "tem
-00001ea0: 7065 7261 7475 7265 223a 2073 656c 662e  perature": self.
-00001eb0: 7465 6d70 6572 6174 7572 652c 0d0a 2020  temperature,..  
-00001ec0: 2020 2020 2020 2020 2020 2274 6f70 5f6b            "top_k
-00001ed0: 223a 2073 656c 662e 746f 705f 6b2c 0d0a  ": self.top_k,..
-00001ee0: 2020 2020 2020 2020 2020 2020 2274 6f70              "top
-00001ef0: 5f70 223a 2073 656c 662e 746f 705f 702c  _p": self.top_p,
-00001f00: 0d0a 2020 2020 2020 2020 2020 2020 2273  ..            "s
-00001f10: 746f 705f 7365 7175 656e 6365 7322 3a20  top_sequences": 
-00001f20: 7374 6f70 2c0d 0a20 2020 2020 2020 2020  stop,..         
-00001f30: 2020 2022 7379 7374 656d 223a 2073 7973     "system": sys
-00001f40: 7465 6d2c 0d0a 2020 2020 2020 2020 2020  tem,..          
-00001f50: 2020 2a2a 7365 6c66 2e6d 6f64 656c 5f6b    **self.model_k
-00001f60: 7761 7267 732c 0d0a 2020 2020 2020 2020  wargs,..        
-00001f70: 2020 2020 2a2a 6b77 6172 6773 2c0d 0a20      **kwargs,.. 
-00001f80: 2020 2020 2020 207d 0d0a 2020 2020 2020         }..      
-00001f90: 2020 7274 6e20 3d20 7b6b 3a20 7620 666f    rtn = {k: v fo
-00001fa0: 7220 6b2c 2076 2069 6e20 7274 6e2e 6974  r k, v in rtn.it
-00001fb0: 656d 7328 2920 6966 2076 2069 7320 6e6f  ems() if v is no
-00001fc0: 7420 4e6f 6e65 7d0d 0a0d 0a20 2020 2020  t None}....     
-00001fd0: 2020 2072 6574 7572 6e20 7274 6e0d 0a0d     return rtn...
-00001fe0: 0a20 2020 2064 6566 205f 7374 7265 616d  .    def _stream
-00001ff0: 280d 0a20 2020 2020 2020 2073 656c 662c  (..        self,
-00002000: 0d0a 2020 2020 2020 2020 6d65 7373 6167  ..        messag
-00002010: 6573 3a20 4c69 7374 5b42 6173 654d 6573  es: List[BaseMes
-00002020: 7361 6765 5d2c 0d0a 2020 2020 2020 2020  sage],..        
-00002030: 7374 6f70 3a20 4f70 7469 6f6e 616c 5b4c  stop: Optional[L
-00002040: 6973 745b 7374 725d 5d20 3d20 4e6f 6e65  ist[str]] = None
-00002050: 2c0d 0a20 2020 2020 2020 2072 756e 5f6d  ,..        run_m
-00002060: 616e 6167 6572 3a20 4f70 7469 6f6e 616c  anager: Optional
-00002070: 5b43 616c 6c62 6163 6b4d 616e 6167 6572  [CallbackManager
-00002080: 466f 724c 4c4d 5275 6e5d 203d 204e 6f6e  ForLLMRun] = Non
-00002090: 652c 0d0a 2020 2020 2020 2020 2a2a 6b77  e,..        **kw
-000020a0: 6172 6773 3a20 416e 792c 0d0a 2020 2020  args: Any,..    
-000020b0: 2920 2d3e 2049 7465 7261 746f 725b 4368  ) -> Iterator[Ch
-000020c0: 6174 4765 6e65 7261 7469 6f6e 4368 756e  atGenerationChun
-000020d0: 6b5d 3a0d 0a20 2020 2020 2020 2070 6172  k]:..        par
-000020e0: 616d 7320 3d20 7365 6c66 2e5f 666f 726d  ams = self._form
-000020f0: 6174 5f70 6172 616d 7328 6d65 7373 6167  at_params(messag
-00002100: 6573 3d6d 6573 7361 6765 732c 2073 746f  es=messages, sto
-00002110: 703d 7374 6f70 2c20 2a2a 6b77 6172 6773  p=stop, **kwargs
-00002120: 290d 0a20 2020 2020 2020 2077 6974 6820  )..        with 
-00002130: 7365 6c66 2e5f 636c 6965 6e74 2e6d 6573  self._client.mes
-00002140: 7361 6765 732e 7374 7265 616d 282a 2a70  sages.stream(**p
-00002150: 6172 616d 7329 2061 7320 7374 7265 616d  arams) as stream
-00002160: 3a0d 0a20 2020 2020 2020 2020 2020 2066  :..            f
-00002170: 6f72 2074 6578 7420 696e 2073 7472 6561  or text in strea
-00002180: 6d2e 7465 7874 5f73 7472 6561 6d3a 0d0a  m.text_stream:..
-00002190: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000021a0: 6368 756e 6b20 3d20 4368 6174 4765 6e65  chunk = ChatGene
-000021b0: 7261 7469 6f6e 4368 756e 6b28 6d65 7373  rationChunk(mess
-000021c0: 6167 653d 4149 4d65 7373 6167 6543 6875  age=AIMessageChu
-000021d0: 6e6b 2863 6f6e 7465 6e74 3d74 6578 7429  nk(content=text)
-000021e0: 290d 0a20 2020 2020 2020 2020 2020 2020  )..             
-000021f0: 2020 2069 6620 7275 6e5f 6d61 6e61 6765     if run_manage
-00002200: 723a 0d0a 2020 2020 2020 2020 2020 2020  r:..            
-00002210: 2020 2020 2020 2020 7275 6e5f 6d61 6e61          run_mana
-00002220: 6765 722e 6f6e 5f6c 6c6d 5f6e 6577 5f74  ger.on_llm_new_t
-00002230: 6f6b 656e 2874 6578 742c 2063 6875 6e6b  oken(text, chunk
-00002240: 3d63 6875 6e6b 290d 0a20 2020 2020 2020  =chunk)..       
-00002250: 2020 2020 2020 2020 2079 6965 6c64 2063           yield c
-00002260: 6875 6e6b 0d0a 0d0a 2020 0d0a 0d0a 2020  hunk....  ....  
-00002270: 2020 6465 6620 5f66 6f72 6d61 745f 6f75    def _format_ou
-00002280: 7470 7574 2873 656c 662c 2064 6174 613a  tput(self, data:
-00002290: 2041 6e79 2c20 2a2a 6b77 6172 6773 3a20   Any, **kwargs: 
-000022a0: 416e 7929 202d 3e20 4368 6174 5265 7375  Any) -> ChatResu
-000022b0: 6c74 3a0d 0a20 2020 2020 2020 2064 6174  lt:..        dat
-000022c0: 615f 6469 6374 203d 2064 6174 612e 6d6f  a_dict = data.mo
-000022d0: 6465 6c5f 6475 6d70 2829 0d0a 2020 2020  del_dump()..    
-000022e0: 2020 2020 636f 6e74 656e 7420 3d20 6461      content = da
-000022f0: 7461 5f64 6963 745b 2263 6f6e 7465 6e74  ta_dict["content
-00002300: 225d 0d0a 2020 2020 2020 2020 6c6c 6d5f  "]..        llm_
-00002310: 6f75 7470 7574 203d 207b 0d0a 2020 2020  output = {..    
-00002320: 2020 2020 2020 2020 6b3a 2076 2066 6f72          k: v for
-00002330: 206b 2c20 7620 696e 2064 6174 615f 6469   k, v in data_di
-00002340: 6374 2e69 7465 6d73 2829 2069 6620 6b20  ct.items() if k 
-00002350: 6e6f 7420 696e 2028 2263 6f6e 7465 6e74  not in ("content
-00002360: 222c 2022 726f 6c65 222c 2022 7479 7065  ", "role", "type
-00002370: 2229 0d0a 2020 2020 2020 2020 7d0d 0a20  ")..        }.. 
-00002380: 2020 2020 2020 2069 6620 6c65 6e28 636f         if len(co
-00002390: 6e74 656e 7429 203d 3d20 3120 616e 6420  ntent) == 1 and 
-000023a0: 636f 6e74 656e 745b 305d 5b22 7479 7065  content[0]["type
-000023b0: 225d 203d 3d20 2274 6578 7422 3a0d 0a20  "] == "text":.. 
-000023c0: 2020 2020 2020 2020 2020 206d 7367 203d             msg =
-000023d0: 2041 494d 6573 7361 6765 2863 6f6e 7465   AIMessage(conte
-000023e0: 6e74 3d63 6f6e 7465 6e74 5b30 5d5b 2274  nt=content[0]["t
-000023f0: 6578 7422 5d29 0d0a 2020 2020 2020 2020  ext"])..        
-00002400: 656c 7365 3a0d 0a20 2020 2020 2020 2020  else:..         
-00002410: 2020 206d 7367 203d 2041 494d 6573 7361     msg = AIMessa
-00002420: 6765 2863 6f6e 7465 6e74 3d63 6f6e 7465  ge(content=conte
-00002430: 6e74 290d 0a20 2020 2020 2020 2070 7269  nt)..        pri
-00002440: 6e74 2822 6d73 673a 2022 2c6d 7367 290d  nt("msg: ",msg).
-00002450: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
-00002460: 4368 6174 5265 7375 6c74 280d 0a20 2020  ChatResult(..   
-00002470: 2020 2020 2020 2020 2067 656e 6572 6174           generat
-00002480: 696f 6e73 3d5b 4368 6174 4765 6e65 7261  ions=[ChatGenera
-00002490: 7469 6f6e 286d 6573 7361 6765 3d6d 7367  tion(message=msg
-000024a0: 295d 2c0d 0a20 2020 2020 2020 2020 2020  )],..           
-000024b0: 206c 6c6d 5f6f 7574 7075 743d 6c6c 6d5f   llm_output=llm_
-000024c0: 6f75 7470 7574 2c0d 0a20 2020 2020 2020  output,..       
-000024d0: 2029 0d0a 0d0a 2020 2020 6465 6620 5f67   )....    def _g
-000024e0: 656e 6572 6174 6528 0d0a 2020 2020 2020  enerate(..      
-000024f0: 2020 7365 6c66 2c0d 0a20 2020 2020 2020    self,..       
-00002500: 206d 6573 7361 6765 733a 204c 6973 745b   messages: List[
-00002510: 4261 7365 4d65 7373 6167 655d 2c0d 0a20  BaseMessage],.. 
-00002520: 2020 2020 2020 2073 746f 703a 204f 7074         stop: Opt
-00002530: 696f 6e61 6c5b 4c69 7374 5b73 7472 5d5d  ional[List[str]]
-00002540: 203d 204e 6f6e 652c 0d0a 2020 2020 2020   = None,..      
-00002550: 2020 7275 6e5f 6d61 6e61 6765 723a 204f    run_manager: O
-00002560: 7074 696f 6e61 6c5b 4361 6c6c 6261 636b  ptional[Callback
-00002570: 4d61 6e61 6765 7246 6f72 4c4c 4d52 756e  ManagerForLLMRun
-00002580: 5d20 3d20 4e6f 6e65 2c0d 0a20 2020 2020  ] = None,..     
-00002590: 2020 202a 2a6b 7761 7267 733a 2041 6e79     **kwargs: Any
-000025a0: 2c0d 0a20 2020 2029 202d 3e20 4368 6174  ,..    ) -> Chat
-000025b0: 5265 7375 6c74 3a0d 0a20 2020 2020 2020  Result:..       
-000025c0: 2070 6172 616d 7320 3d20 7365 6c66 2e5f   params = self._
-000025d0: 666f 726d 6174 5f70 6172 616d 7328 6d65  format_params(me
-000025e0: 7373 6167 6573 3d6d 6573 7361 6765 732c  ssages=messages,
-000025f0: 2073 746f 703d 7374 6f70 2c20 2a2a 6b77   stop=stop, **kw
-00002600: 6172 6773 290d 0a20 2020 2020 2020 2069  args)..        i
-00002610: 6620 7365 6c66 2e73 7472 6561 6d69 6e67  f self.streaming
-00002620: 3a0d 0a20 2020 2020 2020 2020 2020 2073  :..            s
-00002630: 7472 6561 6d5f 6974 6572 203d 2073 656c  tream_iter = sel
-00002640: 662e 5f73 7472 6561 6d28 0d0a 2020 2020  f._stream(..    
-00002650: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00002660: 6d65 7373 6167 6573 2c20 7374 6f70 3d73  messages, stop=s
-00002670: 746f 702c 2072 756e 5f6d 616e 6167 6572  top, run_manager
-00002680: 3d72 756e 5f6d 616e 6167 6572 2c20 2a2a  =run_manager, **
-00002690: 6b77 6172 6773 0d0a 2020 2020 2020 2020  kwargs..        
-000026a0: 2020 2020 2020 2020 290d 0a20 2020 2020          )..     
-000026b0: 2020 2020 2020 2072 6574 7572 6e20 6765         return ge
-000026c0: 6e65 7261 7465 5f66 726f 6d5f 7374 7265  nerate_from_stre
-000026d0: 616d 2873 7472 6561 6d5f 6974 6572 290d  am(stream_iter).
-000026e0: 0a20 2020 2020 2020 2065 6c73 653a 0d0a  .        else:..
-000026f0: 2020 2020 2020 2020 2020 2020 6461 7461              data
-00002700: 203d 2073 656c 662e 5f63 6c69 656e 742e   = self._client.
-00002710: 6372 6561 7465 282a 2a70 6172 616d 7329  create(**params)
-00002720: 0d0a 2020 2020 2020 2020 7265 7475 726e  ..        return
-00002730: 2073 656c 662e 5f66 6f72 6d61 745f 6f75   self._format_ou
-00002740: 7470 7574 2864 6174 612c 202a 2a6b 7761  tput(data, **kwa
-00002750: 7267 7329 0d0a 2020 2020 0d0a 2020 2020  rgs)..    ..    
-00002760: 6173 796e 6320 6465 6620 5f61 6765 6e65  async def _agene
-00002770: 7261 7465 280d 0a20 2020 2020 2020 2073  rate(..        s
-00002780: 656c 662c 0d0a 2020 2020 2020 2020 6d65  elf,..        me
-00002790: 7373 6167 6573 3a20 4c69 7374 5b42 6173  ssages: List[Bas
-000027a0: 654d 6573 7361 6765 5d2c 0d0a 2020 2020  eMessage],..    
-000027b0: 2020 2020 7374 6f70 3a20 4f70 7469 6f6e      stop: Option
-000027c0: 616c 5b4c 6973 745b 7374 725d 5d20 3d20  al[List[str]] = 
-000027d0: 4e6f 6e65 2c0d 0a20 2020 2020 2020 2072  None,..        r
-000027e0: 756e 5f6d 616e 6167 6572 3a20 4f70 7469  un_manager: Opti
-000027f0: 6f6e 616c 5b41 7379 6e63 4361 6c6c 6261  onal[AsyncCallba
-00002800: 636b 4d61 6e61 6765 7246 6f72 4c4c 4d52  ckManagerForLLMR
-00002810: 756e 5d20 3d20 4e6f 6e65 2c0d 0a20 2020  un] = None,..   
-00002820: 2020 2020 202a 2a6b 7761 7267 733a 2041       **kwargs: A
-00002830: 6e79 2c0d 0a20 2020 2029 202d 3e20 4368  ny,..    ) -> Ch
-00002840: 6174 5265 7375 6c74 3a0d 0a20 2020 2020  atResult:..     
-00002850: 2020 2070 6172 616d 7320 3d20 7365 6c66     params = self
-00002860: 2e5f 666f 726d 6174 5f70 6172 616d 7328  ._format_params(
-00002870: 6d65 7373 6167 6573 3d6d 6573 7361 6765  messages=message
-00002880: 732c 2073 746f 703d 7374 6f70 2c20 2a2a  s, stop=stop, **
-00002890: 6b77 6172 6773 290d 0a20 2020 2020 2020  kwargs)..       
-000028a0: 2069 6620 7365 6c66 2e73 7472 6561 6d69   if self.streami
-000028b0: 6e67 3a0d 0a20 2020 2020 2020 2020 2020  ng:..           
-000028c0: 2073 7472 6561 6d5f 6974 6572 203d 2073   stream_iter = s
-000028d0: 656c 662e 5f61 7374 7265 616d 280d 0a20  elf._astream(.. 
-000028e0: 2020 2020 2020 2020 2020 2020 2020 206d                 m
-000028f0: 6573 7361 6765 732c 2073 746f 703d 7374  essages, stop=st
-00002900: 6f70 2c20 7275 6e5f 6d61 6e61 6765 723d  op, run_manager=
-00002910: 7275 6e5f 6d61 6e61 6765 722c 202a 2a6b  run_manager, **k
-00002920: 7761 7267 730d 0a20 2020 2020 2020 2020  wargs..         
-00002930: 2020 2029 0d0a 2020 2020 2020 2020 2020     )..          
-00002940: 2020 7265 7475 726e 2061 7761 6974 2061    return await a
-00002950: 6765 6e65 7261 7465 5f66 726f 6d5f 7374  generate_from_st
-00002960: 7265 616d 2873 7472 6561 6d5f 6974 6572  ream(stream_iter
-00002970: 290d 0a20 2020 2020 2020 2065 6c73 653a  )..        else:
-00002980: 0d0a 2020 2020 2020 2020 2020 2020 6461  ..            da
-00002990: 7461 203d 2061 7761 6974 2073 656c 662e  ta = await self.
-000029a0: 5f61 7379 6e63 5f63 6c69 656e 742e 6372  _async_client.cr
-000029b0: 6561 7465 282a 2a70 6172 616d 7329 0d0a  eate(**params)..
-000029c0: 2020 2020 2020 2020 7265 7475 726e 2073          return s
-000029d0: 656c 662e 5f66 6f72 6d61 745f 6f75 7470  elf._format_outp
-000029e0: 7574 2864 6174 612c 202a 2a6b 7761 7267  ut(data, **kwarg
-000029f0: 7329 0d0a 0d0a 200d 0a0d 0a              s).... ....
+00000320: 636c 6965 6e74 2e72 6573 6f75 7263 6573  client.resources
+00000330: 2e61 7069 2069 6d70 6f72 7420 5072 6f64  .api import Prod
+00000340: 5041 444c 4d5f 4150 490d 0a0d 0a0d 0a5f  PADLM_API......_
+00000350: 6d65 7373 6167 655f 7479 7065 5f6c 6f6f  message_type_loo
+00000360: 6b75 7073 203d 207b 2268 756d 616e 223a  kups = {"human":
+00000370: 2022 7573 6572 222c 2022 6169 223a 2022   "user", "ai": "
+00000380: 6173 7369 7374 616e 7422 7d0d 0a0d 0a64  assistant"}....d
+00000390: 6566 205f 6d65 7267 655f 6d65 7373 6167  ef _merge_messag
+000003a0: 6573 280d 0a20 2020 206d 6573 7361 6765  es(..    message
+000003b0: 733a 204c 6973 745b 4261 7365 4d65 7373  s: List[BaseMess
+000003c0: 6167 655d 2c0d 0a29 202d 3e20 4c69 7374  age],..) -> List
+000003d0: 5b55 6e69 6f6e 5b53 7973 7465 6d4d 6573  [Union[SystemMes
+000003e0: 7361 6765 2c20 4149 4d65 7373 6167 652c  sage, AIMessage,
+000003f0: 2048 756d 616e 4d65 7373 6167 655d 5d3a   HumanMessage]]:
+00000400: 0d0a 2020 2020 2222 224d 6572 6765 2072  ..    """Merge r
+00000410: 756e 7320 6f66 2068 756d 616e 2f74 6f6f  uns of human/too
+00000420: 6c20 6d65 7373 6167 6573 2069 6e74 6f20  l messages into 
+00000430: 7369 6e67 6c65 2068 756d 616e 206d 6573  single human mes
+00000440: 7361 6765 7320 7769 7468 2063 6f6e 7465  sages with conte
+00000450: 6e74 2062 6c6f 636b 732e 2222 2220 2023  nt blocks."""  #
+00000460: 206e 6f71 613a 2045 3530 310d 0a20 2020   noqa: E501..   
+00000470: 206d 6572 6765 643a 206c 6973 7420 3d20   merged: list = 
+00000480: 5b5d 0d0a 2020 2020 666f 7220 6375 7272  []..    for curr
+00000490: 2069 6e20 6d65 7373 6167 6573 3a0d 0a20   in messages:.. 
+000004a0: 2020 2020 2020 2069 6620 6973 696e 7374         if isinst
+000004b0: 616e 6365 2863 7572 722c 2054 6f6f 6c4d  ance(curr, ToolM
+000004c0: 6573 7361 6765 293a 0d0a 2020 2020 2020  essage):..      
+000004d0: 2020 2020 2020 6966 2069 7369 6e73 7461        if isinsta
+000004e0: 6e63 6528 6375 7272 2e63 6f6e 7465 6e74  nce(curr.content
+000004f0: 2c20 7374 7229 3a0d 0a20 2020 2020 2020  , str):..       
+00000500: 2020 2020 2020 2020 2063 7572 7220 3d20           curr = 
+00000510: 4875 6d61 6e4d 6573 7361 6765 280d 0a20  HumanMessage(.. 
+00000520: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00000530: 2020 205b 0d0a 2020 2020 2020 2020 2020     [..          
+00000540: 2020 2020 2020 2020 2020 2020 2020 7b0d                {.
+00000550: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00000560: 2020 2020 2020 2020 2020 2020 2022 7479               "ty
+00000570: 7065 223a 2022 746f 6f6c 5f72 6573 756c  pe": "tool_resul
+00000580: 7422 2c0d 0a20 2020 2020 2020 2020 2020  t",..           
+00000590: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000005a0: 2022 636f 6e74 656e 7422 3a20 6375 7272   "content": curr
+000005b0: 2e63 6f6e 7465 6e74 2c0d 0a20 2020 2020  .content,..     
+000005c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000005d0: 2020 2020 2020 2022 746f 6f6c 5f75 7365         "tool_use
+000005e0: 5f69 6422 3a20 6375 7272 2e74 6f6f 6c5f  _id": curr.tool_
+000005f0: 6361 6c6c 5f69 642c 0d0a 2020 2020 2020  call_id,..      
+00000600: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00000610: 2020 7d0d 0a20 2020 2020 2020 2020 2020    }..           
+00000620: 2020 2020 2020 2020 205d 0d0a 2020 2020           ]..    
+00000630: 2020 2020 2020 2020 2020 2020 290d 0a20              ).. 
+00000640: 2020 2020 2020 2020 2020 2065 6c73 653a             else:
+00000650: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00000660: 2020 6375 7272 203d 2048 756d 616e 4d65    curr = HumanMe
+00000670: 7373 6167 6528 6375 7272 2e63 6f6e 7465  ssage(curr.conte
+00000680: 6e74 290d 0a20 2020 2020 2020 206c 6173  nt)..        las
+00000690: 7420 3d20 6d65 7267 6564 5b2d 315d 2069  t = merged[-1] i
+000006a0: 6620 6d65 7267 6564 2065 6c73 6520 4e6f  f merged else No
+000006b0: 6e65 0d0a 2020 2020 2020 2020 6966 2069  ne..        if i
+000006c0: 7369 6e73 7461 6e63 6528 6c61 7374 2c20  sinstance(last, 
+000006d0: 4875 6d61 6e4d 6573 7361 6765 2920 616e  HumanMessage) an
+000006e0: 6420 6973 696e 7374 616e 6365 2863 7572  d isinstance(cur
+000006f0: 722c 2048 756d 616e 4d65 7373 6167 6529  r, HumanMessage)
+00000700: 3a0d 0a20 2020 2020 2020 2020 2020 2069  :..            i
+00000710: 6620 6973 696e 7374 616e 6365 286c 6173  f isinstance(las
+00000720: 742e 636f 6e74 656e 742c 2073 7472 293a  t.content, str):
+00000730: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00000740: 2020 6e65 775f 636f 6e74 656e 743a 204c    new_content: L
+00000750: 6973 7420 3d20 5b7b 2274 7970 6522 3a20  ist = [{"type": 
+00000760: 2274 6578 7422 2c20 2274 6578 7422 3a20  "text", "text": 
+00000770: 6c61 7374 2e63 6f6e 7465 6e74 7d5d 0d0a  last.content}]..
+00000780: 2020 2020 2020 2020 2020 2020 656c 7365              else
+00000790: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
+000007a0: 2020 206e 6577 5f63 6f6e 7465 6e74 203d     new_content =
+000007b0: 206c 6173 742e 636f 6e74 656e 740d 0a20   last.content.. 
+000007c0: 2020 2020 2020 2020 2020 2069 6620 6973             if is
+000007d0: 696e 7374 616e 6365 2863 7572 722e 636f  instance(curr.co
+000007e0: 6e74 656e 742c 2073 7472 293a 0d0a 2020  ntent, str):..  
+000007f0: 2020 2020 2020 2020 2020 2020 2020 6e65                ne
+00000800: 775f 636f 6e74 656e 742e 6170 7065 6e64  w_content.append
+00000810: 287b 2274 7970 6522 3a20 2274 6578 7422  ({"type": "text"
+00000820: 2c20 2274 6578 7422 3a20 6375 7272 2e63  , "text": curr.c
+00000830: 6f6e 7465 6e74 7d29 0d0a 2020 2020 2020  ontent})..      
+00000840: 2020 2020 2020 656c 7365 3a0d 0a20 2020        else:..   
+00000850: 2020 2020 2020 2020 2020 2020 206e 6577               new
+00000860: 5f63 6f6e 7465 6e74 2e65 7874 656e 6428  _content.extend(
+00000870: 6375 7272 2e63 6f6e 7465 6e74 290d 0a20  curr.content).. 
+00000880: 2020 2020 2020 2020 2020 206c 6173 742e             last.
+00000890: 636f 6e74 656e 7420 3d20 6e65 775f 636f  content = new_co
+000008a0: 6e74 656e 740d 0a20 2020 2020 2020 2065  ntent..        e
+000008b0: 6c73 653a 0d0a 2020 2020 2020 2020 2020  lse:..          
+000008c0: 2020 6d65 7267 6564 2e61 7070 656e 6428    merged.append(
+000008d0: 6375 7272 290d 0a20 2020 2072 6574 7572  curr)..    retur
+000008e0: 6e20 6d65 7267 6564 0d0a 0d0a 0d0a 6465  n merged......de
+000008f0: 6620 5f66 6f72 6d61 745f 6d65 7373 6167  f _format_messag
+00000900: 6573 286d 6573 7361 6765 733a 204c 6973  es(messages: Lis
+00000910: 745b 4261 7365 4d65 7373 6167 655d 2920  t[BaseMessage]) 
+00000920: 2d3e 2054 7570 6c65 5b4f 7074 696f 6e61  -> Tuple[Optiona
+00000930: 6c5b 7374 725d 2c20 4c69 7374 5b44 6963  l[str], List[Dic
+00000940: 745d 5d3a 0d0a 2020 2020 2222 2246 6f72  t]]:..    """For
+00000950: 6d61 7420 6d65 7373 6167 6573 2066 6f72  mat messages for
+00000960: 2050 726f 6450 6164 4c4d 2e22 2222 0d0a   ProdPadLM."""..
+00000970: 0d0a 2020 2020 2222 220d 0a20 2020 205b  ..    """..    [
+00000980: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00000990: 2020 7b0d 0a20 2020 2020 2020 2020 2020    {..           
+000009a0: 2020 2020 2020 2020 2022 726f 6c65 223a           "role":
+000009b0: 205f 6d65 7373 6167 655f 7479 7065 5f6c   _message_type_l
+000009c0: 6f6f 6b75 7073 5b6d 2e74 7970 655d 2c0d  ookups[m.type],.
+000009d0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000009e0: 2020 2020 2022 636f 6e74 656e 7422 3a20       "content": 
+000009f0: 5b5f 5072 6f64 5061 644c 4d4d 6573 7361  [_ProdPadLMMessa
+00000a00: 6765 436f 6e74 656e 7428 7465 7874 3d6d  geContent(text=m
+00000a10: 2e63 6f6e 7465 6e74 292e 6469 6374 2829  .content).dict()
+00000a20: 5d2c 0d0a 2020 2020 2020 2020 2020 2020  ],..            
+00000a30: 2020 2020 7d0d 0a20 2020 2020 2020 2020      }..         
+00000a40: 2020 2020 2020 2066 6f72 206d 2069 6e20         for m in 
+00000a50: 6d65 7373 6167 6573 0d0a 2020 2020 2020  messages..      
+00000a60: 2020 2020 2020 5d0d 0a20 2020 2022 2222        ]..    """
+00000a70: 0d0a 2020 2020 7379 7374 656d 3a20 4f70  ..    system: Op
+00000a80: 7469 6f6e 616c 5b73 7472 5d20 3d20 4e6f  tional[str] = No
+00000a90: 6e65 0d0a 2020 2020 666f 726d 6174 7465  ne..    formatte
+00000aa0: 645f 6d65 7373 6167 6573 3a20 4c69 7374  d_messages: List
+00000ab0: 5b44 6963 745d 203d 205b 5d0d 0a0d 0a20  [Dict] = [].... 
+00000ac0: 2020 206d 6572 6765 645f 6d65 7373 6167     merged_messag
+00000ad0: 6573 203d 205f 6d65 7267 655f 6d65 7373  es = _merge_mess
+00000ae0: 6167 6573 286d 6573 7361 6765 7329 0d0a  ages(messages)..
+00000af0: 2020 2020 666f 7220 692c 206d 6573 7361      for i, messa
+00000b00: 6765 2069 6e20 656e 756d 6572 6174 6528  ge in enumerate(
+00000b10: 6d65 7267 6564 5f6d 6573 7361 6765 7329  merged_messages)
+00000b20: 3a0d 0a20 2020 2020 2020 2069 6620 6d65  :..        if me
+00000b30: 7373 6167 652e 7479 7065 203d 3d20 2273  ssage.type == "s
+00000b40: 7973 7465 6d22 3a0d 0a20 2020 2020 2020  ystem":..       
+00000b50: 2020 2020 2069 6620 6920 213d 2030 3a0d       if i != 0:.
+00000b60: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00000b70: 2072 6169 7365 2056 616c 7565 4572 726f   raise ValueErro
+00000b80: 7228 2253 7973 7465 6d20 6d65 7373 6167  r("System messag
+00000b90: 6520 6d75 7374 2062 6520 6174 2062 6567  e must be at beg
+00000ba0: 696e 6e69 6e67 206f 6620 6d65 7373 6167  inning of messag
+00000bb0: 6520 6c69 7374 2e22 290d 0a20 2020 2020  e list.")..     
+00000bc0: 2020 2020 2020 2069 6620 6e6f 7420 6973         if not is
+00000bd0: 696e 7374 616e 6365 286d 6573 7361 6765  instance(message
+00000be0: 2e63 6f6e 7465 6e74 2c20 7374 7229 3a0d  .content, str):.
+00000bf0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00000c00: 2072 6169 7365 2056 616c 7565 4572 726f   raise ValueErro
+00000c10: 7228 0d0a 2020 2020 2020 2020 2020 2020  r(..            
+00000c20: 2020 2020 2020 2020 2253 7973 7465 6d20          "System 
+00000c30: 6d65 7373 6167 6520 6d75 7374 2062 6520  message must be 
+00000c40: 6120 7374 7269 6e67 2c20 220d 0a20 2020  a string, "..   
+00000c50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00000c60: 2066 2269 6e73 7465 6164 2077 6173 3a20   f"instead was: 
+00000c70: 7b74 7970 6528 6d65 7373 6167 652e 636f  {type(message.co
+00000c80: 6e74 656e 7429 7d22 0d0a 2020 2020 2020  ntent)}"..      
+00000c90: 2020 2020 2020 2020 2020 290d 0a20 2020            )..   
+00000ca0: 2020 2020 2020 2020 2073 7973 7465 6d20           system 
+00000cb0: 3d20 6d65 7373 6167 652e 636f 6e74 656e  = message.conten
+00000cc0: 740d 0a20 2020 2020 2020 2020 2020 2063  t..            c
+00000cd0: 6f6e 7469 6e75 650d 0a0d 0a20 2020 2020  ontinue....     
+00000ce0: 2020 2072 6f6c 6520 3d20 5f6d 6573 7361     role = _messa
+00000cf0: 6765 5f74 7970 655f 6c6f 6f6b 7570 735b  ge_type_lookups[
+00000d00: 6d65 7373 6167 652e 7479 7065 5d0d 0a20  message.type].. 
+00000d10: 2020 2020 2020 2063 6f6e 7465 6e74 3a20         content: 
+00000d20: 556e 696f 6e5b 7374 722c 204c 6973 745b  Union[str, List[
+00000d30: 4469 6374 5d5d 0d0a 0d0a 2020 2020 2020  Dict]]....      
+00000d40: 2020 6966 206e 6f74 2069 7369 6e73 7461    if not isinsta
+00000d50: 6e63 6528 6d65 7373 6167 652e 636f 6e74  nce(message.cont
+00000d60: 656e 742c 2073 7472 293a 0d0a 2020 2020  ent, str):..    
+00000d70: 2020 2020 2020 2020 2320 7061 7273 6520          # parse 
+00000d80: 6173 2064 6963 740d 0a20 2020 2020 2020  as dict..       
+00000d90: 2020 2020 2061 7373 6572 7420 6973 696e       assert isin
+00000da0: 7374 616e 6365 280d 0a20 2020 2020 2020  stance(..       
+00000db0: 2020 2020 2020 2020 206d 6573 7361 6765           message
+00000dc0: 2e63 6f6e 7465 6e74 2c20 6c69 7374 0d0a  .content, list..
+00000dd0: 2020 2020 2020 2020 2020 2020 292c 2022              ), "
+00000de0: 5072 6f64 5061 644c 4d20 6d65 7373 6167  ProdPadLM messag
+00000df0: 6520 636f 6e74 656e 7420 6d75 7374 2062  e content must b
+00000e00: 6520 7374 7220 6f72 206c 6973 7420 6f66  e str or list of
+00000e10: 2064 6963 7473 220d 0a0d 0a20 2020 2020   dicts"....     
+00000e20: 2020 2020 2020 2023 2070 6f70 756c 6174         # populat
+00000e30: 6520 636f 6e74 656e 740d 0a20 2020 2020  e content..     
+00000e40: 2020 2020 2020 2063 6f6e 7465 6e74 203d         content =
+00000e50: 205b 5d0d 0a20 2020 2020 2020 2020 2020   []..           
+00000e60: 2066 6f72 2069 7465 6d20 696e 206d 6573   for item in mes
+00000e70: 7361 6765 2e63 6f6e 7465 6e74 3a0d 0a20  sage.content:.. 
+00000e80: 2020 2020 2020 2020 2020 2020 2020 2069                 i
+00000e90: 6620 6973 696e 7374 616e 6365 2869 7465  f isinstance(ite
+00000ea0: 6d2c 2073 7472 293a 0d0a 2020 2020 2020  m, str):..      
+00000eb0: 2020 2020 2020 2020 2020 2020 2020 636f                co
+00000ec0: 6e74 656e 742e 6170 7065 6e64 280d 0a20  ntent.append(.. 
+00000ed0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00000ee0: 2020 2020 2020 207b 0d0a 2020 2020 2020         {..      
+00000ef0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00000f00: 2020 2020 2020 2274 7970 6522 3a20 2274        "type": "t
+00000f10: 6578 7422 2c0d 0a20 2020 2020 2020 2020  ext",..         
+00000f20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00000f30: 2020 2022 7465 7874 223a 2069 7465 6d2c     "text": item,
+00000f40: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00000f50: 2020 2020 2020 2020 2020 7d0d 0a20 2020            }..   
+00000f60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00000f70: 2029 0d0a 2020 2020 2020 2020 2020 2020   )..            
+00000f80: 2020 2020 656c 6966 2069 7369 6e73 7461      elif isinsta
+00000f90: 6e63 6528 6974 656d 2c20 6469 6374 293a  nce(item, dict):
+00000fa0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00000fb0: 2020 2020 2020 6966 2022 7479 7065 2220        if "type" 
+00000fc0: 6e6f 7420 696e 2069 7465 6d3a 0d0a 2020  not in item:..  
+00000fd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00000fe0: 2020 2020 2020 7261 6973 6520 5661 6c75        raise Valu
+00000ff0: 6545 7272 6f72 2822 4469 6374 2063 6f6e  eError("Dict con
+00001000: 7465 6e74 2069 7465 6d20 6d75 7374 2068  tent item must h
+00001010: 6176 6520 6120 7479 7065 206b 6579 2229  ave a type key")
+00001020: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00001030: 2020 2020 2020 656c 6966 2069 7465 6d5b        elif item[
+00001040: 2274 7970 6522 5d20 3d3d 2022 746f 6f6c  "type"] == "tool
+00001050: 5f75 7365 223a 0d0a 2020 2020 2020 2020  _use":..        
+00001060: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00001070: 6974 656d 2e70 6f70 2822 7465 7874 222c  item.pop("text",
+00001080: 204e 6f6e 6529 0d0a 2020 2020 2020 2020   None)..        
+00001090: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000010a0: 636f 6e74 656e 742e 6170 7065 6e64 2869  content.append(i
+000010b0: 7465 6d29 0d0a 2020 2020 2020 2020 2020  tem)..          
+000010c0: 2020 2020 2020 2020 2020 656c 7365 3a0d            else:.
+000010d0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000010e0: 2020 2020 2020 2020 2063 6f6e 7465 6e74           content
+000010f0: 2e61 7070 656e 6428 6974 656d 290d 0a20  .append(item).. 
+00001100: 2020 2020 2020 2020 2020 2020 2020 2065                 e
+00001110: 6c73 653a 0d0a 2020 2020 2020 2020 2020  lse:..          
+00001120: 2020 2020 2020 2020 2020 7261 6973 6520            raise 
+00001130: 5661 6c75 6545 7272 6f72 280d 0a20 2020  ValueError(..   
+00001140: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00001150: 2020 2020 2066 2243 6f6e 7465 6e74 2069       f"Content i
+00001160: 7465 6d73 206d 7573 7420 6265 2073 7472  tems must be str
+00001170: 206f 7220 6469 6374 2c20 696e 7374 6561   or dict, instea
+00001180: 6420 7761 733a 207b 7479 7065 2869 7465  d was: {type(ite
+00001190: 6d29 7d22 0d0a 2020 2020 2020 2020 2020  m)}"..          
+000011a0: 2020 2020 2020 2020 2020 290d 0a20 2020            )..   
+000011b0: 2020 2020 2065 6c73 653a 0d0a 2020 2020       else:..    
+000011c0: 2020 2020 2020 2020 636f 6e74 656e 7420          content 
+000011d0: 3d20 6d65 7373 6167 652e 636f 6e74 656e  = message.conten
+000011e0: 740d 0a0d 0a20 2020 2020 2020 2066 6f72  t....        for
+000011f0: 6d61 7474 6564 5f6d 6573 7361 6765 732e  matted_messages.
+00001200: 6170 7065 6e64 280d 0a20 2020 2020 2020  append(..       
+00001210: 2020 2020 207b 0d0a 2020 2020 2020 2020       {..        
+00001220: 2020 2020 2020 2020 2272 6f6c 6522 3a20          "role": 
+00001230: 726f 6c65 2c0d 0a20 2020 2020 2020 2020  role,..         
+00001240: 2020 2020 2020 2022 636f 6e74 656e 7422         "content"
+00001250: 3a20 636f 6e74 656e 742c 0d0a 2020 2020  : content,..    
+00001260: 2020 2020 2020 2020 7d0d 0a20 2020 2020          }..     
+00001270: 2020 2029 0d0a 2020 2020 7265 7475 726e     )..    return
+00001280: 2073 7973 7465 6d2c 2066 6f72 6d61 7474   system, formatt
+00001290: 6564 5f6d 6573 7361 6765 730d 0a0d 0a0d  ed_messages.....
+000012a0: 0a0d 0a63 6c61 7373 2050 726f 6450 6164  ...class ProdPad
+000012b0: 4c4d 4368 6174 2842 6173 6543 6861 744d  LMChat(BaseChatM
+000012c0: 6f64 656c 293a 0d0a 2020 0d0a 0d0a 2020  odel):..  ....  
+000012d0: 2020 636c 6173 7320 436f 6e66 6967 3a0d    class Config:.
+000012e0: 0a20 2020 2020 2020 2022 2222 436f 6e66  .        """Conf
+000012f0: 6967 7572 6174 696f 6e20 666f 7220 7468  iguration for th
+00001300: 6973 2070 7964 616e 7469 6320 6f62 6a65  is pydantic obje
+00001310: 6374 2e22 2222 0d0a 0d0a 2020 2020 2020  ct."""....      
+00001320: 2020 616c 6c6f 775f 706f 7075 6c61 7469    allow_populati
+00001330: 6f6e 5f62 795f 6669 656c 645f 6e61 6d65  on_by_field_name
+00001340: 203d 2054 7275 650d 0a0d 0a20 2020 205f   = True....    _
+00001350: 636c 6965 6e74 3a20 5072 6f64 5041 444c  client: ProdPADL
+00001360: 4d5f 4150 492e 436c 6965 6e74 203d 2046  M_API.Client = F
+00001370: 6965 6c64 2864 6566 6175 6c74 3d4e 6f6e  ield(default=Non
+00001380: 6529 0d0a 2020 2020 5f61 7379 6e63 5f63  e)..    _async_c
+00001390: 6c69 656e 743a 2050 726f 6450 4144 4c4d  lient: ProdPADLM
+000013a0: 5f41 5049 2e41 7379 6e63 436c 6965 6e74  _API.AsyncClient
+000013b0: 203d 2046 6965 6c64 2864 6566 6175 6c74   = Field(default
+000013c0: 3d4e 6f6e 6529 0d0a 0d0a 2020 2020 6d61  =None)....    ma
+000013d0: 785f 746f 6b65 6e73 3a20 696e 7420 3d20  x_tokens: int = 
+000013e0: 4669 656c 6428 6465 6661 756c 743d 3130  Field(default=10
+000013f0: 3234 2c20 616c 6961 733d 226d 6178 5f74  24, alias="max_t
+00001400: 6f6b 656e 735f 746f 5f73 616d 706c 6522  okens_to_sample"
+00001410: 290d 0a20 2020 2022 2222 4465 6e6f 7465  )..    """Denote
+00001420: 7320 7468 6520 6e75 6d62 6572 206f 6620  s the number of 
+00001430: 746f 6b65 6e73 2074 6f20 7072 6564 6963  tokens to predic
+00001440: 7420 7065 7220 6765 6e65 7261 7469 6f6e  t per generation
+00001450: 2e22 2222 0d0a 0d0a 2020 2020 7465 6d70  ."""....    temp
+00001460: 6572 6174 7572 653a 204f 7074 696f 6e61  erature: Optiona
+00001470: 6c5b 666c 6f61 745d 203d 204e 6f6e 650d  l[float] = None.
+00001480: 0a20 2020 2022 2222 4120 6e6f 6e2d 6e65  .    """A non-ne
+00001490: 6761 7469 7665 2066 6c6f 6174 2074 6861  gative float tha
+000014a0: 7420 7475 6e65 7320 7468 6520 6465 6772  t tunes the degr
+000014b0: 6565 206f 6620 7261 6e64 6f6d 6e65 7373  ee of randomness
+000014c0: 2069 6e20 6765 6e65 7261 7469 6f6e 2e22   in generation."
+000014d0: 2222 0d0a 0d0a 2020 2020 746f 705f 6b3a  ""....    top_k:
+000014e0: 204f 7074 696f 6e61 6c5b 696e 745d 203d   Optional[int] =
+000014f0: 204e 6f6e 650d 0a20 2020 2022 2222 4e75   None..    """Nu
+00001500: 6d62 6572 206f 6620 6d6f 7374 206c 696b  mber of most lik
+00001510: 656c 7920 746f 6b65 6e73 2074 6f20 636f  ely tokens to co
+00001520: 6e73 6964 6572 2061 7420 6561 6368 2073  nsider at each s
+00001530: 7465 702e 2222 220d 0a0d 0a20 2020 2074  tep."""....    t
+00001540: 6f70 5f70 3a20 4f70 7469 6f6e 616c 5b66  op_p: Optional[f
+00001550: 6c6f 6174 5d20 3d20 4e6f 6e65 0d0a 2020  loat] = None..  
+00001560: 2020 2222 2254 6f74 616c 2070 726f 6261    """Total proba
+00001570: 6269 6c69 7479 206d 6173 7320 6f66 2074  bility mass of t
+00001580: 6f6b 656e 7320 746f 2063 6f6e 7369 6465  okens to conside
+00001590: 7220 6174 2065 6163 6820 7374 6570 2e22  r at each step."
+000015a0: 2222 0d0a 0d0a 2020 2020 6465 6661 756c  ""....    defaul
+000015b0: 745f 7265 7175 6573 745f 7469 6d65 6f75  t_request_timeou
+000015c0: 743a 204f 7074 696f 6e61 6c5b 666c 6f61  t: Optional[floa
+000015d0: 745d 203d 204e 6f6e 650d 0a20 2020 2022  t] = None..    "
+000015e0: 2222 5469 6d65 6f75 7420 666f 7220 7265  ""Timeout for re
+000015f0: 7175 6573 7473 2074 6f20 7072 6f64 7061  quests to prodpa
+00001600: 646c 6d20 436f 6d70 6c65 7469 6f6e 2041  dlm Completion A
+00001610: 5049 2e20 4465 6661 756c 7420 6973 2036  PI. Default is 6
+00001620: 3030 2073 6563 6f6e 6473 2e22 2222 0d0a  00 seconds."""..
+00001630: 0d0a 2020 2020 7072 6f64 7061 646c 6d5f  ..    prodpadlm_
+00001640: 6170 695f 7572 6c3a 2073 7472 0d0a 0d0a  api_url: str....
+00001650: 2020 2020 7072 6f64 7061 646c 6d5f 6170      prodpadlm_ap
+00001660: 695f 6b65 793a 204f 7074 696f 6e61 6c5b  i_key: Optional[
+00001670: 5365 6372 6574 5374 725d 203d 204e 6f6e  SecretStr] = Non
+00001680: 650d 0a0d 0a20 2020 2064 6566 6175 6c74  e....    default
+00001690: 5f68 6561 6465 7273 3a20 4f70 7469 6f6e  _headers: Option
+000016a0: 616c 5b4d 6170 7069 6e67 5b73 7472 2c20  al[Mapping[str, 
+000016b0: 7374 725d 5d20 3d20 4e6f 6e65 0d0a 2020  str]] = None..  
+000016c0: 2020 2222 2248 6561 6465 7273 2074 6f20    """Headers to 
+000016d0: 7061 7373 2074 6f20 7468 6520 7072 6f64  pass to the prod
+000016e0: 7061 646c 6d20 636c 6965 6e74 732c 2077  padlm clients, w
+000016f0: 696c 6c20 6265 2075 7365 6420 666f 7220  ill be used for 
+00001700: 6576 6572 7920 4150 4920 6361 6c6c 2e22  every API call."
+00001710: 2222 0d0a 0d0a 2020 2020 6d6f 6465 6c5f  ""....    model_
+00001720: 6b77 6172 6773 3a20 4469 6374 5b73 7472  kwargs: Dict[str
+00001730: 2c20 416e 795d 203d 2046 6965 6c64 2864  , Any] = Field(d
+00001740: 6566 6175 6c74 5f66 6163 746f 7279 3d64  efault_factory=d
+00001750: 6963 7429 0d0a 0d0a 2020 2020 7374 7265  ict)....    stre
+00001760: 616d 696e 673a 2062 6f6f 6c20 3d20 4661  aming: bool = Fa
+00001770: 6c73 650d 0a20 2020 2022 2222 5768 6574  lse..    """Whet
+00001780: 6865 7220 746f 2075 7365 2073 7472 6561  her to use strea
+00001790: 6d69 6e67 206f 7220 6e6f 742e 2222 220d  ming or not.""".
+000017a0: 0a0d 0a20 2020 2040 7072 6f70 6572 7479  ...    @property
+000017b0: 0d0a 2020 2020 6465 6620 5f6c 6c6d 5f74  ..    def _llm_t
+000017c0: 7970 6528 7365 6c66 2920 2d3e 2073 7472  ype(self) -> str
+000017d0: 3a0d 0a20 2020 2020 2020 2022 2222 5265  :..        """Re
+000017e0: 7475 726e 2074 7970 6520 6f66 2063 6861  turn type of cha
+000017f0: 7420 6d6f 6465 6c2e 2222 220d 0a20 2020  t model."""..   
+00001800: 2020 2020 2072 6574 7572 6e20 2270 726f       return "pro
+00001810: 6470 6164 6c6d 2d63 6861 7422 0d0a 0d0a  dpadlm-chat"....
+00001820: 2020 2020 4072 6f6f 745f 7661 6c69 6461      @root_valida
+00001830: 746f 7228 7072 653d 5472 7565 290d 0a20  tor(pre=True).. 
+00001840: 2020 2064 6566 2062 7569 6c64 5f65 7874     def build_ext
+00001850: 7261 2863 6c73 2c20 7661 6c75 6573 3a20  ra(cls, values: 
+00001860: 4469 6374 2920 2d3e 2044 6963 743a 0d0a  Dict) -> Dict:..
+00001870: 2020 2020 2020 2020 6578 7472 6120 3d20          extra = 
+00001880: 7661 6c75 6573 2e67 6574 2822 6d6f 6465  values.get("mode
+00001890: 6c5f 6b77 6172 6773 222c 207b 7d29 0d0a  l_kwargs", {})..
+000018a0: 2020 2020 2020 2020 616c 6c5f 7265 7175          all_requ
+000018b0: 6972 6564 5f66 6965 6c64 5f6e 616d 6573  ired_field_names
+000018c0: 203d 2067 6574 5f70 7964 616e 7469 635f   = get_pydantic_
+000018d0: 6669 656c 645f 6e61 6d65 7328 636c 7329  field_names(cls)
+000018e0: 0d0a 2020 2020 2020 2020 7661 6c75 6573  ..        values
+000018f0: 5b22 6d6f 6465 6c5f 6b77 6172 6773 225d  ["model_kwargs"]
+00001900: 203d 2062 7569 6c64 5f65 7874 7261 5f6b   = build_extra_k
+00001910: 7761 7267 7328 0d0a 2020 2020 2020 2020  wargs(..        
+00001920: 2020 2020 6578 7472 612c 2076 616c 7565      extra, value
+00001930: 732c 2061 6c6c 5f72 6571 7569 7265 645f  s, all_required_
+00001940: 6669 656c 645f 6e61 6d65 730d 0a20 2020  field_names..   
+00001950: 2020 2020 2029 0d0a 2020 2020 2020 2020       )..        
+00001960: 7265 7475 726e 2076 616c 7565 730d 0a0d  return values...
+00001970: 0a20 2020 2040 726f 6f74 5f76 616c 6964  .    @root_valid
+00001980: 6174 6f72 2829 0d0a 2020 2020 6465 6620  ator()..    def 
+00001990: 7661 6c69 6461 7465 5f65 6e76 6972 6f6e  validate_environ
+000019a0: 6d65 6e74 2863 6c73 2c20 7661 6c75 6573  ment(cls, values
+000019b0: 3a20 4469 6374 2920 2d3e 2044 6963 743a  : Dict) -> Dict:
+000019c0: 0d0a 2020 2020 2020 2020 7072 6f64 7061  ..        prodpa
+000019d0: 646c 6d5f 6170 695f 6b65 7920 3d20 636f  dlm_api_key = co
+000019e0: 6e76 6572 745f 746f 5f73 6563 7265 745f  nvert_to_secret_
+000019f0: 7374 7228 0d0a 2020 2020 2020 2020 2020  str(..          
+00001a00: 2020 7661 6c75 6573 2e67 6574 2822 7072    values.get("pr
+00001a10: 6f64 7061 646c 6d5f 6170 695f 6b65 7922  odpadlm_api_key"
+00001a20: 2920 6f72 206f 732e 656e 7669 726f 6e2e  ) or os.environ.
+00001a30: 6765 7428 2270 726f 6470 6164 6c6d 5f41  get("prodpadlm_A
+00001a40: 5049 5f4b 4559 2229 206f 7220 2222 0d0a  PI_KEY") or ""..
+00001a50: 2020 2020 2020 2020 290d 0a20 2020 2020          )..     
+00001a60: 2020 2076 616c 7565 735b 2270 726f 6470     values["prodp
+00001a70: 6164 6c6d 5f61 7069 5f6b 6579 225d 203d  adlm_api_key"] =
+00001a80: 2070 726f 6470 6164 6c6d 5f61 7069 5f6b   prodpadlm_api_k
+00001a90: 6579 0d0a 2020 2020 2020 2020 6170 695f  ey..        api_
+00001aa0: 6b65 7920 3d20 7072 6f64 7061 646c 6d5f  key = prodpadlm_
+00001ab0: 6170 695f 6b65 792e 6765 745f 7365 6372  api_key.get_secr
+00001ac0: 6574 5f76 616c 7565 2829 0d0a 2020 2020  et_value()..    
+00001ad0: 2020 2020 6170 695f 7572 6c20 3d20 280d      api_url = (.
+00001ae0: 0a20 2020 2020 2020 2020 2020 2076 616c  .            val
+00001af0: 7565 732e 6765 7428 2270 726f 6470 6164  ues.get("prodpad
+00001b00: 6c6d 5f61 7069 5f75 726c 2229 0d0a 2020  lm_api_url")..  
+00001b10: 2020 2020 2020 2020 2020 6f72 206f 732e            or os.
+00001b20: 656e 7669 726f 6e2e 6765 7428 2270 726f  environ.get("pro
+00001b30: 6470 6164 6c6d 5f41 5049 5f55 524c 2229  dpadlm_API_URL")
+00001b40: 0d0a 2020 2020 2020 2020 290d 0a20 2020  ..        )..   
+00001b50: 2020 2020 200d 0a20 2020 2020 2020 2076       ..        v
+00001b60: 616c 7565 735b 2270 726f 6470 6164 6c6d  alues["prodpadlm
+00001b70: 5f61 7069 5f75 726c 225d 203d 2061 7069  _api_url"] = api
+00001b80: 5f75 726c 0d0a 0d0a 2020 2020 2020 2020  _url....        
+00001b90: 7661 6c75 6573 5b22 5f63 6c69 656e 7422  values["_client"
+00001ba0: 5d20 3d20 5072 6f64 5041 444c 4d5f 4150  ] = ProdPADLM_AP
+00001bb0: 492e 436c 6965 6e74 280d 0a20 2020 2020  I.Client(..     
+00001bc0: 2020 2020 2020 2061 7069 5f6b 6579 3d61         api_key=a
+00001bd0: 7069 5f6b 6579 2c0d 0a20 2020 2020 2020  pi_key,..       
+00001be0: 2020 2020 2062 6173 655f 7572 6c3d 6170       base_url=ap
+00001bf0: 695f 7572 6c2c 0d0a 2020 2020 2020 2020  i_url,..        
+00001c00: 2020 2020 6465 6661 756c 745f 6865 6164      default_head
+00001c10: 6572 733d 7661 6c75 6573 2e67 6574 2822  ers=values.get("
+00001c20: 6465 6661 756c 745f 6865 6164 6572 7322  default_headers"
+00001c30: 292c 0d0a 2020 2020 2020 2020 290d 0a20  ),..        ).. 
+00001c40: 2020 2020 0d0a 2020 2020 2020 2020 7661      ..        va
+00001c50: 6c75 6573 5b22 5f61 7379 6e63 5f63 6c69  lues["_async_cli
+00001c60: 656e 7422 5d20 3d20 5072 6f64 5041 444c  ent"] = ProdPADL
+00001c70: 4d5f 4150 492e 4173 796e 6343 6c69 656e  M_API.AsyncClien
+00001c80: 7428 0d0a 2020 2020 2020 2020 2020 2020  t(..            
+00001c90: 6170 695f 6b65 793d 6170 695f 6b65 792c  api_key=api_key,
+00001ca0: 0d0a 2020 2020 2020 2020 2020 2020 6261  ..            ba
+00001cb0: 7365 5f75 726c 3d61 7069 5f75 726c 2c0d  se_url=api_url,.
+00001cc0: 0a20 2020 2020 2020 2020 2020 2064 6566  .            def
+00001cd0: 6175 6c74 5f68 6561 6465 7273 3d76 616c  ault_headers=val
+00001ce0: 7565 732e 6765 7428 2264 6566 6175 6c74  ues.get("default
+00001cf0: 5f68 6561 6465 7273 2229 2c0d 0a20 2020  _headers"),..   
+00001d00: 2020 2020 2029 0d0a 2020 2020 2020 2020       )..        
+00001d10: 7265 7475 726e 2076 616c 7565 730d 0a0d  return values...
+00001d20: 0a20 2020 2064 6566 205f 666f 726d 6174  .    def _format
+00001d30: 5f70 6172 616d 7328 0d0a 2020 2020 2020  _params(..      
+00001d40: 2020 7365 6c66 2c0d 0a20 2020 2020 2020    self,..       
+00001d50: 202a 2c0d 0a20 2020 2020 2020 206d 6573   *,..        mes
+00001d60: 7361 6765 733a 204c 6973 745b 4261 7365  sages: List[Base
+00001d70: 4d65 7373 6167 655d 2c0d 0a20 2020 2020  Message],..     
+00001d80: 2020 2073 746f 703a 204f 7074 696f 6e61     stop: Optiona
+00001d90: 6c5b 4c69 7374 5b73 7472 5d5d 203d 204e  l[List[str]] = N
+00001da0: 6f6e 652c 0d0a 2020 2020 2020 2020 2a2a  one,..        **
+00001db0: 6b77 6172 6773 3a20 4469 6374 2c0d 0a20  kwargs: Dict,.. 
+00001dc0: 2020 2029 202d 3e20 4469 6374 3a0d 0a20     ) -> Dict:.. 
+00001dd0: 2020 2020 2020 2023 2067 6574 2073 7973         # get sys
+00001de0: 7465 6d20 7072 6f6d 7074 2069 6620 616e  tem prompt if an
+00001df0: 790d 0a20 2020 2020 2020 2073 7973 7465  y..        syste
+00001e00: 6d2c 2066 6f72 6d61 7474 6564 5f6d 6573  m, formatted_mes
+00001e10: 7361 6765 7320 3d20 5f66 6f72 6d61 745f  sages = _format_
+00001e20: 6d65 7373 6167 6573 286d 6573 7361 6765  messages(message
+00001e30: 7329 0d0a 2020 2020 2020 2020 7274 6e20  s)..        rtn 
+00001e40: 3d20 7b0d 0a20 2020 2020 2020 2020 2020  = {..           
+00001e50: 2022 6d61 785f 746f 6b65 6e73 223a 2073   "max_tokens": s
+00001e60: 656c 662e 6d61 785f 746f 6b65 6e73 2c0d  elf.max_tokens,.
+00001e70: 0a20 2020 2020 2020 2020 2020 2022 6d65  .            "me
+00001e80: 7373 6167 6573 223a 2066 6f72 6d61 7474  ssages": formatt
+00001e90: 6564 5f6d 6573 7361 6765 732c 0d0a 2020  ed_messages,..  
+00001ea0: 2020 2020 2020 2020 2020 2274 656d 7065            "tempe
+00001eb0: 7261 7475 7265 223a 2073 656c 662e 7465  rature": self.te
+00001ec0: 6d70 6572 6174 7572 652c 0d0a 2020 2020  mperature,..    
+00001ed0: 2020 2020 2020 2020 2274 6f70 5f6b 223a          "top_k":
+00001ee0: 2073 656c 662e 746f 705f 6b2c 0d0a 2020   self.top_k,..  
+00001ef0: 2020 2020 2020 2020 2020 2274 6f70 5f70            "top_p
+00001f00: 223a 2073 656c 662e 746f 705f 702c 0d0a  ": self.top_p,..
+00001f10: 2020 2020 2020 2020 2020 2020 2273 746f              "sto
+00001f20: 705f 7365 7175 656e 6365 7322 3a20 7374  p_sequences": st
+00001f30: 6f70 2c0d 0a20 2020 2020 2020 2020 2020  op,..           
+00001f40: 2022 7379 7374 656d 223a 2073 7973 7465   "system": syste
+00001f50: 6d2c 0d0a 2020 2020 2020 2020 2020 2020  m,..            
+00001f60: 2a2a 7365 6c66 2e6d 6f64 656c 5f6b 7761  **self.model_kwa
+00001f70: 7267 732c 0d0a 2020 2020 2020 2020 2020  rgs,..          
+00001f80: 2020 2a2a 6b77 6172 6773 2c0d 0a20 2020    **kwargs,..   
+00001f90: 2020 2020 207d 0d0a 2020 2020 2020 2020       }..        
+00001fa0: 7274 6e20 3d20 7b6b 3a20 7620 666f 7220  rtn = {k: v for 
+00001fb0: 6b2c 2076 2069 6e20 7274 6e2e 6974 656d  k, v in rtn.item
+00001fc0: 7328 2920 6966 2076 2069 7320 6e6f 7420  s() if v is not 
+00001fd0: 4e6f 6e65 7d0d 0a0d 0a20 2020 2020 2020  None}....       
+00001fe0: 2072 6574 7572 6e20 7274 6e0d 0a0d 0a20   return rtn.... 
+00001ff0: 2020 2064 6566 205f 7374 7265 616d 280d     def _stream(.
+00002000: 0a20 2020 2020 2020 2073 656c 662c 0d0a  .        self,..
+00002010: 2020 2020 2020 2020 6d65 7373 6167 6573          messages
+00002020: 3a20 4c69 7374 5b42 6173 654d 6573 7361  : List[BaseMessa
+00002030: 6765 5d2c 0d0a 2020 2020 2020 2020 7374  ge],..        st
+00002040: 6f70 3a20 4f70 7469 6f6e 616c 5b4c 6973  op: Optional[Lis
+00002050: 745b 7374 725d 5d20 3d20 4e6f 6e65 2c0d  t[str]] = None,.
+00002060: 0a20 2020 2020 2020 2072 756e 5f6d 616e  .        run_man
+00002070: 6167 6572 3a20 4f70 7469 6f6e 616c 5b43  ager: Optional[C
+00002080: 616c 6c62 6163 6b4d 616e 6167 6572 466f  allbackManagerFo
+00002090: 724c 4c4d 5275 6e5d 203d 204e 6f6e 652c  rLLMRun] = None,
+000020a0: 0d0a 2020 2020 2020 2020 2a2a 6b77 6172  ..        **kwar
+000020b0: 6773 3a20 416e 792c 0d0a 2020 2020 2920  gs: Any,..    ) 
+000020c0: 2d3e 2049 7465 7261 746f 725b 4368 6174  -> Iterator[Chat
+000020d0: 4765 6e65 7261 7469 6f6e 4368 756e 6b5d  GenerationChunk]
+000020e0: 3a0d 0a20 2020 2020 2020 2070 6172 616d  :..        param
+000020f0: 7320 3d20 7365 6c66 2e5f 666f 726d 6174  s = self._format
+00002100: 5f70 6172 616d 7328 6d65 7373 6167 6573  _params(messages
+00002110: 3d6d 6573 7361 6765 732c 2073 746f 703d  =messages, stop=
+00002120: 7374 6f70 2c20 2a2a 6b77 6172 6773 290d  stop, **kwargs).
+00002130: 0a20 2020 2020 2020 2077 6974 6820 7365  .        with se
+00002140: 6c66 2e5f 636c 6965 6e74 2e6d 6573 7361  lf._client.messa
+00002150: 6765 732e 7374 7265 616d 282a 2a70 6172  ges.stream(**par
+00002160: 616d 7329 2061 7320 7374 7265 616d 3a0d  ams) as stream:.
+00002170: 0a20 2020 2020 2020 2020 2020 2066 6f72  .            for
+00002180: 2074 6578 7420 696e 2073 7472 6561 6d2e   text in stream.
+00002190: 7465 7874 5f73 7472 6561 6d3a 0d0a 2020  text_stream:..  
+000021a0: 2020 2020 2020 2020 2020 2020 2020 6368                ch
+000021b0: 756e 6b20 3d20 4368 6174 4765 6e65 7261  unk = ChatGenera
+000021c0: 7469 6f6e 4368 756e 6b28 6d65 7373 6167  tionChunk(messag
+000021d0: 653d 4149 4d65 7373 6167 6543 6875 6e6b  e=AIMessageChunk
+000021e0: 2863 6f6e 7465 6e74 3d74 6578 7429 290d  (content=text)).
+000021f0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00002200: 2069 6620 7275 6e5f 6d61 6e61 6765 723a   if run_manager:
+00002210: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00002220: 2020 2020 2020 7275 6e5f 6d61 6e61 6765        run_manage
+00002230: 722e 6f6e 5f6c 6c6d 5f6e 6577 5f74 6f6b  r.on_llm_new_tok
+00002240: 656e 2874 6578 742c 2063 6875 6e6b 3d63  en(text, chunk=c
+00002250: 6875 6e6b 290d 0a20 2020 2020 2020 2020  hunk)..         
+00002260: 2020 2020 2020 2079 6965 6c64 2063 6875         yield chu
+00002270: 6e6b 0d0a 0d0a 2020 0d0a 0d0a 2020 2020  nk....  ....    
+00002280: 6465 6620 5f66 6f72 6d61 745f 6f75 7470  def _format_outp
+00002290: 7574 2873 656c 662c 2064 6174 613a 2041  ut(self, data: A
+000022a0: 6e79 2c20 2a2a 6b77 6172 6773 3a20 416e  ny, **kwargs: An
+000022b0: 7929 202d 3e20 4368 6174 5265 7375 6c74  y) -> ChatResult
+000022c0: 3a0d 0a20 2020 2020 2020 2064 6174 615f  :..        data_
+000022d0: 6469 6374 203d 2064 6174 612e 6d6f 6465  dict = data.mode
+000022e0: 6c5f 6475 6d70 2829 0d0a 2020 2020 2020  l_dump()..      
+000022f0: 2020 636f 6e74 656e 7420 3d20 6461 7461    content = data
+00002300: 5f64 6963 745b 2263 6f6e 7465 6e74 225d  _dict["content"]
+00002310: 0d0a 2020 2020 2020 2020 6c6c 6d5f 6f75  ..        llm_ou
+00002320: 7470 7574 203d 207b 0d0a 2020 2020 2020  tput = {..      
+00002330: 2020 2020 2020 6b3a 2076 2066 6f72 206b        k: v for k
+00002340: 2c20 7620 696e 2064 6174 615f 6469 6374  , v in data_dict
+00002350: 2e69 7465 6d73 2829 2069 6620 6b20 6e6f  .items() if k no
+00002360: 7420 696e 2028 2263 6f6e 7465 6e74 222c  t in ("content",
+00002370: 2022 726f 6c65 222c 2022 7479 7065 2229   "role", "type")
+00002380: 0d0a 2020 2020 2020 2020 7d0d 0a20 2020  ..        }..   
+00002390: 2020 2020 2069 6620 6c65 6e28 636f 6e74       if len(cont
+000023a0: 656e 7429 203d 3d20 3120 616e 6420 636f  ent) == 1 and co
+000023b0: 6e74 656e 745b 305d 5b22 7479 7065 225d  ntent[0]["type"]
+000023c0: 203d 3d20 2274 6578 7422 3a0d 0a20 2020   == "text":..   
+000023d0: 2020 2020 2020 2020 206d 7367 203d 2041           msg = A
+000023e0: 494d 6573 7361 6765 2863 6f6e 7465 6e74  IMessage(content
+000023f0: 3d63 6f6e 7465 6e74 5b30 5d5b 2274 6578  =content[0]["tex
+00002400: 7422 5d29 0d0a 2020 2020 2020 2020 656c  t"])..        el
+00002410: 7365 3a0d 0a20 2020 2020 2020 2020 2020  se:..           
+00002420: 206d 7367 203d 2041 494d 6573 7361 6765   msg = AIMessage
+00002430: 2863 6f6e 7465 6e74 3d63 6f6e 7465 6e74  (content=content
+00002440: 290d 0a20 2020 2020 2020 2070 7269 6e74  )..        print
+00002450: 2822 6d73 673a 2022 2c6d 7367 290d 0a20  ("msg: ",msg).. 
+00002460: 2020 2020 2020 2072 6574 7572 6e20 4368         return Ch
+00002470: 6174 5265 7375 6c74 280d 0a20 2020 2020  atResult(..     
+00002480: 2020 2020 2020 2067 656e 6572 6174 696f         generatio
+00002490: 6e73 3d5b 4368 6174 4765 6e65 7261 7469  ns=[ChatGenerati
+000024a0: 6f6e 286d 6573 7361 6765 3d6d 7367 295d  on(message=msg)]
+000024b0: 2c0d 0a20 2020 2020 2020 2020 2020 206c  ,..            l
+000024c0: 6c6d 5f6f 7574 7075 743d 6c6c 6d5f 6f75  lm_output=llm_ou
+000024d0: 7470 7574 2c0d 0a20 2020 2020 2020 2029  tput,..        )
+000024e0: 0d0a 0d0a 2020 2020 6465 6620 5f67 656e  ....    def _gen
+000024f0: 6572 6174 6528 0d0a 2020 2020 2020 2020  erate(..        
+00002500: 7365 6c66 2c0d 0a20 2020 2020 2020 206d  self,..        m
+00002510: 6573 7361 6765 733a 204c 6973 745b 4261  essages: List[Ba
+00002520: 7365 4d65 7373 6167 655d 2c0d 0a20 2020  seMessage],..   
+00002530: 2020 2020 2073 746f 703a 204f 7074 696f       stop: Optio
+00002540: 6e61 6c5b 4c69 7374 5b73 7472 5d5d 203d  nal[List[str]] =
+00002550: 204e 6f6e 652c 0d0a 2020 2020 2020 2020   None,..        
+00002560: 7275 6e5f 6d61 6e61 6765 723a 204f 7074  run_manager: Opt
+00002570: 696f 6e61 6c5b 4361 6c6c 6261 636b 4d61  ional[CallbackMa
+00002580: 6e61 6765 7246 6f72 4c4c 4d52 756e 5d20  nagerForLLMRun] 
+00002590: 3d20 4e6f 6e65 2c0d 0a20 2020 2020 2020  = None,..       
+000025a0: 202a 2a6b 7761 7267 733a 2041 6e79 2c0d   **kwargs: Any,.
+000025b0: 0a20 2020 2029 202d 3e20 4368 6174 5265  .    ) -> ChatRe
+000025c0: 7375 6c74 3a0d 0a20 2020 2020 2020 2070  sult:..        p
+000025d0: 6172 616d 7320 3d20 7365 6c66 2e5f 666f  arams = self._fo
+000025e0: 726d 6174 5f70 6172 616d 7328 6d65 7373  rmat_params(mess
+000025f0: 6167 6573 3d6d 6573 7361 6765 732c 2073  ages=messages, s
+00002600: 746f 703d 7374 6f70 2c20 2a2a 6b77 6172  top=stop, **kwar
+00002610: 6773 290d 0a20 2020 2020 2020 2069 6620  gs)..        if 
+00002620: 7365 6c66 2e73 7472 6561 6d69 6e67 3a0d  self.streaming:.
+00002630: 0a20 2020 2020 2020 2020 2020 2073 7472  .            str
+00002640: 6561 6d5f 6974 6572 203d 2073 656c 662e  eam_iter = self.
+00002650: 5f73 7472 6561 6d28 0d0a 2020 2020 2020  _stream(..      
+00002660: 2020 2020 2020 2020 2020 2020 2020 6d65                me
+00002670: 7373 6167 6573 2c20 7374 6f70 3d73 746f  ssages, stop=sto
+00002680: 702c 2072 756e 5f6d 616e 6167 6572 3d72  p, run_manager=r
+00002690: 756e 5f6d 616e 6167 6572 2c20 2a2a 6b77  un_manager, **kw
+000026a0: 6172 6773 0d0a 2020 2020 2020 2020 2020  args..          
+000026b0: 2020 2020 2020 290d 0a20 2020 2020 2020        )..       
+000026c0: 2020 2020 2072 6574 7572 6e20 6765 6e65       return gene
+000026d0: 7261 7465 5f66 726f 6d5f 7374 7265 616d  rate_from_stream
+000026e0: 2873 7472 6561 6d5f 6974 6572 290d 0a20  (stream_iter).. 
+000026f0: 2020 2020 2020 2065 6c73 653a 0d0a 2020         else:..  
+00002700: 2020 2020 2020 2020 2020 6461 7461 203d            data =
+00002710: 2073 656c 662e 5f63 6c69 656e 742e 6372   self._client.cr
+00002720: 6561 7465 282a 2a70 6172 616d 7329 0d0a  eate(**params)..
+00002730: 2020 2020 2020 2020 7265 7475 726e 2073          return s
+00002740: 656c 662e 5f66 6f72 6d61 745f 6f75 7470  elf._format_outp
+00002750: 7574 2864 6174 612c 202a 2a6b 7761 7267  ut(data, **kwarg
+00002760: 7329 0d0a 2020 2020 0d0a 2020 2020 6173  s)..    ..    as
+00002770: 796e 6320 6465 6620 5f61 6765 6e65 7261  ync def _agenera
+00002780: 7465 280d 0a20 2020 2020 2020 2073 656c  te(..        sel
+00002790: 662c 0d0a 2020 2020 2020 2020 6d65 7373  f,..        mess
+000027a0: 6167 6573 3a20 4c69 7374 5b42 6173 654d  ages: List[BaseM
+000027b0: 6573 7361 6765 5d2c 0d0a 2020 2020 2020  essage],..      
+000027c0: 2020 7374 6f70 3a20 4f70 7469 6f6e 616c    stop: Optional
+000027d0: 5b4c 6973 745b 7374 725d 5d20 3d20 4e6f  [List[str]] = No
+000027e0: 6e65 2c0d 0a20 2020 2020 2020 2072 756e  ne,..        run
+000027f0: 5f6d 616e 6167 6572 3a20 4f70 7469 6f6e  _manager: Option
+00002800: 616c 5b41 7379 6e63 4361 6c6c 6261 636b  al[AsyncCallback
+00002810: 4d61 6e61 6765 7246 6f72 4c4c 4d52 756e  ManagerForLLMRun
+00002820: 5d20 3d20 4e6f 6e65 2c0d 0a20 2020 2020  ] = None,..     
+00002830: 2020 202a 2a6b 7761 7267 733a 2041 6e79     **kwargs: Any
+00002840: 2c0d 0a20 2020 2029 202d 3e20 4368 6174  ,..    ) -> Chat
+00002850: 5265 7375 6c74 3a0d 0a20 2020 2020 2020  Result:..       
+00002860: 2070 6172 616d 7320 3d20 7365 6c66 2e5f   params = self._
+00002870: 666f 726d 6174 5f70 6172 616d 7328 6d65  format_params(me
+00002880: 7373 6167 6573 3d6d 6573 7361 6765 732c  ssages=messages,
+00002890: 2073 746f 703d 7374 6f70 2c20 2a2a 6b77   stop=stop, **kw
+000028a0: 6172 6773 290d 0a20 2020 2020 2020 2069  args)..        i
+000028b0: 6620 7365 6c66 2e73 7472 6561 6d69 6e67  f self.streaming
+000028c0: 3a0d 0a20 2020 2020 2020 2020 2020 2073  :..            s
+000028d0: 7472 6561 6d5f 6974 6572 203d 2073 656c  tream_iter = sel
+000028e0: 662e 5f61 7374 7265 616d 280d 0a20 2020  f._astream(..   
+000028f0: 2020 2020 2020 2020 2020 2020 206d 6573               mes
+00002900: 7361 6765 732c 2073 746f 703d 7374 6f70  sages, stop=stop
+00002910: 2c20 7275 6e5f 6d61 6e61 6765 723d 7275  , run_manager=ru
+00002920: 6e5f 6d61 6e61 6765 722c 202a 2a6b 7761  n_manager, **kwa
+00002930: 7267 730d 0a20 2020 2020 2020 2020 2020  rgs..           
+00002940: 2029 0d0a 2020 2020 2020 2020 2020 2020   )..            
+00002950: 7265 7475 726e 2061 7761 6974 2061 6765  return await age
+00002960: 6e65 7261 7465 5f66 726f 6d5f 7374 7265  nerate_from_stre
+00002970: 616d 2873 7472 6561 6d5f 6974 6572 290d  am(stream_iter).
+00002980: 0a20 2020 2020 2020 2065 6c73 653a 0d0a  .        else:..
+00002990: 2020 2020 2020 2020 2020 2020 6461 7461              data
+000029a0: 203d 2061 7761 6974 2073 656c 662e 5f61   = await self._a
+000029b0: 7379 6e63 5f63 6c69 656e 742e 6372 6561  sync_client.crea
+000029c0: 7465 282a 2a70 6172 616d 7329 0d0a 2020  te(**params)..  
+000029d0: 2020 2020 2020 7265 7475 726e 2073 656c        return sel
+000029e0: 662e 5f66 6f72 6d61 745f 6f75 7470 7574  f._format_output
+000029f0: 2864 6174 612c 202a 2a6b 7761 7267 7329  (data, **kwargs)
+00002a00: 0d0a 0d0a 200d 0a0d 0a                   .... ....
```

### Comparing `prodpadlm_client-0.1.1/prodpadlm_client.egg-info/PKG-INFO` & `prodpadlm_client-0.1.1.1/prodpadlm_client.egg-info/PKG-INFO`

 * *Files 5% similar despite different names*

```diff
@@ -1,10 +1,10 @@
 Metadata-Version: 2.1
 Name: prodpadlm-client
-Version: 0.1.1
+Version: 0.1.1.1
 Summary: Production LaunchPad for Language Models [Client] - ⚡ Ship Open Source LLMs to production faster and efficiently ⚡
 Author: Ayo Kehinde Samuel
 License: Apache 2.0
 Requires-Python: >=3.9.0
 Description-Content-Type: text/markdown
 
 # ProdPadLM - Client
```

### Comparing `prodpadlm_client-0.1.1/setup.py` & `prodpadlm_client-0.1.1.1/setup.py`

 * *Files 0% similar despite different names*

```diff
@@ -12,15 +12,15 @@
     "pydantic-settings",
     "langchain==0.1.14",
     "langchain-core==0.1.40",
 ]
 
 setup(
     name='prodpadlm_client',
-    version='0.1.1',
+    version='0.1.1.1',
     description='Production LaunchPad for Language Models [Client] - ⚡ Ship Open Source LLMs to production faster and efficiently ⚡',
     author='Ayo Kehinde Samuel',
     packages=find_packages(),
     long_description=read_readme(),
     long_description_content_type="text/markdown",
     license="Apache 2.0",
     license_files="LICENSE.txt",
```

