# Comparing `tmp/fossiler-0.0.4.8.tar.gz` & `tmp/fossiler-0.0.4.9.tar.gz`

## filetype from file(1)

```diff
@@ -1 +1 @@
-gzip compressed data, was "dist/fossiler-0.0.4.8.tar", last modified: Thu Mar 28 09:26:05 2024, max compression
+gzip compressed data, was "dist/fossiler-0.0.4.9.tar", last modified: Mon Apr  8 06:06:44 2024, max compression
```

## Comparing `fossiler-0.0.4.8.tar` & `fossiler-0.0.4.9.tar`

### file list

```diff
@@ -1,16 +1,16 @@
-drwxrwxrwx   0 heche     (1000) heche     (1000)        0 2024-03-28 09:26:05.711509 fossiler-0.0.4.8/
--rwxrwxrwx   0 heche     (1000) heche     (1000)    35149 2023-05-11 08:47:25.000000 fossiler-0.0.4.8/LICENSE
--rwxrwxrwx   0 heche     (1000) heche     (1000)    87151 2024-03-28 09:26:05.711509 fossiler-0.0.4.8/PKG-INFO
--rwxrwxrwx   0 heche     (1000) heche     (1000)    86853 2023-08-18 12:47:39.000000 fossiler-0.0.4.8/README.md
--rwxrwxrwx   0 heche     (1000) heche     (1000)     2774 2023-12-16 09:53:10.000000 fossiler-0.0.4.8/command.py
-drwxrwxrwx   0 heche     (1000) heche     (1000)        0 2024-03-28 09:26:05.690909 fossiler-0.0.4.8/fossiler/
--rwxrwxrwx   0 heche     (1000) heche     (1000)   152541 2024-03-28 09:23:01.000000 fossiler-0.0.4.8/fossiler/fossils.py
-drwxrwxrwx   0 heche     (1000) heche     (1000)        0 2024-03-28 09:26:05.709502 fossiler-0.0.4.8/fossiler.egg-info/
--rwxrwxrwx   0 heche     (1000) heche     (1000)    87151 2024-03-28 09:26:05.000000 fossiler-0.0.4.8/fossiler.egg-info/PKG-INFO
--rwxrwxrwx   0 heche     (1000) heche     (1000)      261 2024-03-28 09:26:05.000000 fossiler-0.0.4.8/fossiler.egg-info/SOURCES.txt
--rwxrwxrwx   0 heche     (1000) heche     (1000)        1 2024-03-28 09:26:05.000000 fossiler-0.0.4.8/fossiler.egg-info/dependency_links.txt
--rwxrwxrwx   0 heche     (1000) heche     (1000)       41 2024-03-28 09:26:05.000000 fossiler-0.0.4.8/fossiler.egg-info/entry_points.txt
--rwxrwxrwx   0 heche     (1000) heche     (1000)       69 2024-03-28 09:26:05.000000 fossiler-0.0.4.8/fossiler.egg-info/requires.txt
--rwxrwxrwx   0 heche     (1000) heche     (1000)       17 2024-03-28 09:26:05.000000 fossiler-0.0.4.8/fossiler.egg-info/top_level.txt
--rwxrwxrwx   0 heche     (1000) heche     (1000)      103 2024-03-28 09:26:05.713519 fossiler-0.0.4.8/setup.cfg
--rwxrwxrwx   0 heche     (1000) heche     (1000)      826 2024-03-28 09:25:34.000000 fossiler-0.0.4.8/setup.py
+drwxrwxrwx   0 heche     (1000) heche     (1000)        0 2024-04-08 06:06:44.911908 fossiler-0.0.4.9/
+-rwxrwxrwx   0 heche     (1000) heche     (1000)    35149 2023-05-11 08:47:25.000000 fossiler-0.0.4.9/LICENSE
+-rwxrwxrwx   0 heche     (1000) heche     (1000)    87151 2024-04-08 06:06:44.911908 fossiler-0.0.4.9/PKG-INFO
+-rwxrwxrwx   0 heche     (1000) heche     (1000)    86853 2023-08-18 12:47:39.000000 fossiler-0.0.4.9/README.md
+-rwxrwxrwx   0 heche     (1000) heche     (1000)     2774 2023-12-16 09:53:10.000000 fossiler-0.0.4.9/command.py
+drwxrwxrwx   0 heche     (1000) heche     (1000)        0 2024-04-08 06:06:44.897688 fossiler-0.0.4.9/fossiler/
+-rwxrwxrwx   0 heche     (1000) heche     (1000)   152540 2024-04-08 06:05:24.000000 fossiler-0.0.4.9/fossiler/fossils.py
+drwxrwxrwx   0 heche     (1000) heche     (1000)        0 2024-04-08 06:06:44.911287 fossiler-0.0.4.9/fossiler.egg-info/
+-rwxrwxrwx   0 heche     (1000) heche     (1000)    87151 2024-04-08 06:06:44.000000 fossiler-0.0.4.9/fossiler.egg-info/PKG-INFO
+-rwxrwxrwx   0 heche     (1000) heche     (1000)      261 2024-04-08 06:06:44.000000 fossiler-0.0.4.9/fossiler.egg-info/SOURCES.txt
+-rwxrwxrwx   0 heche     (1000) heche     (1000)        1 2024-04-08 06:06:44.000000 fossiler-0.0.4.9/fossiler.egg-info/dependency_links.txt
+-rwxrwxrwx   0 heche     (1000) heche     (1000)       41 2024-04-08 06:06:44.000000 fossiler-0.0.4.9/fossiler.egg-info/entry_points.txt
+-rwxrwxrwx   0 heche     (1000) heche     (1000)       69 2024-04-08 06:06:44.000000 fossiler-0.0.4.9/fossiler.egg-info/requires.txt
+-rwxrwxrwx   0 heche     (1000) heche     (1000)       17 2024-04-08 06:06:44.000000 fossiler-0.0.4.9/fossiler.egg-info/top_level.txt
+-rwxrwxrwx   0 heche     (1000) heche     (1000)      103 2024-04-08 06:06:44.913630 fossiler-0.0.4.9/setup.cfg
+-rwxrwxrwx   0 heche     (1000) heche     (1000)      826 2024-04-08 06:06:00.000000 fossiler-0.0.4.9/setup.py
```

### Comparing `fossiler-0.0.4.8/LICENSE` & `fossiler-0.0.4.9/LICENSE`

 * *Files identical despite different names*

### Comparing `fossiler-0.0.4.8/PKG-INFO` & `fossiler-0.0.4.9/PKG-INFO`

 * *Files 0% similar despite different names*

```diff
@@ -1,10 +1,10 @@
 Metadata-Version: 2.1
 Name: fossiler
-Version: 0.0.4.8
+Version: 0.0.4.9
 Summary: Python package and CLI for finding available fossils
 Home-page: http://github.com/heche-psb/fossiler
 Author: Hengchi Chen
 Author-email: heche@psb.vib-ugent.be
 License: GPL
 Description-Content-Type: text/markdown
 License-File: LICENSE
```

### Comparing `fossiler-0.0.4.8/README.md` & `fossiler-0.0.4.9/README.md`

 * *Files identical despite different names*

### Comparing `fossiler-0.0.4.8/command.py` & `fossiler-0.0.4.9/command.py`

 * *Files identical despite different names*

### Comparing `fossiler-0.0.4.8/fossiler/fossils.py` & `fossiler-0.0.4.9/fossiler/fossils.py`

 * *Files 0% similar despite different names*

```diff
@@ -9152,383 +9152,383 @@
 00023bf0: 6e61 6d65 290a 2020 2020 2020 2020 2020  name).          
 00023c00: 2020 2020 2020 7375 6363 6573 7320 3d20        success = 
 00023c10: 5472 7565 0a20 2020 2020 2020 2020 2020  True.           
 00023c20: 2065 7863 6570 7420 4854 5450 4572 726f   except HTTPErro
 00023c30: 7220 6173 2065 3a0a 2020 2020 2020 2020  r as e:.        
 00023c40: 2020 2020 2020 2020 7375 6363 6573 7320          success 
 00023c50: 3d20 4661 6c73 650a 2020 2020 2020 2020  = False.        
-00023c60: 2369 6620 696e 666f 5b27 6f72 6465 7227  #if info['order'
-00023c70: 5d20 3d3d 2027 273a 2069 6e66 6f5b 276f  ] == '': info['o
-00023c80: 7264 6572 275d 203d 2063 6c61 6465 2e6e  rder'] = clade.n
-00023c90: 616d 6520 2320 5468 6973 2073 7465 7020  ame # This step 
-00023ca0: 6973 2074 7269 636b 792c 2061 7373 756d  is tricky, assum
-00023cb0: 696e 6720 7468 6520 696e 7075 7420 6973  ing the input is
-00023cc0: 2061 6c72 6561 6479 206f 7264 6572 206e   already order n
-00023cd0: 616d 650a 2020 2020 2020 2020 7461 786f  ame.        taxo
-00023ce0: 6e6f 6d79 5f64 6963 745b 636c 6164 652e  nomy_dict[clade.
-00023cf0: 6e61 6d65 5d20 3d20 696e 666f 0a20 2020  name] = info.   
-00023d00: 2020 2020 206c 6f67 6769 6e67 2e69 6e66       logging.inf
-00023d10: 6f28 227b 7d20 6265 6c6f 6e67 7320 746f  o("{} belongs to
-00023d20: 207b 7d22 2e66 6f72 6d61 7428 636c 6164   {}".format(clad
-00023d30: 652e 6e61 6d65 2c74 6178 6f6e 6f6d 795f  e.name,taxonomy_
-00023d40: 6469 6374 5b63 6c61 6465 2e6e 616d 655d  dict[clade.name]
-00023d50: 5b27 6f72 6465 7227 5d29 290a 2020 2020  ['order'])).    
-00023d60: 666f 7220 692c 636c 6164 6520 696e 2065  for i,clade in e
-00023d70: 6e75 6d65 7261 7465 2854 7265 652e 6765  numerate(Tree.ge
-00023d80: 745f 6e6f 6e74 6572 6d69 6e61 6c73 2829  t_nonterminals()
-00023d90: 293a 0a20 2020 2020 2020 206f 7264 6572  ):.        order
-00023da0: 5f6f 6363 7572 203d 205b 7461 786f 6e6f  _occur = [taxono
-00023db0: 6d79 5f64 6963 745b 7469 702e 6e61 6d65  my_dict[tip.name
-00023dc0: 5d5b 276f 7264 6572 275d 2066 6f72 2074  ]['order'] for t
-00023dd0: 6970 2069 6e20 636c 6164 652e 6765 745f  ip in clade.get_
-00023de0: 7465 726d 696e 616c 7328 295d 0a20 2020  terminals()].   
-00023df0: 2020 2020 2069 6620 6c65 6e28 7365 7428       if len(set(
-00023e00: 6f72 6465 725f 6f63 6375 7229 2920 3c3d  order_occur)) <=
-00023e10: 313a 2063 6f6e 7469 6e75 650a 2020 2020  1: continue.    
-00023e20: 2020 2020 4d69 6e69 6e75 6d5f 6c69 6d69      Mininum_limi
-00023e30: 742c 4d61 7869 6d75 6d5f 6c69 6d69 742c  t,Maximum_limit,
-00023e40: 6f72 6465 725f 6f63 6375 7220 3d20 302c  order_occur = 0,
-00023e50: 302c 5b5d 0a20 2020 2020 2020 2069 6620  0,[].        if 
-00023e60: 7768 6f6c 6574 7265 653a 0a20 2020 2020  wholetree:.     
-00023e70: 2020 2020 2020 2074 6f74 616c 5f63 6c61         total_cla
-00023e80: 6465 7320 3d20 6765 746f 7461 6c63 616c  des = getotalcal
-00023e90: 6465 7328 636c 6164 652c 7461 786f 6e6f  des(clade,taxono
-00023ea0: 6d79 5f64 6963 7429 0a20 2020 2020 2020  my_dict).       
-00023eb0: 2065 6c73 653a 0a20 2020 2020 2020 2020   else:.         
-00023ec0: 2020 2074 6f74 616c 5f63 6c61 6465 7320     total_clades 
-00023ed0: 3d20 636c 6164 652e 6765 745f 7465 726d  = clade.get_term
-00023ee0: 696e 616c 7328 290a 2020 2020 2020 2020  inals().        
-00023ef0: 666f 7220 7469 7020 696e 2074 6f74 616c  for tip in total
-00023f00: 5f63 6c61 6465 733a 0a20 2020 2020 2020  _clades:.       
-00023f10: 2020 2020 2061 6765 203d 204f 7264 6572       age = Order
-00023f20: 735f 426f 756e 6473 2e67 6574 2874 6178  s_Bounds.get(tax
-00023f30: 6f6e 6f6d 795f 6469 6374 5b74 6970 2e6e  onomy_dict[tip.n
-00023f40: 616d 655d 5b27 6f72 6465 7227 5d2c 3029  ame]['order'],0)
-00023f50: 2f31 3030 2069 6620 6e6f 7420 7768 6f6c  /100 if not whol
-00023f60: 6574 7265 6520 656c 7365 204f 7264 6572  etree else Order
-00023f70: 735f 426f 756e 6473 2e67 6574 2874 6970  s_Bounds.get(tip
-00023f80: 2e6e 616d 652c 3029 2f31 3030 0a20 2020  .name,0)/100.   
-00023f90: 2020 2020 2020 2020 2069 6620 6167 6520           if age 
-00023fa0: 3e20 4d69 6e69 6e75 6d5f 6c69 6d69 743a  > Mininum_limit:
-00023fb0: 204d 696e 696e 756d 5f6c 696d 6974 203d   Mininum_limit =
-00023fc0: 2061 6765 0a20 2020 2020 2020 2020 2020   age.           
-00023fd0: 2069 6620 5961 6e67 3a0a 2020 2020 2020   if Yang:.      
-00023fe0: 2020 2020 2020 2020 2020 7570 7065 725f            upper_
-00023ff0: 6167 6520 3d20 436c 6164 6573 5f55 7070  age = Clades_Upp
-00024000: 6572 5f42 6f75 6e64 735f 466f 6c6c 6f77  er_Bounds_Follow
-00024010: 5961 6e67 2e67 6574 2874 6178 6f6e 6f6d  Yang.get(taxonom
-00024020: 795f 6469 6374 5b74 6970 2e6e 616d 655d  y_dict[tip.name]
-00024030: 5b27 6f72 6465 7227 5d2c 3029 2f31 3030  ['order'],0)/100
-00024040: 2069 6620 6e6f 7420 7768 6f6c 6574 7265   if not wholetre
-00024050: 6520 656c 7365 2043 6c61 6465 735f 5570  e else Clades_Up
-00024060: 7065 725f 426f 756e 6473 5f46 6f6c 6c6f  per_Bounds_Follo
-00024070: 7759 616e 672e 6765 7428 7469 702e 6e61  wYang.get(tip.na
-00024080: 6d65 2c30 292f 3130 300a 2020 2020 2020  me,0)/100.      
-00024090: 2020 2020 2020 656c 7365 3a0a 2020 2020        else:.    
-000240a0: 2020 2020 2020 2020 2020 2020 7570 7065              uppe
-000240b0: 725f 6167 6520 3d20 436c 6164 6573 5f55  r_age = Clades_U
-000240c0: 7070 6572 5f42 6f75 6e64 732e 6765 7428  pper_Bounds.get(
-000240d0: 7461 786f 6e6f 6d79 5f64 6963 745b 7469  taxonomy_dict[ti
-000240e0: 702e 6e61 6d65 5d5b 276f 7264 6572 275d  p.name]['order']
-000240f0: 2c30 292f 3130 3020 6966 206e 6f74 2077  ,0)/100 if not w
-00024100: 686f 6c65 7472 6565 2065 6c73 6520 436c  holetree else Cl
-00024110: 6164 6573 5f55 7070 6572 5f42 6f75 6e64  ades_Upper_Bound
-00024120: 732e 6765 7428 7469 702e 6e61 6d65 2c30  s.get(tip.name,0
-00024130: 292f 3130 300a 2020 2020 2020 2020 2020  )/100.          
-00024140: 2020 6966 2075 7070 6572 5f61 6765 203e    if upper_age >
-00024150: 204d 6178 696d 756d 5f6c 696d 6974 3a20   Maximum_limit: 
-00024160: 4d61 7869 6d75 6d5f 6c69 6d69 7420 3d20  Maximum_limit = 
-00024170: 7570 7065 725f 6167 650a 2020 2020 2020  upper_age.      
-00024180: 2020 636c 6164 652e 6e61 6d65 203d 2027    clade.name = '
-00024190: 5b3e 7b30 3a2e 3466 7d3c 7b31 3a2e 3466  [>{0:.4f}<{1:.4f
-000241a0: 7d5d 272e 666f 726d 6174 284d 696e 696e  }]'.format(Minin
-000241b0: 756d 5f6c 696d 6974 2c4d 6178 696d 756d  um_limit,Maximum
-000241c0: 5f6c 696d 6974 290a 2020 2020 5068 796c  _limit).    Phyl
-000241d0: 6f2e 7772 6974 6528 5472 6565 2c74 7265  o.write(Tree,tre
-000241e0: 6566 2c20 226e 6577 6963 6b22 290a 2020  ef, "newick").  
-000241f0: 2020 706f 7374 7072 6f63 6573 7374 7265    postprocesstre
-00024200: 6528 7472 6565 6629 0a20 2020 2066 6f72  e(treef).    for
-00024210: 2063 6c61 6465 2069 6e20 5472 6565 2e67   clade in Tree.g
-00024220: 6574 5f74 6572 6d69 6e61 6c73 2829 3a20  et_terminals(): 
-00024230: 636c 6164 652e 6e61 6d65 203d 2074 6178  clade.name = tax
-00024240: 6f6e 6f6d 795f 6469 6374 5b63 6c61 6465  onomy_dict[clade
-00024250: 2e6e 616d 655d 5b27 6f72 6465 7227 5d0a  .name]['order'].
-00024260: 2020 2020 5068 796c 6f2e 7772 6974 6528      Phylo.write(
-00024270: 5472 6565 2c74 7265 6566 7461 782c 2022  Tree,treeftax, "
-00024280: 6e65 7769 636b 2229 0a20 2020 2070 6f73  newick").    pos
-00024290: 7470 726f 6365 7373 7472 6565 2874 7265  tprocesstree(tre
-000242a0: 6566 7461 7829 0a20 2020 2069 6620 666f  eftax).    if fo
-000242b0: 726d 6174 743a 0a20 2020 2020 2020 2066  rmatt:.        f
-000242c0: 6f72 6d61 746d 636d 6374 7265 6528 6c65  ormatmcmctree(le
-000242d0: 6e28 5472 6565 2e67 6574 5f74 6572 6d69  n(Tree.get_termi
-000242e0: 6e61 6c73 2829 292c 7472 6565 6629 0a20  nals()),treef). 
-000242f0: 2020 2020 2020 2066 6f72 6d61 746d 636d         formatmcm
-00024300: 6374 7265 6528 6c65 6e28 5472 6565 2e67  ctree(len(Tree.g
-00024310: 6574 5f74 6572 6d69 6e61 6c73 2829 292c  et_terminals()),
-00024320: 7472 6565 6674 6178 290a 2020 2020 6966  treeftax).    if
-00024330: 2046 6f63 7573 5f73 7020 213d 4e6f 6e65   Focus_sp !=None
-00024340: 3a0a 2020 2020 2020 2020 666f 726d 6174  :.        format
-00024350: 666f 6375 7373 7028 7472 6565 662c 466f  focussp(treef,Fo
-00024360: 6375 735f 7370 290a 2020 2020 2020 2020  cus_sp).        
-00024370: 666f 726d 6174 666f 6375 7373 7028 7472  formatfocussp(tr
-00024380: 6565 6674 6178 2c46 6f63 7573 5f73 7029  eeftax,Focus_sp)
-00024390: 0a20 2020 2072 6574 7572 6e20 7472 6565  .    return tree
-000243a0: 660a 0a64 6566 2066 6f72 6d61 7466 6f63  f..def formatfoc
-000243b0: 7573 7370 2866 6e61 6d65 2c46 6f63 7573  ussp(fname,Focus
-000243c0: 5f73 7029 3a0a 2020 2020 7769 7468 206f  _sp):.    with o
-000243d0: 7065 6e28 666e 616d 652c 2272 2229 2061  pen(fname,"r") a
-000243e0: 7320 663a 2063 6f6e 7465 6e74 203d 2066  s f: content = f
-000243f0: 2e72 6561 6428 290a 2020 2020 7769 7468  .read().    with
-00024400: 206f 7065 6e28 666e 616d 652c 2277 2229   open(fname,"w")
-00024410: 2061 7320 663a 2066 2e77 7269 7465 2863   as f: f.write(c
-00024420: 6f6e 7465 6e74 2e72 6570 6c61 6365 2846  ontent.replace(F
-00024430: 6f63 7573 5f73 702b 222c 222c 466f 6375  ocus_sp+",",Focu
-00024440: 735f 7370 2b22 5f61 7031 2c22 292e 7265  s_sp+"_ap1,").re
-00024450: 706c 6163 6528 466f 6375 735f 7370 2b22  place(Focus_sp+"
-00024460: 2922 2c46 6f63 7573 5f73 702b 225f 6170  )",Focus_sp+"_ap
-00024470: 3229 2229 290a 0a64 6566 2066 6f72 6d61  2)"))..def forma
-00024480: 746d 636d 6374 7265 6528 7370 6e75 6d2c  tmcmctree(spnum,
-00024490: 666e 616d 6529 3a0a 2020 2020 7769 7468  fname):.    with
-000244a0: 206f 7065 6e28 666e 616d 652c 2272 2229   open(fname,"r")
-000244b0: 2061 7320 663a 2063 6f6e 7465 6e74 203d   as f: content =
-000244c0: 2066 2e72 6561 6428 290a 2020 2020 7769   f.read().    wi
-000244d0: 7468 206f 7065 6e28 666e 616d 652c 2277  th open(fname,"w
-000244e0: 2229 2061 7320 663a 0a20 2020 2020 2020  ") as f:.       
-000244f0: 2066 2e77 7269 7465 2822 7b7d 2031 5c6e   f.write("{} 1\n
-00024500: 7b7d 222e 666f 726d 6174 2873 706e 756d  {}".format(spnum
-00024510: 2c63 6f6e 7465 6e74 2929 0a0a 6465 6620  ,content))..def 
-00024520: 6765 746f 7461 6c63 616c 6465 7328 636c  getotalcaldes(cl
-00024530: 6164 652c 7461 786f 6e6f 6d79 5f64 6963  ade,taxonomy_dic
-00024540: 7429 3a0a 2020 2020 6861 6e64 6c65 203d  t):.    handle =
-00024550: 2053 7472 696e 6749 4f28 4150 475f 4956   StringIO(APG_IV
-00024560: 5f4d 6f64 6966 6965 645f 5472 6565 290a  _Modified_Tree).
-00024570: 2020 2020 5472 6565 203d 2050 6879 6c6f      Tree = Phylo
-00024580: 2e72 6561 6428 6861 6e64 6c65 2c22 6e65  .read(handle,"ne
-00024590: 7769 636b 2229 0a20 2020 206f 7272 7572  wick").    orrur
-000245a0: 7265 645f 636c 6164 6573 203d 205b 7461  red_clades = [ta
-000245b0: 786f 6e6f 6d79 5f64 6963 745b 7469 702e  xonomy_dict[tip.
-000245c0: 6e61 6d65 5d5b 276f 7264 6572 275d 2066  name]['order'] f
-000245d0: 6f72 2074 6970 2069 6e20 636c 6164 652e  or tip in clade.
-000245e0: 6765 745f 7465 726d 696e 616c 7328 295d  get_terminals()]
-000245f0: 0a20 2020 204d 5243 415f 4e6f 6465 203d  .    MRCA_Node =
-00024600: 2054 7265 652e 636f 6d6d 6f6e 5f61 6e63   Tree.common_anc
-00024610: 6573 746f 7228 2a6f 7272 7572 7265 645f  estor(*orrurred_
-00024620: 636c 6164 6573 290a 2020 2020 7265 7475  clades).    retu
-00024630: 726e 204d 5243 415f 4e6f 6465 2e67 6574  rn MRCA_Node.get
-00024640: 5f74 6572 6d69 6e61 6c73 2829 0a0a 6465  _terminals()..de
-00024650: 6620 6669 6e64 6e65 6967 6862 6f72 2862  f findneighbor(b
-00024660: 656c 6f6e 6765 645f 6f72 6465 722c 6e75  elonged_order,nu
-00024670: 6d62 6572 3d38 293a 0a20 2020 2023 2054  mber=8):.    # T
-00024680: 6865 206e 756d 6265 7220 6865 7265 2069  he number here i
-00024690: 7320 7468 6520 6e75 6d62 6572 206f 6620  s the number of 
-000246a0: 6f72 6465 7273 0a20 2020 2068 616e 646c  orders.    handl
-000246b0: 6520 3d20 5374 7269 6e67 494f 2841 5047  e = StringIO(APG
-000246c0: 5f49 565f 4d6f 6469 6669 6564 5f54 7265  _IV_Modified_Tre
-000246d0: 6529 0a20 2020 2054 7265 6520 3d20 5068  e).    Tree = Ph
-000246e0: 796c 6f2e 7265 6164 2868 616e 646c 652c  ylo.read(handle,
-000246f0: 226e 6577 6963 6b22 290a 2020 2020 416c  "newick").    Al
-00024700: 6c5f 436c 6164 6573 203d 205b 692e 6e61  l_Clades = [i.na
-00024710: 6d65 2066 6f72 2069 2069 6e20 5472 6565  me for i in Tree
-00024720: 2e67 6574 5f74 6572 6d69 6e61 6c73 2829  .get_terminals()
-00024730: 5d0a 2020 2020 6e65 6564 6564 5f6d 7263  ].    needed_mrc
-00024740: 6120 3d20 4e6f 6e65 0a20 2020 2066 6f72  a = None.    for
-00024750: 206d 7263 6120 696e 206d 6170 286c 616d   mrca in map(lam
-00024760: 6264 6120 783a 5472 6565 2e63 6f6d 6d6f  bda x:Tree.commo
-00024770: 6e5f 616e 6365 7374 6f72 2878 2c62 656c  n_ancestor(x,bel
-00024780: 6f6e 6765 645f 6f72 6465 7229 2c41 6c6c  onged_order),All
-00024790: 5f43 6c61 6465 7329 3a0a 2020 2020 2020  _Clades):.      
-000247a0: 2020 6966 206c 656e 286d 7263 612e 6765    if len(mrca.ge
-000247b0: 745f 7465 726d 696e 616c 7328 2929 203d  t_terminals()) =
-000247c0: 3d20 6e75 6d62 6572 3a0a 2020 2020 2020  = number:.      
-000247d0: 2020 2020 2020 206e 6565 6465 645f 6d72         needed_mr
-000247e0: 6361 203d 206d 7263 610a 2020 2020 2020  ca = mrca.      
-000247f0: 2020 2020 2020 2062 7265 616b 0a20 2020         break.   
-00024800: 2072 6574 7572 6e20 6e65 6564 6564 5f6d   return needed_m
-00024810: 7263 610a 0a64 6566 2072 6570 6c61 6365  rca..def replace
-00024820: 7370 6563 6965 7328 636f 6e74 656e 742c  species(content,
-00024830: 436c 6164 655f 6e61 6d65 732c 6f6e 6c79  Clade_names,only
-00024840: 6f6e 653d 4661 6c73 6529 3a0a 2020 2020  one=False):.    
-00024850: 6f72 6967 696e 616c 5f73 705f 6e75 6d20  original_sp_num 
-00024860: 3d20 696e 7428 636f 6e74 656e 742e 7370  = int(content.sp
-00024870: 6c69 7428 275c 6e27 295b 305d 2e73 706c  lit('\n')[0].spl
-00024880: 6974 2827 2027 295b 305d 290a 2020 2020  it(' ')[0]).    
-00024890: 666f 7220 6920 696e 2043 6c61 6465 5f6e  for i in Clade_n
-000248a0: 616d 6573 3a0a 2020 2020 2020 2020 6966  ames:.        if
-000248b0: 2069 2e65 6e64 7377 6974 6828 225f 6170   i.endswith("_ap
-000248c0: 3122 2920 6f72 2069 2e65 6e64 7377 6974  1") or i.endswit
-000248d0: 6828 225f 6170 3222 293a 2063 6f6e 7469  h("_ap2"): conti
-000248e0: 6e75 650a 2020 2020 2020 2020 2361 6464  nue.        #add
-000248f0: 6564 5f6e 756d 203d 206c 656e 284f 7264  ed_num = len(Ord
-00024900: 6572 735f 7265 706c 6163 655f 5370 6563  ers_replace_Spec
-00024910: 6965 735b 695d 2e73 706c 6974 2827 2c27  ies[i].split(','
-00024920: 2929 202d 2031 0a20 2020 2020 2020 2023  )) - 1.        #
-00024930: 6669 6e61 6c5f 7370 5f6e 756d 203d 206f  final_sp_num = o
-00024940: 7269 6769 6e61 6c5f 7370 5f6e 756d 202b  riginal_sp_num +
-00024950: 2061 6464 6564 5f6e 756d 0a20 2020 2020   added_num.     
-00024960: 2020 2069 6620 6f6e 6c79 6f6e 653a 0a20     if onlyone:. 
-00024970: 2020 2020 2020 2020 2020 2063 6f6e 7465             conte
-00024980: 6e74 203d 2063 6f6e 7465 6e74 2e72 6570  nt = content.rep
-00024990: 6c61 6365 2869 2c4f 7264 6572 735f 7265  lace(i,Orders_re
-000249a0: 706c 6163 655f 4f6e 655f 5370 6563 6965  place_One_Specie
-000249b0: 735b 695d 290a 2020 2020 2020 2020 2020  s[i]).          
-000249c0: 2020 6c6f 6767 696e 672e 696e 666f 2822    logging.info("
-000249d0: 5265 7072 6573 656e 7461 7469 7665 2073  Representative s
-000249e0: 7065 6369 6573 206f 6620 7b30 7d3a 207b  pecies of {0}: {
-000249f0: 317d 222e 666f 726d 6174 2869 2c4f 7264  1}".format(i,Ord
-00024a00: 6572 735f 7265 706c 6163 655f 4f6e 655f  ers_replace_One_
-00024a10: 5370 6563 6965 735b 695d 2929 0a20 2020  Species[i])).   
-00024a20: 2020 2020 2065 6c73 653a 0a20 2020 2020       else:.     
-00024a30: 2020 2020 2020 2063 6f6e 7465 6e74 203d         content =
-00024a40: 2063 6f6e 7465 6e74 2e72 6570 6c61 6365   content.replace
-00024a50: 2869 2c4f 7264 6572 735f 7265 706c 6163  (i,Orders_replac
-00024a60: 655f 5370 6563 6965 735b 695d 290a 2020  e_Species[i]).  
-00024a70: 2020 2020 2020 2020 2020 6c6f 6767 696e            loggin
-00024a80: 672e 696e 666f 2822 5265 7072 6573 656e  g.info("Represen
-00024a90: 7461 7469 7665 2073 7065 6369 6573 206f  tative species o
-00024aa0: 6620 7b30 7d3a 207b 317d 222e 666f 726d  f {0}: {1}".form
-00024ab0: 6174 2869 2c4f 7264 6572 735f 7265 706c  at(i,Orders_repl
-00024ac0: 6163 655f 5370 6563 6965 735b 695d 2e72  ace_Species[i].r
-00024ad0: 6570 6c61 6365 2827 2829 272c 2727 2929  eplace('()',''))
-00024ae0: 290a 2020 2020 6861 6e64 6c65 203d 2053  ).    handle = S
-00024af0: 7472 696e 6749 4f28 636f 6e74 656e 742e  tringIO(content.
-00024b00: 7370 6c69 7428 225c 6e22 295b 315d 290a  split("\n")[1]).
-00024b10: 2020 2020 5472 6565 203d 2050 6879 6c6f      Tree = Phylo
-00024b20: 2e72 6561 6428 6861 6e64 6c65 2c22 6e65  .read(handle,"ne
-00024b30: 7769 636b 2229 0a20 2020 2073 706e 756d  wick").    spnum
-00024b40: 203d 206c 656e 2854 7265 652e 6765 745f   = len(Tree.get_
-00024b50: 7465 726d 696e 616c 7328 2929 0a20 2020  terminals()).   
-00024b60: 2077 6974 6820 6f70 656e 2822 7370 7b7d   with open("sp{}
-00024b70: 5f73 7065 6369 6573 5f6c 6973 745f 7370  _species_list_sp
-00024b80: 6163 6522 2e66 6f72 6d61 7428 7370 6e75  ace".format(spnu
-00024b90: 6d29 2c22 7722 2920 6173 2066 3a0a 2020  m),"w") as f:.  
-00024ba0: 2020 2020 2020 666f 6375 7373 7020 3d20        focussp = 
-00024bb0: 2727 0a20 2020 2020 2020 2066 6f72 2069  ''.        for i
-00024bc0: 2069 6e20 5472 6565 2e67 6574 5f74 6572   in Tree.get_ter
-00024bd0: 6d69 6e61 6c73 2829 3a0a 2020 2020 2020  minals():.      
-00024be0: 2020 2020 2020 6966 2069 2e6e 616d 652e        if i.name.
-00024bf0: 656e 6473 7769 7468 2822 5f61 7032 2229  endswith("_ap2")
-00024c00: 206f 7220 692e 6e61 6d65 2e65 6e64 7377   or i.name.endsw
-00024c10: 6974 6828 225f 6170 3122 293a 0a20 2020  ith("_ap1"):.   
-00024c20: 2020 2020 2020 2020 2020 2020 2066 6f63               foc
-00024c30: 7573 7370 203d 2069 2e6e 616d 655b 3a2d  ussp = i.name[:-
-00024c40: 345d 0a20 2020 2020 2020 2020 2020 2020  4].             
-00024c50: 2020 2063 6f6e 7469 6e75 650a 2020 2020     continue.    
-00024c60: 2020 2020 2020 2020 662e 7772 6974 6528          f.write(
-00024c70: 227b 7d20 222e 666f 726d 6174 2869 2e6e  "{} ".format(i.n
-00024c80: 616d 6529 290a 2020 2020 2020 2020 662e  ame)).        f.
-00024c90: 7772 6974 6528 227b 7d22 2e66 6f72 6d61  write("{}".forma
-00024ca0: 7428 666f 6375 7373 7029 290a 2020 2020  t(focussp)).    
-00024cb0: 7769 7468 206f 7065 6e28 2273 707b 7d5f  with open("sp{}_
-00024cc0: 7370 6563 6965 735f 6c69 7374 5f6c 696e  species_list_lin
-00024cd0: 6573 222e 666f 726d 6174 2873 706e 756d  es".format(spnum
-00024ce0: 292c 2277 2229 2061 7320 663a 0a20 2020  ),"w") as f:.   
-00024cf0: 2020 2020 2066 6f63 7573 7370 203d 2027       focussp = '
-00024d00: 270a 2020 2020 2020 2020 666f 7220 6920  '.        for i 
-00024d10: 696e 2054 7265 652e 6765 745f 7465 726d  in Tree.get_term
-00024d20: 696e 616c 7328 293a 0a20 2020 2020 2020  inals():.       
-00024d30: 2020 2020 2069 6620 692e 6e61 6d65 2e65       if i.name.e
-00024d40: 6e64 7377 6974 6828 225f 6170 3222 2920  ndswith("_ap2") 
-00024d50: 6f72 2069 2e6e 616d 652e 656e 6473 7769  or i.name.endswi
-00024d60: 7468 2822 5f61 7031 2229 3a0a 2020 2020  th("_ap1"):.    
-00024d70: 2020 2020 2020 2020 2020 2020 666f 6375              focu
-00024d80: 7373 7020 3d20 692e 6e61 6d65 5b3a 2d34  ssp = i.name[:-4
-00024d90: 5d0a 2020 2020 2020 2020 2020 2020 2020  ].              
-00024da0: 2020 636f 6e74 696e 7565 0a20 2020 2020    continue.     
-00024db0: 2020 2020 2020 2066 2e77 7269 7465 2822         f.write("
-00024dc0: 7b7d 5c6e 222e 666f 726d 6174 2869 2e6e  {}\n".format(i.n
-00024dd0: 616d 6529 290a 2020 2020 2020 2020 662e  ame)).        f.
-00024de0: 7772 6974 6528 227b 7d22 2e66 6f72 6d61  write("{}".forma
-00024df0: 7428 666f 6375 7373 7029 290a 2020 2020  t(focussp)).    
-00024e00: 636f 6e74 656e 7420 3d20 636f 6e74 656e  content = conten
-00024e10: 742e 7265 706c 6163 6528 7374 7228 6f72  t.replace(str(or
-00024e20: 6967 696e 616c 5f73 705f 6e75 6d29 2b22  iginal_sp_num)+"
-00024e30: 2022 2c73 7472 2873 706e 756d 292b 2220   ",str(spnum)+" 
-00024e40: 2229 0a20 2020 2072 6574 7572 6e20 636f  ").    return co
-00024e50: 6e74 656e 742c 2073 706e 756d 0a0a 6465  ntent, spnum..de
-00024e60: 6620 6765 7470 726f 7065 7273 7461 7274  f getproperstart
-00024e70: 696e 6774 7265 6528 7472 6565 662c 6e75  ingtree(treef,nu
-00024e80: 6d62 6572 2c6f 7574 6469 722c 6f6e 6c79  mber,outdir,only
-00024e90: 6f6e 653d 4661 6c73 6529 3a0a 2020 2020  one=False):.    
-00024ea0: 2320 4f6e 6c79 2077 6f72 6b73 2066 6f72  # Only works for
-00024eb0: 206f 7264 6572 2d6c 6576 656c 2f6f 7220   order-level/or 
-00024ec0: 6d6f 7265 2072 6563 656e 7420 5747 4473  more recent WGDs
-00024ed0: 0a20 2020 2054 7265 6520 3d20 5068 796c  .    Tree = Phyl
-00024ee0: 6f2e 7265 6164 2874 7265 6566 2c22 6e65  o.read(treef,"ne
-00024ef0: 7769 636b 2229 0a20 2020 2043 6c61 6465  wick").    Clade
-00024f00: 5f6e 616d 6573 203d 205b 692e 6e61 6d65  _names = [i.name
-00024f10: 2066 6f72 2069 2069 6e20 5472 6565 2e67   for i in Tree.g
-00024f20: 6574 5f74 6572 6d69 6e61 6c73 2829 5d0a  et_terminals()].
-00024f30: 2020 2020 7769 7468 206f 7065 6e28 7472      with open(tr
-00024f40: 6565 662c 2272 2229 2061 7320 663a 2063  eef,"r") as f: c
-00024f50: 6f6e 7465 6e74 203d 2066 2e72 6561 6428  ontent = f.read(
-00024f60: 290a 2020 2020 636f 6e74 656e 742c 2073  ).    content, s
-00024f70: 706e 756d 203d 2072 6570 6c61 6365 7370  pnum = replacesp
-00024f80: 6563 6965 7328 636f 6e74 656e 742c 436c  ecies(content,Cl
-00024f90: 6164 655f 6e61 6d65 732c 6f6e 6c79 6f6e  ade_names,onlyon
-00024fa0: 653d 6f6e 6c79 6f6e 6529 0a20 2020 2077  e=onlyone).    w
-00024fb0: 6974 6820 6f70 656e 2874 7265 6566 2b27  ith open(treef+'
-00024fc0: 5f7b 7d73 7027 2e66 6f72 6d61 7428 7370  _{}sp'.format(sp
-00024fd0: 6e75 6d29 2c22 7722 2920 6173 2066 3a20  num),"w") as f: 
-00024fe0: 662e 7772 6974 6528 636f 6e74 656e 7429  f.write(content)
-00024ff0: 0a0a 6465 6620 6f74 6865 7270 6170 6572  ..def otherpaper
-00025000: 6573 7469 6d61 7465 2864 6174 6129 3a0a  estimate(data):.
-00025010: 2020 2020 6d61 7869 6d75 6d5f 6f74 6865      maximum_othe
-00025020: 725f 7061 7065 7220 3d20 7b27 6575 6469  r_paper = {'eudi
-00025030: 636f 7473 273a 307d 0a0a 6465 6620 7265  cots':0}..def re
-00025040: 7368 7566 666c 654d 5341 2866 6e5f 6d73  shuffleMSA(fn_ms
-00025050: 6129 3a0a 2020 2020 6d73 6120 3d20 416c  a):.    msa = Al
-00025060: 6967 6e49 4f2e 7265 6164 2866 6e5f 6d73  ignIO.read(fn_ms
-00025070: 612c 2266 6173 7461 2229 0a20 2020 2023  a,"fasta").    #
-00025080: 2066 6972 7374 2073 656c 6563 7420 6120   first select a 
-00025090: 7261 6e64 6f6d 2073 7065 6369 6573 0a20  random species. 
-000250a0: 2020 2073 6875 6666 6c65 645f 7370 203d     shuffled_sp =
-000250b0: 206d 7361 5b6e 702e 7261 6e64 6f6d 2e72   msa[np.random.r
-000250c0: 616e 6469 6e74 2830 2c6c 656e 286d 7361  andint(0,len(msa
-000250d0: 2929 5d0a 2020 2020 7265 5f73 6875 6666  ))].    re_shuff
-000250e0: 6c65 645f 7370 203d 2072 6573 6875 6666  led_sp = reshuff
-000250f0: 6c65 7365 7128 7368 7566 666c 6564 5f73  leseq(shuffled_s
-00025100: 7029 0a0a 6465 6620 7265 7368 7566 666c  p)..def reshuffl
-00025110: 6573 6571 2873 6875 6666 6c65 645f 7370  eseq(shuffled_sp
-00025120: 293a 0a20 2020 2023 2073 6571 7565 6e63  ):.    # sequenc
-00025130: 6520 7265 706c 6163 656d 656e 7420 6361  e replacement ca
-00025140: 6e20 6265 2073 796e 6f6e 2061 6e64 206e  n be synon and n
-00025150: 6f6e 2d73 796e 6f6e 2c20 7765 2073 686f  on-synon, we sho
-00025160: 756c 6420 6d61 7962 6520 6573 7469 6d61  uld maybe estima
-00025170: 7465 2f61 7373 756d 6520 7468 6520 6469  te/assume the di
-00025180: 7374 7269 6275 7469 6f6e 206f 6620 770a  stribution of w.
-00025190: 2020 2020 4f72 6967 696e 616c 5f73 6571      Original_seq
-000251a0: 7565 6e63 6520 3d20 7374 7228 7368 7566  uence = str(shuf
-000251b0: 666c 6564 5f73 702e 7365 7129 0a20 2020  fled_sp.seq).   
-000251c0: 2023 666f 7220 6920 696e 2072 616e 6765   #for i in range
-000251d0: 2830 2c6c 656e 284f 7269 6769 6e61 6c5f  (0,len(Original_
-000251e0: 7365 7175 656e 6365 292c 3329 3a0a 2020  sequence),3):.  
-000251f0: 2020 2320 3372 6420 6e74 206f 6620 636f    # 3rd nt of co
-00025200: 646f 6e2c 2070 726f 6261 6269 6c74 7920  don, probabilty 
-00025210: 7361 6d70 6c65 6420 6672 6f6d 2061 206c  sampled from a l
-00025220: 6f67 6e6f 726d 616c 2064 6973 7472 6962  ognormal distrib
-00025230: 7574 696f 6e20 284f 7665 7261 6c6c 2070  ution (Overall p
-00025240: 726f 6261 6269 6c69 7479 2073 686f 756c  robability shoul
-00025250: 6420 666f 6c6c 6f77 206c 6f67 6e6f 726d  d follow lognorm
-00025260: 616c 2064 6973 7472 6962 7574 696f 6e2c  al distribution,
-00025270: 206d 6561 6e3d 302e 352c 2073 7464 3d30   mean=0.5, std=0
-00025280: 2e35 290a 2020 2020 2320 416e 2069 6465  .5).    # An ide
-00025290: 6120 6f66 2075 7369 6e67 2042 6179 6573  a of using Bayes
-000252a0: 6961 6e20 696e 6665 7265 6e63 6520 746f  ian inference to
-000252b0: 2067 6574 2061 6e20 4d4c 4520 6f66 2074   get an MLE of t
-000252c0: 6865 2070 726f 6162 696c 6974 792c 2072  he proability, r
-000252d0: 6571 7569 7265 7320 6120 7072 696f 7220  equires a prior 
-000252e0: 6469 7374 7269 6275 7469 6f6e 206f 6620  distribution of 
-000252f0: 7072 6f61 6269 6c69 7479 206f 6620 3173  proability of 1s
-00025300: 742c 2032 6e64 2c20 3372 6420 6e74 2063  t, 2nd, 3rd nt c
-00025310: 6861 6e67 6573 2c20 7768 6963 6820 6361  hanges, which ca
-00025320: 6e20 6265 206f 6274 6169 6e65 6420 6279  n be obtained by
-00025330: 2063 6f64 6f6e 2d61 6c69 676e 6d65 6e74   codon-alignment
-00025340: 2c20 6e70 2e6d 6561 6e28 746f 7461 6c20  , np.mean(total 
-00025350: 6e75 6d62 6572 206f 6620 3173 7420 6e74  number of 1st nt
-00025360: 2063 6861 6e67 6564 202f 746f 7461 6c20   changed /total 
-00025370: 6e75 6d62 6572 206f 6620 636f 646f 6e29  number of codon)
-00025380: 0a0a 0a23 6465 6620 7369 6d75 6c61 7465  ...#def simulate
-00025390: 4d61 7869 6d75 6d62 6f75 6e64 2873 7461  Maximumbound(sta
-000253a0: 7274 7472 6565 2c73 7065 6369 6573 706f  rttree,speciespo
-000253b0: 6f6c 293a 0a20 2020 2023 2073 7461 7274  ol):.    # start
-000253c0: 7472 6565 2077 6974 6820 7469 7020 6e61  tree with tip na
-000253d0: 6d65 7320 696e 206f 7264 6572 0a         mes in order.
+00023c60: 6966 2069 6e66 6f5b 276f 7264 6572 275d  if info['order']
+00023c70: 203d 3d20 2727 3a20 696e 666f 5b27 6f72   == '': info['or
+00023c80: 6465 7227 5d20 3d20 636c 6164 652e 6e61  der'] = clade.na
+00023c90: 6d65 2023 2054 6869 7320 7374 6570 2069  me # This step i
+00023ca0: 7320 7472 6963 6b79 2c20 6173 7375 6d69  s tricky, assumi
+00023cb0: 6e67 2074 6865 2069 6e70 7574 2069 7320  ng the input is 
+00023cc0: 616c 7265 6164 7920 6f72 6465 7220 6e61  already order na
+00023cd0: 6d65 0a20 2020 2020 2020 2074 6178 6f6e  me.        taxon
+00023ce0: 6f6d 795f 6469 6374 5b63 6c61 6465 2e6e  omy_dict[clade.n
+00023cf0: 616d 655d 203d 2069 6e66 6f0a 2020 2020  ame] = info.    
+00023d00: 2020 2020 6c6f 6767 696e 672e 696e 666f      logging.info
+00023d10: 2822 7b7d 2062 656c 6f6e 6773 2074 6f20  ("{} belongs to 
+00023d20: 7b7d 222e 666f 726d 6174 2863 6c61 6465  {}".format(clade
+00023d30: 2e6e 616d 652c 7461 786f 6e6f 6d79 5f64  .name,taxonomy_d
+00023d40: 6963 745b 636c 6164 652e 6e61 6d65 5d5b  ict[clade.name][
+00023d50: 276f 7264 6572 275d 2929 0a20 2020 2066  'order'])).    f
+00023d60: 6f72 2069 2c63 6c61 6465 2069 6e20 656e  or i,clade in en
+00023d70: 756d 6572 6174 6528 5472 6565 2e67 6574  umerate(Tree.get
+00023d80: 5f6e 6f6e 7465 726d 696e 616c 7328 2929  _nonterminals())
+00023d90: 3a0a 2020 2020 2020 2020 6f72 6465 725f  :.        order_
+00023da0: 6f63 6375 7220 3d20 5b74 6178 6f6e 6f6d  occur = [taxonom
+00023db0: 795f 6469 6374 5b74 6970 2e6e 616d 655d  y_dict[tip.name]
+00023dc0: 5b27 6f72 6465 7227 5d20 666f 7220 7469  ['order'] for ti
+00023dd0: 7020 696e 2063 6c61 6465 2e67 6574 5f74  p in clade.get_t
+00023de0: 6572 6d69 6e61 6c73 2829 5d0a 2020 2020  erminals()].    
+00023df0: 2020 2020 6966 206c 656e 2873 6574 286f      if len(set(o
+00023e00: 7264 6572 5f6f 6363 7572 2929 203c 3d31  rder_occur)) <=1
+00023e10: 3a20 636f 6e74 696e 7565 0a20 2020 2020  : continue.     
+00023e20: 2020 204d 696e 696e 756d 5f6c 696d 6974     Mininum_limit
+00023e30: 2c4d 6178 696d 756d 5f6c 696d 6974 2c6f  ,Maximum_limit,o
+00023e40: 7264 6572 5f6f 6363 7572 203d 2030 2c30  rder_occur = 0,0
+00023e50: 2c5b 5d0a 2020 2020 2020 2020 6966 2077  ,[].        if w
+00023e60: 686f 6c65 7472 6565 3a0a 2020 2020 2020  holetree:.      
+00023e70: 2020 2020 2020 746f 7461 6c5f 636c 6164        total_clad
+00023e80: 6573 203d 2067 6574 6f74 616c 6361 6c64  es = getotalcald
+00023e90: 6573 2863 6c61 6465 2c74 6178 6f6e 6f6d  es(clade,taxonom
+00023ea0: 795f 6469 6374 290a 2020 2020 2020 2020  y_dict).        
+00023eb0: 656c 7365 3a0a 2020 2020 2020 2020 2020  else:.          
+00023ec0: 2020 746f 7461 6c5f 636c 6164 6573 203d    total_clades =
+00023ed0: 2063 6c61 6465 2e67 6574 5f74 6572 6d69   clade.get_termi
+00023ee0: 6e61 6c73 2829 0a20 2020 2020 2020 2066  nals().        f
+00023ef0: 6f72 2074 6970 2069 6e20 746f 7461 6c5f  or tip in total_
+00023f00: 636c 6164 6573 3a0a 2020 2020 2020 2020  clades:.        
+00023f10: 2020 2020 6167 6520 3d20 4f72 6465 7273      age = Orders
+00023f20: 5f42 6f75 6e64 732e 6765 7428 7461 786f  _Bounds.get(taxo
+00023f30: 6e6f 6d79 5f64 6963 745b 7469 702e 6e61  nomy_dict[tip.na
+00023f40: 6d65 5d5b 276f 7264 6572 275d 2c30 292f  me]['order'],0)/
+00023f50: 3130 3020 6966 206e 6f74 2077 686f 6c65  100 if not whole
+00023f60: 7472 6565 2065 6c73 6520 4f72 6465 7273  tree else Orders
+00023f70: 5f42 6f75 6e64 732e 6765 7428 7469 702e  _Bounds.get(tip.
+00023f80: 6e61 6d65 2c30 292f 3130 300a 2020 2020  name,0)/100.    
+00023f90: 2020 2020 2020 2020 6966 2061 6765 203e          if age >
+00023fa0: 204d 696e 696e 756d 5f6c 696d 6974 3a20   Mininum_limit: 
+00023fb0: 4d69 6e69 6e75 6d5f 6c69 6d69 7420 3d20  Mininum_limit = 
+00023fc0: 6167 650a 2020 2020 2020 2020 2020 2020  age.            
+00023fd0: 6966 2059 616e 673a 0a20 2020 2020 2020  if Yang:.       
+00023fe0: 2020 2020 2020 2020 2075 7070 6572 5f61           upper_a
+00023ff0: 6765 203d 2043 6c61 6465 735f 5570 7065  ge = Clades_Uppe
+00024000: 725f 426f 756e 6473 5f46 6f6c 6c6f 7759  r_Bounds_FollowY
+00024010: 616e 672e 6765 7428 7461 786f 6e6f 6d79  ang.get(taxonomy
+00024020: 5f64 6963 745b 7469 702e 6e61 6d65 5d5b  _dict[tip.name][
+00024030: 276f 7264 6572 275d 2c30 292f 3130 3020  'order'],0)/100 
+00024040: 6966 206e 6f74 2077 686f 6c65 7472 6565  if not wholetree
+00024050: 2065 6c73 6520 436c 6164 6573 5f55 7070   else Clades_Upp
+00024060: 6572 5f42 6f75 6e64 735f 466f 6c6c 6f77  er_Bounds_Follow
+00024070: 5961 6e67 2e67 6574 2874 6970 2e6e 616d  Yang.get(tip.nam
+00024080: 652c 3029 2f31 3030 0a20 2020 2020 2020  e,0)/100.       
+00024090: 2020 2020 2065 6c73 653a 0a20 2020 2020       else:.     
+000240a0: 2020 2020 2020 2020 2020 2075 7070 6572             upper
+000240b0: 5f61 6765 203d 2043 6c61 6465 735f 5570  _age = Clades_Up
+000240c0: 7065 725f 426f 756e 6473 2e67 6574 2874  per_Bounds.get(t
+000240d0: 6178 6f6e 6f6d 795f 6469 6374 5b74 6970  axonomy_dict[tip
+000240e0: 2e6e 616d 655d 5b27 6f72 6465 7227 5d2c  .name]['order'],
+000240f0: 3029 2f31 3030 2069 6620 6e6f 7420 7768  0)/100 if not wh
+00024100: 6f6c 6574 7265 6520 656c 7365 2043 6c61  oletree else Cla
+00024110: 6465 735f 5570 7065 725f 426f 756e 6473  des_Upper_Bounds
+00024120: 2e67 6574 2874 6970 2e6e 616d 652c 3029  .get(tip.name,0)
+00024130: 2f31 3030 0a20 2020 2020 2020 2020 2020  /100.           
+00024140: 2069 6620 7570 7065 725f 6167 6520 3e20   if upper_age > 
+00024150: 4d61 7869 6d75 6d5f 6c69 6d69 743a 204d  Maximum_limit: M
+00024160: 6178 696d 756d 5f6c 696d 6974 203d 2075  aximum_limit = u
+00024170: 7070 6572 5f61 6765 0a20 2020 2020 2020  pper_age.       
+00024180: 2063 6c61 6465 2e6e 616d 6520 3d20 275b   clade.name = '[
+00024190: 3e7b 303a 2e34 667d 3c7b 313a 2e34 667d  >{0:.4f}<{1:.4f}
+000241a0: 5d27 2e66 6f72 6d61 7428 4d69 6e69 6e75  ]'.format(Mininu
+000241b0: 6d5f 6c69 6d69 742c 4d61 7869 6d75 6d5f  m_limit,Maximum_
+000241c0: 6c69 6d69 7429 0a20 2020 2050 6879 6c6f  limit).    Phylo
+000241d0: 2e77 7269 7465 2854 7265 652c 7472 6565  .write(Tree,tree
+000241e0: 662c 2022 6e65 7769 636b 2229 0a20 2020  f, "newick").   
+000241f0: 2070 6f73 7470 726f 6365 7373 7472 6565   postprocesstree
+00024200: 2874 7265 6566 290a 2020 2020 666f 7220  (treef).    for 
+00024210: 636c 6164 6520 696e 2054 7265 652e 6765  clade in Tree.ge
+00024220: 745f 7465 726d 696e 616c 7328 293a 2063  t_terminals(): c
+00024230: 6c61 6465 2e6e 616d 6520 3d20 7461 786f  lade.name = taxo
+00024240: 6e6f 6d79 5f64 6963 745b 636c 6164 652e  nomy_dict[clade.
+00024250: 6e61 6d65 5d5b 276f 7264 6572 275d 0a20  name]['order']. 
+00024260: 2020 2050 6879 6c6f 2e77 7269 7465 2854     Phylo.write(T
+00024270: 7265 652c 7472 6565 6674 6178 2c20 226e  ree,treeftax, "n
+00024280: 6577 6963 6b22 290a 2020 2020 706f 7374  ewick").    post
+00024290: 7072 6f63 6573 7374 7265 6528 7472 6565  processtree(tree
+000242a0: 6674 6178 290a 2020 2020 6966 2066 6f72  ftax).    if for
+000242b0: 6d61 7474 3a0a 2020 2020 2020 2020 666f  matt:.        fo
+000242c0: 726d 6174 6d63 6d63 7472 6565 286c 656e  rmatmcmctree(len
+000242d0: 2854 7265 652e 6765 745f 7465 726d 696e  (Tree.get_termin
+000242e0: 616c 7328 2929 2c74 7265 6566 290a 2020  als()),treef).  
+000242f0: 2020 2020 2020 666f 726d 6174 6d63 6d63        formatmcmc
+00024300: 7472 6565 286c 656e 2854 7265 652e 6765  tree(len(Tree.ge
+00024310: 745f 7465 726d 696e 616c 7328 2929 2c74  t_terminals()),t
+00024320: 7265 6566 7461 7829 0a20 2020 2069 6620  reeftax).    if 
+00024330: 466f 6375 735f 7370 2021 3d4e 6f6e 653a  Focus_sp !=None:
+00024340: 0a20 2020 2020 2020 2066 6f72 6d61 7466  .        formatf
+00024350: 6f63 7573 7370 2874 7265 6566 2c46 6f63  ocussp(treef,Foc
+00024360: 7573 5f73 7029 0a20 2020 2020 2020 2066  us_sp).        f
+00024370: 6f72 6d61 7466 6f63 7573 7370 2874 7265  ormatfocussp(tre
+00024380: 6566 7461 782c 466f 6375 735f 7370 290a  eftax,Focus_sp).
+00024390: 2020 2020 7265 7475 726e 2074 7265 6566      return treef
+000243a0: 0a0a 6465 6620 666f 726d 6174 666f 6375  ..def formatfocu
+000243b0: 7373 7028 666e 616d 652c 466f 6375 735f  ssp(fname,Focus_
+000243c0: 7370 293a 0a20 2020 2077 6974 6820 6f70  sp):.    with op
+000243d0: 656e 2866 6e61 6d65 2c22 7222 2920 6173  en(fname,"r") as
+000243e0: 2066 3a20 636f 6e74 656e 7420 3d20 662e   f: content = f.
+000243f0: 7265 6164 2829 0a20 2020 2077 6974 6820  read().    with 
+00024400: 6f70 656e 2866 6e61 6d65 2c22 7722 2920  open(fname,"w") 
+00024410: 6173 2066 3a20 662e 7772 6974 6528 636f  as f: f.write(co
+00024420: 6e74 656e 742e 7265 706c 6163 6528 466f  ntent.replace(Fo
+00024430: 6375 735f 7370 2b22 2c22 2c46 6f63 7573  cus_sp+",",Focus
+00024440: 5f73 702b 225f 6170 312c 2229 2e72 6570  _sp+"_ap1,").rep
+00024450: 6c61 6365 2846 6f63 7573 5f73 702b 2229  lace(Focus_sp+")
+00024460: 222c 466f 6375 735f 7370 2b22 5f61 7032  ",Focus_sp+"_ap2
+00024470: 2922 2929 0a0a 6465 6620 666f 726d 6174  )"))..def format
+00024480: 6d63 6d63 7472 6565 2873 706e 756d 2c66  mcmctree(spnum,f
+00024490: 6e61 6d65 293a 0a20 2020 2077 6974 6820  name):.    with 
+000244a0: 6f70 656e 2866 6e61 6d65 2c22 7222 2920  open(fname,"r") 
+000244b0: 6173 2066 3a20 636f 6e74 656e 7420 3d20  as f: content = 
+000244c0: 662e 7265 6164 2829 0a20 2020 2077 6974  f.read().    wit
+000244d0: 6820 6f70 656e 2866 6e61 6d65 2c22 7722  h open(fname,"w"
+000244e0: 2920 6173 2066 3a0a 2020 2020 2020 2020  ) as f:.        
+000244f0: 662e 7772 6974 6528 227b 7d20 315c 6e7b  f.write("{} 1\n{
+00024500: 7d22 2e66 6f72 6d61 7428 7370 6e75 6d2c  }".format(spnum,
+00024510: 636f 6e74 656e 7429 290a 0a64 6566 2067  content))..def g
+00024520: 6574 6f74 616c 6361 6c64 6573 2863 6c61  etotalcaldes(cla
+00024530: 6465 2c74 6178 6f6e 6f6d 795f 6469 6374  de,taxonomy_dict
+00024540: 293a 0a20 2020 2068 616e 646c 6520 3d20  ):.    handle = 
+00024550: 5374 7269 6e67 494f 2841 5047 5f49 565f  StringIO(APG_IV_
+00024560: 4d6f 6469 6669 6564 5f54 7265 6529 0a20  Modified_Tree). 
+00024570: 2020 2054 7265 6520 3d20 5068 796c 6f2e     Tree = Phylo.
+00024580: 7265 6164 2868 616e 646c 652c 226e 6577  read(handle,"new
+00024590: 6963 6b22 290a 2020 2020 6f72 7275 7272  ick").    orrurr
+000245a0: 6564 5f63 6c61 6465 7320 3d20 5b74 6178  ed_clades = [tax
+000245b0: 6f6e 6f6d 795f 6469 6374 5b74 6970 2e6e  onomy_dict[tip.n
+000245c0: 616d 655d 5b27 6f72 6465 7227 5d20 666f  ame]['order'] fo
+000245d0: 7220 7469 7020 696e 2063 6c61 6465 2e67  r tip in clade.g
+000245e0: 6574 5f74 6572 6d69 6e61 6c73 2829 5d0a  et_terminals()].
+000245f0: 2020 2020 4d52 4341 5f4e 6f64 6520 3d20      MRCA_Node = 
+00024600: 5472 6565 2e63 6f6d 6d6f 6e5f 616e 6365  Tree.common_ance
+00024610: 7374 6f72 282a 6f72 7275 7272 6564 5f63  stor(*orrurred_c
+00024620: 6c61 6465 7329 0a20 2020 2072 6574 7572  lades).    retur
+00024630: 6e20 4d52 4341 5f4e 6f64 652e 6765 745f  n MRCA_Node.get_
+00024640: 7465 726d 696e 616c 7328 290a 0a64 6566  terminals()..def
+00024650: 2066 696e 646e 6569 6768 626f 7228 6265   findneighbor(be
+00024660: 6c6f 6e67 6564 5f6f 7264 6572 2c6e 756d  longed_order,num
+00024670: 6265 723d 3829 3a0a 2020 2020 2320 5468  ber=8):.    # Th
+00024680: 6520 6e75 6d62 6572 2068 6572 6520 6973  e number here is
+00024690: 2074 6865 206e 756d 6265 7220 6f66 206f   the number of o
+000246a0: 7264 6572 730a 2020 2020 6861 6e64 6c65  rders.    handle
+000246b0: 203d 2053 7472 696e 6749 4f28 4150 475f   = StringIO(APG_
+000246c0: 4956 5f4d 6f64 6966 6965 645f 5472 6565  IV_Modified_Tree
+000246d0: 290a 2020 2020 5472 6565 203d 2050 6879  ).    Tree = Phy
+000246e0: 6c6f 2e72 6561 6428 6861 6e64 6c65 2c22  lo.read(handle,"
+000246f0: 6e65 7769 636b 2229 0a20 2020 2041 6c6c  newick").    All
+00024700: 5f43 6c61 6465 7320 3d20 5b69 2e6e 616d  _Clades = [i.nam
+00024710: 6520 666f 7220 6920 696e 2054 7265 652e  e for i in Tree.
+00024720: 6765 745f 7465 726d 696e 616c 7328 295d  get_terminals()]
+00024730: 0a20 2020 206e 6565 6465 645f 6d72 6361  .    needed_mrca
+00024740: 203d 204e 6f6e 650a 2020 2020 666f 7220   = None.    for 
+00024750: 6d72 6361 2069 6e20 6d61 7028 6c61 6d62  mrca in map(lamb
+00024760: 6461 2078 3a54 7265 652e 636f 6d6d 6f6e  da x:Tree.common
+00024770: 5f61 6e63 6573 746f 7228 782c 6265 6c6f  _ancestor(x,belo
+00024780: 6e67 6564 5f6f 7264 6572 292c 416c 6c5f  nged_order),All_
+00024790: 436c 6164 6573 293a 0a20 2020 2020 2020  Clades):.       
+000247a0: 2069 6620 6c65 6e28 6d72 6361 2e67 6574   if len(mrca.get
+000247b0: 5f74 6572 6d69 6e61 6c73 2829 2920 3d3d  _terminals()) ==
+000247c0: 206e 756d 6265 723a 0a20 2020 2020 2020   number:.       
+000247d0: 2020 2020 2020 6e65 6564 6564 5f6d 7263        needed_mrc
+000247e0: 6120 3d20 6d72 6361 0a20 2020 2020 2020  a = mrca.       
+000247f0: 2020 2020 2020 6272 6561 6b0a 2020 2020        break.    
+00024800: 7265 7475 726e 206e 6565 6465 645f 6d72  return needed_mr
+00024810: 6361 0a0a 6465 6620 7265 706c 6163 6573  ca..def replaces
+00024820: 7065 6369 6573 2863 6f6e 7465 6e74 2c43  pecies(content,C
+00024830: 6c61 6465 5f6e 616d 6573 2c6f 6e6c 796f  lade_names,onlyo
+00024840: 6e65 3d46 616c 7365 293a 0a20 2020 206f  ne=False):.    o
+00024850: 7269 6769 6e61 6c5f 7370 5f6e 756d 203d  riginal_sp_num =
+00024860: 2069 6e74 2863 6f6e 7465 6e74 2e73 706c   int(content.spl
+00024870: 6974 2827 5c6e 2729 5b30 5d2e 7370 6c69  it('\n')[0].spli
+00024880: 7428 2720 2729 5b30 5d29 0a20 2020 2066  t(' ')[0]).    f
+00024890: 6f72 2069 2069 6e20 436c 6164 655f 6e61  or i in Clade_na
+000248a0: 6d65 733a 0a20 2020 2020 2020 2069 6620  mes:.        if 
+000248b0: 692e 656e 6473 7769 7468 2822 5f61 7031  i.endswith("_ap1
+000248c0: 2229 206f 7220 692e 656e 6473 7769 7468  ") or i.endswith
+000248d0: 2822 5f61 7032 2229 3a20 636f 6e74 696e  ("_ap2"): contin
+000248e0: 7565 0a20 2020 2020 2020 2023 6164 6465  ue.        #adde
+000248f0: 645f 6e75 6d20 3d20 6c65 6e28 4f72 6465  d_num = len(Orde
+00024900: 7273 5f72 6570 6c61 6365 5f53 7065 6369  rs_replace_Speci
+00024910: 6573 5b69 5d2e 7370 6c69 7428 272c 2729  es[i].split(',')
+00024920: 2920 2d20 310a 2020 2020 2020 2020 2366  ) - 1.        #f
+00024930: 696e 616c 5f73 705f 6e75 6d20 3d20 6f72  inal_sp_num = or
+00024940: 6967 696e 616c 5f73 705f 6e75 6d20 2b20  iginal_sp_num + 
+00024950: 6164 6465 645f 6e75 6d0a 2020 2020 2020  added_num.      
+00024960: 2020 6966 206f 6e6c 796f 6e65 3a0a 2020    if onlyone:.  
+00024970: 2020 2020 2020 2020 2020 636f 6e74 656e            conten
+00024980: 7420 3d20 636f 6e74 656e 742e 7265 706c  t = content.repl
+00024990: 6163 6528 692c 4f72 6465 7273 5f72 6570  ace(i,Orders_rep
+000249a0: 6c61 6365 5f4f 6e65 5f53 7065 6369 6573  lace_One_Species
+000249b0: 5b69 5d29 0a20 2020 2020 2020 2020 2020  [i]).           
+000249c0: 206c 6f67 6769 6e67 2e69 6e66 6f28 2252   logging.info("R
+000249d0: 6570 7265 7365 6e74 6174 6976 6520 7370  epresentative sp
+000249e0: 6563 6965 7320 6f66 207b 307d 3a20 7b31  ecies of {0}: {1
+000249f0: 7d22 2e66 6f72 6d61 7428 692c 4f72 6465  }".format(i,Orde
+00024a00: 7273 5f72 6570 6c61 6365 5f4f 6e65 5f53  rs_replace_One_S
+00024a10: 7065 6369 6573 5b69 5d29 290a 2020 2020  pecies[i])).    
+00024a20: 2020 2020 656c 7365 3a0a 2020 2020 2020      else:.      
+00024a30: 2020 2020 2020 636f 6e74 656e 7420 3d20        content = 
+00024a40: 636f 6e74 656e 742e 7265 706c 6163 6528  content.replace(
+00024a50: 692c 4f72 6465 7273 5f72 6570 6c61 6365  i,Orders_replace
+00024a60: 5f53 7065 6369 6573 5b69 5d29 0a20 2020  _Species[i]).   
+00024a70: 2020 2020 2020 2020 206c 6f67 6769 6e67           logging
+00024a80: 2e69 6e66 6f28 2252 6570 7265 7365 6e74  .info("Represent
+00024a90: 6174 6976 6520 7370 6563 6965 7320 6f66  ative species of
+00024aa0: 207b 307d 3a20 7b31 7d22 2e66 6f72 6d61   {0}: {1}".forma
+00024ab0: 7428 692c 4f72 6465 7273 5f72 6570 6c61  t(i,Orders_repla
+00024ac0: 6365 5f53 7065 6369 6573 5b69 5d2e 7265  ce_Species[i].re
+00024ad0: 706c 6163 6528 2728 2927 2c27 2729 2929  place('()','')))
+00024ae0: 0a20 2020 2068 616e 646c 6520 3d20 5374  .    handle = St
+00024af0: 7269 6e67 494f 2863 6f6e 7465 6e74 2e73  ringIO(content.s
+00024b00: 706c 6974 2822 5c6e 2229 5b31 5d29 0a20  plit("\n")[1]). 
+00024b10: 2020 2054 7265 6520 3d20 5068 796c 6f2e     Tree = Phylo.
+00024b20: 7265 6164 2868 616e 646c 652c 226e 6577  read(handle,"new
+00024b30: 6963 6b22 290a 2020 2020 7370 6e75 6d20  ick").    spnum 
+00024b40: 3d20 6c65 6e28 5472 6565 2e67 6574 5f74  = len(Tree.get_t
+00024b50: 6572 6d69 6e61 6c73 2829 290a 2020 2020  erminals()).    
+00024b60: 7769 7468 206f 7065 6e28 2273 707b 7d5f  with open("sp{}_
+00024b70: 7370 6563 6965 735f 6c69 7374 5f73 7061  species_list_spa
+00024b80: 6365 222e 666f 726d 6174 2873 706e 756d  ce".format(spnum
+00024b90: 292c 2277 2229 2061 7320 663a 0a20 2020  ),"w") as f:.   
+00024ba0: 2020 2020 2066 6f63 7573 7370 203d 2027       focussp = '
+00024bb0: 270a 2020 2020 2020 2020 666f 7220 6920  '.        for i 
+00024bc0: 696e 2054 7265 652e 6765 745f 7465 726d  in Tree.get_term
+00024bd0: 696e 616c 7328 293a 0a20 2020 2020 2020  inals():.       
+00024be0: 2020 2020 2069 6620 692e 6e61 6d65 2e65       if i.name.e
+00024bf0: 6e64 7377 6974 6828 225f 6170 3222 2920  ndswith("_ap2") 
+00024c00: 6f72 2069 2e6e 616d 652e 656e 6473 7769  or i.name.endswi
+00024c10: 7468 2822 5f61 7031 2229 3a0a 2020 2020  th("_ap1"):.    
+00024c20: 2020 2020 2020 2020 2020 2020 666f 6375              focu
+00024c30: 7373 7020 3d20 692e 6e61 6d65 5b3a 2d34  ssp = i.name[:-4
+00024c40: 5d0a 2020 2020 2020 2020 2020 2020 2020  ].              
+00024c50: 2020 636f 6e74 696e 7565 0a20 2020 2020    continue.     
+00024c60: 2020 2020 2020 2066 2e77 7269 7465 2822         f.write("
+00024c70: 7b7d 2022 2e66 6f72 6d61 7428 692e 6e61  {} ".format(i.na
+00024c80: 6d65 2929 0a20 2020 2020 2020 2066 2e77  me)).        f.w
+00024c90: 7269 7465 2822 7b7d 222e 666f 726d 6174  rite("{}".format
+00024ca0: 2866 6f63 7573 7370 2929 0a20 2020 2077  (focussp)).    w
+00024cb0: 6974 6820 6f70 656e 2822 7370 7b7d 5f73  ith open("sp{}_s
+00024cc0: 7065 6369 6573 5f6c 6973 745f 6c69 6e65  pecies_list_line
+00024cd0: 7322 2e66 6f72 6d61 7428 7370 6e75 6d29  s".format(spnum)
+00024ce0: 2c22 7722 2920 6173 2066 3a0a 2020 2020  ,"w") as f:.    
+00024cf0: 2020 2020 666f 6375 7373 7020 3d20 2727      focussp = ''
+00024d00: 0a20 2020 2020 2020 2066 6f72 2069 2069  .        for i i
+00024d10: 6e20 5472 6565 2e67 6574 5f74 6572 6d69  n Tree.get_termi
+00024d20: 6e61 6c73 2829 3a0a 2020 2020 2020 2020  nals():.        
+00024d30: 2020 2020 6966 2069 2e6e 616d 652e 656e      if i.name.en
+00024d40: 6473 7769 7468 2822 5f61 7032 2229 206f  dswith("_ap2") o
+00024d50: 7220 692e 6e61 6d65 2e65 6e64 7377 6974  r i.name.endswit
+00024d60: 6828 225f 6170 3122 293a 0a20 2020 2020  h("_ap1"):.     
+00024d70: 2020 2020 2020 2020 2020 2066 6f63 7573             focus
+00024d80: 7370 203d 2069 2e6e 616d 655b 3a2d 345d  sp = i.name[:-4]
+00024d90: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00024da0: 2063 6f6e 7469 6e75 650a 2020 2020 2020   continue.      
+00024db0: 2020 2020 2020 662e 7772 6974 6528 227b        f.write("{
+00024dc0: 7d5c 6e22 2e66 6f72 6d61 7428 692e 6e61  }\n".format(i.na
+00024dd0: 6d65 2929 0a20 2020 2020 2020 2066 2e77  me)).        f.w
+00024de0: 7269 7465 2822 7b7d 222e 666f 726d 6174  rite("{}".format
+00024df0: 2866 6f63 7573 7370 2929 0a20 2020 2063  (focussp)).    c
+00024e00: 6f6e 7465 6e74 203d 2063 6f6e 7465 6e74  ontent = content
+00024e10: 2e72 6570 6c61 6365 2873 7472 286f 7269  .replace(str(ori
+00024e20: 6769 6e61 6c5f 7370 5f6e 756d 292b 2220  ginal_sp_num)+" 
+00024e30: 222c 7374 7228 7370 6e75 6d29 2b22 2022  ",str(spnum)+" "
+00024e40: 290a 2020 2020 7265 7475 726e 2063 6f6e  ).    return con
+00024e50: 7465 6e74 2c20 7370 6e75 6d0a 0a64 6566  tent, spnum..def
+00024e60: 2067 6574 7072 6f70 6572 7374 6172 7469   getproperstarti
+00024e70: 6e67 7472 6565 2874 7265 6566 2c6e 756d  ngtree(treef,num
+00024e80: 6265 722c 6f75 7464 6972 2c6f 6e6c 796f  ber,outdir,onlyo
+00024e90: 6e65 3d46 616c 7365 293a 0a20 2020 2023  ne=False):.    #
+00024ea0: 204f 6e6c 7920 776f 726b 7320 666f 7220   Only works for 
+00024eb0: 6f72 6465 722d 6c65 7665 6c2f 6f72 206d  order-level/or m
+00024ec0: 6f72 6520 7265 6365 6e74 2057 4744 730a  ore recent WGDs.
+00024ed0: 2020 2020 5472 6565 203d 2050 6879 6c6f      Tree = Phylo
+00024ee0: 2e72 6561 6428 7472 6565 662c 226e 6577  .read(treef,"new
+00024ef0: 6963 6b22 290a 2020 2020 436c 6164 655f  ick").    Clade_
+00024f00: 6e61 6d65 7320 3d20 5b69 2e6e 616d 6520  names = [i.name 
+00024f10: 666f 7220 6920 696e 2054 7265 652e 6765  for i in Tree.ge
+00024f20: 745f 7465 726d 696e 616c 7328 295d 0a20  t_terminals()]. 
+00024f30: 2020 2077 6974 6820 6f70 656e 2874 7265     with open(tre
+00024f40: 6566 2c22 7222 2920 6173 2066 3a20 636f  ef,"r") as f: co
+00024f50: 6e74 656e 7420 3d20 662e 7265 6164 2829  ntent = f.read()
+00024f60: 0a20 2020 2063 6f6e 7465 6e74 2c20 7370  .    content, sp
+00024f70: 6e75 6d20 3d20 7265 706c 6163 6573 7065  num = replacespe
+00024f80: 6369 6573 2863 6f6e 7465 6e74 2c43 6c61  cies(content,Cla
+00024f90: 6465 5f6e 616d 6573 2c6f 6e6c 796f 6e65  de_names,onlyone
+00024fa0: 3d6f 6e6c 796f 6e65 290a 2020 2020 7769  =onlyone).    wi
+00024fb0: 7468 206f 7065 6e28 7472 6565 662b 275f  th open(treef+'_
+00024fc0: 7b7d 7370 272e 666f 726d 6174 2873 706e  {}sp'.format(spn
+00024fd0: 756d 292c 2277 2229 2061 7320 663a 2066  um),"w") as f: f
+00024fe0: 2e77 7269 7465 2863 6f6e 7465 6e74 290a  .write(content).
+00024ff0: 0a64 6566 206f 7468 6572 7061 7065 7265  .def otherpapere
+00025000: 7374 696d 6174 6528 6461 7461 293a 0a20  stimate(data):. 
+00025010: 2020 206d 6178 696d 756d 5f6f 7468 6572     maximum_other
+00025020: 5f70 6170 6572 203d 207b 2765 7564 6963  _paper = {'eudic
+00025030: 6f74 7327 3a30 7d0a 0a64 6566 2072 6573  ots':0}..def res
+00025040: 6875 6666 6c65 4d53 4128 666e 5f6d 7361  huffleMSA(fn_msa
+00025050: 293a 0a20 2020 206d 7361 203d 2041 6c69  ):.    msa = Ali
+00025060: 676e 494f 2e72 6561 6428 666e 5f6d 7361  gnIO.read(fn_msa
+00025070: 2c22 6661 7374 6122 290a 2020 2020 2320  ,"fasta").    # 
+00025080: 6669 7273 7420 7365 6c65 6374 2061 2072  first select a r
+00025090: 616e 646f 6d20 7370 6563 6965 730a 2020  andom species.  
+000250a0: 2020 7368 7566 666c 6564 5f73 7020 3d20    shuffled_sp = 
+000250b0: 6d73 615b 6e70 2e72 616e 646f 6d2e 7261  msa[np.random.ra
+000250c0: 6e64 696e 7428 302c 6c65 6e28 6d73 6129  ndint(0,len(msa)
+000250d0: 295d 0a20 2020 2072 655f 7368 7566 666c  )].    re_shuffl
+000250e0: 6564 5f73 7020 3d20 7265 7368 7566 666c  ed_sp = reshuffl
+000250f0: 6573 6571 2873 6875 6666 6c65 645f 7370  eseq(shuffled_sp
+00025100: 290a 0a64 6566 2072 6573 6875 6666 6c65  )..def reshuffle
+00025110: 7365 7128 7368 7566 666c 6564 5f73 7029  seq(shuffled_sp)
+00025120: 3a0a 2020 2020 2320 7365 7175 656e 6365  :.    # sequence
+00025130: 2072 6570 6c61 6365 6d65 6e74 2063 616e   replacement can
+00025140: 2062 6520 7379 6e6f 6e20 616e 6420 6e6f   be synon and no
+00025150: 6e2d 7379 6e6f 6e2c 2077 6520 7368 6f75  n-synon, we shou
+00025160: 6c64 206d 6179 6265 2065 7374 696d 6174  ld maybe estimat
+00025170: 652f 6173 7375 6d65 2074 6865 2064 6973  e/assume the dis
+00025180: 7472 6962 7574 696f 6e20 6f66 2077 0a20  tribution of w. 
+00025190: 2020 204f 7269 6769 6e61 6c5f 7365 7175     Original_sequ
+000251a0: 656e 6365 203d 2073 7472 2873 6875 6666  ence = str(shuff
+000251b0: 6c65 645f 7370 2e73 6571 290a 2020 2020  led_sp.seq).    
+000251c0: 2366 6f72 2069 2069 6e20 7261 6e67 6528  #for i in range(
+000251d0: 302c 6c65 6e28 4f72 6967 696e 616c 5f73  0,len(Original_s
+000251e0: 6571 7565 6e63 6529 2c33 293a 0a20 2020  equence),3):.   
+000251f0: 2023 2033 7264 206e 7420 6f66 2063 6f64   # 3rd nt of cod
+00025200: 6f6e 2c20 7072 6f62 6162 696c 7479 2073  on, probabilty s
+00025210: 616d 706c 6564 2066 726f 6d20 6120 6c6f  ampled from a lo
+00025220: 676e 6f72 6d61 6c20 6469 7374 7269 6275  gnormal distribu
+00025230: 7469 6f6e 2028 4f76 6572 616c 6c20 7072  tion (Overall pr
+00025240: 6f62 6162 696c 6974 7920 7368 6f75 6c64  obability should
+00025250: 2066 6f6c 6c6f 7720 6c6f 676e 6f72 6d61   follow lognorma
+00025260: 6c20 6469 7374 7269 6275 7469 6f6e 2c20  l distribution, 
+00025270: 6d65 616e 3d30 2e35 2c20 7374 643d 302e  mean=0.5, std=0.
+00025280: 3529 0a20 2020 2023 2041 6e20 6964 6561  5).    # An idea
+00025290: 206f 6620 7573 696e 6720 4261 7965 7369   of using Bayesi
+000252a0: 616e 2069 6e66 6572 656e 6365 2074 6f20  an inference to 
+000252b0: 6765 7420 616e 204d 4c45 206f 6620 7468  get an MLE of th
+000252c0: 6520 7072 6f61 6269 6c69 7479 2c20 7265  e proability, re
+000252d0: 7175 6972 6573 2061 2070 7269 6f72 2064  quires a prior d
+000252e0: 6973 7472 6962 7574 696f 6e20 6f66 2070  istribution of p
+000252f0: 726f 6162 696c 6974 7920 6f66 2031 7374  roability of 1st
+00025300: 2c20 326e 642c 2033 7264 206e 7420 6368  , 2nd, 3rd nt ch
+00025310: 616e 6765 732c 2077 6869 6368 2063 616e  anges, which can
+00025320: 2062 6520 6f62 7461 696e 6564 2062 7920   be obtained by 
+00025330: 636f 646f 6e2d 616c 6967 6e6d 656e 742c  codon-alignment,
+00025340: 206e 702e 6d65 616e 2874 6f74 616c 206e   np.mean(total n
+00025350: 756d 6265 7220 6f66 2031 7374 206e 7420  umber of 1st nt 
+00025360: 6368 616e 6765 6420 2f74 6f74 616c 206e  changed /total n
+00025370: 756d 6265 7220 6f66 2063 6f64 6f6e 290a  umber of codon).
+00025380: 0a0a 2364 6566 2073 696d 756c 6174 654d  ..#def simulateM
+00025390: 6178 696d 756d 626f 756e 6428 7374 6172  aximumbound(star
+000253a0: 7474 7265 652c 7370 6563 6965 7370 6f6f  ttree,speciespoo
+000253b0: 6c29 3a0a 2020 2020 2320 7374 6172 7474  l):.    # startt
+000253c0: 7265 6520 7769 7468 2074 6970 206e 616d  ree with tip nam
+000253d0: 6573 2069 6e20 6f72 6465 720a            es in order.
```

### Comparing `fossiler-0.0.4.8/fossiler.egg-info/PKG-INFO` & `fossiler-0.0.4.9/fossiler.egg-info/PKG-INFO`

 * *Files 0% similar despite different names*

```diff
@@ -1,10 +1,10 @@
 Metadata-Version: 2.1
 Name: fossiler
-Version: 0.0.4.8
+Version: 0.0.4.9
 Summary: Python package and CLI for finding available fossils
 Home-page: http://github.com/heche-psb/fossiler
 Author: Hengchi Chen
 Author-email: heche@psb.vib-ugent.be
 License: GPL
 Description-Content-Type: text/markdown
 License-File: LICENSE
```

### Comparing `fossiler-0.0.4.8/setup.py` & `fossiler-0.0.4.9/setup.py`

 * *Files 12% similar despite different names*

```diff
@@ -4,15 +4,15 @@
 from setuptools import setup
 
 with open("README.md", "r") as fh:
     long_description = fh.read()
 
 setup(
     name='fossiler',
-    version='0.0.4.8',
+    version='0.0.4.9',
     packages=['fossiler'],
     url='http://github.com/heche-psb/fossiler',
     license='GPL',
     author='Hengchi Chen',
     author_email='heche@psb.vib-ugent.be',
     description='Python package and CLI for finding available fossils',
     long_description=long_description,
```

