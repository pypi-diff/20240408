# Comparing `tmp/sat-toolkit-0.4.1.tar.gz` & `tmp/sat-toolkit-0.4.2.tar.gz`

## filetype from file(1)

```diff
@@ -1 +1 @@
-gzip compressed data, was "sat-toolkit-0.4.1.tar", last modified: Wed Mar 27 14:39:47 2024, max compression
+gzip compressed data, was "sat-toolkit-0.4.2.tar", last modified: Mon Apr  8 13:49:48 2024, max compression
```

## Comparing `sat-toolkit-0.4.1.tar` & `sat-toolkit-0.4.2.tar`

### file list

```diff
@@ -1,25 +1,25 @@
-drwxr-xr-x   0 runner    (1001) docker     (127)        0 2024-03-27 14:39:47.049470 sat-toolkit-0.4.1/
--rw-r--r--   0 runner    (1001) docker     (127)     1071 2024-03-27 14:39:39.000000 sat-toolkit-0.4.1/LICENSE
--rw-r--r--   0 runner    (1001) docker     (127)      102 2024-03-27 14:39:39.000000 sat-toolkit-0.4.1/MANIFEST.in
--rw-r--r--   0 runner    (1001) docker     (127)     1112 2024-03-27 14:39:47.049470 sat-toolkit-0.4.1/PKG-INFO
--rw-r--r--   0 runner    (1001) docker     (127)      660 2024-03-27 14:39:39.000000 sat-toolkit-0.4.1/README.md
--rw-r--r--   0 runner    (1001) docker     (127)       60 2024-03-27 14:39:39.000000 sat-toolkit-0.4.1/pyproject.toml
-drwxr-xr-x   0 runner    (1001) docker     (127)        0 2024-03-27 14:39:47.049470 sat-toolkit-0.4.1/sat_toolkit/
--rw-r--r--   0 runner    (1001) docker     (127)        0 2024-03-27 14:39:39.000000 sat-toolkit-0.4.1/sat_toolkit/__init__.py
--rw-r--r--   0 runner    (1001) docker     (127)     1327 2024-03-27 14:39:39.000000 sat-toolkit-0.4.1/sat_toolkit/fmt.h
--rw-r--r--   0 runner    (1001) docker     (127)  3074160 2024-03-27 14:39:46.000000 sat-toolkit-0.4.1/sat_toolkit/formula.cpp
--rw-r--r--   0 runner    (1001) docker     (127)    60121 2024-03-27 14:39:39.000000 sat-toolkit-0.4.1/sat_toolkit/formula.pyx
--rw-r--r--   0 runner    (1001) docker     (127)      215 2024-03-27 14:39:39.000000 sat-toolkit-0.4.1/sat_toolkit/types.pxd
--rw-r--r--   0 runner    (1001) docker     (127)     2198 2024-03-27 14:39:39.000000 sat-toolkit-0.4.1/sat_toolkit/util.py
-drwxr-xr-x   0 runner    (1001) docker     (127)        0 2024-03-27 14:39:47.049470 sat-toolkit-0.4.1/sat_toolkit.egg-info/
--rw-r--r--   0 runner    (1001) docker     (127)     1112 2024-03-27 14:39:47.000000 sat-toolkit-0.4.1/sat_toolkit.egg-info/PKG-INFO
--rw-r--r--   0 runner    (1001) docker     (127)      423 2024-03-27 14:39:47.000000 sat-toolkit-0.4.1/sat_toolkit.egg-info/SOURCES.txt
--rw-r--r--   0 runner    (1001) docker     (127)        1 2024-03-27 14:39:47.000000 sat-toolkit-0.4.1/sat_toolkit.egg-info/dependency_links.txt
--rw-r--r--   0 runner    (1001) docker     (127)       12 2024-03-27 14:39:47.000000 sat-toolkit-0.4.1/sat_toolkit.egg-info/requires.txt
--rw-r--r--   0 runner    (1001) docker     (127)       12 2024-03-27 14:39:47.000000 sat-toolkit-0.4.1/sat_toolkit.egg-info/top_level.txt
--rw-r--r--   0 runner    (1001) docker     (127)       38 2024-03-27 14:39:47.049470 sat-toolkit-0.4.1/setup.cfg
--rwxr-xr-x   0 runner    (1001) docker     (127)     1031 2024-03-27 14:39:39.000000 sat-toolkit-0.4.1/setup.py
-drwxr-xr-x   0 runner    (1001) docker     (127)        0 2024-03-27 14:39:47.049470 sat-toolkit-0.4.1/tests/
--rw-r--r--   0 runner    (1001) docker     (127)     8136 2024-03-27 14:39:39.000000 sat-toolkit-0.4.1/tests/test_cnf.py
--rw-r--r--   0 runner    (1001) docker     (127)     2745 2024-03-27 14:39:39.000000 sat-toolkit-0.4.1/tests/test_partition.py
--rw-r--r--   0 runner    (1001) docker     (127)    10441 2024-03-27 14:39:39.000000 sat-toolkit-0.4.1/tests/test_xor_cnf.py
+drwxr-xr-x   0 runner    (1001) docker     (127)        0 2024-04-08 13:49:48.233142 sat-toolkit-0.4.2/
+-rw-r--r--   0 runner    (1001) docker     (127)     1071 2024-04-08 13:49:41.000000 sat-toolkit-0.4.2/LICENSE
+-rw-r--r--   0 runner    (1001) docker     (127)      102 2024-04-08 13:49:41.000000 sat-toolkit-0.4.2/MANIFEST.in
+-rw-r--r--   0 runner    (1001) docker     (127)     1112 2024-04-08 13:49:48.233142 sat-toolkit-0.4.2/PKG-INFO
+-rw-r--r--   0 runner    (1001) docker     (127)      660 2024-04-08 13:49:41.000000 sat-toolkit-0.4.2/README.md
+-rw-r--r--   0 runner    (1001) docker     (127)       60 2024-04-08 13:49:41.000000 sat-toolkit-0.4.2/pyproject.toml
+drwxr-xr-x   0 runner    (1001) docker     (127)        0 2024-04-08 13:49:48.229142 sat-toolkit-0.4.2/sat_toolkit/
+-rw-r--r--   0 runner    (1001) docker     (127)        0 2024-04-08 13:49:41.000000 sat-toolkit-0.4.2/sat_toolkit/__init__.py
+-rw-r--r--   0 runner    (1001) docker     (127)     1327 2024-04-08 13:49:41.000000 sat-toolkit-0.4.2/sat_toolkit/fmt.h
+-rw-r--r--   0 runner    (1001) docker     (127)  3085898 2024-04-08 13:49:47.000000 sat-toolkit-0.4.2/sat_toolkit/formula.cpp
+-rw-r--r--   0 runner    (1001) docker     (127)    60409 2024-04-08 13:49:41.000000 sat-toolkit-0.4.2/sat_toolkit/formula.pyx
+-rw-r--r--   0 runner    (1001) docker     (127)      215 2024-04-08 13:49:41.000000 sat-toolkit-0.4.2/sat_toolkit/types.pxd
+-rw-r--r--   0 runner    (1001) docker     (127)     2198 2024-04-08 13:49:41.000000 sat-toolkit-0.4.2/sat_toolkit/util.py
+drwxr-xr-x   0 runner    (1001) docker     (127)        0 2024-04-08 13:49:48.233142 sat-toolkit-0.4.2/sat_toolkit.egg-info/
+-rw-r--r--   0 runner    (1001) docker     (127)     1112 2024-04-08 13:49:48.000000 sat-toolkit-0.4.2/sat_toolkit.egg-info/PKG-INFO
+-rw-r--r--   0 runner    (1001) docker     (127)      423 2024-04-08 13:49:48.000000 sat-toolkit-0.4.2/sat_toolkit.egg-info/SOURCES.txt
+-rw-r--r--   0 runner    (1001) docker     (127)        1 2024-04-08 13:49:48.000000 sat-toolkit-0.4.2/sat_toolkit.egg-info/dependency_links.txt
+-rw-r--r--   0 runner    (1001) docker     (127)       12 2024-04-08 13:49:48.000000 sat-toolkit-0.4.2/sat_toolkit.egg-info/requires.txt
+-rw-r--r--   0 runner    (1001) docker     (127)       12 2024-04-08 13:49:48.000000 sat-toolkit-0.4.2/sat_toolkit.egg-info/top_level.txt
+-rw-r--r--   0 runner    (1001) docker     (127)       38 2024-04-08 13:49:48.233142 sat-toolkit-0.4.2/setup.cfg
+-rwxr-xr-x   0 runner    (1001) docker     (127)     1031 2024-04-08 13:49:41.000000 sat-toolkit-0.4.2/setup.py
+drwxr-xr-x   0 runner    (1001) docker     (127)        0 2024-04-08 13:49:48.233142 sat-toolkit-0.4.2/tests/
+-rw-r--r--   0 runner    (1001) docker     (127)     8136 2024-04-08 13:49:41.000000 sat-toolkit-0.4.2/tests/test_cnf.py
+-rw-r--r--   0 runner    (1001) docker     (127)     4734 2024-04-08 13:49:41.000000 sat-toolkit-0.4.2/tests/test_partition.py
+-rw-r--r--   0 runner    (1001) docker     (127)    10440 2024-04-08 13:49:41.000000 sat-toolkit-0.4.2/tests/test_xor_cnf.py
```

### Comparing `sat-toolkit-0.4.1/LICENSE` & `sat-toolkit-0.4.2/LICENSE`

 * *Files identical despite different names*

### Comparing `sat-toolkit-0.4.1/PKG-INFO` & `sat-toolkit-0.4.2/PKG-INFO`

 * *Files 1% similar despite different names*

```diff
@@ -1,10 +1,10 @@
 Metadata-Version: 2.1
 Name: sat-toolkit
-Version: 0.4.1
+Version: 0.4.2
 Summary: Tool for manipulating CNF formulas
 Home-page: https://github.com/fanosta/sat_toolkit
 Author: Marcel Nageler
 Author-email: marcel.nageler@iaik.tugraz.at
 Classifier: Programming Language :: Python :: 3
 Classifier: License :: OSI Approved :: MIT License
 Classifier: Operating System :: POSIX :: Linux
```

### Comparing `sat-toolkit-0.4.1/README.md` & `sat-toolkit-0.4.2/README.md`

 * *Files identical despite different names*

### Comparing `sat-toolkit-0.4.1/sat_toolkit/fmt.h` & `sat-toolkit-0.4.2/sat_toolkit/fmt.h`

 * *Files identical despite different names*

### Comparing `sat-toolkit-0.4.1/sat_toolkit/formula.cpp` & `sat-toolkit-0.4.2/sat_toolkit/formula.cpp`

 * *Files 0% similar despite different names*

```diff
@@ -1,8 +1,8 @@
-/* Generated by Cython 3.0.9 */
+/* Generated by Cython 3.0.10 */
 
 /* BEGIN: Cython Metadata
 {
     "distutils": {
         "depends": [
             "sat_toolkit/fmt.h"
         ],
@@ -56,18 +56,18 @@
     #error Cython requires Python 2.7+ or Python 3.3+.
 #else
 #if defined(CYTHON_LIMITED_API) && CYTHON_LIMITED_API
 #define __PYX_EXTRA_ABI_MODULE_NAME "limited"
 #else
 #define __PYX_EXTRA_ABI_MODULE_NAME ""
 #endif
-#define CYTHON_ABI "3_0_9" __PYX_EXTRA_ABI_MODULE_NAME
+#define CYTHON_ABI "3_0_10" __PYX_EXTRA_ABI_MODULE_NAME
 #define __PYX_ABI_MODULE_NAME "_cython_" CYTHON_ABI
 #define __PYX_TYPE_MODULE_PREFIX __PYX_ABI_MODULE_NAME "."
-#define CYTHON_HEX_VERSION 0x030009F0
+#define CYTHON_HEX_VERSION 0x03000AF0
 #define CYTHON_FUTURE_DIVISION 1
 #include <stddef.h>
 #ifndef offsetof
   #define offsetof(type, member) ( (size_t) & ((type*)0) -> member )
 #endif
 #if !defined(_WIN32) && !defined(WIN32) && !defined(MS_WINDOWS)
   #ifndef __stdcall
@@ -151,14 +151,16 @@
   #undef CYTHON_USE_DICT_VERSIONS
   #define CYTHON_USE_DICT_VERSIONS 0
   #undef CYTHON_USE_EXC_INFO_STACK
   #define CYTHON_USE_EXC_INFO_STACK 0
   #ifndef CYTHON_UPDATE_DESCRIPTOR_DOC
     #define CYTHON_UPDATE_DESCRIPTOR_DOC 0
   #endif
+  #undef CYTHON_USE_FREELISTS
+  #define CYTHON_USE_FREELISTS 0
 #elif defined(PYPY_VERSION)
   #define CYTHON_COMPILING_IN_PYPY 1
   #define CYTHON_COMPILING_IN_CPYTHON 0
   #define CYTHON_COMPILING_IN_LIMITED_API 0
   #define CYTHON_COMPILING_IN_GRAAL 0
   #define CYTHON_COMPILING_IN_NOGIL 0
   #undef CYTHON_USE_TYPE_SLOTS
@@ -212,14 +214,16 @@
   #undef CYTHON_USE_DICT_VERSIONS
   #define CYTHON_USE_DICT_VERSIONS 0
   #undef CYTHON_USE_EXC_INFO_STACK
   #define CYTHON_USE_EXC_INFO_STACK 0
   #ifndef CYTHON_UPDATE_DESCRIPTOR_DOC
     #define CYTHON_UPDATE_DESCRIPTOR_DOC 0
   #endif
+  #undef CYTHON_USE_FREELISTS
+  #define CYTHON_USE_FREELISTS 0
 #elif defined(CYTHON_LIMITED_API)
   #ifdef Py_LIMITED_API
     #undef __PYX_LIMITED_VERSION_HEX
     #define __PYX_LIMITED_VERSION_HEX Py_LIMITED_API
   #endif
   #define CYTHON_COMPILING_IN_PYPY 0
   #define CYTHON_COMPILING_IN_CPYTHON 0
@@ -273,60 +277,83 @@
   #undef CYTHON_USE_DICT_VERSIONS
   #define CYTHON_USE_DICT_VERSIONS 0
   #undef CYTHON_USE_EXC_INFO_STACK
   #define CYTHON_USE_EXC_INFO_STACK 0
   #ifndef CYTHON_UPDATE_DESCRIPTOR_DOC
     #define CYTHON_UPDATE_DESCRIPTOR_DOC 0
   #endif
+  #undef CYTHON_USE_FREELISTS
+  #define CYTHON_USE_FREELISTS 0
 #elif defined(Py_GIL_DISABLED) || defined(Py_NOGIL)
   #define CYTHON_COMPILING_IN_PYPY 0
   #define CYTHON_COMPILING_IN_CPYTHON 0
   #define CYTHON_COMPILING_IN_LIMITED_API 0
   #define CYTHON_COMPILING_IN_GRAAL 0
   #define CYTHON_COMPILING_IN_NOGIL 1
   #ifndef CYTHON_USE_TYPE_SLOTS
     #define CYTHON_USE_TYPE_SLOTS 1
   #endif
+  #ifndef CYTHON_USE_TYPE_SPECS
+    #define CYTHON_USE_TYPE_SPECS 0
+  #endif
   #undef CYTHON_USE_PYTYPE_LOOKUP
   #define CYTHON_USE_PYTYPE_LOOKUP 0
   #ifndef CYTHON_USE_ASYNC_SLOTS
     #define CYTHON_USE_ASYNC_SLOTS 1
   #endif
+  #ifndef CYTHON_USE_PYLONG_INTERNALS
+    #define CYTHON_USE_PYLONG_INTERNALS 0
+  #endif
   #undef CYTHON_USE_PYLIST_INTERNALS
   #define CYTHON_USE_PYLIST_INTERNALS 0
   #ifndef CYTHON_USE_UNICODE_INTERNALS
     #define CYTHON_USE_UNICODE_INTERNALS 1
   #endif
   #undef CYTHON_USE_UNICODE_WRITER
   #define CYTHON_USE_UNICODE_WRITER 0
-  #undef CYTHON_USE_PYLONG_INTERNALS
-  #define CYTHON_USE_PYLONG_INTERNALS 0
   #ifndef CYTHON_AVOID_BORROWED_REFS
     #define CYTHON_AVOID_BORROWED_REFS 0
   #endif
   #ifndef CYTHON_ASSUME_SAFE_MACROS
     #define CYTHON_ASSUME_SAFE_MACROS 1
   #endif
   #ifndef CYTHON_UNPACK_METHODS
     #define CYTHON_UNPACK_METHODS 1
   #endif
   #undef CYTHON_FAST_THREAD_STATE
   #define CYTHON_FAST_THREAD_STATE 0
+  #undef CYTHON_FAST_GIL
+  #define CYTHON_FAST_GIL 0
+  #ifndef CYTHON_METH_FASTCALL
+    #define CYTHON_METH_FASTCALL 1
+  #endif
   #undef CYTHON_FAST_PYCALL
   #define CYTHON_FAST_PYCALL 0
+  #ifndef CYTHON_PEP487_INIT_SUBCLASS
+    #define CYTHON_PEP487_INIT_SUBCLASS 1
+  #endif
   #ifndef CYTHON_PEP489_MULTI_PHASE_INIT
     #define CYTHON_PEP489_MULTI_PHASE_INIT 1
   #endif
+  #ifndef CYTHON_USE_MODULE_STATE
+    #define CYTHON_USE_MODULE_STATE 0
+  #endif
   #ifndef CYTHON_USE_TP_FINALIZE
     #define CYTHON_USE_TP_FINALIZE 1
   #endif
   #undef CYTHON_USE_DICT_VERSIONS
   #define CYTHON_USE_DICT_VERSIONS 0
   #undef CYTHON_USE_EXC_INFO_STACK
   #define CYTHON_USE_EXC_INFO_STACK 0
+  #ifndef CYTHON_UPDATE_DESCRIPTOR_DOC
+    #define CYTHON_UPDATE_DESCRIPTOR_DOC 1
+  #endif
+  #ifndef CYTHON_USE_FREELISTS
+    #define CYTHON_USE_FREELISTS 0
+  #endif
 #else
   #define CYTHON_COMPILING_IN_PYPY 0
   #define CYTHON_COMPILING_IN_CPYTHON 1
   #define CYTHON_COMPILING_IN_LIMITED_API 0
   #define CYTHON_COMPILING_IN_GRAAL 0
   #define CYTHON_COMPILING_IN_NOGIL 0
   #ifndef CYTHON_USE_TYPE_SLOTS
@@ -409,14 +436,17 @@
     #define CYTHON_USE_EXC_INFO_STACK 0
   #elif !defined(CYTHON_USE_EXC_INFO_STACK)
     #define CYTHON_USE_EXC_INFO_STACK 1
   #endif
   #ifndef CYTHON_UPDATE_DESCRIPTOR_DOC
     #define CYTHON_UPDATE_DESCRIPTOR_DOC 1
   #endif
+  #ifndef CYTHON_USE_FREELISTS
+    #define CYTHON_USE_FREELISTS 1
+  #endif
 #endif
 #if !defined(CYTHON_FAST_PYCCALL)
 #define CYTHON_FAST_PYCCALL  (CYTHON_FAST_PYCALL && PY_VERSION_HEX >= 0x030600B1)
 #endif
 #if !defined(CYTHON_VECTORCALL)
 #define CYTHON_VECTORCALL  (CYTHON_FAST_PYCCALL && PY_VERSION_HEX >= 0x030800B1)
 #endif
@@ -1774,15 +1804,15 @@
  */
 struct __pyx_opt_args_7cpython_11contextvars_get_value_no_default {
   int __pyx_n;
   PyObject *default_value;
 };
 struct __pyx_opt_args_11sat_toolkit_7formula_3CNF__add_xor_clause;
 
-/* "sat_toolkit/formula.pyx":811
+/* "sat_toolkit/formula.pyx":818
  *         return res
  * 
  *     cdef int _add_xor_clause(self, const int[::1] xor_clause, int rhs=0) except -1 nogil:             # <<<<<<<<<<<<<<
  *         if rhs not in [0, 1]:
  *             raise ValueError(f"right hand side must be 0 or 1, not {rhs}")
  */
 struct __pyx_opt_args_11sat_toolkit_7formula_3CNF__add_xor_clause {
@@ -1842,54 +1872,54 @@
   std::vector<size_t>  _start_indices;
   int nvars;
   Py_ssize_t shape[1];
   Py_ssize_t view_count;
 };
 
 
-/* "sat_toolkit/formula.pyx":669
+/* "sat_toolkit/formula.pyx":676
  * 
  * 
  * cdef class CNF(_ClauseList):             # <<<<<<<<<<<<<<
  *     """
  *     Class for storing and manipulating CNF formulas.
  */
 struct __pyx_obj_11sat_toolkit_7formula_CNF {
   struct __pyx_obj_11sat_toolkit_7formula__ClauseList __pyx_base;
 };
 
 
-/* "sat_toolkit/formula.pyx":1350
+/* "sat_toolkit/formula.pyx":1357
  * 
  * 
  * cdef class XorClauseList(_ClauseList):             # <<<<<<<<<<<<<<
  *     """
  *     Class for storing and manipulating a list of xor clauses.
  */
 struct __pyx_obj_11sat_toolkit_7formula_XorClauseList {
   struct __pyx_obj_11sat_toolkit_7formula__ClauseList __pyx_base;
 };
 
 
-/* "sat_toolkit/formula.pyx":1364
+/* "sat_toolkit/formula.pyx":1371
  * 
  * 
  * cdef class XorCNF:             # <<<<<<<<<<<<<<
  *     cdef readonly CNF _clauses
  *     cdef readonly XorClauseList _xor_clauses
  */
 struct __pyx_obj_11sat_toolkit_7formula_XorCNF {
   PyObject_HEAD
   struct __pyx_vtabstruct_11sat_toolkit_7formula_XorCNF *__pyx_vtab;
   struct __pyx_obj_11sat_toolkit_7formula_CNF *_clauses;
   struct __pyx_obj_11sat_toolkit_7formula_XorClauseList *_xor_clauses;
 };
 
 
-/* "sat_toolkit/formula.pyx":1657
+/* "sat_toolkit/formula.pyx":1664
  * 
  * 
  * cdef class Truthtable:             # <<<<<<<<<<<<<<
  *     """
  *     A boolean function represented as a truth table.
  */
 struct __pyx_obj_11sat_toolkit_7formula_Truthtable {
@@ -1928,29 +1958,29 @@
   PyObject_HEAD
   size_t __pyx_v_i;
   struct __pyx_obj_11sat_toolkit_7formula__BaseClause *__pyx_v_self;
   size_t __pyx_t_0;
 };
 
 
-/* "sat_toolkit/formula.pyx":512
+/* "sat_toolkit/formula.pyx":519
  *         return self._start_indices.size()
  * 
  *     def __iter__(self) -> Iterable[Clause]:             # <<<<<<<<<<<<<<
  *         cdef size_t i = 0
  *         while i < self._start_indices.size():
  */
 struct __pyx_obj_11sat_toolkit_7formula___pyx_scope_struct_2___iter__ {
   PyObject_HEAD
   size_t __pyx_v_i;
   struct __pyx_obj_11sat_toolkit_7formula__ClauseList *__pyx_v_self;
 };
 
 
-/* "sat_toolkit/formula.pyx":519
+/* "sat_toolkit/formula.pyx":526
  * 
  * 
  *     def __reversed__(self) -> Iterable[Clause]:             # <<<<<<<<<<<<<<
  *         cdef size_t i
  *         for i in reversed(range(self._start_indices.size())):
  */
 struct __pyx_obj_11sat_toolkit_7formula___pyx_scope_struct_3___reversed__ {
@@ -2102,15 +2132,15 @@
   int (*_check_clause_type)(struct __pyx_obj_11sat_toolkit_7formula__ClauseList *, struct __pyx_obj_11sat_toolkit_7formula__BaseClause *);
   int (*_compare_clause)(struct __pyx_obj_11sat_toolkit_7formula__ClauseList *, size_t, struct __pyx_obj_11sat_toolkit_7formula__BaseClause *);
   size_t (*_get_slice_index)(struct __pyx_obj_11sat_toolkit_7formula__ClauseList *, Py_ssize_t);
 };
 static struct __pyx_vtabstruct_11sat_toolkit_7formula__ClauseList *__pyx_vtabptr_11sat_toolkit_7formula__ClauseList;
 
 
-/* "sat_toolkit/formula.pyx":669
+/* "sat_toolkit/formula.pyx":676
  * 
  * 
  * cdef class CNF(_ClauseList):             # <<<<<<<<<<<<<<
  *     """
  *     Class for storing and manipulating CNF formulas.
  */
 
@@ -2122,30 +2152,30 @@
   int (*_check_solution)(struct __pyx_obj_11sat_toolkit_7formula_CNF *, __Pyx_memviewslice);
   int (*_check_solution_for_single_clause)(struct __pyx_obj_11sat_toolkit_7formula_CNF *, size_t, __Pyx_memviewslice);
   struct __pyx_obj_11sat_toolkit_7formula_Clause *(*get_clause)(struct __pyx_obj_11sat_toolkit_7formula_CNF *, Py_ssize_t);
 };
 static struct __pyx_vtabstruct_11sat_toolkit_7formula_CNF *__pyx_vtabptr_11sat_toolkit_7formula_CNF;
 
 
-/* "sat_toolkit/formula.pyx":1350
+/* "sat_toolkit/formula.pyx":1357
  * 
  * 
  * cdef class XorClauseList(_ClauseList):             # <<<<<<<<<<<<<<
  *     """
  *     Class for storing and manipulating a list of xor clauses.
  */
 
 struct __pyx_vtabstruct_11sat_toolkit_7formula_XorClauseList {
   struct __pyx_vtabstruct_11sat_toolkit_7formula__ClauseList __pyx_base;
   struct __pyx_obj_11sat_toolkit_7formula_XorClause *(*get_clause)(struct __pyx_obj_11sat_toolkit_7formula_XorClauseList *, Py_ssize_t);
 };
 static struct __pyx_vtabstruct_11sat_toolkit_7formula_XorClauseList *__pyx_vtabptr_11sat_toolkit_7formula_XorClauseList;
 
 
-/* "sat_toolkit/formula.pyx":1364
+/* "sat_toolkit/formula.pyx":1371
  * 
  * 
  * cdef class XorCNF:             # <<<<<<<<<<<<<<
  *     cdef readonly CNF _clauses
  *     cdef readonly XorClauseList _xor_clauses
  */
 
@@ -2857,17 +2887,42 @@
 #define __Pyx_PyDict_GetItem(d, key) PyObject_GetItem(d, key)
 #define __Pyx_PyObject_Dict_GetItem(obj, name)  PyObject_GetItem(obj, name)
 #endif
 
 /* append.proto */
 static CYTHON_INLINE int __Pyx_PyObject_Append(PyObject* L, PyObject* x);
 
+/* UnpackUnboundCMethod.proto */
+typedef struct {
+    PyObject *type;
+    PyObject **method_name;
+    PyCFunction func;
+    PyObject *method;
+    int flag;
+} __Pyx_CachedCFunction;
+
+/* CallUnboundCMethod1.proto */
+static PyObject* __Pyx__CallUnboundCMethod1(__Pyx_CachedCFunction* cfunc, PyObject* self, PyObject* arg);
+#if CYTHON_COMPILING_IN_CPYTHON
+static CYTHON_INLINE PyObject* __Pyx_CallUnboundCMethod1(__Pyx_CachedCFunction* cfunc, PyObject* self, PyObject* arg);
+#else
+#define __Pyx_CallUnboundCMethod1(cfunc, self, arg)  __Pyx__CallUnboundCMethod1(cfunc, self, arg)
+#endif
+
 /* IterFinish.proto */
 static CYTHON_INLINE int __Pyx_IterFinish(void);
 
+/* set_iter.proto */
+static CYTHON_INLINE PyObject* __Pyx_set_iterator(PyObject* iterable, int is_set,
+                                                  Py_ssize_t* p_orig_length, int* p_source_is_set);
+static CYTHON_INLINE int __Pyx_set_iter_next(
+        PyObject* iter_obj, Py_ssize_t orig_length,
+        Py_ssize_t* ppos, PyObject **value,
+        int source_is_set);
+
 /* PyObjectCallNoArg.proto */
 static CYTHON_INLINE PyObject* __Pyx_PyObject_CallNoArg(PyObject *func);
 
 /* PyObjectCallMethod0.proto */
 static PyObject* __Pyx_PyObject_CallMethod0(PyObject* obj, PyObject* method_name);
 
 /* UnpackItemEndCheck.proto */
@@ -3212,30 +3267,30 @@
 
 /* SetupReduce.proto */
 #if !CYTHON_COMPILING_IN_LIMITED_API
 static int __Pyx_setup_reduce(PyObject* type_obj);
 #endif
 
 /* TypeImport.proto */
-#ifndef __PYX_HAVE_RT_ImportType_proto_3_0_9
-#define __PYX_HAVE_RT_ImportType_proto_3_0_9
+#ifndef __PYX_HAVE_RT_ImportType_proto_3_0_10
+#define __PYX_HAVE_RT_ImportType_proto_3_0_10
 #if defined (__STDC_VERSION__) && __STDC_VERSION__ >= 201112L
 #include <stdalign.h>
 #endif
 #if (defined (__STDC_VERSION__) && __STDC_VERSION__ >= 201112L) || __cplusplus >= 201103L
-#define __PYX_GET_STRUCT_ALIGNMENT_3_0_9(s) alignof(s)
+#define __PYX_GET_STRUCT_ALIGNMENT_3_0_10(s) alignof(s)
 #else
-#define __PYX_GET_STRUCT_ALIGNMENT_3_0_9(s) sizeof(void*)
+#define __PYX_GET_STRUCT_ALIGNMENT_3_0_10(s) sizeof(void*)
 #endif
-enum __Pyx_ImportType_CheckSize_3_0_9 {
-   __Pyx_ImportType_CheckSize_Error_3_0_9 = 0,
-   __Pyx_ImportType_CheckSize_Warn_3_0_9 = 1,
-   __Pyx_ImportType_CheckSize_Ignore_3_0_9 = 2
+enum __Pyx_ImportType_CheckSize_3_0_10 {
+   __Pyx_ImportType_CheckSize_Error_3_0_10 = 0,
+   __Pyx_ImportType_CheckSize_Warn_3_0_10 = 1,
+   __Pyx_ImportType_CheckSize_Ignore_3_0_10 = 2
 };
-static PyTypeObject *__Pyx_ImportType_3_0_9(PyObject* module, const char *module_name, const char *class_name, size_t size, size_t alignment, enum __Pyx_ImportType_CheckSize_3_0_9 check_size);
+static PyTypeObject *__Pyx_ImportType_3_0_10(PyObject* module, const char *module_name, const char *class_name, size_t size, size_t alignment, enum __Pyx_ImportType_CheckSize_3_0_10 check_size);
 #endif
 
 /* GetNameInClass.proto */
 #define __Pyx_GetNameInClass(var, nmspace, name)  (var) = __Pyx__GetNameInClass(nmspace, name)
 static PyObject *__Pyx__GetNameInClass(PyObject *nmspace, PyObject *name);
 
 /* ClassMethod.proto */
@@ -3939,14 +3994,15 @@
 static const char __pyx_k_split[] = "split";
 static const char __pyx_k_start[] = "start";
 static const char __pyx_k_state[] = "state";
 static const char __pyx_k_stdin[] = "stdin";
 static const char __pyx_k_strip[] = "strip";
 static const char __pyx_k_throw[] = "throw";
 static const char __pyx_k_uint8[] = "uint8";
+static const char __pyx_k_union[] = "union";
 static const char __pyx_k_where[] = "where";
 static const char __pyx_k_write[] = "write";
 static const char __pyx_k_zeros[] = "zeros";
 static const char __pyx_k_Clause[] = "Clause";
 static const char __pyx_k_XorCNF[] = "XorCNF";
 static const char __pyx_k_append[] = "append";
 static const char __pyx_k_clause[] = "clause";
@@ -4142,14 +4198,15 @@
 static const char __pyx_k_CNF_implied_by[] = "CNF.implied_by";
 static const char __pyx_k_CNF_logical_or[] = "CNF.logical_or";
 static const char __pyx_k_INIT_INDEX_SET[] = "INIT_INDEX_SET";
 static const char __pyx_k_check_solution[] = "check_solution";
 static const char __pyx_k_cryptominisat5[] = "cryptominisat5";
 static const char __pyx_k_unknown_status[] = "unknown status: ";
 static const char __pyx_k_variables_with[] = " variables with ";
+static const char __pyx_k_vars_to_update[] = "vars_to_update";
 static const char __pyx_k_CNF_from_dimacs[] = "CNF.from_dimacs";
 static const char __pyx_k_CNF_to_espresso[] = "CNF.to_espresso";
 static const char __pyx_k_Iterable_Clause[] = "Iterable[Clause]";
 static const char __pyx_k_View_MemoryView[] = "View.MemoryView";
 static const char __pyx_k_XorCNF___reduce[] = "XorCNF.__reduce__";
 static const char __pyx_k_add_xor_clauses[] = "add_xor_clauses";
 static const char __pyx_k_allocate_buffer[] = "allocate_buffer";
@@ -4216,26 +4273,26 @@
 static const char __pyx_k_BaseClause___reversed[] = "_BaseClause.__reversed__";
 static const char __pyx_k_CNF__create_all_equal[] = "CNF._create_all_equal";
 static const char __pyx_k_CNF_minimize_espresso[] = "CNF.minimize_espresso";
 static const char __pyx_k_ClauseList___reversed[] = "_ClauseList.__reversed__";
 static const char __pyx_k_ClauseList_add_clause[] = "_ClauseList.add_clause";
 static const char __pyx_k_Invalid_shape_in_axis[] = "Invalid shape in axis ";
 static const char __pyx_k_contiguous_and_direct[] = "<contiguous and direct>";
-static const char __pyx_k_CNF_get_units_line_967[] = "CNF.get_units (line 967)";
+static const char __pyx_k_CNF_get_units_line_974[] = "CNF.get_units (line 974)";
 static const char __pyx_k_CNF_minimize_lingeling[] = "CNF.minimize_lingeling";
 static const char __pyx_k_Cannot_index_with_type[] = "Cannot index with type '";
 static const char __pyx_k_ClauseList_add_clauses[] = "_ClauseList.add_clauses";
 static const char __pyx_k_Clause___reduce_cython[] = "Clause.__reduce_cython__";
 static const char __pyx_k_MemoryView_of_r_object[] = "<MemoryView of %r object>";
 static const char __pyx_k_Truthtable_to_espresso[] = "Truthtable.to_espresso";
 static const char __pyx_k_XorCNF_add_xor_clauses[] = "XorCNF.add_xor_clauses";
 static const char __pyx_k_cannot_use_0_in_clause[] = "cannot use 0 in clause";
 static const char __pyx_k_pyx_unpickle_XorClause[] = "__pyx_unpickle_XorClause";
 static const char __pyx_k_too_short_for_CNF_with[] = " too short for CNF with ";
-static const char __pyx_k_CNF_logical_or_line_904[] = "CNF.logical_or (line 904)";
+static const char __pyx_k_CNF_logical_or_line_911[] = "CNF.logical_or (line 911)";
 static const char __pyx_k_MemoryView_of_r_at_0x_x[] = "<MemoryView of %r at 0x%x>";
 static const char __pyx_k_Truthtable_from_indices[] = "Truthtable.from_indices";
 static const char __pyx_k_contiguous_and_indirect[] = "<contiguous and indirect>";
 static const char __pyx_k_invalid_value_for_phase[] = "invalid value for `phase`";
 static const char __pyx_k_no_p_cnf_line_in_dimacs[] = "no 'p cnf ...' line in dimacs";
 static const char __pyx_k_pyx_unpickle_Truthtable[] = "__pyx_unpickle_Truthtable";
 static const char __pyx_k_sat_toolkit_formula_pyx[] = "sat_toolkit/formula.pyx";
@@ -4470,14 +4527,15 @@
 static PyObject *__pyx_tp_new_11sat_toolkit_7formula___pyx_scope_struct_1___reversed__(PyTypeObject *t, PyObject *a, PyObject *k); /*proto*/
 static PyObject *__pyx_tp_new_11sat_toolkit_7formula___pyx_scope_struct_2___iter__(PyTypeObject *t, PyObject *a, PyObject *k); /*proto*/
 static PyObject *__pyx_tp_new_11sat_toolkit_7formula___pyx_scope_struct_3___reversed__(PyTypeObject *t, PyObject *a, PyObject *k); /*proto*/
 static PyObject *__pyx_tp_new_array(PyTypeObject *t, PyObject *a, PyObject *k); /*proto*/
 static PyObject *__pyx_tp_new_Enum(PyTypeObject *t, PyObject *a, PyObject *k); /*proto*/
 static PyObject *__pyx_tp_new_memoryview(PyTypeObject *t, PyObject *a, PyObject *k); /*proto*/
 static PyObject *__pyx_tp_new__memoryviewslice(PyTypeObject *t, PyObject *a, PyObject *k); /*proto*/
+static __Pyx_CachedCFunction __pyx_umethod_PySet_Type_union = {0, 0, 0, 0, 0};
 /* #### Code section: late_includes ### */
 /* #### Code section: module_state ### */
 typedef struct {
   PyObject *__pyx_d;
   PyObject *__pyx_b;
   PyObject *__pyx_cython_runtime;
   PyObject *__pyx_empty_tuple;
@@ -4666,18 +4724,18 @@
   PyObject *__pyx_n_s_CNF_create_all_equal;
   PyObject *__pyx_n_s_CNF_create_all_zero;
   PyObject *__pyx_n_s_CNF_create_xor;
   PyObject *__pyx_n_s_CNF_equiv;
   PyObject *__pyx_n_s_CNF_from_dimacs;
   PyObject *__pyx_n_s_CNF_from_espresso;
   PyObject *__pyx_n_s_CNF_get_units;
-  PyObject *__pyx_kp_u_CNF_get_units_line_967;
+  PyObject *__pyx_kp_u_CNF_get_units_line_974;
   PyObject *__pyx_n_s_CNF_implied_by;
   PyObject *__pyx_n_s_CNF_logical_or;
-  PyObject *__pyx_kp_u_CNF_logical_or_line_904;
+  PyObject *__pyx_kp_u_CNF_logical_or_line_911;
   PyObject *__pyx_n_s_CNF_minimize_espresso;
   PyObject *__pyx_n_s_CNF_minimize_lingeling;
   PyObject *__pyx_kp_u_CNF_must_not_contain_xor_clauses;
   PyObject *__pyx_kp_u_CNF_over;
   PyObject *__pyx_n_s_CNF_solve_dimacs;
   PyObject *__pyx_n_s_CNF_to_dimacs;
   PyObject *__pyx_n_s_CNF_to_espresso;
@@ -5129,14 +5187,15 @@
   PyObject *__pyx_n_s_translate;
   PyObject *__pyx_n_s_truthtable;
   PyObject *__pyx_n_s_truthtable_view;
   PyObject *__pyx_kp_s_tuple_list_CNF_list_XorClauseLis;
   PyObject *__pyx_n_s_uint8;
   PyObject *__pyx_kp_s_unable_to_allocate_array_data;
   PyObject *__pyx_kp_s_unable_to_allocate_shape_and_str;
+  PyObject *__pyx_n_s_union;
   PyObject *__pyx_kp_u_unknown_status;
   PyObject *__pyx_n_s_unpack;
   PyObject *__pyx_n_s_update;
   PyObject *__pyx_kp_u_use_from_lut_or_from_indices;
   PyObject *__pyx_n_s_use_setstate;
   PyObject *__pyx_kp_u_v;
   PyObject *__pyx_n_s_v_2;
@@ -5146,14 +5205,15 @@
   PyObject *__pyx_kp_u_var_must_not_be_zero;
   PyObject *__pyx_n_s_var_view;
   PyObject *__pyx_kp_u_variable_0_must_map_to_0_again;
   PyObject *__pyx_kp_u_variable_must_not_be_mapped_to_0;
   PyObject *__pyx_n_s_variables;
   PyObject *__pyx_kp_u_variables_2;
   PyObject *__pyx_kp_u_variables_with;
+  PyObject *__pyx_n_s_vars_to_update;
   PyObject *__pyx_n_s_vec_result;
   PyObject *__pyx_n_s_verbose;
   PyObject *__pyx_n_s_version_info;
   PyObject *__pyx_n_u_w;
   PyObject *__pyx_n_s_wait;
   PyObject *__pyx_n_s_where;
   PyObject *__pyx_n_s_write;
@@ -5448,18 +5508,18 @@
   Py_CLEAR(clear_module_state->__pyx_n_s_CNF_create_all_equal);
   Py_CLEAR(clear_module_state->__pyx_n_s_CNF_create_all_zero);
   Py_CLEAR(clear_module_state->__pyx_n_s_CNF_create_xor);
   Py_CLEAR(clear_module_state->__pyx_n_s_CNF_equiv);
   Py_CLEAR(clear_module_state->__pyx_n_s_CNF_from_dimacs);
   Py_CLEAR(clear_module_state->__pyx_n_s_CNF_from_espresso);
   Py_CLEAR(clear_module_state->__pyx_n_s_CNF_get_units);
-  Py_CLEAR(clear_module_state->__pyx_kp_u_CNF_get_units_line_967);
+  Py_CLEAR(clear_module_state->__pyx_kp_u_CNF_get_units_line_974);
   Py_CLEAR(clear_module_state->__pyx_n_s_CNF_implied_by);
   Py_CLEAR(clear_module_state->__pyx_n_s_CNF_logical_or);
-  Py_CLEAR(clear_module_state->__pyx_kp_u_CNF_logical_or_line_904);
+  Py_CLEAR(clear_module_state->__pyx_kp_u_CNF_logical_or_line_911);
   Py_CLEAR(clear_module_state->__pyx_n_s_CNF_minimize_espresso);
   Py_CLEAR(clear_module_state->__pyx_n_s_CNF_minimize_lingeling);
   Py_CLEAR(clear_module_state->__pyx_kp_u_CNF_must_not_contain_xor_clauses);
   Py_CLEAR(clear_module_state->__pyx_kp_u_CNF_over);
   Py_CLEAR(clear_module_state->__pyx_n_s_CNF_solve_dimacs);
   Py_CLEAR(clear_module_state->__pyx_n_s_CNF_to_dimacs);
   Py_CLEAR(clear_module_state->__pyx_n_s_CNF_to_espresso);
@@ -5911,14 +5971,15 @@
   Py_CLEAR(clear_module_state->__pyx_n_s_translate);
   Py_CLEAR(clear_module_state->__pyx_n_s_truthtable);
   Py_CLEAR(clear_module_state->__pyx_n_s_truthtable_view);
   Py_CLEAR(clear_module_state->__pyx_kp_s_tuple_list_CNF_list_XorClauseLis);
   Py_CLEAR(clear_module_state->__pyx_n_s_uint8);
   Py_CLEAR(clear_module_state->__pyx_kp_s_unable_to_allocate_array_data);
   Py_CLEAR(clear_module_state->__pyx_kp_s_unable_to_allocate_shape_and_str);
+  Py_CLEAR(clear_module_state->__pyx_n_s_union);
   Py_CLEAR(clear_module_state->__pyx_kp_u_unknown_status);
   Py_CLEAR(clear_module_state->__pyx_n_s_unpack);
   Py_CLEAR(clear_module_state->__pyx_n_s_update);
   Py_CLEAR(clear_module_state->__pyx_kp_u_use_from_lut_or_from_indices);
   Py_CLEAR(clear_module_state->__pyx_n_s_use_setstate);
   Py_CLEAR(clear_module_state->__pyx_kp_u_v);
   Py_CLEAR(clear_module_state->__pyx_n_s_v_2);
@@ -5928,14 +5989,15 @@
   Py_CLEAR(clear_module_state->__pyx_kp_u_var_must_not_be_zero);
   Py_CLEAR(clear_module_state->__pyx_n_s_var_view);
   Py_CLEAR(clear_module_state->__pyx_kp_u_variable_0_must_map_to_0_again);
   Py_CLEAR(clear_module_state->__pyx_kp_u_variable_must_not_be_mapped_to_0);
   Py_CLEAR(clear_module_state->__pyx_n_s_variables);
   Py_CLEAR(clear_module_state->__pyx_kp_u_variables_2);
   Py_CLEAR(clear_module_state->__pyx_kp_u_variables_with);
+  Py_CLEAR(clear_module_state->__pyx_n_s_vars_to_update);
   Py_CLEAR(clear_module_state->__pyx_n_s_vec_result);
   Py_CLEAR(clear_module_state->__pyx_n_s_verbose);
   Py_CLEAR(clear_module_state->__pyx_n_s_version_info);
   Py_CLEAR(clear_module_state->__pyx_n_u_w);
   Py_CLEAR(clear_module_state->__pyx_n_s_wait);
   Py_CLEAR(clear_module_state->__pyx_n_s_where);
   Py_CLEAR(clear_module_state->__pyx_n_s_write);
@@ -6208,18 +6270,18 @@
   Py_VISIT(traverse_module_state->__pyx_n_s_CNF_create_all_equal);
   Py_VISIT(traverse_module_state->__pyx_n_s_CNF_create_all_zero);
   Py_VISIT(traverse_module_state->__pyx_n_s_CNF_create_xor);
   Py_VISIT(traverse_module_state->__pyx_n_s_CNF_equiv);
   Py_VISIT(traverse_module_state->__pyx_n_s_CNF_from_dimacs);
   Py_VISIT(traverse_module_state->__pyx_n_s_CNF_from_espresso);
   Py_VISIT(traverse_module_state->__pyx_n_s_CNF_get_units);
-  Py_VISIT(traverse_module_state->__pyx_kp_u_CNF_get_units_line_967);
+  Py_VISIT(traverse_module_state->__pyx_kp_u_CNF_get_units_line_974);
   Py_VISIT(traverse_module_state->__pyx_n_s_CNF_implied_by);
   Py_VISIT(traverse_module_state->__pyx_n_s_CNF_logical_or);
-  Py_VISIT(traverse_module_state->__pyx_kp_u_CNF_logical_or_line_904);
+  Py_VISIT(traverse_module_state->__pyx_kp_u_CNF_logical_or_line_911);
   Py_VISIT(traverse_module_state->__pyx_n_s_CNF_minimize_espresso);
   Py_VISIT(traverse_module_state->__pyx_n_s_CNF_minimize_lingeling);
   Py_VISIT(traverse_module_state->__pyx_kp_u_CNF_must_not_contain_xor_clauses);
   Py_VISIT(traverse_module_state->__pyx_kp_u_CNF_over);
   Py_VISIT(traverse_module_state->__pyx_n_s_CNF_solve_dimacs);
   Py_VISIT(traverse_module_state->__pyx_n_s_CNF_to_dimacs);
   Py_VISIT(traverse_module_state->__pyx_n_s_CNF_to_espresso);
@@ -6671,14 +6733,15 @@
   Py_VISIT(traverse_module_state->__pyx_n_s_translate);
   Py_VISIT(traverse_module_state->__pyx_n_s_truthtable);
   Py_VISIT(traverse_module_state->__pyx_n_s_truthtable_view);
   Py_VISIT(traverse_module_state->__pyx_kp_s_tuple_list_CNF_list_XorClauseLis);
   Py_VISIT(traverse_module_state->__pyx_n_s_uint8);
   Py_VISIT(traverse_module_state->__pyx_kp_s_unable_to_allocate_array_data);
   Py_VISIT(traverse_module_state->__pyx_kp_s_unable_to_allocate_shape_and_str);
+  Py_VISIT(traverse_module_state->__pyx_n_s_union);
   Py_VISIT(traverse_module_state->__pyx_kp_u_unknown_status);
   Py_VISIT(traverse_module_state->__pyx_n_s_unpack);
   Py_VISIT(traverse_module_state->__pyx_n_s_update);
   Py_VISIT(traverse_module_state->__pyx_kp_u_use_from_lut_or_from_indices);
   Py_VISIT(traverse_module_state->__pyx_n_s_use_setstate);
   Py_VISIT(traverse_module_state->__pyx_kp_u_v);
   Py_VISIT(traverse_module_state->__pyx_n_s_v_2);
@@ -6688,14 +6751,15 @@
   Py_VISIT(traverse_module_state->__pyx_kp_u_var_must_not_be_zero);
   Py_VISIT(traverse_module_state->__pyx_n_s_var_view);
   Py_VISIT(traverse_module_state->__pyx_kp_u_variable_0_must_map_to_0_again);
   Py_VISIT(traverse_module_state->__pyx_kp_u_variable_must_not_be_mapped_to_0);
   Py_VISIT(traverse_module_state->__pyx_n_s_variables);
   Py_VISIT(traverse_module_state->__pyx_kp_u_variables_2);
   Py_VISIT(traverse_module_state->__pyx_kp_u_variables_with);
+  Py_VISIT(traverse_module_state->__pyx_n_s_vars_to_update);
   Py_VISIT(traverse_module_state->__pyx_n_s_vec_result);
   Py_VISIT(traverse_module_state->__pyx_n_s_verbose);
   Py_VISIT(traverse_module_state->__pyx_n_s_version_info);
   Py_VISIT(traverse_module_state->__pyx_n_u_w);
   Py_VISIT(traverse_module_state->__pyx_n_s_wait);
   Py_VISIT(traverse_module_state->__pyx_n_s_where);
   Py_VISIT(traverse_module_state->__pyx_n_s_write);
@@ -7080,18 +7144,18 @@
 #define __pyx_n_s_CNF_create_all_equal __pyx_mstate_global->__pyx_n_s_CNF_create_all_equal
 #define __pyx_n_s_CNF_create_all_zero __pyx_mstate_global->__pyx_n_s_CNF_create_all_zero
 #define __pyx_n_s_CNF_create_xor __pyx_mstate_global->__pyx_n_s_CNF_create_xor
 #define __pyx_n_s_CNF_equiv __pyx_mstate_global->__pyx_n_s_CNF_equiv
 #define __pyx_n_s_CNF_from_dimacs __pyx_mstate_global->__pyx_n_s_CNF_from_dimacs
 #define __pyx_n_s_CNF_from_espresso __pyx_mstate_global->__pyx_n_s_CNF_from_espresso
 #define __pyx_n_s_CNF_get_units __pyx_mstate_global->__pyx_n_s_CNF_get_units
-#define __pyx_kp_u_CNF_get_units_line_967 __pyx_mstate_global->__pyx_kp_u_CNF_get_units_line_967
+#define __pyx_kp_u_CNF_get_units_line_974 __pyx_mstate_global->__pyx_kp_u_CNF_get_units_line_974
 #define __pyx_n_s_CNF_implied_by __pyx_mstate_global->__pyx_n_s_CNF_implied_by
 #define __pyx_n_s_CNF_logical_or __pyx_mstate_global->__pyx_n_s_CNF_logical_or
-#define __pyx_kp_u_CNF_logical_or_line_904 __pyx_mstate_global->__pyx_kp_u_CNF_logical_or_line_904
+#define __pyx_kp_u_CNF_logical_or_line_911 __pyx_mstate_global->__pyx_kp_u_CNF_logical_or_line_911
 #define __pyx_n_s_CNF_minimize_espresso __pyx_mstate_global->__pyx_n_s_CNF_minimize_espresso
 #define __pyx_n_s_CNF_minimize_lingeling __pyx_mstate_global->__pyx_n_s_CNF_minimize_lingeling
 #define __pyx_kp_u_CNF_must_not_contain_xor_clauses __pyx_mstate_global->__pyx_kp_u_CNF_must_not_contain_xor_clauses
 #define __pyx_kp_u_CNF_over __pyx_mstate_global->__pyx_kp_u_CNF_over
 #define __pyx_n_s_CNF_solve_dimacs __pyx_mstate_global->__pyx_n_s_CNF_solve_dimacs
 #define __pyx_n_s_CNF_to_dimacs __pyx_mstate_global->__pyx_n_s_CNF_to_dimacs
 #define __pyx_n_s_CNF_to_espresso __pyx_mstate_global->__pyx_n_s_CNF_to_espresso
@@ -7543,14 +7607,15 @@
 #define __pyx_n_s_translate __pyx_mstate_global->__pyx_n_s_translate
 #define __pyx_n_s_truthtable __pyx_mstate_global->__pyx_n_s_truthtable
 #define __pyx_n_s_truthtable_view __pyx_mstate_global->__pyx_n_s_truthtable_view
 #define __pyx_kp_s_tuple_list_CNF_list_XorClauseLis __pyx_mstate_global->__pyx_kp_s_tuple_list_CNF_list_XorClauseLis
 #define __pyx_n_s_uint8 __pyx_mstate_global->__pyx_n_s_uint8
 #define __pyx_kp_s_unable_to_allocate_array_data __pyx_mstate_global->__pyx_kp_s_unable_to_allocate_array_data
 #define __pyx_kp_s_unable_to_allocate_shape_and_str __pyx_mstate_global->__pyx_kp_s_unable_to_allocate_shape_and_str
+#define __pyx_n_s_union __pyx_mstate_global->__pyx_n_s_union
 #define __pyx_kp_u_unknown_status __pyx_mstate_global->__pyx_kp_u_unknown_status
 #define __pyx_n_s_unpack __pyx_mstate_global->__pyx_n_s_unpack
 #define __pyx_n_s_update __pyx_mstate_global->__pyx_n_s_update
 #define __pyx_kp_u_use_from_lut_or_from_indices __pyx_mstate_global->__pyx_kp_u_use_from_lut_or_from_indices
 #define __pyx_n_s_use_setstate __pyx_mstate_global->__pyx_n_s_use_setstate
 #define __pyx_kp_u_v __pyx_mstate_global->__pyx_kp_u_v
 #define __pyx_n_s_v_2 __pyx_mstate_global->__pyx_n_s_v_2
@@ -7560,14 +7625,15 @@
 #define __pyx_kp_u_var_must_not_be_zero __pyx_mstate_global->__pyx_kp_u_var_must_not_be_zero
 #define __pyx_n_s_var_view __pyx_mstate_global->__pyx_n_s_var_view
 #define __pyx_kp_u_variable_0_must_map_to_0_again __pyx_mstate_global->__pyx_kp_u_variable_0_must_map_to_0_again
 #define __pyx_kp_u_variable_must_not_be_mapped_to_0 __pyx_mstate_global->__pyx_kp_u_variable_must_not_be_mapped_to_0
 #define __pyx_n_s_variables __pyx_mstate_global->__pyx_n_s_variables
 #define __pyx_kp_u_variables_2 __pyx_mstate_global->__pyx_kp_u_variables_2
 #define __pyx_kp_u_variables_with __pyx_mstate_global->__pyx_kp_u_variables_with
+#define __pyx_n_s_vars_to_update __pyx_mstate_global->__pyx_n_s_vars_to_update
 #define __pyx_n_s_vec_result __pyx_mstate_global->__pyx_n_s_vec_result
 #define __pyx_n_s_verbose __pyx_mstate_global->__pyx_n_s_verbose
 #define __pyx_n_s_version_info __pyx_mstate_global->__pyx_n_s_version_info
 #define __pyx_n_u_w __pyx_mstate_global->__pyx_n_u_w
 #define __pyx_n_s_wait __pyx_mstate_global->__pyx_n_s_wait
 #define __pyx_n_s_where __pyx_mstate_global->__pyx_n_s_where
 #define __pyx_n_s_write __pyx_mstate_global->__pyx_n_s_write
@@ -22262,70 +22328,70 @@
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
 /* "cpython/complex.pxd":19
  * 
  *         @property
- *         cdef inline double real(self):             # <<<<<<<<<<<<<<
+ *         cdef inline double real(self) noexcept:             # <<<<<<<<<<<<<<
  *             return self.cval.real
  * 
  */
 
 static CYTHON_INLINE double __pyx_f_7cpython_7complex_7complex_4real_real(PyComplexObject *__pyx_v_self) {
   double __pyx_r;
 
   /* "cpython/complex.pxd":20
  *         @property
- *         cdef inline double real(self):
+ *         cdef inline double real(self) noexcept:
  *             return self.cval.real             # <<<<<<<<<<<<<<
  * 
  *         @property
  */
   __pyx_r = __pyx_v_self->cval.real;
   goto __pyx_L0;
 
   /* "cpython/complex.pxd":19
  * 
  *         @property
- *         cdef inline double real(self):             # <<<<<<<<<<<<<<
+ *         cdef inline double real(self) noexcept:             # <<<<<<<<<<<<<<
  *             return self.cval.real
  * 
  */
 
   /* function exit code */
   __pyx_L0:;
   return __pyx_r;
 }
 
 /* "cpython/complex.pxd":23
  * 
  *         @property
- *         cdef inline double imag(self):             # <<<<<<<<<<<<<<
+ *         cdef inline double imag(self) noexcept:             # <<<<<<<<<<<<<<
  *             return self.cval.imag
  * 
  */
 
 static CYTHON_INLINE double __pyx_f_7cpython_7complex_7complex_4imag_imag(PyComplexObject *__pyx_v_self) {
   double __pyx_r;
 
   /* "cpython/complex.pxd":24
  *         @property
- *         cdef inline double imag(self):
+ *         cdef inline double imag(self) noexcept:
  *             return self.cval.imag             # <<<<<<<<<<<<<<
  * 
  *     # PyTypeObject PyComplex_Type
  */
   __pyx_r = __pyx_v_self->cval.imag;
   goto __pyx_L0;
 
   /* "cpython/complex.pxd":23
  * 
  *         @property
- *         cdef inline double imag(self):             # <<<<<<<<<<<<<<
+ *         cdef inline double imag(self) noexcept:             # <<<<<<<<<<<<<<
  *             return self.cval.imag
  * 
  */
 
   /* function exit code */
   __pyx_L0:;
   return __pyx_r;
@@ -27269,15 +27335,15 @@
   }
 
   /* "sat_toolkit/formula.pyx":282
  *                 raise ValueError(f'cannot set nvars to {val} as it is too small')
  * 
  *         self.nvars = val             # <<<<<<<<<<<<<<
  * 
- *     cdef set[int] _get_vars(self) nogil:
+ *     cdef cpp_set[int] _get_vars(self) nogil:
  */
   __pyx_v_self->nvars = __pyx_v_val;
 
   /* "sat_toolkit/formula.pyx":268
  *         return self.nvars
  * 
  *     @nvars.setter             # <<<<<<<<<<<<<<
@@ -27297,16 +27363,16 @@
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
 /* "sat_toolkit/formula.pyx":284
  *         self.nvars = val
  * 
- *     cdef set[int] _get_vars(self) nogil:             # <<<<<<<<<<<<<<
- *         cdef set[int] res
+ *     cdef cpp_set[int] _get_vars(self) nogil:             # <<<<<<<<<<<<<<
+ *         cdef cpp_set[int] res
  *         cdef size_t i
  */
 
 static std::set<int>  __pyx_f_11sat_toolkit_7formula_11_ClauseList__get_vars(struct __pyx_obj_11sat_toolkit_7formula__ClauseList *__pyx_v_self) {
   std::set<int>  __pyx_v_res;
   size_t __pyx_v_i;
   int __pyx_v_val;
@@ -27392,16 +27458,16 @@
  */
   __pyx_r = __pyx_v_res;
   goto __pyx_L0;
 
   /* "sat_toolkit/formula.pyx":284
  *         self.nvars = val
  * 
- *     cdef set[int] _get_vars(self) nogil:             # <<<<<<<<<<<<<<
- *         cdef set[int] res
+ *     cdef cpp_set[int] _get_vars(self) nogil:             # <<<<<<<<<<<<<<
+ *         cdef cpp_set[int] res
  *         cdef size_t i
  */
 
   /* function exit code */
   __pyx_L1_error:;
   #ifdef WITH_THREAD
   __pyx_gilstate_save = __Pyx_PyGILState_Ensure();
@@ -27654,14 +27720,15 @@
   /* function exit code */
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
 static PyObject *__pyx_pf_11sat_toolkit_7formula_11_ClauseList_8partition(struct __pyx_obj_11sat_toolkit_7formula__ClauseList *__pyx_v_self) {
   PyObject *__pyx_v_res = 0;
+  PyObject *__pyx_v_vars_to_update = 0;
   struct __pyx_obj_11sat_toolkit_7formula__BaseClause *__pyx_v_clause = 0;
   struct __pyx_obj_11sat_toolkit_7formula__ClauseList *__pyx_v_dst = 0;
   struct __pyx_obj_11sat_toolkit_7formula__ClauseList *__pyx_v_tmp = 0;
   int __pyx_v_var;
   PyObject *__pyx_v_result_list = 0;
   std::set<void *>  __pyx_v_seen_keys;
   PyObject *__pyx_v_val = 0;
@@ -27677,145 +27744,158 @@
   PyObject *__pyx_t_8 = NULL;
   int __pyx_t_9;
   int __pyx_t_10;
   PyObject *(*__pyx_t_11)(PyObject *);
   PyObject *__pyx_t_12 = NULL;
   int __pyx_t_13;
   Py_ssize_t __pyx_t_14;
+  int __pyx_t_15;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("partition", 1);
 
   /* "sat_toolkit/formula.pyx":313
  *         partition the CNF/XorClauseList into a list of CNF/XorClauseLists with disjoints variables.
  *         """
- *         cdef dict res = {}             # <<<<<<<<<<<<<<
+ *         cdef dict[int, _ClauseList] res = {}             # <<<<<<<<<<<<<<
+ *         cdef set[int] vars_to_update = set()
  *         cdef _BaseClause clause = None
- *         cdef _ClauseList dst = None, tmp = None
  */
   __pyx_t_1 = __Pyx_PyDict_NewPresized(0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 313, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_v_res = ((PyObject*)__pyx_t_1);
   __pyx_t_1 = 0;
 
   /* "sat_toolkit/formula.pyx":314
  *         """
- *         cdef dict res = {}
+ *         cdef dict[int, _ClauseList] res = {}
+ *         cdef set[int] vars_to_update = set()             # <<<<<<<<<<<<<<
+ *         cdef _BaseClause clause = None
+ *         cdef _ClauseList dst = None, tmp = None
+ */
+  __pyx_t_1 = PySet_New(0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 314, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_1);
+  __pyx_v_vars_to_update = ((PyObject*)__pyx_t_1);
+  __pyx_t_1 = 0;
+
+  /* "sat_toolkit/formula.pyx":315
+ *         cdef dict[int, _ClauseList] res = {}
+ *         cdef set[int] vars_to_update = set()
  *         cdef _BaseClause clause = None             # <<<<<<<<<<<<<<
  *         cdef _ClauseList dst = None, tmp = None
  *         cdef int var
  */
   __Pyx_INCREF(Py_None);
   __pyx_v_clause = ((struct __pyx_obj_11sat_toolkit_7formula__BaseClause *)Py_None);
 
-  /* "sat_toolkit/formula.pyx":315
- *         cdef dict res = {}
+  /* "sat_toolkit/formula.pyx":316
+ *         cdef set[int] vars_to_update = set()
  *         cdef _BaseClause clause = None
  *         cdef _ClauseList dst = None, tmp = None             # <<<<<<<<<<<<<<
  *         cdef int var
  * 
  */
   __Pyx_INCREF(Py_None);
   __pyx_v_dst = ((struct __pyx_obj_11sat_toolkit_7formula__ClauseList *)Py_None);
   __Pyx_INCREF(Py_None);
   __pyx_v_tmp = ((struct __pyx_obj_11sat_toolkit_7formula__ClauseList *)Py_None);
 
-  /* "sat_toolkit/formula.pyx":318
+  /* "sat_toolkit/formula.pyx":319
  *         cdef int var
  * 
  *         for clause in self:             # <<<<<<<<<<<<<<
  *             if len(clause) == 0:
  *                 if 0 not in res:
  */
   if (likely(PyList_CheckExact(((PyObject *)__pyx_v_self))) || PyTuple_CheckExact(((PyObject *)__pyx_v_self))) {
     __pyx_t_1 = ((PyObject *)__pyx_v_self); __Pyx_INCREF(__pyx_t_1);
     __pyx_t_2 = 0;
     __pyx_t_3 = NULL;
   } else {
-    __pyx_t_2 = -1; __pyx_t_1 = PyObject_GetIter(((PyObject *)__pyx_v_self)); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 318, __pyx_L1_error)
+    __pyx_t_2 = -1; __pyx_t_1 = PyObject_GetIter(((PyObject *)__pyx_v_self)); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 319, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
-    __pyx_t_3 = __Pyx_PyObject_GetIterNextFunc(__pyx_t_1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 318, __pyx_L1_error)
+    __pyx_t_3 = __Pyx_PyObject_GetIterNextFunc(__pyx_t_1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 319, __pyx_L1_error)
   }
   for (;;) {
     if (likely(!__pyx_t_3)) {
       if (likely(PyList_CheckExact(__pyx_t_1))) {
         {
           Py_ssize_t __pyx_temp = __Pyx_PyList_GET_SIZE(__pyx_t_1);
           #if !CYTHON_ASSUME_SAFE_MACROS
-          if (unlikely((__pyx_temp < 0))) __PYX_ERR(0, 318, __pyx_L1_error)
+          if (unlikely((__pyx_temp < 0))) __PYX_ERR(0, 319, __pyx_L1_error)
           #endif
           if (__pyx_t_2 >= __pyx_temp) break;
         }
         #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-        __pyx_t_4 = PyList_GET_ITEM(__pyx_t_1, __pyx_t_2); __Pyx_INCREF(__pyx_t_4); __pyx_t_2++; if (unlikely((0 < 0))) __PYX_ERR(0, 318, __pyx_L1_error)
+        __pyx_t_4 = PyList_GET_ITEM(__pyx_t_1, __pyx_t_2); __Pyx_INCREF(__pyx_t_4); __pyx_t_2++; if (unlikely((0 < 0))) __PYX_ERR(0, 319, __pyx_L1_error)
         #else
-        __pyx_t_4 = __Pyx_PySequence_ITEM(__pyx_t_1, __pyx_t_2); __pyx_t_2++; if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 318, __pyx_L1_error)
+        __pyx_t_4 = __Pyx_PySequence_ITEM(__pyx_t_1, __pyx_t_2); __pyx_t_2++; if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 319, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_4);
         #endif
       } else {
         {
           Py_ssize_t __pyx_temp = __Pyx_PyTuple_GET_SIZE(__pyx_t_1);
           #if !CYTHON_ASSUME_SAFE_MACROS
-          if (unlikely((__pyx_temp < 0))) __PYX_ERR(0, 318, __pyx_L1_error)
+          if (unlikely((__pyx_temp < 0))) __PYX_ERR(0, 319, __pyx_L1_error)
           #endif
           if (__pyx_t_2 >= __pyx_temp) break;
         }
         #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-        __pyx_t_4 = PyTuple_GET_ITEM(__pyx_t_1, __pyx_t_2); __Pyx_INCREF(__pyx_t_4); __pyx_t_2++; if (unlikely((0 < 0))) __PYX_ERR(0, 318, __pyx_L1_error)
+        __pyx_t_4 = PyTuple_GET_ITEM(__pyx_t_1, __pyx_t_2); __Pyx_INCREF(__pyx_t_4); __pyx_t_2++; if (unlikely((0 < 0))) __PYX_ERR(0, 319, __pyx_L1_error)
         #else
-        __pyx_t_4 = __Pyx_PySequence_ITEM(__pyx_t_1, __pyx_t_2); __pyx_t_2++; if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 318, __pyx_L1_error)
+        __pyx_t_4 = __Pyx_PySequence_ITEM(__pyx_t_1, __pyx_t_2); __pyx_t_2++; if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 319, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_4);
         #endif
       }
     } else {
       __pyx_t_4 = __pyx_t_3(__pyx_t_1);
       if (unlikely(!__pyx_t_4)) {
         PyObject* exc_type = PyErr_Occurred();
         if (exc_type) {
           if (likely(__Pyx_PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
-          else __PYX_ERR(0, 318, __pyx_L1_error)
+          else __PYX_ERR(0, 319, __pyx_L1_error)
         }
         break;
       }
       __Pyx_GOTREF(__pyx_t_4);
     }
-    if (!(likely(((__pyx_t_4) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_4, __pyx_ptype_11sat_toolkit_7formula__BaseClause))))) __PYX_ERR(0, 318, __pyx_L1_error)
+    if (!(likely(((__pyx_t_4) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_4, __pyx_ptype_11sat_toolkit_7formula__BaseClause))))) __PYX_ERR(0, 319, __pyx_L1_error)
     __Pyx_DECREF_SET(__pyx_v_clause, ((struct __pyx_obj_11sat_toolkit_7formula__BaseClause *)__pyx_t_4));
     __pyx_t_4 = 0;
 
-    /* "sat_toolkit/formula.pyx":319
+    /* "sat_toolkit/formula.pyx":320
  * 
  *         for clause in self:
  *             if len(clause) == 0:             # <<<<<<<<<<<<<<
  *                 if 0 not in res:
  *                     dst = type(self).__new__(type(self))
  */
-    __pyx_t_5 = PyObject_Length(((PyObject *)__pyx_v_clause)); if (unlikely(__pyx_t_5 == ((Py_ssize_t)-1))) __PYX_ERR(0, 319, __pyx_L1_error)
+    __pyx_t_5 = PyObject_Length(((PyObject *)__pyx_v_clause)); if (unlikely(__pyx_t_5 == ((Py_ssize_t)-1))) __PYX_ERR(0, 320, __pyx_L1_error)
     __pyx_t_6 = (__pyx_t_5 == 0);
     if (__pyx_t_6) {
 
-      /* "sat_toolkit/formula.pyx":320
+      /* "sat_toolkit/formula.pyx":321
  *         for clause in self:
  *             if len(clause) == 0:
  *                 if 0 not in res:             # <<<<<<<<<<<<<<
  *                     dst = type(self).__new__(type(self))
  *                     dst.nvars = self.nvars
  */
-      __pyx_t_6 = (__Pyx_PyDict_ContainsTF(__pyx_int_0, __pyx_v_res, Py_NE)); if (unlikely((__pyx_t_6 < 0))) __PYX_ERR(0, 320, __pyx_L1_error)
+      __pyx_t_6 = (__Pyx_PyDict_ContainsTF(__pyx_int_0, __pyx_v_res, Py_NE)); if (unlikely((__pyx_t_6 < 0))) __PYX_ERR(0, 321, __pyx_L1_error)
       if (__pyx_t_6) {
 
-        /* "sat_toolkit/formula.pyx":321
+        /* "sat_toolkit/formula.pyx":322
  *             if len(clause) == 0:
  *                 if 0 not in res:
  *                     dst = type(self).__new__(type(self))             # <<<<<<<<<<<<<<
  *                     dst.nvars = self.nvars
  *                     res[0] = dst
  */
-        __pyx_t_7 = __Pyx_PyObject_GetAttrStr(((PyObject *)Py_TYPE(((PyObject *)__pyx_v_self))), __pyx_n_s_new); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 321, __pyx_L1_error)
+        __pyx_t_7 = __Pyx_PyObject_GetAttrStr(((PyObject *)Py_TYPE(((PyObject *)__pyx_v_self))), __pyx_n_s_new); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 322, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_7);
         __pyx_t_8 = NULL;
         __pyx_t_9 = 0;
         #if CYTHON_UNPACK_METHODS
         if (likely(PyMethod_Check(__pyx_t_7))) {
           __pyx_t_8 = PyMethod_GET_SELF(__pyx_t_7);
           if (likely(__pyx_t_8)) {
@@ -27827,307 +27907,323 @@
           }
         }
         #endif
         {
           PyObject *__pyx_callargs[2] = {__pyx_t_8, ((PyObject *)Py_TYPE(((PyObject *)__pyx_v_self)))};
           __pyx_t_4 = __Pyx_PyObject_FastCall(__pyx_t_7, __pyx_callargs+1-__pyx_t_9, 1+__pyx_t_9);
           __Pyx_XDECREF(__pyx_t_8); __pyx_t_8 = 0;
-          if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 321, __pyx_L1_error)
+          if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 322, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_4);
           __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
         }
-        if (!(likely(((__pyx_t_4) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_4, __pyx_ptype_11sat_toolkit_7formula__ClauseList))))) __PYX_ERR(0, 321, __pyx_L1_error)
+        if (!(likely(((__pyx_t_4) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_4, __pyx_ptype_11sat_toolkit_7formula__ClauseList))))) __PYX_ERR(0, 322, __pyx_L1_error)
         __Pyx_DECREF_SET(__pyx_v_dst, ((struct __pyx_obj_11sat_toolkit_7formula__ClauseList *)__pyx_t_4));
         __pyx_t_4 = 0;
 
-        /* "sat_toolkit/formula.pyx":322
+        /* "sat_toolkit/formula.pyx":323
  *                 if 0 not in res:
  *                     dst = type(self).__new__(type(self))
  *                     dst.nvars = self.nvars             # <<<<<<<<<<<<<<
  *                     res[0] = dst
  *                 else:
  */
         __pyx_t_9 = __pyx_v_self->nvars;
         __pyx_v_dst->nvars = __pyx_t_9;
 
-        /* "sat_toolkit/formula.pyx":323
+        /* "sat_toolkit/formula.pyx":324
  *                     dst = type(self).__new__(type(self))
  *                     dst.nvars = self.nvars
  *                     res[0] = dst             # <<<<<<<<<<<<<<
  *                 else:
  *                     dst = res[0]
  */
-        if (unlikely((PyDict_SetItem(__pyx_v_res, __pyx_int_0, ((PyObject *)__pyx_v_dst)) < 0))) __PYX_ERR(0, 323, __pyx_L1_error)
+        if (unlikely((PyDict_SetItem(__pyx_v_res, __pyx_int_0, ((PyObject *)__pyx_v_dst)) < 0))) __PYX_ERR(0, 324, __pyx_L1_error)
 
-        /* "sat_toolkit/formula.pyx":320
+        /* "sat_toolkit/formula.pyx":321
  *         for clause in self:
  *             if len(clause) == 0:
  *                 if 0 not in res:             # <<<<<<<<<<<<<<
  *                     dst = type(self).__new__(type(self))
  *                     dst.nvars = self.nvars
  */
         goto __pyx_L6;
       }
 
-      /* "sat_toolkit/formula.pyx":325
+      /* "sat_toolkit/formula.pyx":326
  *                     res[0] = dst
  *                 else:
  *                     dst = res[0]             # <<<<<<<<<<<<<<
  *                 dst.append(clause)
  * 
  */
       /*else*/ {
-        __pyx_t_4 = __Pyx_PyDict_GetItem(__pyx_v_res, __pyx_int_0); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 325, __pyx_L1_error)
+        __pyx_t_4 = __Pyx_PyDict_GetItem(__pyx_v_res, __pyx_int_0); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 326, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_4);
-        if (!(likely(((__pyx_t_4) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_4, __pyx_ptype_11sat_toolkit_7formula__ClauseList))))) __PYX_ERR(0, 325, __pyx_L1_error)
+        if (!(likely(((__pyx_t_4) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_4, __pyx_ptype_11sat_toolkit_7formula__ClauseList))))) __PYX_ERR(0, 326, __pyx_L1_error)
         __Pyx_DECREF_SET(__pyx_v_dst, ((struct __pyx_obj_11sat_toolkit_7formula__ClauseList *)__pyx_t_4));
         __pyx_t_4 = 0;
       }
       __pyx_L6:;
 
-      /* "sat_toolkit/formula.pyx":326
+      /* "sat_toolkit/formula.pyx":327
  *                 else:
  *                     dst = res[0]
  *                 dst.append(clause)             # <<<<<<<<<<<<<<
  * 
  *             dst = None
  */
-      __pyx_t_10 = __Pyx_PyObject_Append(((PyObject *)__pyx_v_dst), ((PyObject *)__pyx_v_clause)); if (unlikely(__pyx_t_10 == ((int)-1))) __PYX_ERR(0, 326, __pyx_L1_error)
+      __pyx_t_10 = __Pyx_PyObject_Append(((PyObject *)__pyx_v_dst), ((PyObject *)__pyx_v_clause)); if (unlikely(__pyx_t_10 == ((int)-1))) __PYX_ERR(0, 327, __pyx_L1_error)
 
-      /* "sat_toolkit/formula.pyx":319
+      /* "sat_toolkit/formula.pyx":320
  * 
  *         for clause in self:
  *             if len(clause) == 0:             # <<<<<<<<<<<<<<
  *                 if 0 not in res:
  *                     dst = type(self).__new__(type(self))
  */
     }
 
-    /* "sat_toolkit/formula.pyx":328
+    /* "sat_toolkit/formula.pyx":329
  *                 dst.append(clause)
  * 
  *             dst = None             # <<<<<<<<<<<<<<
- *             for var in clause:
- *                 var = abs(var)
+ *             vars_to_update.clear()
+ * 
  */
     __Pyx_INCREF(Py_None);
     __Pyx_DECREF_SET(__pyx_v_dst, ((struct __pyx_obj_11sat_toolkit_7formula__ClauseList *)Py_None));
 
-    /* "sat_toolkit/formula.pyx":329
+    /* "sat_toolkit/formula.pyx":330
  * 
  *             dst = None
+ *             vars_to_update.clear()             # <<<<<<<<<<<<<<
+ * 
+ *             for var in clause:
+ */
+    if (unlikely(__pyx_v_vars_to_update == Py_None)) {
+      PyErr_Format(PyExc_AttributeError, "'NoneType' object has no attribute '%.30s'", "clear");
+      __PYX_ERR(0, 330, __pyx_L1_error)
+    }
+    __pyx_t_10 = PySet_Clear(__pyx_v_vars_to_update); if (unlikely(__pyx_t_10 == ((int)-1))) __PYX_ERR(0, 330, __pyx_L1_error)
+
+    /* "sat_toolkit/formula.pyx":332
+ *             vars_to_update.clear()
+ * 
  *             for var in clause:             # <<<<<<<<<<<<<<
  *                 var = abs(var)
- * 
+ *                 vars_to_update.add(var)
  */
     if (likely(PyList_CheckExact(((PyObject *)__pyx_v_clause))) || PyTuple_CheckExact(((PyObject *)__pyx_v_clause))) {
       __pyx_t_4 = ((PyObject *)__pyx_v_clause); __Pyx_INCREF(__pyx_t_4);
       __pyx_t_5 = 0;
       __pyx_t_11 = NULL;
     } else {
-      __pyx_t_5 = -1; __pyx_t_4 = PyObject_GetIter(((PyObject *)__pyx_v_clause)); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 329, __pyx_L1_error)
+      __pyx_t_5 = -1; __pyx_t_4 = PyObject_GetIter(((PyObject *)__pyx_v_clause)); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 332, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_4);
-      __pyx_t_11 = __Pyx_PyObject_GetIterNextFunc(__pyx_t_4); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 329, __pyx_L1_error)
+      __pyx_t_11 = __Pyx_PyObject_GetIterNextFunc(__pyx_t_4); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 332, __pyx_L1_error)
     }
     for (;;) {
       if (likely(!__pyx_t_11)) {
         if (likely(PyList_CheckExact(__pyx_t_4))) {
           {
             Py_ssize_t __pyx_temp = __Pyx_PyList_GET_SIZE(__pyx_t_4);
             #if !CYTHON_ASSUME_SAFE_MACROS
-            if (unlikely((__pyx_temp < 0))) __PYX_ERR(0, 329, __pyx_L1_error)
+            if (unlikely((__pyx_temp < 0))) __PYX_ERR(0, 332, __pyx_L1_error)
             #endif
             if (__pyx_t_5 >= __pyx_temp) break;
           }
           #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-          __pyx_t_7 = PyList_GET_ITEM(__pyx_t_4, __pyx_t_5); __Pyx_INCREF(__pyx_t_7); __pyx_t_5++; if (unlikely((0 < 0))) __PYX_ERR(0, 329, __pyx_L1_error)
+          __pyx_t_7 = PyList_GET_ITEM(__pyx_t_4, __pyx_t_5); __Pyx_INCREF(__pyx_t_7); __pyx_t_5++; if (unlikely((0 < 0))) __PYX_ERR(0, 332, __pyx_L1_error)
           #else
-          __pyx_t_7 = __Pyx_PySequence_ITEM(__pyx_t_4, __pyx_t_5); __pyx_t_5++; if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 329, __pyx_L1_error)
+          __pyx_t_7 = __Pyx_PySequence_ITEM(__pyx_t_4, __pyx_t_5); __pyx_t_5++; if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 332, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_7);
           #endif
         } else {
           {
             Py_ssize_t __pyx_temp = __Pyx_PyTuple_GET_SIZE(__pyx_t_4);
             #if !CYTHON_ASSUME_SAFE_MACROS
-            if (unlikely((__pyx_temp < 0))) __PYX_ERR(0, 329, __pyx_L1_error)
+            if (unlikely((__pyx_temp < 0))) __PYX_ERR(0, 332, __pyx_L1_error)
             #endif
             if (__pyx_t_5 >= __pyx_temp) break;
           }
           #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-          __pyx_t_7 = PyTuple_GET_ITEM(__pyx_t_4, __pyx_t_5); __Pyx_INCREF(__pyx_t_7); __pyx_t_5++; if (unlikely((0 < 0))) __PYX_ERR(0, 329, __pyx_L1_error)
+          __pyx_t_7 = PyTuple_GET_ITEM(__pyx_t_4, __pyx_t_5); __Pyx_INCREF(__pyx_t_7); __pyx_t_5++; if (unlikely((0 < 0))) __PYX_ERR(0, 332, __pyx_L1_error)
           #else
-          __pyx_t_7 = __Pyx_PySequence_ITEM(__pyx_t_4, __pyx_t_5); __pyx_t_5++; if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 329, __pyx_L1_error)
+          __pyx_t_7 = __Pyx_PySequence_ITEM(__pyx_t_4, __pyx_t_5); __pyx_t_5++; if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 332, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_7);
           #endif
         }
       } else {
         __pyx_t_7 = __pyx_t_11(__pyx_t_4);
         if (unlikely(!__pyx_t_7)) {
           PyObject* exc_type = PyErr_Occurred();
           if (exc_type) {
             if (likely(__Pyx_PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
-            else __PYX_ERR(0, 329, __pyx_L1_error)
+            else __PYX_ERR(0, 332, __pyx_L1_error)
           }
           break;
         }
         __Pyx_GOTREF(__pyx_t_7);
       }
-      __pyx_t_9 = __Pyx_PyInt_As_int(__pyx_t_7); if (unlikely((__pyx_t_9 == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 329, __pyx_L1_error)
+      __pyx_t_9 = __Pyx_PyInt_As_int(__pyx_t_7); if (unlikely((__pyx_t_9 == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 332, __pyx_L1_error)
       __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
       __pyx_v_var = __pyx_t_9;
 
-      /* "sat_toolkit/formula.pyx":330
- *             dst = None
+      /* "sat_toolkit/formula.pyx":333
+ * 
  *             for var in clause:
  *                 var = abs(var)             # <<<<<<<<<<<<<<
+ *                 vars_to_update.add(var)
  * 
- *                 if var not in res:
  */
       __pyx_v_var = __pyx_f_11sat_toolkit_7formula_abs(__pyx_v_var);
 
-      /* "sat_toolkit/formula.pyx":332
+      /* "sat_toolkit/formula.pyx":334
+ *             for var in clause:
  *                 var = abs(var)
+ *                 vars_to_update.add(var)             # <<<<<<<<<<<<<<
+ * 
+ *                 if var not in res:
+ */
+      if (unlikely(__pyx_v_vars_to_update == Py_None)) {
+        PyErr_Format(PyExc_AttributeError, "'NoneType' object has no attribute '%.30s'", "add");
+        __PYX_ERR(0, 334, __pyx_L1_error)
+      }
+      __pyx_t_7 = __Pyx_PyInt_From_int(__pyx_v_var); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 334, __pyx_L1_error)
+      __Pyx_GOTREF(__pyx_t_7);
+      __pyx_t_10 = PySet_Add(__pyx_v_vars_to_update, __pyx_t_7); if (unlikely(__pyx_t_10 == ((int)-1))) __PYX_ERR(0, 334, __pyx_L1_error)
+      __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
+
+      /* "sat_toolkit/formula.pyx":336
+ *                 vars_to_update.add(var)
  * 
  *                 if var not in res:             # <<<<<<<<<<<<<<
  *                     continue
  * 
  */
-      __pyx_t_7 = __Pyx_PyInt_From_int(__pyx_v_var); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 332, __pyx_L1_error)
+      __pyx_t_7 = __Pyx_PyInt_From_int(__pyx_v_var); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 336, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_7);
-      __pyx_t_6 = (__Pyx_PyDict_ContainsTF(__pyx_t_7, __pyx_v_res, Py_NE)); if (unlikely((__pyx_t_6 < 0))) __PYX_ERR(0, 332, __pyx_L1_error)
+      __pyx_t_6 = (__Pyx_PyDict_ContainsTF(__pyx_t_7, __pyx_v_res, Py_NE)); if (unlikely((__pyx_t_6 < 0))) __PYX_ERR(0, 336, __pyx_L1_error)
       __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
       if (__pyx_t_6) {
 
-        /* "sat_toolkit/formula.pyx":333
+        /* "sat_toolkit/formula.pyx":337
  * 
  *                 if var not in res:
  *                     continue             # <<<<<<<<<<<<<<
  * 
  *                 if dst is None:
  */
         goto __pyx_L7_continue;
 
-        /* "sat_toolkit/formula.pyx":332
- *                 var = abs(var)
+        /* "sat_toolkit/formula.pyx":336
+ *                 vars_to_update.add(var)
  * 
  *                 if var not in res:             # <<<<<<<<<<<<<<
  *                     continue
  * 
  */
       }
 
-      /* "sat_toolkit/formula.pyx":335
+      /* "sat_toolkit/formula.pyx":339
  *                     continue
  * 
  *                 if dst is None:             # <<<<<<<<<<<<<<
  *                     dst = res[var]
  *                     continue
  */
       __pyx_t_6 = (((PyObject *)__pyx_v_dst) == Py_None);
       if (__pyx_t_6) {
 
-        /* "sat_toolkit/formula.pyx":336
+        /* "sat_toolkit/formula.pyx":340
  * 
  *                 if dst is None:
  *                     dst = res[var]             # <<<<<<<<<<<<<<
  *                     continue
  * 
  */
-        __pyx_t_7 = __Pyx_PyInt_From_int(__pyx_v_var); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 336, __pyx_L1_error)
+        __pyx_t_7 = __Pyx_PyInt_From_int(__pyx_v_var); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 340, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_7);
-        __pyx_t_8 = __Pyx_PyDict_GetItem(__pyx_v_res, __pyx_t_7); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 336, __pyx_L1_error)
+        __pyx_t_8 = __Pyx_PyDict_GetItem(__pyx_v_res, __pyx_t_7); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 340, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_8);
         __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-        if (!(likely(((__pyx_t_8) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_8, __pyx_ptype_11sat_toolkit_7formula__ClauseList))))) __PYX_ERR(0, 336, __pyx_L1_error)
+        if (!(likely(((__pyx_t_8) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_8, __pyx_ptype_11sat_toolkit_7formula__ClauseList))))) __PYX_ERR(0, 340, __pyx_L1_error)
         __Pyx_DECREF_SET(__pyx_v_dst, ((struct __pyx_obj_11sat_toolkit_7formula__ClauseList *)__pyx_t_8));
         __pyx_t_8 = 0;
 
-        /* "sat_toolkit/formula.pyx":337
+        /* "sat_toolkit/formula.pyx":341
  *                 if dst is None:
  *                     dst = res[var]
  *                     continue             # <<<<<<<<<<<<<<
  * 
  *                 tmp = res[var]
  */
         goto __pyx_L7_continue;
 
-        /* "sat_toolkit/formula.pyx":335
+        /* "sat_toolkit/formula.pyx":339
  *                     continue
  * 
  *                 if dst is None:             # <<<<<<<<<<<<<<
  *                     dst = res[var]
  *                     continue
  */
       }
 
-      /* "sat_toolkit/formula.pyx":339
+      /* "sat_toolkit/formula.pyx":343
  *                     continue
  * 
  *                 tmp = res[var]             # <<<<<<<<<<<<<<
  *                 if dst is tmp:
  *                     continue
  */
-      __pyx_t_8 = __Pyx_PyInt_From_int(__pyx_v_var); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 339, __pyx_L1_error)
+      __pyx_t_8 = __Pyx_PyInt_From_int(__pyx_v_var); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 343, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_8);
-      __pyx_t_7 = __Pyx_PyDict_GetItem(__pyx_v_res, __pyx_t_8); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 339, __pyx_L1_error)
+      __pyx_t_7 = __Pyx_PyDict_GetItem(__pyx_v_res, __pyx_t_8); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 343, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_7);
       __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
-      if (!(likely(((__pyx_t_7) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_7, __pyx_ptype_11sat_toolkit_7formula__ClauseList))))) __PYX_ERR(0, 339, __pyx_L1_error)
+      if (!(likely(((__pyx_t_7) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_7, __pyx_ptype_11sat_toolkit_7formula__ClauseList))))) __PYX_ERR(0, 343, __pyx_L1_error)
       __Pyx_DECREF_SET(__pyx_v_tmp, ((struct __pyx_obj_11sat_toolkit_7formula__ClauseList *)__pyx_t_7));
       __pyx_t_7 = 0;
 
-      /* "sat_toolkit/formula.pyx":340
+      /* "sat_toolkit/formula.pyx":344
  * 
  *                 tmp = res[var]
  *                 if dst is tmp:             # <<<<<<<<<<<<<<
  *                     continue
  * 
  */
       __pyx_t_6 = (__pyx_v_dst == __pyx_v_tmp);
       if (__pyx_t_6) {
 
-        /* "sat_toolkit/formula.pyx":341
+        /* "sat_toolkit/formula.pyx":345
  *                 tmp = res[var]
  *                 if dst is tmp:
  *                     continue             # <<<<<<<<<<<<<<
  * 
- *                 dst += tmp
+ *                 vars_to_update = vars_to_update.union(tmp.get_vars())
  */
         goto __pyx_L7_continue;
 
-        /* "sat_toolkit/formula.pyx":340
+        /* "sat_toolkit/formula.pyx":344
  * 
  *                 tmp = res[var]
  *                 if dst is tmp:             # <<<<<<<<<<<<<<
  *                     continue
  * 
  */
       }
 
-      /* "sat_toolkit/formula.pyx":343
+      /* "sat_toolkit/formula.pyx":347
  *                     continue
  * 
- *                 dst += tmp             # <<<<<<<<<<<<<<
- *                 tmp.clear()
- * 
- */
-      __pyx_t_7 = PyNumber_InPlaceAdd(((PyObject *)__pyx_v_dst), ((PyObject *)__pyx_v_tmp)); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 343, __pyx_L1_error)
-      __Pyx_GOTREF(__pyx_t_7);
-      if (!(likely(((__pyx_t_7) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_7, __pyx_ptype_11sat_toolkit_7formula__ClauseList))))) __PYX_ERR(0, 343, __pyx_L1_error)
-      __Pyx_DECREF_SET(__pyx_v_dst, ((struct __pyx_obj_11sat_toolkit_7formula__ClauseList *)__pyx_t_7));
-      __pyx_t_7 = 0;
-
-      /* "sat_toolkit/formula.pyx":344
- * 
+ *                 vars_to_update = vars_to_update.union(tmp.get_vars())             # <<<<<<<<<<<<<<
  *                 dst += tmp
- *                 tmp.clear()             # <<<<<<<<<<<<<<
- * 
- *             if dst is None:
+ *                 tmp.clear()
  */
-      __pyx_t_8 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_tmp), __pyx_n_s_clear); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 344, __pyx_L1_error)
+      __pyx_t_8 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_tmp), __pyx_n_s_get_vars); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 347, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_8);
       __pyx_t_12 = NULL;
       __pyx_t_9 = 0;
       #if CYTHON_UNPACK_METHODS
       if (likely(PyMethod_Check(__pyx_t_8))) {
         __pyx_t_12 = PyMethod_GET_SELF(__pyx_t_8);
         if (likely(__pyx_t_12)) {
@@ -28139,316 +28235,356 @@
         }
       }
       #endif
       {
         PyObject *__pyx_callargs[2] = {__pyx_t_12, NULL};
         __pyx_t_7 = __Pyx_PyObject_FastCall(__pyx_t_8, __pyx_callargs+1-__pyx_t_9, 0+__pyx_t_9);
         __Pyx_XDECREF(__pyx_t_12); __pyx_t_12 = 0;
-        if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 344, __pyx_L1_error)
+        if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 347, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_7);
         __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
       }
+      __pyx_t_8 = __Pyx_CallUnboundCMethod1(&__pyx_umethod_PySet_Type_union, __pyx_v_vars_to_update, __pyx_t_7); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 347, __pyx_L1_error)
+      __Pyx_GOTREF(__pyx_t_8);
       __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
+      if (!(likely(PySet_CheckExact(__pyx_t_8))||((__pyx_t_8) == Py_None) || __Pyx_RaiseUnexpectedTypeError("set", __pyx_t_8))) __PYX_ERR(0, 347, __pyx_L1_error)
+      __Pyx_DECREF_SET(__pyx_v_vars_to_update, ((PyObject*)__pyx_t_8));
+      __pyx_t_8 = 0;
 
-      /* "sat_toolkit/formula.pyx":329
+      /* "sat_toolkit/formula.pyx":348
+ * 
+ *                 vars_to_update = vars_to_update.union(tmp.get_vars())
+ *                 dst += tmp             # <<<<<<<<<<<<<<
+ *                 tmp.clear()
+ * 
+ */
+      __pyx_t_8 = PyNumber_InPlaceAdd(((PyObject *)__pyx_v_dst), ((PyObject *)__pyx_v_tmp)); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 348, __pyx_L1_error)
+      __Pyx_GOTREF(__pyx_t_8);
+      if (!(likely(((__pyx_t_8) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_8, __pyx_ptype_11sat_toolkit_7formula__ClauseList))))) __PYX_ERR(0, 348, __pyx_L1_error)
+      __Pyx_DECREF_SET(__pyx_v_dst, ((struct __pyx_obj_11sat_toolkit_7formula__ClauseList *)__pyx_t_8));
+      __pyx_t_8 = 0;
+
+      /* "sat_toolkit/formula.pyx":349
+ *                 vars_to_update = vars_to_update.union(tmp.get_vars())
+ *                 dst += tmp
+ *                 tmp.clear()             # <<<<<<<<<<<<<<
+ * 
+ *             assert dst is None or len(dst) > 0
+ */
+      __pyx_t_7 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_tmp), __pyx_n_s_clear); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 349, __pyx_L1_error)
+      __Pyx_GOTREF(__pyx_t_7);
+      __pyx_t_12 = NULL;
+      __pyx_t_9 = 0;
+      #if CYTHON_UNPACK_METHODS
+      if (likely(PyMethod_Check(__pyx_t_7))) {
+        __pyx_t_12 = PyMethod_GET_SELF(__pyx_t_7);
+        if (likely(__pyx_t_12)) {
+          PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_7);
+          __Pyx_INCREF(__pyx_t_12);
+          __Pyx_INCREF(function);
+          __Pyx_DECREF_SET(__pyx_t_7, function);
+          __pyx_t_9 = 1;
+        }
+      }
+      #endif
+      {
+        PyObject *__pyx_callargs[2] = {__pyx_t_12, NULL};
+        __pyx_t_8 = __Pyx_PyObject_FastCall(__pyx_t_7, __pyx_callargs+1-__pyx_t_9, 0+__pyx_t_9);
+        __Pyx_XDECREF(__pyx_t_12); __pyx_t_12 = 0;
+        if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 349, __pyx_L1_error)
+        __Pyx_GOTREF(__pyx_t_8);
+        __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
+      }
+      __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
+
+      /* "sat_toolkit/formula.pyx":332
+ *             vars_to_update.clear()
  * 
- *             dst = None
  *             for var in clause:             # <<<<<<<<<<<<<<
  *                 var = abs(var)
- * 
+ *                 vars_to_update.add(var)
  */
       __pyx_L7_continue:;
     }
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
 
-    /* "sat_toolkit/formula.pyx":346
+    /* "sat_toolkit/formula.pyx":351
  *                 tmp.clear()
  * 
+ *             assert dst is None or len(dst) > 0             # <<<<<<<<<<<<<<
+ * 
+ *             if dst is None:
+ */
+    #ifndef CYTHON_WITHOUT_ASSERTIONS
+    if (unlikely(__pyx_assertions_enabled())) {
+      __pyx_t_13 = (((PyObject *)__pyx_v_dst) == Py_None);
+      if (!__pyx_t_13) {
+      } else {
+        __pyx_t_6 = __pyx_t_13;
+        goto __pyx_L13_bool_binop_done;
+      }
+      __pyx_t_5 = PyObject_Length(((PyObject *)__pyx_v_dst)); if (unlikely(__pyx_t_5 == ((Py_ssize_t)-1))) __PYX_ERR(0, 351, __pyx_L1_error)
+      __pyx_t_13 = (__pyx_t_5 > 0);
+      __pyx_t_6 = __pyx_t_13;
+      __pyx_L13_bool_binop_done:;
+      if (unlikely(!__pyx_t_6)) {
+        __Pyx_Raise(__pyx_builtin_AssertionError, 0, 0, 0);
+        __PYX_ERR(0, 351, __pyx_L1_error)
+      }
+    }
+    #else
+    if ((1)); else __PYX_ERR(0, 351, __pyx_L1_error)
+    #endif
+
+    /* "sat_toolkit/formula.pyx":353
+ *             assert dst is None or len(dst) > 0
+ * 
  *             if dst is None:             # <<<<<<<<<<<<<<
  *                 dst = type(self).__new__(type(self))
  *                 dst.nvars = self.nvars
  */
     __pyx_t_6 = (((PyObject *)__pyx_v_dst) == Py_None);
     if (__pyx_t_6) {
 
-      /* "sat_toolkit/formula.pyx":347
+      /* "sat_toolkit/formula.pyx":354
  * 
  *             if dst is None:
  *                 dst = type(self).__new__(type(self))             # <<<<<<<<<<<<<<
  *                 dst.nvars = self.nvars
  * 
  */
-      __pyx_t_7 = __Pyx_PyObject_GetAttrStr(((PyObject *)Py_TYPE(((PyObject *)__pyx_v_self))), __pyx_n_s_new); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 347, __pyx_L1_error)
-      __Pyx_GOTREF(__pyx_t_7);
-      __pyx_t_8 = NULL;
+      __pyx_t_8 = __Pyx_PyObject_GetAttrStr(((PyObject *)Py_TYPE(((PyObject *)__pyx_v_self))), __pyx_n_s_new); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 354, __pyx_L1_error)
+      __Pyx_GOTREF(__pyx_t_8);
+      __pyx_t_7 = NULL;
       __pyx_t_9 = 0;
       #if CYTHON_UNPACK_METHODS
-      if (likely(PyMethod_Check(__pyx_t_7))) {
-        __pyx_t_8 = PyMethod_GET_SELF(__pyx_t_7);
-        if (likely(__pyx_t_8)) {
-          PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_7);
-          __Pyx_INCREF(__pyx_t_8);
+      if (likely(PyMethod_Check(__pyx_t_8))) {
+        __pyx_t_7 = PyMethod_GET_SELF(__pyx_t_8);
+        if (likely(__pyx_t_7)) {
+          PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_8);
+          __Pyx_INCREF(__pyx_t_7);
           __Pyx_INCREF(function);
-          __Pyx_DECREF_SET(__pyx_t_7, function);
+          __Pyx_DECREF_SET(__pyx_t_8, function);
           __pyx_t_9 = 1;
         }
       }
       #endif
       {
-        PyObject *__pyx_callargs[2] = {__pyx_t_8, ((PyObject *)Py_TYPE(((PyObject *)__pyx_v_self)))};
-        __pyx_t_4 = __Pyx_PyObject_FastCall(__pyx_t_7, __pyx_callargs+1-__pyx_t_9, 1+__pyx_t_9);
-        __Pyx_XDECREF(__pyx_t_8); __pyx_t_8 = 0;
-        if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 347, __pyx_L1_error)
+        PyObject *__pyx_callargs[2] = {__pyx_t_7, ((PyObject *)Py_TYPE(((PyObject *)__pyx_v_self)))};
+        __pyx_t_4 = __Pyx_PyObject_FastCall(__pyx_t_8, __pyx_callargs+1-__pyx_t_9, 1+__pyx_t_9);
+        __Pyx_XDECREF(__pyx_t_7); __pyx_t_7 = 0;
+        if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 354, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_4);
-        __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
+        __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
       }
-      if (!(likely(((__pyx_t_4) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_4, __pyx_ptype_11sat_toolkit_7formula__ClauseList))))) __PYX_ERR(0, 347, __pyx_L1_error)
+      if (!(likely(((__pyx_t_4) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_4, __pyx_ptype_11sat_toolkit_7formula__ClauseList))))) __PYX_ERR(0, 354, __pyx_L1_error)
       __Pyx_DECREF_SET(__pyx_v_dst, ((struct __pyx_obj_11sat_toolkit_7formula__ClauseList *)__pyx_t_4));
       __pyx_t_4 = 0;
 
-      /* "sat_toolkit/formula.pyx":348
+      /* "sat_toolkit/formula.pyx":355
  *             if dst is None:
  *                 dst = type(self).__new__(type(self))
  *                 dst.nvars = self.nvars             # <<<<<<<<<<<<<<
  * 
- *             for var in clause:
+ *             for var in vars_to_update:
  */
       __pyx_t_9 = __pyx_v_self->nvars;
       __pyx_v_dst->nvars = __pyx_t_9;
 
-      /* "sat_toolkit/formula.pyx":346
- *                 tmp.clear()
+      /* "sat_toolkit/formula.pyx":353
+ *             assert dst is None or len(dst) > 0
  * 
  *             if dst is None:             # <<<<<<<<<<<<<<
  *                 dst = type(self).__new__(type(self))
  *                 dst.nvars = self.nvars
  */
     }
 
-    /* "sat_toolkit/formula.pyx":350
+    /* "sat_toolkit/formula.pyx":357
  *                 dst.nvars = self.nvars
  * 
- *             for var in clause:             # <<<<<<<<<<<<<<
- *                 var = abs(var)
+ *             for var in vars_to_update:             # <<<<<<<<<<<<<<
+ *                 assert var > 0
  *                 res[var] = dst
  */
-    if (likely(PyList_CheckExact(((PyObject *)__pyx_v_clause))) || PyTuple_CheckExact(((PyObject *)__pyx_v_clause))) {
-      __pyx_t_4 = ((PyObject *)__pyx_v_clause); __Pyx_INCREF(__pyx_t_4);
-      __pyx_t_5 = 0;
-      __pyx_t_11 = NULL;
-    } else {
-      __pyx_t_5 = -1; __pyx_t_4 = PyObject_GetIter(((PyObject *)__pyx_v_clause)); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 350, __pyx_L1_error)
-      __Pyx_GOTREF(__pyx_t_4);
-      __pyx_t_11 = __Pyx_PyObject_GetIterNextFunc(__pyx_t_4); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 350, __pyx_L1_error)
-    }
-    for (;;) {
-      if (likely(!__pyx_t_11)) {
-        if (likely(PyList_CheckExact(__pyx_t_4))) {
-          {
-            Py_ssize_t __pyx_temp = __Pyx_PyList_GET_SIZE(__pyx_t_4);
-            #if !CYTHON_ASSUME_SAFE_MACROS
-            if (unlikely((__pyx_temp < 0))) __PYX_ERR(0, 350, __pyx_L1_error)
-            #endif
-            if (__pyx_t_5 >= __pyx_temp) break;
-          }
-          #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-          __pyx_t_7 = PyList_GET_ITEM(__pyx_t_4, __pyx_t_5); __Pyx_INCREF(__pyx_t_7); __pyx_t_5++; if (unlikely((0 < 0))) __PYX_ERR(0, 350, __pyx_L1_error)
-          #else
-          __pyx_t_7 = __Pyx_PySequence_ITEM(__pyx_t_4, __pyx_t_5); __pyx_t_5++; if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 350, __pyx_L1_error)
-          __Pyx_GOTREF(__pyx_t_7);
-          #endif
-        } else {
-          {
-            Py_ssize_t __pyx_temp = __Pyx_PyTuple_GET_SIZE(__pyx_t_4);
-            #if !CYTHON_ASSUME_SAFE_MACROS
-            if (unlikely((__pyx_temp < 0))) __PYX_ERR(0, 350, __pyx_L1_error)
-            #endif
-            if (__pyx_t_5 >= __pyx_temp) break;
-          }
-          #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-          __pyx_t_7 = PyTuple_GET_ITEM(__pyx_t_4, __pyx_t_5); __Pyx_INCREF(__pyx_t_7); __pyx_t_5++; if (unlikely((0 < 0))) __PYX_ERR(0, 350, __pyx_L1_error)
-          #else
-          __pyx_t_7 = __Pyx_PySequence_ITEM(__pyx_t_4, __pyx_t_5); __pyx_t_5++; if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 350, __pyx_L1_error)
-          __Pyx_GOTREF(__pyx_t_7);
-          #endif
-        }
-      } else {
-        __pyx_t_7 = __pyx_t_11(__pyx_t_4);
-        if (unlikely(!__pyx_t_7)) {
-          PyObject* exc_type = PyErr_Occurred();
-          if (exc_type) {
-            if (likely(__Pyx_PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
-            else __PYX_ERR(0, 350, __pyx_L1_error)
-          }
-          break;
-        }
-        __Pyx_GOTREF(__pyx_t_7);
-      }
-      __pyx_t_9 = __Pyx_PyInt_As_int(__pyx_t_7); if (unlikely((__pyx_t_9 == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 350, __pyx_L1_error)
-      __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-      __pyx_v_var = __pyx_t_9;
+    __pyx_t_5 = 0;
+    __pyx_t_8 = __Pyx_set_iterator(__pyx_v_vars_to_update, 1, (&__pyx_t_14), (&__pyx_t_9)); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 357, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_8);
+    __Pyx_XDECREF(__pyx_t_4);
+    __pyx_t_4 = __pyx_t_8;
+    __pyx_t_8 = 0;
+    while (1) {
+      __pyx_t_15 = __Pyx_set_iter_next(__pyx_t_4, __pyx_t_14, &__pyx_t_5, &__pyx_t_8, __pyx_t_9);
+      if (unlikely(__pyx_t_15 == 0)) break;
+      if (unlikely(__pyx_t_15 == -1)) __PYX_ERR(0, 357, __pyx_L1_error)
+      __Pyx_GOTREF(__pyx_t_8);
+      __pyx_t_15 = __Pyx_PyInt_As_int(__pyx_t_8); if (unlikely((__pyx_t_15 == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 357, __pyx_L1_error)
+      __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
+      __pyx_v_var = __pyx_t_15;
 
-      /* "sat_toolkit/formula.pyx":351
+      /* "sat_toolkit/formula.pyx":358
  * 
- *             for var in clause:
- *                 var = abs(var)             # <<<<<<<<<<<<<<
+ *             for var in vars_to_update:
+ *                 assert var > 0             # <<<<<<<<<<<<<<
  *                 res[var] = dst
  * 
  */
-      __pyx_v_var = __pyx_f_11sat_toolkit_7formula_abs(__pyx_v_var);
+      #ifndef CYTHON_WITHOUT_ASSERTIONS
+      if (unlikely(__pyx_assertions_enabled())) {
+        __pyx_t_6 = (__pyx_v_var > 0);
+        if (unlikely(!__pyx_t_6)) {
+          __Pyx_Raise(__pyx_builtin_AssertionError, 0, 0, 0);
+          __PYX_ERR(0, 358, __pyx_L1_error)
+        }
+      }
+      #else
+      if ((1)); else __PYX_ERR(0, 358, __pyx_L1_error)
+      #endif
 
-      /* "sat_toolkit/formula.pyx":352
- *             for var in clause:
- *                 var = abs(var)
+      /* "sat_toolkit/formula.pyx":359
+ *             for var in vars_to_update:
+ *                 assert var > 0
  *                 res[var] = dst             # <<<<<<<<<<<<<<
  * 
  *             dst.append(clause)
  */
-      __pyx_t_7 = __Pyx_PyInt_From_int(__pyx_v_var); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 352, __pyx_L1_error)
-      __Pyx_GOTREF(__pyx_t_7);
-      if (unlikely((PyDict_SetItem(__pyx_v_res, __pyx_t_7, ((PyObject *)__pyx_v_dst)) < 0))) __PYX_ERR(0, 352, __pyx_L1_error)
-      __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-
-      /* "sat_toolkit/formula.pyx":350
- *                 dst.nvars = self.nvars
- * 
- *             for var in clause:             # <<<<<<<<<<<<<<
- *                 var = abs(var)
- *                 res[var] = dst
- */
+      __pyx_t_8 = __Pyx_PyInt_From_int(__pyx_v_var); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 359, __pyx_L1_error)
+      __Pyx_GOTREF(__pyx_t_8);
+      if (unlikely((PyDict_SetItem(__pyx_v_res, __pyx_t_8, ((PyObject *)__pyx_v_dst)) < 0))) __PYX_ERR(0, 359, __pyx_L1_error)
+      __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
     }
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
 
-    /* "sat_toolkit/formula.pyx":354
+    /* "sat_toolkit/formula.pyx":361
  *                 res[var] = dst
  * 
  *             dst.append(clause)             # <<<<<<<<<<<<<<
  * 
  *         # iterate over res dictionary values and find all unique
  */
-    __pyx_t_10 = __Pyx_PyObject_Append(((PyObject *)__pyx_v_dst), ((PyObject *)__pyx_v_clause)); if (unlikely(__pyx_t_10 == ((int)-1))) __PYX_ERR(0, 354, __pyx_L1_error)
+    __pyx_t_10 = __Pyx_PyObject_Append(((PyObject *)__pyx_v_dst), ((PyObject *)__pyx_v_clause)); if (unlikely(__pyx_t_10 == ((int)-1))) __PYX_ERR(0, 361, __pyx_L1_error)
 
-    /* "sat_toolkit/formula.pyx":318
+    /* "sat_toolkit/formula.pyx":319
  *         cdef int var
  * 
  *         for clause in self:             # <<<<<<<<<<<<<<
  *             if len(clause) == 0:
  *                 if 0 not in res:
  */
   }
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-  /* "sat_toolkit/formula.pyx":358
+  /* "sat_toolkit/formula.pyx":365
  *         # iterate over res dictionary values and find all unique
  *         # and non-empty partitions
  *         cdef list result_list = []             # <<<<<<<<<<<<<<
- *         cdef set[void *] seen_keys
+ *         cdef cpp_set[void *] seen_keys
  *         cdef object val
  */
-  __pyx_t_1 = PyList_New(0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 358, __pyx_L1_error)
+  __pyx_t_1 = PyList_New(0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 365, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_v_result_list = ((PyObject*)__pyx_t_1);
   __pyx_t_1 = 0;
 
-  /* "sat_toolkit/formula.pyx":362
+  /* "sat_toolkit/formula.pyx":369
  *         cdef object val
  * 
  *         for val in res.values():             # <<<<<<<<<<<<<<
  *             if seen_keys.count(<void *> val) > 0:
  *                 continue
  */
   __pyx_t_2 = 0;
-  __pyx_t_4 = __Pyx_dict_iterator(__pyx_v_res, 1, __pyx_n_s_values, (&__pyx_t_5), (&__pyx_t_9)); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 362, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_dict_iterator(__pyx_v_res, 1, __pyx_n_s_values, (&__pyx_t_14), (&__pyx_t_9)); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 369, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __Pyx_XDECREF(__pyx_t_1);
   __pyx_t_1 = __pyx_t_4;
   __pyx_t_4 = 0;
   while (1) {
-    __pyx_t_13 = __Pyx_dict_iter_next(__pyx_t_1, __pyx_t_5, &__pyx_t_2, NULL, &__pyx_t_4, NULL, __pyx_t_9);
-    if (unlikely(__pyx_t_13 == 0)) break;
-    if (unlikely(__pyx_t_13 == -1)) __PYX_ERR(0, 362, __pyx_L1_error)
+    __pyx_t_15 = __Pyx_dict_iter_next(__pyx_t_1, __pyx_t_14, &__pyx_t_2, NULL, &__pyx_t_4, NULL, __pyx_t_9);
+    if (unlikely(__pyx_t_15 == 0)) break;
+    if (unlikely(__pyx_t_15 == -1)) __PYX_ERR(0, 369, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
     __Pyx_XDECREF_SET(__pyx_v_val, __pyx_t_4);
     __pyx_t_4 = 0;
 
-    /* "sat_toolkit/formula.pyx":363
+    /* "sat_toolkit/formula.pyx":370
  * 
  *         for val in res.values():
  *             if seen_keys.count(<void *> val) > 0:             # <<<<<<<<<<<<<<
  *                 continue
  *             seen_keys.insert(<void *> val)
  */
     __pyx_t_6 = (__pyx_v_seen_keys.count(((void *)__pyx_v_val)) > 0);
     if (__pyx_t_6) {
 
-      /* "sat_toolkit/formula.pyx":364
+      /* "sat_toolkit/formula.pyx":371
  *         for val in res.values():
  *             if seen_keys.count(<void *> val) > 0:
  *                 continue             # <<<<<<<<<<<<<<
  *             seen_keys.insert(<void *> val)
  *             if len(val) > 0:
  */
-      goto __pyx_L18_continue;
+      goto __pyx_L19_continue;
 
-      /* "sat_toolkit/formula.pyx":363
+      /* "sat_toolkit/formula.pyx":370
  * 
  *         for val in res.values():
  *             if seen_keys.count(<void *> val) > 0:             # <<<<<<<<<<<<<<
  *                 continue
  *             seen_keys.insert(<void *> val)
  */
     }
 
-    /* "sat_toolkit/formula.pyx":365
+    /* "sat_toolkit/formula.pyx":372
  *             if seen_keys.count(<void *> val) > 0:
  *                 continue
  *             seen_keys.insert(<void *> val)             # <<<<<<<<<<<<<<
  *             if len(val) > 0:
  *                 result_list.append(val)
  */
     try {
       __pyx_v_seen_keys.insert(((void *)__pyx_v_val));
     } catch(...) {
       __Pyx_CppExn2PyErr();
-      __PYX_ERR(0, 365, __pyx_L1_error)
+      __PYX_ERR(0, 372, __pyx_L1_error)
     }
 
-    /* "sat_toolkit/formula.pyx":366
+    /* "sat_toolkit/formula.pyx":373
  *                 continue
  *             seen_keys.insert(<void *> val)
  *             if len(val) > 0:             # <<<<<<<<<<<<<<
  *                 result_list.append(val)
  * 
  */
-    __pyx_t_14 = PyObject_Length(__pyx_v_val); if (unlikely(__pyx_t_14 == ((Py_ssize_t)-1))) __PYX_ERR(0, 366, __pyx_L1_error)
-    __pyx_t_6 = (__pyx_t_14 > 0);
+    __pyx_t_5 = PyObject_Length(__pyx_v_val); if (unlikely(__pyx_t_5 == ((Py_ssize_t)-1))) __PYX_ERR(0, 373, __pyx_L1_error)
+    __pyx_t_6 = (__pyx_t_5 > 0);
     if (__pyx_t_6) {
 
-      /* "sat_toolkit/formula.pyx":367
+      /* "sat_toolkit/formula.pyx":374
  *             seen_keys.insert(<void *> val)
  *             if len(val) > 0:
  *                 result_list.append(val)             # <<<<<<<<<<<<<<
  * 
  *         return result_list
  */
-      __pyx_t_10 = __Pyx_PyList_Append(__pyx_v_result_list, __pyx_v_val); if (unlikely(__pyx_t_10 == ((int)-1))) __PYX_ERR(0, 367, __pyx_L1_error)
+      __pyx_t_10 = __Pyx_PyList_Append(__pyx_v_result_list, __pyx_v_val); if (unlikely(__pyx_t_10 == ((int)-1))) __PYX_ERR(0, 374, __pyx_L1_error)
 
-      /* "sat_toolkit/formula.pyx":366
+      /* "sat_toolkit/formula.pyx":373
  *                 continue
  *             seen_keys.insert(<void *> val)
  *             if len(val) > 0:             # <<<<<<<<<<<<<<
  *                 result_list.append(val)
  * 
  */
     }
-    __pyx_L18_continue:;
+    __pyx_L19_continue:;
   }
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-  /* "sat_toolkit/formula.pyx":369
+  /* "sat_toolkit/formula.pyx":376
  *                 result_list.append(val)
  * 
  *         return result_list             # <<<<<<<<<<<<<<
  * 
  *     cdef int _add_clauses_raw(self, const int *clauses, size_t length) except -1 nogil:
  */
   __Pyx_XDECREF(__pyx_r);
@@ -28471,25 +28607,26 @@
   __Pyx_XDECREF(__pyx_t_7);
   __Pyx_XDECREF(__pyx_t_8);
   __Pyx_XDECREF(__pyx_t_12);
   __Pyx_AddTraceback("sat_toolkit.formula._ClauseList.partition", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __pyx_r = NULL;
   __pyx_L0:;
   __Pyx_XDECREF(__pyx_v_res);
+  __Pyx_XDECREF(__pyx_v_vars_to_update);
   __Pyx_XDECREF((PyObject *)__pyx_v_clause);
   __Pyx_XDECREF((PyObject *)__pyx_v_dst);
   __Pyx_XDECREF((PyObject *)__pyx_v_tmp);
   __Pyx_XDECREF(__pyx_v_result_list);
   __Pyx_XDECREF(__pyx_v_val);
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "sat_toolkit/formula.pyx":371
+/* "sat_toolkit/formula.pyx":378
  *         return result_list
  * 
  *     cdef int _add_clauses_raw(self, const int *clauses, size_t length) except -1 nogil:             # <<<<<<<<<<<<<<
  *         cdef size_t old_len, i
  * 
  */
 
@@ -28508,62 +28645,62 @@
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   #ifdef WITH_THREAD
   PyGILState_STATE __pyx_gilstate_save;
   #endif
   __Pyx_RefNannySetupContext("_add_clauses_raw", 1);
 
-  /* "sat_toolkit/formula.pyx":374
+  /* "sat_toolkit/formula.pyx":381
  *         cdef size_t old_len, i
  * 
  *         if self.view_count > 0:             # <<<<<<<<<<<<<<
  *             raise ValueError('cannot alter while referenced by buffer')
  * 
  */
   __pyx_t_1 = (__pyx_v_self->view_count > 0);
   if (unlikely(__pyx_t_1)) {
 
-    /* "sat_toolkit/formula.pyx":375
+    /* "sat_toolkit/formula.pyx":382
  * 
  *         if self.view_count > 0:
  *             raise ValueError('cannot alter while referenced by buffer')             # <<<<<<<<<<<<<<
  * 
  *         if length > 0 and clauses[length - 1] != 0:
  */
     {
         #ifdef WITH_THREAD
         PyGILState_STATE __pyx_gilstate_save = __Pyx_PyGILState_Ensure();
         #endif
         /*try:*/ {
-          __pyx_t_2 = __Pyx_PyObject_Call(__pyx_builtin_ValueError, __pyx_tuple__21, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 375, __pyx_L5_error)
+          __pyx_t_2 = __Pyx_PyObject_Call(__pyx_builtin_ValueError, __pyx_tuple__21, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 382, __pyx_L5_error)
           __Pyx_GOTREF(__pyx_t_2);
           __Pyx_Raise(__pyx_t_2, 0, 0, 0);
           __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-          __PYX_ERR(0, 375, __pyx_L5_error)
+          __PYX_ERR(0, 382, __pyx_L5_error)
         }
         /*finally:*/ {
           __pyx_L5_error: {
             #ifdef WITH_THREAD
             __Pyx_PyGILState_Release(__pyx_gilstate_save);
             #endif
             goto __pyx_L1_error;
           }
         }
     }
 
-    /* "sat_toolkit/formula.pyx":374
+    /* "sat_toolkit/formula.pyx":381
  *         cdef size_t old_len, i
  * 
  *         if self.view_count > 0:             # <<<<<<<<<<<<<<
  *             raise ValueError('cannot alter while referenced by buffer')
  * 
  */
   }
 
-  /* "sat_toolkit/formula.pyx":377
+  /* "sat_toolkit/formula.pyx":384
  *             raise ValueError('cannot alter while referenced by buffer')
  * 
  *         if length > 0 and clauses[length - 1] != 0:             # <<<<<<<<<<<<<<
  *             raise ValueError('last clause not terminated with 0')
  * 
  */
   __pyx_t_3 = (__pyx_v_length > 0);
@@ -28573,61 +28710,61 @@
     goto __pyx_L8_bool_binop_done;
   }
   __pyx_t_3 = ((__pyx_v_clauses[(__pyx_v_length - 1)]) != 0);
   __pyx_t_1 = __pyx_t_3;
   __pyx_L8_bool_binop_done:;
   if (unlikely(__pyx_t_1)) {
 
-    /* "sat_toolkit/formula.pyx":378
+    /* "sat_toolkit/formula.pyx":385
  * 
  *         if length > 0 and clauses[length - 1] != 0:
  *             raise ValueError('last clause not terminated with 0')             # <<<<<<<<<<<<<<
  * 
  *         old_len = self._clauses.size()
  */
     {
         #ifdef WITH_THREAD
         PyGILState_STATE __pyx_gilstate_save = __Pyx_PyGILState_Ensure();
         #endif
         /*try:*/ {
-          __pyx_t_2 = __Pyx_PyObject_Call(__pyx_builtin_ValueError, __pyx_tuple__22, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 378, __pyx_L11_error)
+          __pyx_t_2 = __Pyx_PyObject_Call(__pyx_builtin_ValueError, __pyx_tuple__22, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 385, __pyx_L11_error)
           __Pyx_GOTREF(__pyx_t_2);
           __Pyx_Raise(__pyx_t_2, 0, 0, 0);
           __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-          __PYX_ERR(0, 378, __pyx_L11_error)
+          __PYX_ERR(0, 385, __pyx_L11_error)
         }
         /*finally:*/ {
           __pyx_L11_error: {
             #ifdef WITH_THREAD
             __Pyx_PyGILState_Release(__pyx_gilstate_save);
             #endif
             goto __pyx_L1_error;
           }
         }
     }
 
-    /* "sat_toolkit/formula.pyx":377
+    /* "sat_toolkit/formula.pyx":384
  *             raise ValueError('cannot alter while referenced by buffer')
  * 
  *         if length > 0 and clauses[length - 1] != 0:             # <<<<<<<<<<<<<<
  *             raise ValueError('last clause not terminated with 0')
  * 
  */
   }
 
-  /* "sat_toolkit/formula.pyx":380
+  /* "sat_toolkit/formula.pyx":387
  *             raise ValueError('last clause not terminated with 0')
  * 
  *         old_len = self._clauses.size()             # <<<<<<<<<<<<<<
  *         self._clauses.resize(self._clauses.size() + length)
  * 
  */
   __pyx_v_old_len = __pyx_v_self->_clauses.size();
 
-  /* "sat_toolkit/formula.pyx":381
+  /* "sat_toolkit/formula.pyx":388
  * 
  *         old_len = self._clauses.size()
  *         self._clauses.resize(self._clauses.size() + length)             # <<<<<<<<<<<<<<
  * 
  *         if length > 0:
  */
   try {
@@ -28636,28 +28773,28 @@
     #ifdef WITH_THREAD
     PyGILState_STATE __pyx_gilstate_save = __Pyx_PyGILState_Ensure();
     #endif
     __Pyx_CppExn2PyErr();
     #ifdef WITH_THREAD
     __Pyx_PyGILState_Release(__pyx_gilstate_save);
     #endif
-    __PYX_ERR(0, 381, __pyx_L1_error)
+    __PYX_ERR(0, 388, __pyx_L1_error)
   }
 
-  /* "sat_toolkit/formula.pyx":383
+  /* "sat_toolkit/formula.pyx":390
  *         self._clauses.resize(self._clauses.size() + length)
  * 
  *         if length > 0:             # <<<<<<<<<<<<<<
  *             self._start_indices.push_back(old_len)
  * 
  */
   __pyx_t_1 = (__pyx_v_length > 0);
   if (__pyx_t_1) {
 
-    /* "sat_toolkit/formula.pyx":384
+    /* "sat_toolkit/formula.pyx":391
  * 
  *         if length > 0:
  *             self._start_indices.push_back(old_len)             # <<<<<<<<<<<<<<
  * 
  *         for i in range(length):
  */
     try {
@@ -28666,76 +28803,76 @@
       #ifdef WITH_THREAD
       PyGILState_STATE __pyx_gilstate_save = __Pyx_PyGILState_Ensure();
       #endif
       __Pyx_CppExn2PyErr();
       #ifdef WITH_THREAD
       __Pyx_PyGILState_Release(__pyx_gilstate_save);
       #endif
-      __PYX_ERR(0, 384, __pyx_L1_error)
+      __PYX_ERR(0, 391, __pyx_L1_error)
     }
 
-    /* "sat_toolkit/formula.pyx":383
+    /* "sat_toolkit/formula.pyx":390
  *         self._clauses.resize(self._clauses.size() + length)
  * 
  *         if length > 0:             # <<<<<<<<<<<<<<
  *             self._start_indices.push_back(old_len)
  * 
  */
   }
 
-  /* "sat_toolkit/formula.pyx":386
+  /* "sat_toolkit/formula.pyx":393
  *             self._start_indices.push_back(old_len)
  * 
  *         for i in range(length):             # <<<<<<<<<<<<<<
  *             self._clauses[old_len + i] = clauses[i]
  *             if abs(clauses[i]) > self.nvars:
  */
   __pyx_t_4 = __pyx_v_length;
   __pyx_t_5 = __pyx_t_4;
   for (__pyx_t_6 = 0; __pyx_t_6 < __pyx_t_5; __pyx_t_6+=1) {
     __pyx_v_i = __pyx_t_6;
 
-    /* "sat_toolkit/formula.pyx":387
+    /* "sat_toolkit/formula.pyx":394
  * 
  *         for i in range(length):
  *             self._clauses[old_len + i] = clauses[i]             # <<<<<<<<<<<<<<
  *             if abs(clauses[i]) > self.nvars:
  *                 self.nvars = abs(clauses[i])
  */
     (__pyx_v_self->_clauses[(__pyx_v_old_len + __pyx_v_i)]) = (__pyx_v_clauses[__pyx_v_i]);
 
-    /* "sat_toolkit/formula.pyx":388
+    /* "sat_toolkit/formula.pyx":395
  *         for i in range(length):
  *             self._clauses[old_len + i] = clauses[i]
  *             if abs(clauses[i]) > self.nvars:             # <<<<<<<<<<<<<<
  *                 self.nvars = abs(clauses[i])
  * 
  */
     __pyx_t_1 = (__pyx_f_11sat_toolkit_7formula_abs((__pyx_v_clauses[__pyx_v_i])) > __pyx_v_self->nvars);
     if (__pyx_t_1) {
 
-      /* "sat_toolkit/formula.pyx":389
+      /* "sat_toolkit/formula.pyx":396
  *             self._clauses[old_len + i] = clauses[i]
  *             if abs(clauses[i]) > self.nvars:
  *                 self.nvars = abs(clauses[i])             # <<<<<<<<<<<<<<
  * 
  *             if clauses[i] == 0 and i + 1 < length:
  */
       __pyx_v_self->nvars = __pyx_f_11sat_toolkit_7formula_abs((__pyx_v_clauses[__pyx_v_i]));
 
-      /* "sat_toolkit/formula.pyx":388
+      /* "sat_toolkit/formula.pyx":395
  *         for i in range(length):
  *             self._clauses[old_len + i] = clauses[i]
  *             if abs(clauses[i]) > self.nvars:             # <<<<<<<<<<<<<<
  *                 self.nvars = abs(clauses[i])
  * 
  */
     }
 
-    /* "sat_toolkit/formula.pyx":391
+    /* "sat_toolkit/formula.pyx":398
  *                 self.nvars = abs(clauses[i])
  * 
  *             if clauses[i] == 0 and i + 1 < length:             # <<<<<<<<<<<<<<
  *                 self._start_indices.push_back(old_len + i + 1)
  * 
  */
     __pyx_t_3 = ((__pyx_v_clauses[__pyx_v_i]) == 0);
@@ -28745,15 +28882,15 @@
       goto __pyx_L18_bool_binop_done;
     }
     __pyx_t_3 = ((__pyx_v_i + 1) < __pyx_v_length);
     __pyx_t_1 = __pyx_t_3;
     __pyx_L18_bool_binop_done:;
     if (__pyx_t_1) {
 
-      /* "sat_toolkit/formula.pyx":392
+      /* "sat_toolkit/formula.pyx":399
  * 
  *             if clauses[i] == 0 and i + 1 < length:
  *                 self._start_indices.push_back(old_len + i + 1)             # <<<<<<<<<<<<<<
  * 
  *         return 0
  */
       try {
@@ -28762,38 +28899,38 @@
         #ifdef WITH_THREAD
         PyGILState_STATE __pyx_gilstate_save = __Pyx_PyGILState_Ensure();
         #endif
         __Pyx_CppExn2PyErr();
         #ifdef WITH_THREAD
         __Pyx_PyGILState_Release(__pyx_gilstate_save);
         #endif
-        __PYX_ERR(0, 392, __pyx_L1_error)
+        __PYX_ERR(0, 399, __pyx_L1_error)
       }
 
-      /* "sat_toolkit/formula.pyx":391
+      /* "sat_toolkit/formula.pyx":398
  *                 self.nvars = abs(clauses[i])
  * 
  *             if clauses[i] == 0 and i + 1 < length:             # <<<<<<<<<<<<<<
  *                 self._start_indices.push_back(old_len + i + 1)
  * 
  */
     }
   }
 
-  /* "sat_toolkit/formula.pyx":394
+  /* "sat_toolkit/formula.pyx":401
  *                 self._start_indices.push_back(old_len + i + 1)
  * 
  *         return 0             # <<<<<<<<<<<<<<
  * 
  *     cdef int _add_clauses(self, const int[:] clauses) except -1 nogil:
  */
   __pyx_r = 0;
   goto __pyx_L0;
 
-  /* "sat_toolkit/formula.pyx":371
+  /* "sat_toolkit/formula.pyx":378
  *         return result_list
  * 
  *     cdef int _add_clauses_raw(self, const int *clauses, size_t length) except -1 nogil:             # <<<<<<<<<<<<<<
  *         cdef size_t old_len, i
  * 
  */
 
@@ -28809,15 +28946,15 @@
   __Pyx_PyGILState_Release(__pyx_gilstate_save);
   #endif
   __pyx_L0:;
   __Pyx_RefNannyFinishContextNogil()
   return __pyx_r;
 }
 
-/* "sat_toolkit/formula.pyx":396
+/* "sat_toolkit/formula.pyx":403
  *         return 0
  * 
  *     cdef int _add_clauses(self, const int[:] clauses) except -1 nogil:             # <<<<<<<<<<<<<<
  *         if clauses.shape[0] == 0:
  *             return 0
  */
 
@@ -28829,56 +28966,56 @@
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   #ifdef WITH_THREAD
   PyGILState_STATE __pyx_gilstate_save;
   #endif
 
-  /* "sat_toolkit/formula.pyx":397
+  /* "sat_toolkit/formula.pyx":404
  * 
  *     cdef int _add_clauses(self, const int[:] clauses) except -1 nogil:
  *         if clauses.shape[0] == 0:             # <<<<<<<<<<<<<<
  *             return 0
  *         return self._add_clauses_raw(&clauses[0], clauses.shape[0])
  */
   __pyx_t_1 = ((__pyx_v_clauses.shape[0]) == 0);
   if (__pyx_t_1) {
 
-    /* "sat_toolkit/formula.pyx":398
+    /* "sat_toolkit/formula.pyx":405
  *     cdef int _add_clauses(self, const int[:] clauses) except -1 nogil:
  *         if clauses.shape[0] == 0:
  *             return 0             # <<<<<<<<<<<<<<
  *         return self._add_clauses_raw(&clauses[0], clauses.shape[0])
  * 
  */
     __pyx_r = 0;
     goto __pyx_L0;
 
-    /* "sat_toolkit/formula.pyx":397
+    /* "sat_toolkit/formula.pyx":404
  * 
  *     cdef int _add_clauses(self, const int[:] clauses) except -1 nogil:
  *         if clauses.shape[0] == 0:             # <<<<<<<<<<<<<<
  *             return 0
  *         return self._add_clauses_raw(&clauses[0], clauses.shape[0])
  */
   }
 
-  /* "sat_toolkit/formula.pyx":399
+  /* "sat_toolkit/formula.pyx":406
  *         if clauses.shape[0] == 0:
  *             return 0
  *         return self._add_clauses_raw(&clauses[0], clauses.shape[0])             # <<<<<<<<<<<<<<
  * 
  * 
  */
   __pyx_t_2 = 0;
-  __pyx_t_3 = ((struct __pyx_vtabstruct_11sat_toolkit_7formula__ClauseList *)__pyx_v_self->__pyx_vtab)->_add_clauses_raw(__pyx_v_self, (&(*((int const  *) ( /* dim=0 */ (__pyx_v_clauses.data + __pyx_t_2 * __pyx_v_clauses.strides[0]) )))), (__pyx_v_clauses.shape[0])); if (unlikely(__pyx_t_3 == ((int)-1))) __PYX_ERR(0, 399, __pyx_L1_error)
+  __pyx_t_3 = ((struct __pyx_vtabstruct_11sat_toolkit_7formula__ClauseList *)__pyx_v_self->__pyx_vtab)->_add_clauses_raw(__pyx_v_self, (&(*((int const  *) ( /* dim=0 */ (__pyx_v_clauses.data + __pyx_t_2 * __pyx_v_clauses.strides[0]) )))), (__pyx_v_clauses.shape[0])); if (unlikely(__pyx_t_3 == ((int)-1))) __PYX_ERR(0, 406, __pyx_L1_error)
   __pyx_r = __pyx_t_3;
   goto __pyx_L0;
 
-  /* "sat_toolkit/formula.pyx":396
+  /* "sat_toolkit/formula.pyx":403
  *         return 0
  * 
  *     cdef int _add_clauses(self, const int[:] clauses) except -1 nogil:             # <<<<<<<<<<<<<<
  *         if clauses.shape[0] == 0:
  *             return 0
  */
 
@@ -28892,15 +29029,15 @@
   #ifdef WITH_THREAD
   __Pyx_PyGILState_Release(__pyx_gilstate_save);
   #endif
   __pyx_L0:;
   return __pyx_r;
 }
 
-/* "sat_toolkit/formula.pyx":402
+/* "sat_toolkit/formula.pyx":409
  * 
  * 
  *     cdef str _to_dimacs(self, const char* clause_prefix):             # <<<<<<<<<<<<<<
  *         cdef size_t max_len = snprintf(NULL, 0, "%d", -self.nvars)
  *         cdef size_t nclauses = self._start_indices.size()
  */
 
@@ -28923,73 +29060,73 @@
   int __pyx_t_6;
   PyObject *__pyx_t_7 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("_to_dimacs", 1);
 
-  /* "sat_toolkit/formula.pyx":403
+  /* "sat_toolkit/formula.pyx":410
  * 
  *     cdef str _to_dimacs(self, const char* clause_prefix):
  *         cdef size_t max_len = snprintf(NULL, 0, "%d", -self.nvars)             # <<<<<<<<<<<<<<
  *         cdef size_t nclauses = self._start_indices.size()
  *         cdef ssize_t buf_size = (self._clauses.size() - nclauses) * (max_len + 1) + nclauses * (2) + nclauses * len(clause_prefix)
  */
   __pyx_v_max_len = snprintf(NULL, 0, ((char const *)"%d"), (-__pyx_v_self->nvars));
 
-  /* "sat_toolkit/formula.pyx":404
+  /* "sat_toolkit/formula.pyx":411
  *     cdef str _to_dimacs(self, const char* clause_prefix):
  *         cdef size_t max_len = snprintf(NULL, 0, "%d", -self.nvars)
  *         cdef size_t nclauses = self._start_indices.size()             # <<<<<<<<<<<<<<
  *         cdef ssize_t buf_size = (self._clauses.size() - nclauses) * (max_len + 1) + nclauses * (2) + nclauses * len(clause_prefix)
  *         cdef char *buf = <char *> malloc(buf_size + 1)
  */
   __pyx_v_nclauses = __pyx_v_self->_start_indices.size();
 
-  /* "sat_toolkit/formula.pyx":405
+  /* "sat_toolkit/formula.pyx":412
  *         cdef size_t max_len = snprintf(NULL, 0, "%d", -self.nvars)
  *         cdef size_t nclauses = self._start_indices.size()
  *         cdef ssize_t buf_size = (self._clauses.size() - nclauses) * (max_len + 1) + nclauses * (2) + nclauses * len(clause_prefix)             # <<<<<<<<<<<<<<
  *         cdef char *buf = <char *> malloc(buf_size + 1)
  *         cdef ssize_t buf_idx = 0, written
  */
-  __pyx_t_1 = __Pyx_ssize_strlen(__pyx_v_clause_prefix); if (unlikely(__pyx_t_1 == ((Py_ssize_t)-1))) __PYX_ERR(0, 405, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_ssize_strlen(__pyx_v_clause_prefix); if (unlikely(__pyx_t_1 == ((Py_ssize_t)-1))) __PYX_ERR(0, 412, __pyx_L1_error)
   __pyx_v_buf_size = ((((__pyx_v_self->_clauses.size() - __pyx_v_nclauses) * (__pyx_v_max_len + 1)) + (__pyx_v_nclauses * 2)) + (__pyx_v_nclauses * __pyx_t_1));
 
-  /* "sat_toolkit/formula.pyx":406
+  /* "sat_toolkit/formula.pyx":413
  *         cdef size_t nclauses = self._start_indices.size()
  *         cdef ssize_t buf_size = (self._clauses.size() - nclauses) * (max_len + 1) + nclauses * (2) + nclauses * len(clause_prefix)
  *         cdef char *buf = <char *> malloc(buf_size + 1)             # <<<<<<<<<<<<<<
  *         cdef ssize_t buf_idx = 0, written
  *         cdef size_t i
  */
   __pyx_v_buf = ((char *)malloc((__pyx_v_buf_size + 1)));
 
-  /* "sat_toolkit/formula.pyx":407
+  /* "sat_toolkit/formula.pyx":414
  *         cdef ssize_t buf_size = (self._clauses.size() - nclauses) * (max_len + 1) + nclauses * (2) + nclauses * len(clause_prefix)
  *         cdef char *buf = <char *> malloc(buf_size + 1)
  *         cdef ssize_t buf_idx = 0, written             # <<<<<<<<<<<<<<
  *         cdef size_t i
  * 
  */
   __pyx_v_buf_idx = 0;
 
-  /* "sat_toolkit/formula.pyx":410
+  /* "sat_toolkit/formula.pyx":417
  *         cdef size_t i
  * 
  *         for i in range(self._clauses.size()):             # <<<<<<<<<<<<<<
  *             if i == 0 or self._clauses[i - 1] == 0:
  *                 written = snprintf(&buf[buf_idx], buf_size, "%s", clause_prefix)
  */
   __pyx_t_2 = __pyx_v_self->_clauses.size();
   __pyx_t_3 = __pyx_t_2;
   for (__pyx_t_4 = 0; __pyx_t_4 < __pyx_t_3; __pyx_t_4+=1) {
     __pyx_v_i = __pyx_t_4;
 
-    /* "sat_toolkit/formula.pyx":411
+    /* "sat_toolkit/formula.pyx":418
  * 
  *         for i in range(self._clauses.size()):
  *             if i == 0 or self._clauses[i - 1] == 0:             # <<<<<<<<<<<<<<
  *                 written = snprintf(&buf[buf_idx], buf_size, "%s", clause_prefix)
  *                 if written < 0:
  */
     __pyx_t_6 = (__pyx_v_i == 0);
@@ -28999,294 +29136,294 @@
       goto __pyx_L6_bool_binop_done;
     }
     __pyx_t_6 = ((__pyx_v_self->_clauses[(__pyx_v_i - 1)]) == 0);
     __pyx_t_5 = __pyx_t_6;
     __pyx_L6_bool_binop_done:;
     if (__pyx_t_5) {
 
-      /* "sat_toolkit/formula.pyx":412
+      /* "sat_toolkit/formula.pyx":419
  *         for i in range(self._clauses.size()):
  *             if i == 0 or self._clauses[i - 1] == 0:
  *                 written = snprintf(&buf[buf_idx], buf_size, "%s", clause_prefix)             # <<<<<<<<<<<<<<
  *                 if written < 0:
  *                     assert 0
  */
       __pyx_v_written = snprintf((&(__pyx_v_buf[__pyx_v_buf_idx])), __pyx_v_buf_size, ((char const *)"%s"), __pyx_v_clause_prefix);
 
-      /* "sat_toolkit/formula.pyx":413
+      /* "sat_toolkit/formula.pyx":420
  *             if i == 0 or self._clauses[i - 1] == 0:
  *                 written = snprintf(&buf[buf_idx], buf_size, "%s", clause_prefix)
  *                 if written < 0:             # <<<<<<<<<<<<<<
  *                     assert 0
  *                 buf_idx += written
  */
       __pyx_t_5 = (__pyx_v_written < 0);
       if (__pyx_t_5) {
 
-        /* "sat_toolkit/formula.pyx":414
+        /* "sat_toolkit/formula.pyx":421
  *                 written = snprintf(&buf[buf_idx], buf_size, "%s", clause_prefix)
  *                 if written < 0:
  *                     assert 0             # <<<<<<<<<<<<<<
  *                 buf_idx += written
  *                 buf_size -= written
  */
         #ifndef CYTHON_WITHOUT_ASSERTIONS
         if (unlikely(__pyx_assertions_enabled())) {
           if (unlikely(!0)) {
             __Pyx_Raise(__pyx_builtin_AssertionError, 0, 0, 0);
-            __PYX_ERR(0, 414, __pyx_L1_error)
+            __PYX_ERR(0, 421, __pyx_L1_error)
           }
         }
         #else
-        if ((1)); else __PYX_ERR(0, 414, __pyx_L1_error)
+        if ((1)); else __PYX_ERR(0, 421, __pyx_L1_error)
         #endif
 
-        /* "sat_toolkit/formula.pyx":413
+        /* "sat_toolkit/formula.pyx":420
  *             if i == 0 or self._clauses[i - 1] == 0:
  *                 written = snprintf(&buf[buf_idx], buf_size, "%s", clause_prefix)
  *                 if written < 0:             # <<<<<<<<<<<<<<
  *                     assert 0
  *                 buf_idx += written
  */
       }
 
-      /* "sat_toolkit/formula.pyx":415
+      /* "sat_toolkit/formula.pyx":422
  *                 if written < 0:
  *                     assert 0
  *                 buf_idx += written             # <<<<<<<<<<<<<<
  *                 buf_size -= written
  * 
  */
       __pyx_v_buf_idx = (__pyx_v_buf_idx + __pyx_v_written);
 
-      /* "sat_toolkit/formula.pyx":416
+      /* "sat_toolkit/formula.pyx":423
  *                     assert 0
  *                 buf_idx += written
  *                 buf_size -= written             # <<<<<<<<<<<<<<
  * 
  *             if self._clauses[i] == 0:
  */
       __pyx_v_buf_size = (__pyx_v_buf_size - __pyx_v_written);
 
-      /* "sat_toolkit/formula.pyx":411
+      /* "sat_toolkit/formula.pyx":418
  * 
  *         for i in range(self._clauses.size()):
  *             if i == 0 or self._clauses[i - 1] == 0:             # <<<<<<<<<<<<<<
  *                 written = snprintf(&buf[buf_idx], buf_size, "%s", clause_prefix)
  *                 if written < 0:
  */
     }
 
-    /* "sat_toolkit/formula.pyx":418
+    /* "sat_toolkit/formula.pyx":425
  *                 buf_size -= written
  * 
  *             if self._clauses[i] == 0:             # <<<<<<<<<<<<<<
  *                 written = snprintf(&buf[buf_idx], buf_size, "0\n")
  *                 if written < 0:
  */
     __pyx_t_5 = ((__pyx_v_self->_clauses[__pyx_v_i]) == 0);
     if (__pyx_t_5) {
 
-      /* "sat_toolkit/formula.pyx":419
+      /* "sat_toolkit/formula.pyx":426
  * 
  *             if self._clauses[i] == 0:
  *                 written = snprintf(&buf[buf_idx], buf_size, "0\n")             # <<<<<<<<<<<<<<
  *                 if written < 0:
  *                     assert 0
  */
       __pyx_v_written = snprintf((&(__pyx_v_buf[__pyx_v_buf_idx])), __pyx_v_buf_size, ((char const *)"0\n"));
 
-      /* "sat_toolkit/formula.pyx":420
+      /* "sat_toolkit/formula.pyx":427
  *             if self._clauses[i] == 0:
  *                 written = snprintf(&buf[buf_idx], buf_size, "0\n")
  *                 if written < 0:             # <<<<<<<<<<<<<<
  *                     assert 0
  *                 buf_idx += written
  */
       __pyx_t_5 = (__pyx_v_written < 0);
       if (__pyx_t_5) {
 
-        /* "sat_toolkit/formula.pyx":421
+        /* "sat_toolkit/formula.pyx":428
  *                 written = snprintf(&buf[buf_idx], buf_size, "0\n")
  *                 if written < 0:
  *                     assert 0             # <<<<<<<<<<<<<<
  *                 buf_idx += written
  *                 buf_size -= written
  */
         #ifndef CYTHON_WITHOUT_ASSERTIONS
         if (unlikely(__pyx_assertions_enabled())) {
           if (unlikely(!0)) {
             __Pyx_Raise(__pyx_builtin_AssertionError, 0, 0, 0);
-            __PYX_ERR(0, 421, __pyx_L1_error)
+            __PYX_ERR(0, 428, __pyx_L1_error)
           }
         }
         #else
-        if ((1)); else __PYX_ERR(0, 421, __pyx_L1_error)
+        if ((1)); else __PYX_ERR(0, 428, __pyx_L1_error)
         #endif
 
-        /* "sat_toolkit/formula.pyx":420
+        /* "sat_toolkit/formula.pyx":427
  *             if self._clauses[i] == 0:
  *                 written = snprintf(&buf[buf_idx], buf_size, "0\n")
  *                 if written < 0:             # <<<<<<<<<<<<<<
  *                     assert 0
  *                 buf_idx += written
  */
       }
 
-      /* "sat_toolkit/formula.pyx":422
+      /* "sat_toolkit/formula.pyx":429
  *                 if written < 0:
  *                     assert 0
  *                 buf_idx += written             # <<<<<<<<<<<<<<
  *                 buf_size -= written
  *             else:
  */
       __pyx_v_buf_idx = (__pyx_v_buf_idx + __pyx_v_written);
 
-      /* "sat_toolkit/formula.pyx":423
+      /* "sat_toolkit/formula.pyx":430
  *                     assert 0
  *                 buf_idx += written
  *                 buf_size -= written             # <<<<<<<<<<<<<<
  *             else:
  *                 written = snprintf(&buf[buf_idx], buf_size, "%d ", self._clauses[i])
  */
       __pyx_v_buf_size = (__pyx_v_buf_size - __pyx_v_written);
 
-      /* "sat_toolkit/formula.pyx":418
+      /* "sat_toolkit/formula.pyx":425
  *                 buf_size -= written
  * 
  *             if self._clauses[i] == 0:             # <<<<<<<<<<<<<<
  *                 written = snprintf(&buf[buf_idx], buf_size, "0\n")
  *                 if written < 0:
  */
       goto __pyx_L9;
     }
 
-    /* "sat_toolkit/formula.pyx":425
+    /* "sat_toolkit/formula.pyx":432
  *                 buf_size -= written
  *             else:
  *                 written = snprintf(&buf[buf_idx], buf_size, "%d ", self._clauses[i])             # <<<<<<<<<<<<<<
  *                 if written < 0:
  *                     assert 0
  */
     /*else*/ {
       __pyx_v_written = snprintf((&(__pyx_v_buf[__pyx_v_buf_idx])), __pyx_v_buf_size, ((char const *)"%d "), (__pyx_v_self->_clauses[__pyx_v_i]));
 
-      /* "sat_toolkit/formula.pyx":426
+      /* "sat_toolkit/formula.pyx":433
  *             else:
  *                 written = snprintf(&buf[buf_idx], buf_size, "%d ", self._clauses[i])
  *                 if written < 0:             # <<<<<<<<<<<<<<
  *                     assert 0
  *                 buf_idx += written
  */
       __pyx_t_5 = (__pyx_v_written < 0);
       if (__pyx_t_5) {
 
-        /* "sat_toolkit/formula.pyx":427
+        /* "sat_toolkit/formula.pyx":434
  *                 written = snprintf(&buf[buf_idx], buf_size, "%d ", self._clauses[i])
  *                 if written < 0:
  *                     assert 0             # <<<<<<<<<<<<<<
  *                 buf_idx += written
  *                 buf_size -= written
  */
         #ifndef CYTHON_WITHOUT_ASSERTIONS
         if (unlikely(__pyx_assertions_enabled())) {
           if (unlikely(!0)) {
             __Pyx_Raise(__pyx_builtin_AssertionError, 0, 0, 0);
-            __PYX_ERR(0, 427, __pyx_L1_error)
+            __PYX_ERR(0, 434, __pyx_L1_error)
           }
         }
         #else
-        if ((1)); else __PYX_ERR(0, 427, __pyx_L1_error)
+        if ((1)); else __PYX_ERR(0, 434, __pyx_L1_error)
         #endif
 
-        /* "sat_toolkit/formula.pyx":426
+        /* "sat_toolkit/formula.pyx":433
  *             else:
  *                 written = snprintf(&buf[buf_idx], buf_size, "%d ", self._clauses[i])
  *                 if written < 0:             # <<<<<<<<<<<<<<
  *                     assert 0
  *                 buf_idx += written
  */
       }
 
-      /* "sat_toolkit/formula.pyx":428
+      /* "sat_toolkit/formula.pyx":435
  *                 if written < 0:
  *                     assert 0
  *                 buf_idx += written             # <<<<<<<<<<<<<<
  *                 buf_size -= written
  * 
  */
       __pyx_v_buf_idx = (__pyx_v_buf_idx + __pyx_v_written);
 
-      /* "sat_toolkit/formula.pyx":429
+      /* "sat_toolkit/formula.pyx":436
  *                     assert 0
  *                 buf_idx += written
  *                 buf_size -= written             # <<<<<<<<<<<<<<
  * 
  *         assert buf_size >= 0
  */
       __pyx_v_buf_size = (__pyx_v_buf_size - __pyx_v_written);
     }
     __pyx_L9:;
   }
 
-  /* "sat_toolkit/formula.pyx":431
+  /* "sat_toolkit/formula.pyx":438
  *                 buf_size -= written
  * 
  *         assert buf_size >= 0             # <<<<<<<<<<<<<<
  *         py_str = buf[:buf_idx]
  *         free(buf)
  */
   #ifndef CYTHON_WITHOUT_ASSERTIONS
   if (unlikely(__pyx_assertions_enabled())) {
     __pyx_t_5 = (__pyx_v_buf_size >= 0);
     if (unlikely(!__pyx_t_5)) {
       __Pyx_Raise(__pyx_builtin_AssertionError, 0, 0, 0);
-      __PYX_ERR(0, 431, __pyx_L1_error)
+      __PYX_ERR(0, 438, __pyx_L1_error)
     }
   }
   #else
-  if ((1)); else __PYX_ERR(0, 431, __pyx_L1_error)
+  if ((1)); else __PYX_ERR(0, 438, __pyx_L1_error)
   #endif
 
-  /* "sat_toolkit/formula.pyx":432
+  /* "sat_toolkit/formula.pyx":439
  * 
  *         assert buf_size >= 0
  *         py_str = buf[:buf_idx]             # <<<<<<<<<<<<<<
  *         free(buf)
  * 
  */
-  __pyx_t_7 = __Pyx_PyBytes_FromStringAndSize(__pyx_v_buf + 0, __pyx_v_buf_idx - 0); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 432, __pyx_L1_error)
+  __pyx_t_7 = __Pyx_PyBytes_FromStringAndSize(__pyx_v_buf + 0, __pyx_v_buf_idx - 0); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 439, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_7);
   __pyx_v_py_str = ((PyObject*)__pyx_t_7);
   __pyx_t_7 = 0;
 
-  /* "sat_toolkit/formula.pyx":433
+  /* "sat_toolkit/formula.pyx":440
  *         assert buf_size >= 0
  *         py_str = buf[:buf_idx]
  *         free(buf)             # <<<<<<<<<<<<<<
  * 
  *         return py_str.decode()
  */
   free(__pyx_v_buf);
 
-  /* "sat_toolkit/formula.pyx":435
+  /* "sat_toolkit/formula.pyx":442
  *         free(buf)
  * 
  *         return py_str.decode()             # <<<<<<<<<<<<<<
  * 
  * 
  */
   __Pyx_XDECREF(__pyx_r);
-  __pyx_t_7 = __Pyx_decode_bytes(__pyx_v_py_str, 0, PY_SSIZE_T_MAX, NULL, NULL, NULL); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 435, __pyx_L1_error)
+  __pyx_t_7 = __Pyx_decode_bytes(__pyx_v_py_str, 0, PY_SSIZE_T_MAX, NULL, NULL, NULL); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 442, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_7);
   __pyx_r = ((PyObject*)__pyx_t_7);
   __pyx_t_7 = 0;
   goto __pyx_L0;
 
-  /* "sat_toolkit/formula.pyx":402
+  /* "sat_toolkit/formula.pyx":409
  * 
  * 
  *     cdef str _to_dimacs(self, const char* clause_prefix):             # <<<<<<<<<<<<<<
  *         cdef size_t max_len = snprintf(NULL, 0, "%d", -self.nvars)
  *         cdef size_t nclauses = self._start_indices.size()
  */
 
@@ -29298,15 +29435,15 @@
   __pyx_L0:;
   __Pyx_XDECREF(__pyx_v_py_str);
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "sat_toolkit/formula.pyx":438
+/* "sat_toolkit/formula.pyx":445
  * 
  * 
  *     def add_clauses(self, clauses) -> None:             # <<<<<<<<<<<<<<
  *         cdef _ClauseList c_clauses = None
  * 
  */
 
@@ -29360,31 +29497,31 @@
       kw_args = __Pyx_NumKwargs_FASTCALL(__pyx_kwds);
       switch (__pyx_nargs) {
         case  0:
         if (likely((values[0] = __Pyx_GetKwValue_FASTCALL(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_clauses)) != 0)) {
           (void)__Pyx_Arg_NewRef_FASTCALL(values[0]);
           kw_args--;
         }
-        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 438, __pyx_L3_error)
+        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 445, __pyx_L3_error)
         else goto __pyx_L5_argtuple_error;
       }
       if (unlikely(kw_args > 0)) {
         const Py_ssize_t kwd_pos_args = __pyx_nargs;
-        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values + 0, kwd_pos_args, "add_clauses") < 0)) __PYX_ERR(0, 438, __pyx_L3_error)
+        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values + 0, kwd_pos_args, "add_clauses") < 0)) __PYX_ERR(0, 445, __pyx_L3_error)
       }
     } else if (unlikely(__pyx_nargs != 1)) {
       goto __pyx_L5_argtuple_error;
     } else {
       values[0] = __Pyx_Arg_FASTCALL(__pyx_args, 0);
     }
     __pyx_v_clauses = values[0];
   }
   goto __pyx_L6_skip;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("add_clauses", 1, 1, 1, __pyx_nargs); __PYX_ERR(0, 438, __pyx_L3_error)
+  __Pyx_RaiseArgtupleInvalid("add_clauses", 1, 1, 1, __pyx_nargs); __PYX_ERR(0, 445, __pyx_L3_error)
   __pyx_L6_skip:;
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L3_error:;
   {
     Py_ssize_t __pyx_temp;
     for (__pyx_temp=0; __pyx_temp < (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
       __Pyx_Arg_XDECREF_FASTCALL(values[__pyx_temp]);
@@ -29432,25 +29569,25 @@
   PyObject *__pyx_t_17 = NULL;
   PyObject *__pyx_t_18 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("add_clauses", 1);
 
-  /* "sat_toolkit/formula.pyx":439
+  /* "sat_toolkit/formula.pyx":446
  * 
  *     def add_clauses(self, clauses) -> None:
  *         cdef _ClauseList c_clauses = None             # <<<<<<<<<<<<<<
  * 
  *         try:
  */
   __Pyx_INCREF(Py_None);
   __pyx_v_c_clauses = ((struct __pyx_obj_11sat_toolkit_7formula__ClauseList *)Py_None);
 
-  /* "sat_toolkit/formula.pyx":441
+  /* "sat_toolkit/formula.pyx":448
  *         cdef _ClauseList c_clauses = None
  * 
  *         try:             # <<<<<<<<<<<<<<
  *             c_clauses = clauses
  *         except TypeError:
  */
   {
@@ -29458,57 +29595,57 @@
     __Pyx_PyThreadState_assign
     __Pyx_ExceptionSave(&__pyx_t_1, &__pyx_t_2, &__pyx_t_3);
     __Pyx_XGOTREF(__pyx_t_1);
     __Pyx_XGOTREF(__pyx_t_2);
     __Pyx_XGOTREF(__pyx_t_3);
     /*try:*/ {
 
-      /* "sat_toolkit/formula.pyx":442
+      /* "sat_toolkit/formula.pyx":449
  * 
  *         try:
  *             c_clauses = clauses             # <<<<<<<<<<<<<<
  *         except TypeError:
  *             pass
  */
-      if (!(likely(((__pyx_v_clauses) == Py_None) || likely(__Pyx_TypeTest(__pyx_v_clauses, __pyx_ptype_11sat_toolkit_7formula__ClauseList))))) __PYX_ERR(0, 442, __pyx_L3_error)
+      if (!(likely(((__pyx_v_clauses) == Py_None) || likely(__Pyx_TypeTest(__pyx_v_clauses, __pyx_ptype_11sat_toolkit_7formula__ClauseList))))) __PYX_ERR(0, 449, __pyx_L3_error)
       __pyx_t_4 = __pyx_v_clauses;
       __Pyx_INCREF(__pyx_t_4);
       __Pyx_DECREF_SET(__pyx_v_c_clauses, ((struct __pyx_obj_11sat_toolkit_7formula__ClauseList *)__pyx_t_4));
       __pyx_t_4 = 0;
 
-      /* "sat_toolkit/formula.pyx":441
+      /* "sat_toolkit/formula.pyx":448
  *         cdef _ClauseList c_clauses = None
  * 
  *         try:             # <<<<<<<<<<<<<<
  *             c_clauses = clauses
  *         except TypeError:
  */
     }
     __Pyx_XDECREF(__pyx_t_1); __pyx_t_1 = 0;
     __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
     __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
     goto __pyx_L8_try_end;
     __pyx_L3_error:;
     __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
 
-    /* "sat_toolkit/formula.pyx":443
+    /* "sat_toolkit/formula.pyx":450
  *         try:
  *             c_clauses = clauses
  *         except TypeError:             # <<<<<<<<<<<<<<
  *             pass
  * 
  */
     __pyx_t_5 = __Pyx_PyErr_ExceptionMatches(__pyx_builtin_TypeError);
     if (__pyx_t_5) {
       __Pyx_ErrRestore(0,0,0);
       goto __pyx_L4_exception_handled;
     }
     goto __pyx_L5_except_error;
 
-    /* "sat_toolkit/formula.pyx":441
+    /* "sat_toolkit/formula.pyx":448
  *         cdef _ClauseList c_clauses = None
  * 
  *         try:             # <<<<<<<<<<<<<<
  *             c_clauses = clauses
  *         except TypeError:
  */
     __pyx_L5_except_error:;
@@ -29521,104 +29658,104 @@
     __Pyx_XGIVEREF(__pyx_t_1);
     __Pyx_XGIVEREF(__pyx_t_2);
     __Pyx_XGIVEREF(__pyx_t_3);
     __Pyx_ExceptionReset(__pyx_t_1, __pyx_t_2, __pyx_t_3);
     __pyx_L8_try_end:;
   }
 
-  /* "sat_toolkit/formula.pyx":446
+  /* "sat_toolkit/formula.pyx":453
  *             pass
  * 
  *         if c_clauses is not None and not isinstance(c_clauses, type(self)):             # <<<<<<<<<<<<<<
  *             raise TypeError(f'cannot append {type(clauses).__name__} to {type(self).__name__}')
  * 
  */
   __pyx_t_7 = (((PyObject *)__pyx_v_c_clauses) != Py_None);
   if (__pyx_t_7) {
   } else {
     __pyx_t_6 = __pyx_t_7;
     goto __pyx_L10_bool_binop_done;
   }
-  __pyx_t_7 = PyObject_IsInstance(((PyObject *)__pyx_v_c_clauses), ((PyObject *)Py_TYPE(((PyObject *)__pyx_v_self)))); if (unlikely(__pyx_t_7 == ((int)-1))) __PYX_ERR(0, 446, __pyx_L1_error)
+  __pyx_t_7 = PyObject_IsInstance(((PyObject *)__pyx_v_c_clauses), ((PyObject *)Py_TYPE(((PyObject *)__pyx_v_self)))); if (unlikely(__pyx_t_7 == ((int)-1))) __PYX_ERR(0, 453, __pyx_L1_error)
   __pyx_t_8 = (!__pyx_t_7);
   __pyx_t_6 = __pyx_t_8;
   __pyx_L10_bool_binop_done:;
   if (unlikely(__pyx_t_6)) {
 
-    /* "sat_toolkit/formula.pyx":447
+    /* "sat_toolkit/formula.pyx":454
  * 
  *         if c_clauses is not None and not isinstance(c_clauses, type(self)):
  *             raise TypeError(f'cannot append {type(clauses).__name__} to {type(self).__name__}')             # <<<<<<<<<<<<<<
  * 
  *         cdef const int[:] clauses_view = None
  */
-    __pyx_t_4 = PyTuple_New(4); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 447, __pyx_L1_error)
+    __pyx_t_4 = PyTuple_New(4); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 454, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
     __pyx_t_9 = 0;
     __pyx_t_10 = 127;
     __Pyx_INCREF(__pyx_kp_u_cannot_append);
     __pyx_t_9 += 14;
     __Pyx_GIVEREF(__pyx_kp_u_cannot_append);
     PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_kp_u_cannot_append);
-    __pyx_t_11 = __Pyx_PyObject_GetAttrStr(((PyObject *)Py_TYPE(__pyx_v_clauses)), __pyx_n_s_name_2); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 447, __pyx_L1_error)
+    __pyx_t_11 = __Pyx_PyObject_GetAttrStr(((PyObject *)Py_TYPE(__pyx_v_clauses)), __pyx_n_s_name_2); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 454, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_11);
-    __pyx_t_12 = __Pyx_PyObject_FormatSimple(__pyx_t_11, __pyx_empty_unicode); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 447, __pyx_L1_error)
+    __pyx_t_12 = __Pyx_PyObject_FormatSimple(__pyx_t_11, __pyx_empty_unicode); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 454, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_12);
     __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
     __pyx_t_10 = (__Pyx_PyUnicode_MAX_CHAR_VALUE(__pyx_t_12) > __pyx_t_10) ? __Pyx_PyUnicode_MAX_CHAR_VALUE(__pyx_t_12) : __pyx_t_10;
     __pyx_t_9 += __Pyx_PyUnicode_GET_LENGTH(__pyx_t_12);
     __Pyx_GIVEREF(__pyx_t_12);
     PyTuple_SET_ITEM(__pyx_t_4, 1, __pyx_t_12);
     __pyx_t_12 = 0;
     __Pyx_INCREF(__pyx_kp_u_to);
     __pyx_t_9 += 4;
     __Pyx_GIVEREF(__pyx_kp_u_to);
     PyTuple_SET_ITEM(__pyx_t_4, 2, __pyx_kp_u_to);
-    __pyx_t_12 = __Pyx_PyObject_GetAttrStr(((PyObject *)Py_TYPE(((PyObject *)__pyx_v_self))), __pyx_n_s_name_2); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 447, __pyx_L1_error)
+    __pyx_t_12 = __Pyx_PyObject_GetAttrStr(((PyObject *)Py_TYPE(((PyObject *)__pyx_v_self))), __pyx_n_s_name_2); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 454, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_12);
-    __pyx_t_11 = __Pyx_PyObject_FormatSimple(__pyx_t_12, __pyx_empty_unicode); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 447, __pyx_L1_error)
+    __pyx_t_11 = __Pyx_PyObject_FormatSimple(__pyx_t_12, __pyx_empty_unicode); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 454, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_11);
     __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;
     __pyx_t_10 = (__Pyx_PyUnicode_MAX_CHAR_VALUE(__pyx_t_11) > __pyx_t_10) ? __Pyx_PyUnicode_MAX_CHAR_VALUE(__pyx_t_11) : __pyx_t_10;
     __pyx_t_9 += __Pyx_PyUnicode_GET_LENGTH(__pyx_t_11);
     __Pyx_GIVEREF(__pyx_t_11);
     PyTuple_SET_ITEM(__pyx_t_4, 3, __pyx_t_11);
     __pyx_t_11 = 0;
-    __pyx_t_11 = __Pyx_PyUnicode_Join(__pyx_t_4, 4, __pyx_t_9, __pyx_t_10); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 447, __pyx_L1_error)
+    __pyx_t_11 = __Pyx_PyUnicode_Join(__pyx_t_4, 4, __pyx_t_9, __pyx_t_10); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 454, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_11);
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-    __pyx_t_4 = __Pyx_PyObject_CallOneArg(__pyx_builtin_TypeError, __pyx_t_11); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 447, __pyx_L1_error)
+    __pyx_t_4 = __Pyx_PyObject_CallOneArg(__pyx_builtin_TypeError, __pyx_t_11); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 454, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
     __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
     __Pyx_Raise(__pyx_t_4, 0, 0, 0);
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-    __PYX_ERR(0, 447, __pyx_L1_error)
+    __PYX_ERR(0, 454, __pyx_L1_error)
 
-    /* "sat_toolkit/formula.pyx":446
+    /* "sat_toolkit/formula.pyx":453
  *             pass
  * 
  *         if c_clauses is not None and not isinstance(c_clauses, type(self)):             # <<<<<<<<<<<<<<
  *             raise TypeError(f'cannot append {type(clauses).__name__} to {type(self).__name__}')
  * 
  */
   }
 
-  /* "sat_toolkit/formula.pyx":449
+  /* "sat_toolkit/formula.pyx":456
  *             raise TypeError(f'cannot append {type(clauses).__name__} to {type(self).__name__}')
  * 
  *         cdef const int[:] clauses_view = None             # <<<<<<<<<<<<<<
  * 
  *         try:
  */
-  __pyx_t_13 = __Pyx_PyObject_to_MemoryviewSlice_ds_int__const__(Py_None, 0); if (unlikely(!__pyx_t_13.memview)) __PYX_ERR(0, 449, __pyx_L1_error)
+  __pyx_t_13 = __Pyx_PyObject_to_MemoryviewSlice_ds_int__const__(Py_None, 0); if (unlikely(!__pyx_t_13.memview)) __PYX_ERR(0, 456, __pyx_L1_error)
   __pyx_v_clauses_view = __pyx_t_13;
   __pyx_t_13.memview = NULL;
   __pyx_t_13.data = NULL;
 
-  /* "sat_toolkit/formula.pyx":451
+  /* "sat_toolkit/formula.pyx":458
  *         cdef const int[:] clauses_view = None
  * 
  *         try:             # <<<<<<<<<<<<<<
  *             clauses_view = clauses
  *         except (TypeError, ValueError):
  */
   {
@@ -29626,28 +29763,28 @@
     __Pyx_PyThreadState_assign
     __Pyx_ExceptionSave(&__pyx_t_3, &__pyx_t_2, &__pyx_t_1);
     __Pyx_XGOTREF(__pyx_t_3);
     __Pyx_XGOTREF(__pyx_t_2);
     __Pyx_XGOTREF(__pyx_t_1);
     /*try:*/ {
 
-      /* "sat_toolkit/formula.pyx":452
+      /* "sat_toolkit/formula.pyx":459
  * 
  *         try:
  *             clauses_view = clauses             # <<<<<<<<<<<<<<
  *         except (TypeError, ValueError):
  *             np_clauses = np.array(clauses, copy=False, dtype=np.int32)
  */
-      __pyx_t_13 = __Pyx_PyObject_to_MemoryviewSlice_ds_int__const__(__pyx_v_clauses, 0); if (unlikely(!__pyx_t_13.memview)) __PYX_ERR(0, 452, __pyx_L12_error)
+      __pyx_t_13 = __Pyx_PyObject_to_MemoryviewSlice_ds_int__const__(__pyx_v_clauses, 0); if (unlikely(!__pyx_t_13.memview)) __PYX_ERR(0, 459, __pyx_L12_error)
       __PYX_XCLEAR_MEMVIEW(&__pyx_v_clauses_view, 1);
       __pyx_v_clauses_view = __pyx_t_13;
       __pyx_t_13.memview = NULL;
       __pyx_t_13.data = NULL;
 
-      /* "sat_toolkit/formula.pyx":451
+      /* "sat_toolkit/formula.pyx":458
  *         cdef const int[:] clauses_view = None
  * 
  *         try:             # <<<<<<<<<<<<<<
  *             clauses_view = clauses
  *         except (TypeError, ValueError):
  */
     }
@@ -29658,84 +29795,84 @@
     __pyx_L12_error:;
     __Pyx_XDECREF(__pyx_t_11); __pyx_t_11 = 0;
     __Pyx_XDECREF(__pyx_t_12); __pyx_t_12 = 0;
     __PYX_XCLEAR_MEMVIEW(&__pyx_t_13, 1);
     __pyx_t_13.memview = NULL; __pyx_t_13.data = NULL;
     __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
 
-    /* "sat_toolkit/formula.pyx":453
+    /* "sat_toolkit/formula.pyx":460
  *         try:
  *             clauses_view = clauses
  *         except (TypeError, ValueError):             # <<<<<<<<<<<<<<
  *             np_clauses = np.array(clauses, copy=False, dtype=np.int32)
  *             clauses_view = np_clauses
  */
     __pyx_t_5 = __Pyx_PyErr_ExceptionMatches2(__pyx_builtin_TypeError, __pyx_builtin_ValueError);
     if (__pyx_t_5) {
       __Pyx_AddTraceback("sat_toolkit.formula._ClauseList.add_clauses", __pyx_clineno, __pyx_lineno, __pyx_filename);
-      if (__Pyx_GetException(&__pyx_t_4, &__pyx_t_11, &__pyx_t_12) < 0) __PYX_ERR(0, 453, __pyx_L14_except_error)
+      if (__Pyx_GetException(&__pyx_t_4, &__pyx_t_11, &__pyx_t_12) < 0) __PYX_ERR(0, 460, __pyx_L14_except_error)
       __Pyx_XGOTREF(__pyx_t_4);
       __Pyx_XGOTREF(__pyx_t_11);
       __Pyx_XGOTREF(__pyx_t_12);
 
-      /* "sat_toolkit/formula.pyx":454
+      /* "sat_toolkit/formula.pyx":461
  *             clauses_view = clauses
  *         except (TypeError, ValueError):
  *             np_clauses = np.array(clauses, copy=False, dtype=np.int32)             # <<<<<<<<<<<<<<
  *             clauses_view = np_clauses
  * 
  */
-      __Pyx_GetModuleGlobalName(__pyx_t_14, __pyx_n_s_np); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 454, __pyx_L14_except_error)
+      __Pyx_GetModuleGlobalName(__pyx_t_14, __pyx_n_s_np); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 461, __pyx_L14_except_error)
       __Pyx_GOTREF(__pyx_t_14);
-      __pyx_t_15 = __Pyx_PyObject_GetAttrStr(__pyx_t_14, __pyx_n_s_array); if (unlikely(!__pyx_t_15)) __PYX_ERR(0, 454, __pyx_L14_except_error)
+      __pyx_t_15 = __Pyx_PyObject_GetAttrStr(__pyx_t_14, __pyx_n_s_array); if (unlikely(!__pyx_t_15)) __PYX_ERR(0, 461, __pyx_L14_except_error)
       __Pyx_GOTREF(__pyx_t_15);
       __Pyx_DECREF(__pyx_t_14); __pyx_t_14 = 0;
-      __pyx_t_14 = PyTuple_New(1); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 454, __pyx_L14_except_error)
+      __pyx_t_14 = PyTuple_New(1); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 461, __pyx_L14_except_error)
       __Pyx_GOTREF(__pyx_t_14);
       __Pyx_INCREF(__pyx_v_clauses);
       __Pyx_GIVEREF(__pyx_v_clauses);
-      if (__Pyx_PyTuple_SET_ITEM(__pyx_t_14, 0, __pyx_v_clauses)) __PYX_ERR(0, 454, __pyx_L14_except_error);
-      __pyx_t_16 = __Pyx_PyDict_NewPresized(2); if (unlikely(!__pyx_t_16)) __PYX_ERR(0, 454, __pyx_L14_except_error)
+      if (__Pyx_PyTuple_SET_ITEM(__pyx_t_14, 0, __pyx_v_clauses)) __PYX_ERR(0, 461, __pyx_L14_except_error);
+      __pyx_t_16 = __Pyx_PyDict_NewPresized(2); if (unlikely(!__pyx_t_16)) __PYX_ERR(0, 461, __pyx_L14_except_error)
       __Pyx_GOTREF(__pyx_t_16);
-      if (PyDict_SetItem(__pyx_t_16, __pyx_n_s_copy, Py_False) < 0) __PYX_ERR(0, 454, __pyx_L14_except_error)
-      __Pyx_GetModuleGlobalName(__pyx_t_17, __pyx_n_s_np); if (unlikely(!__pyx_t_17)) __PYX_ERR(0, 454, __pyx_L14_except_error)
+      if (PyDict_SetItem(__pyx_t_16, __pyx_n_s_copy, Py_False) < 0) __PYX_ERR(0, 461, __pyx_L14_except_error)
+      __Pyx_GetModuleGlobalName(__pyx_t_17, __pyx_n_s_np); if (unlikely(!__pyx_t_17)) __PYX_ERR(0, 461, __pyx_L14_except_error)
       __Pyx_GOTREF(__pyx_t_17);
-      __pyx_t_18 = __Pyx_PyObject_GetAttrStr(__pyx_t_17, __pyx_n_s_int32); if (unlikely(!__pyx_t_18)) __PYX_ERR(0, 454, __pyx_L14_except_error)
+      __pyx_t_18 = __Pyx_PyObject_GetAttrStr(__pyx_t_17, __pyx_n_s_int32); if (unlikely(!__pyx_t_18)) __PYX_ERR(0, 461, __pyx_L14_except_error)
       __Pyx_GOTREF(__pyx_t_18);
       __Pyx_DECREF(__pyx_t_17); __pyx_t_17 = 0;
-      if (PyDict_SetItem(__pyx_t_16, __pyx_n_s_dtype, __pyx_t_18) < 0) __PYX_ERR(0, 454, __pyx_L14_except_error)
+      if (PyDict_SetItem(__pyx_t_16, __pyx_n_s_dtype, __pyx_t_18) < 0) __PYX_ERR(0, 461, __pyx_L14_except_error)
       __Pyx_DECREF(__pyx_t_18); __pyx_t_18 = 0;
-      __pyx_t_18 = __Pyx_PyObject_Call(__pyx_t_15, __pyx_t_14, __pyx_t_16); if (unlikely(!__pyx_t_18)) __PYX_ERR(0, 454, __pyx_L14_except_error)
+      __pyx_t_18 = __Pyx_PyObject_Call(__pyx_t_15, __pyx_t_14, __pyx_t_16); if (unlikely(!__pyx_t_18)) __PYX_ERR(0, 461, __pyx_L14_except_error)
       __Pyx_GOTREF(__pyx_t_18);
       __Pyx_DECREF(__pyx_t_15); __pyx_t_15 = 0;
       __Pyx_DECREF(__pyx_t_14); __pyx_t_14 = 0;
       __Pyx_DECREF(__pyx_t_16); __pyx_t_16 = 0;
       __pyx_v_np_clauses = __pyx_t_18;
       __pyx_t_18 = 0;
 
-      /* "sat_toolkit/formula.pyx":455
+      /* "sat_toolkit/formula.pyx":462
  *         except (TypeError, ValueError):
  *             np_clauses = np.array(clauses, copy=False, dtype=np.int32)
  *             clauses_view = np_clauses             # <<<<<<<<<<<<<<
  * 
  *         self._add_clauses(clauses_view)
  */
-      __pyx_t_13 = __Pyx_PyObject_to_MemoryviewSlice_ds_int__const__(__pyx_v_np_clauses, 0); if (unlikely(!__pyx_t_13.memview)) __PYX_ERR(0, 455, __pyx_L14_except_error)
+      __pyx_t_13 = __Pyx_PyObject_to_MemoryviewSlice_ds_int__const__(__pyx_v_np_clauses, 0); if (unlikely(!__pyx_t_13.memview)) __PYX_ERR(0, 462, __pyx_L14_except_error)
       __PYX_XCLEAR_MEMVIEW(&__pyx_v_clauses_view, 1);
       __pyx_v_clauses_view = __pyx_t_13;
       __pyx_t_13.memview = NULL;
       __pyx_t_13.data = NULL;
       __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
       __Pyx_XDECREF(__pyx_t_11); __pyx_t_11 = 0;
       __Pyx_XDECREF(__pyx_t_12); __pyx_t_12 = 0;
       goto __pyx_L13_exception_handled;
     }
     goto __pyx_L14_except_error;
 
-    /* "sat_toolkit/formula.pyx":451
+    /* "sat_toolkit/formula.pyx":458
  *         cdef const int[:] clauses_view = None
  * 
  *         try:             # <<<<<<<<<<<<<<
  *             clauses_view = clauses
  *         except (TypeError, ValueError):
  */
     __pyx_L14_except_error:;
@@ -29748,72 +29885,72 @@
     __Pyx_XGIVEREF(__pyx_t_3);
     __Pyx_XGIVEREF(__pyx_t_2);
     __Pyx_XGIVEREF(__pyx_t_1);
     __Pyx_ExceptionReset(__pyx_t_3, __pyx_t_2, __pyx_t_1);
     __pyx_L17_try_end:;
   }
 
-  /* "sat_toolkit/formula.pyx":457
+  /* "sat_toolkit/formula.pyx":464
  *             clauses_view = np_clauses
  * 
  *         self._add_clauses(clauses_view)             # <<<<<<<<<<<<<<
  * 
  *         if c_clauses is not None:
  */
-  __pyx_t_5 = ((struct __pyx_vtabstruct_11sat_toolkit_7formula__ClauseList *)__pyx_v_self->__pyx_vtab)->_add_clauses(__pyx_v_self, __pyx_v_clauses_view); if (unlikely(__pyx_t_5 == ((int)-1))) __PYX_ERR(0, 457, __pyx_L1_error)
+  __pyx_t_5 = ((struct __pyx_vtabstruct_11sat_toolkit_7formula__ClauseList *)__pyx_v_self->__pyx_vtab)->_add_clauses(__pyx_v_self, __pyx_v_clauses_view); if (unlikely(__pyx_t_5 == ((int)-1))) __PYX_ERR(0, 464, __pyx_L1_error)
 
-  /* "sat_toolkit/formula.pyx":459
+  /* "sat_toolkit/formula.pyx":466
  *         self._add_clauses(clauses_view)
  * 
  *         if c_clauses is not None:             # <<<<<<<<<<<<<<
  *             if c_clauses.nvars > self.nvars:
  *                 self.nvars = c_clauses.nvars
  */
   __pyx_t_6 = (((PyObject *)__pyx_v_c_clauses) != Py_None);
   if (__pyx_t_6) {
 
-    /* "sat_toolkit/formula.pyx":460
+    /* "sat_toolkit/formula.pyx":467
  * 
  *         if c_clauses is not None:
  *             if c_clauses.nvars > self.nvars:             # <<<<<<<<<<<<<<
  *                 self.nvars = c_clauses.nvars
  * 
  */
     __pyx_t_6 = (__pyx_v_c_clauses->nvars > __pyx_v_self->nvars);
     if (__pyx_t_6) {
 
-      /* "sat_toolkit/formula.pyx":461
+      /* "sat_toolkit/formula.pyx":468
  *         if c_clauses is not None:
  *             if c_clauses.nvars > self.nvars:
  *                 self.nvars = c_clauses.nvars             # <<<<<<<<<<<<<<
  * 
  *     def add_clause(self, clause) -> None:
  */
       __pyx_t_5 = __pyx_v_c_clauses->nvars;
       __pyx_v_self->nvars = __pyx_t_5;
 
-      /* "sat_toolkit/formula.pyx":460
+      /* "sat_toolkit/formula.pyx":467
  * 
  *         if c_clauses is not None:
  *             if c_clauses.nvars > self.nvars:             # <<<<<<<<<<<<<<
  *                 self.nvars = c_clauses.nvars
  * 
  */
     }
 
-    /* "sat_toolkit/formula.pyx":459
+    /* "sat_toolkit/formula.pyx":466
  *         self._add_clauses(clauses_view)
  * 
  *         if c_clauses is not None:             # <<<<<<<<<<<<<<
  *             if c_clauses.nvars > self.nvars:
  *                 self.nvars = c_clauses.nvars
  */
   }
 
-  /* "sat_toolkit/formula.pyx":438
+  /* "sat_toolkit/formula.pyx":445
  * 
  * 
  *     def add_clauses(self, clauses) -> None:             # <<<<<<<<<<<<<<
  *         cdef _ClauseList c_clauses = None
  * 
  */
 
@@ -29837,15 +29974,15 @@
   __PYX_XCLEAR_MEMVIEW(&__pyx_v_clauses_view, 1);
   __Pyx_XDECREF(__pyx_v_np_clauses);
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "sat_toolkit/formula.pyx":463
+/* "sat_toolkit/formula.pyx":470
  *                 self.nvars = c_clauses.nvars
  * 
  *     def add_clause(self, clause) -> None:             # <<<<<<<<<<<<<<
  *         """Add a single clause to CNF formula. Specify the clause without trailing 0."""
  * 
  */
 
@@ -29899,31 +30036,31 @@
       kw_args = __Pyx_NumKwargs_FASTCALL(__pyx_kwds);
       switch (__pyx_nargs) {
         case  0:
         if (likely((values[0] = __Pyx_GetKwValue_FASTCALL(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_clause)) != 0)) {
           (void)__Pyx_Arg_NewRef_FASTCALL(values[0]);
           kw_args--;
         }
-        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 463, __pyx_L3_error)
+        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 470, __pyx_L3_error)
         else goto __pyx_L5_argtuple_error;
       }
       if (unlikely(kw_args > 0)) {
         const Py_ssize_t kwd_pos_args = __pyx_nargs;
-        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values + 0, kwd_pos_args, "add_clause") < 0)) __PYX_ERR(0, 463, __pyx_L3_error)
+        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values + 0, kwd_pos_args, "add_clause") < 0)) __PYX_ERR(0, 470, __pyx_L3_error)
       }
     } else if (unlikely(__pyx_nargs != 1)) {
       goto __pyx_L5_argtuple_error;
     } else {
       values[0] = __Pyx_Arg_FASTCALL(__pyx_args, 0);
     }
     __pyx_v_clause = values[0];
   }
   goto __pyx_L6_skip;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("add_clause", 1, 1, 1, __pyx_nargs); __PYX_ERR(0, 463, __pyx_L3_error)
+  __Pyx_RaiseArgtupleInvalid("add_clause", 1, 1, 1, __pyx_nargs); __PYX_ERR(0, 470, __pyx_L3_error)
   __pyx_L6_skip:;
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L3_error:;
   {
     Py_ssize_t __pyx_temp;
     for (__pyx_temp=0; __pyx_temp < (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
       __Pyx_Arg_XDECREF_FASTCALL(values[__pyx_temp]);
@@ -29963,156 +30100,156 @@
   int __pyx_t_10;
   __Pyx_memviewslice __pyx_t_11 = { 0, 0, { 0 }, { 0 }, { 0 } };
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("add_clause", 1);
 
-  /* "sat_toolkit/formula.pyx":466
+  /* "sat_toolkit/formula.pyx":473
  *         """Add a single clause to CNF formula. Specify the clause without trailing 0."""
  * 
  *         if isinstance(clause, _BaseClause) and not self._check_clause_type(clause):             # <<<<<<<<<<<<<<
  *             raise TypeError(f'cannot append {type(clause).__name__} to {type(self).__name__}')
  * 
  */
   __pyx_t_2 = __Pyx_TypeCheck(__pyx_v_clause, __pyx_ptype_11sat_toolkit_7formula__BaseClause); 
   if (__pyx_t_2) {
   } else {
     __pyx_t_1 = __pyx_t_2;
     goto __pyx_L4_bool_binop_done;
   }
-  if (!(likely(((__pyx_v_clause) == Py_None) || likely(__Pyx_TypeTest(__pyx_v_clause, __pyx_ptype_11sat_toolkit_7formula__BaseClause))))) __PYX_ERR(0, 466, __pyx_L1_error)
+  if (!(likely(((__pyx_v_clause) == Py_None) || likely(__Pyx_TypeTest(__pyx_v_clause, __pyx_ptype_11sat_toolkit_7formula__BaseClause))))) __PYX_ERR(0, 473, __pyx_L1_error)
   __pyx_t_2 = (!(((struct __pyx_vtabstruct_11sat_toolkit_7formula__ClauseList *)__pyx_v_self->__pyx_vtab)->_check_clause_type(__pyx_v_self, ((struct __pyx_obj_11sat_toolkit_7formula__BaseClause *)__pyx_v_clause)) != 0));
   __pyx_t_1 = __pyx_t_2;
   __pyx_L4_bool_binop_done:;
   if (unlikely(__pyx_t_1)) {
 
-    /* "sat_toolkit/formula.pyx":467
+    /* "sat_toolkit/formula.pyx":474
  * 
  *         if isinstance(clause, _BaseClause) and not self._check_clause_type(clause):
  *             raise TypeError(f'cannot append {type(clause).__name__} to {type(self).__name__}')             # <<<<<<<<<<<<<<
  * 
  *         cdef ssize_t clause_len = len(clause)
  */
-    __pyx_t_3 = PyTuple_New(4); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 467, __pyx_L1_error)
+    __pyx_t_3 = PyTuple_New(4); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 474, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
     __pyx_t_4 = 0;
     __pyx_t_5 = 127;
     __Pyx_INCREF(__pyx_kp_u_cannot_append);
     __pyx_t_4 += 14;
     __Pyx_GIVEREF(__pyx_kp_u_cannot_append);
     PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_kp_u_cannot_append);
-    __pyx_t_6 = __Pyx_PyObject_GetAttrStr(((PyObject *)Py_TYPE(__pyx_v_clause)), __pyx_n_s_name_2); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 467, __pyx_L1_error)
+    __pyx_t_6 = __Pyx_PyObject_GetAttrStr(((PyObject *)Py_TYPE(__pyx_v_clause)), __pyx_n_s_name_2); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 474, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
-    __pyx_t_7 = __Pyx_PyObject_FormatSimple(__pyx_t_6, __pyx_empty_unicode); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 467, __pyx_L1_error)
+    __pyx_t_7 = __Pyx_PyObject_FormatSimple(__pyx_t_6, __pyx_empty_unicode); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 474, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_7);
     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
     __pyx_t_5 = (__Pyx_PyUnicode_MAX_CHAR_VALUE(__pyx_t_7) > __pyx_t_5) ? __Pyx_PyUnicode_MAX_CHAR_VALUE(__pyx_t_7) : __pyx_t_5;
     __pyx_t_4 += __Pyx_PyUnicode_GET_LENGTH(__pyx_t_7);
     __Pyx_GIVEREF(__pyx_t_7);
     PyTuple_SET_ITEM(__pyx_t_3, 1, __pyx_t_7);
     __pyx_t_7 = 0;
     __Pyx_INCREF(__pyx_kp_u_to);
     __pyx_t_4 += 4;
     __Pyx_GIVEREF(__pyx_kp_u_to);
     PyTuple_SET_ITEM(__pyx_t_3, 2, __pyx_kp_u_to);
-    __pyx_t_7 = __Pyx_PyObject_GetAttrStr(((PyObject *)Py_TYPE(((PyObject *)__pyx_v_self))), __pyx_n_s_name_2); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 467, __pyx_L1_error)
+    __pyx_t_7 = __Pyx_PyObject_GetAttrStr(((PyObject *)Py_TYPE(((PyObject *)__pyx_v_self))), __pyx_n_s_name_2); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 474, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_7);
-    __pyx_t_6 = __Pyx_PyObject_FormatSimple(__pyx_t_7, __pyx_empty_unicode); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 467, __pyx_L1_error)
+    __pyx_t_6 = __Pyx_PyObject_FormatSimple(__pyx_t_7, __pyx_empty_unicode); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 474, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
     __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
     __pyx_t_5 = (__Pyx_PyUnicode_MAX_CHAR_VALUE(__pyx_t_6) > __pyx_t_5) ? __Pyx_PyUnicode_MAX_CHAR_VALUE(__pyx_t_6) : __pyx_t_5;
     __pyx_t_4 += __Pyx_PyUnicode_GET_LENGTH(__pyx_t_6);
     __Pyx_GIVEREF(__pyx_t_6);
     PyTuple_SET_ITEM(__pyx_t_3, 3, __pyx_t_6);
     __pyx_t_6 = 0;
-    __pyx_t_6 = __Pyx_PyUnicode_Join(__pyx_t_3, 4, __pyx_t_4, __pyx_t_5); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 467, __pyx_L1_error)
+    __pyx_t_6 = __Pyx_PyUnicode_Join(__pyx_t_3, 4, __pyx_t_4, __pyx_t_5); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 474, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-    __pyx_t_3 = __Pyx_PyObject_CallOneArg(__pyx_builtin_TypeError, __pyx_t_6); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 467, __pyx_L1_error)
+    __pyx_t_3 = __Pyx_PyObject_CallOneArg(__pyx_builtin_TypeError, __pyx_t_6); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 474, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
     __Pyx_Raise(__pyx_t_3, 0, 0, 0);
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-    __PYX_ERR(0, 467, __pyx_L1_error)
+    __PYX_ERR(0, 474, __pyx_L1_error)
 
-    /* "sat_toolkit/formula.pyx":466
+    /* "sat_toolkit/formula.pyx":473
  *         """Add a single clause to CNF formula. Specify the clause without trailing 0."""
  * 
  *         if isinstance(clause, _BaseClause) and not self._check_clause_type(clause):             # <<<<<<<<<<<<<<
  *             raise TypeError(f'cannot append {type(clause).__name__} to {type(self).__name__}')
  * 
  */
   }
 
-  /* "sat_toolkit/formula.pyx":469
+  /* "sat_toolkit/formula.pyx":476
  *             raise TypeError(f'cannot append {type(clause).__name__} to {type(self).__name__}')
  * 
  *         cdef ssize_t clause_len = len(clause)             # <<<<<<<<<<<<<<
  *         np_clause = np.zeros(clause_len + 1, dtype=np.int32)
  *         np_clause[:clause_len] = clause
  */
-  __pyx_t_4 = PyObject_Length(__pyx_v_clause); if (unlikely(__pyx_t_4 == ((Py_ssize_t)-1))) __PYX_ERR(0, 469, __pyx_L1_error)
+  __pyx_t_4 = PyObject_Length(__pyx_v_clause); if (unlikely(__pyx_t_4 == ((Py_ssize_t)-1))) __PYX_ERR(0, 476, __pyx_L1_error)
   __pyx_v_clause_len = __pyx_t_4;
 
-  /* "sat_toolkit/formula.pyx":470
+  /* "sat_toolkit/formula.pyx":477
  * 
  *         cdef ssize_t clause_len = len(clause)
  *         np_clause = np.zeros(clause_len + 1, dtype=np.int32)             # <<<<<<<<<<<<<<
  *         np_clause[:clause_len] = clause
  *         if np.count_nonzero(np_clause) != clause_len:
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_np); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 470, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_np); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 477, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_zeros); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 470, __pyx_L1_error)
+  __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_zeros); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 477, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_6);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  __pyx_t_3 = PyInt_FromSsize_t((__pyx_v_clause_len + 1)); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 470, __pyx_L1_error)
+  __pyx_t_3 = PyInt_FromSsize_t((__pyx_v_clause_len + 1)); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 477, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  __pyx_t_7 = PyTuple_New(1); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 470, __pyx_L1_error)
+  __pyx_t_7 = PyTuple_New(1); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 477, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_7);
   __Pyx_GIVEREF(__pyx_t_3);
-  if (__Pyx_PyTuple_SET_ITEM(__pyx_t_7, 0, __pyx_t_3)) __PYX_ERR(0, 470, __pyx_L1_error);
+  if (__Pyx_PyTuple_SET_ITEM(__pyx_t_7, 0, __pyx_t_3)) __PYX_ERR(0, 477, __pyx_L1_error);
   __pyx_t_3 = 0;
-  __pyx_t_3 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 470, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 477, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  __Pyx_GetModuleGlobalName(__pyx_t_8, __pyx_n_s_np); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 470, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_8, __pyx_n_s_np); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 477, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_8);
-  __pyx_t_9 = __Pyx_PyObject_GetAttrStr(__pyx_t_8, __pyx_n_s_int32); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 470, __pyx_L1_error)
+  __pyx_t_9 = __Pyx_PyObject_GetAttrStr(__pyx_t_8, __pyx_n_s_int32); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 477, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_9);
   __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
-  if (PyDict_SetItem(__pyx_t_3, __pyx_n_s_dtype, __pyx_t_9) < 0) __PYX_ERR(0, 470, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_3, __pyx_n_s_dtype, __pyx_t_9) < 0) __PYX_ERR(0, 477, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
-  __pyx_t_9 = __Pyx_PyObject_Call(__pyx_t_6, __pyx_t_7, __pyx_t_3); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 470, __pyx_L1_error)
+  __pyx_t_9 = __Pyx_PyObject_Call(__pyx_t_6, __pyx_t_7, __pyx_t_3); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 477, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_9);
   __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
   __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   __pyx_v_np_clause = __pyx_t_9;
   __pyx_t_9 = 0;
 
-  /* "sat_toolkit/formula.pyx":471
+  /* "sat_toolkit/formula.pyx":478
  *         cdef ssize_t clause_len = len(clause)
  *         np_clause = np.zeros(clause_len + 1, dtype=np.int32)
  *         np_clause[:clause_len] = clause             # <<<<<<<<<<<<<<
  *         if np.count_nonzero(np_clause) != clause_len:
  *             raise ValueError('cannot use 0 in clause')
  */
-  if (__Pyx_PyObject_SetSlice(__pyx_v_np_clause, __pyx_v_clause, 0, __pyx_v_clause_len, NULL, NULL, NULL, 0, 1, 0) < 0) __PYX_ERR(0, 471, __pyx_L1_error)
+  if (__Pyx_PyObject_SetSlice(__pyx_v_np_clause, __pyx_v_clause, 0, __pyx_v_clause_len, NULL, NULL, NULL, 0, 1, 0) < 0) __PYX_ERR(0, 478, __pyx_L1_error)
 
-  /* "sat_toolkit/formula.pyx":472
+  /* "sat_toolkit/formula.pyx":479
  *         np_clause = np.zeros(clause_len + 1, dtype=np.int32)
  *         np_clause[:clause_len] = clause
  *         if np.count_nonzero(np_clause) != clause_len:             # <<<<<<<<<<<<<<
  *             raise ValueError('cannot use 0 in clause')
  *         self._add_clauses(np_clause)
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_np); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 472, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_np); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 479, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  __pyx_t_7 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_count_nonzero); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 472, __pyx_L1_error)
+  __pyx_t_7 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_count_nonzero); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 479, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_7);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   __pyx_t_3 = NULL;
   __pyx_t_10 = 0;
   #if CYTHON_UNPACK_METHODS
   if (unlikely(PyMethod_Check(__pyx_t_7))) {
     __pyx_t_3 = PyMethod_GET_SELF(__pyx_t_7);
@@ -30125,62 +30262,62 @@
     }
   }
   #endif
   {
     PyObject *__pyx_callargs[2] = {__pyx_t_3, __pyx_v_np_clause};
     __pyx_t_9 = __Pyx_PyObject_FastCall(__pyx_t_7, __pyx_callargs+1-__pyx_t_10, 1+__pyx_t_10);
     __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
-    if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 472, __pyx_L1_error)
+    if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 479, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_9);
     __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
   }
-  __pyx_t_7 = PyInt_FromSsize_t(__pyx_v_clause_len); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 472, __pyx_L1_error)
+  __pyx_t_7 = PyInt_FromSsize_t(__pyx_v_clause_len); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 479, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_7);
-  __pyx_t_3 = PyObject_RichCompare(__pyx_t_9, __pyx_t_7, Py_NE); __Pyx_XGOTREF(__pyx_t_3); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 472, __pyx_L1_error)
+  __pyx_t_3 = PyObject_RichCompare(__pyx_t_9, __pyx_t_7, Py_NE); __Pyx_XGOTREF(__pyx_t_3); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 479, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
   __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-  __pyx_t_1 = __Pyx_PyObject_IsTrue(__pyx_t_3); if (unlikely((__pyx_t_1 < 0))) __PYX_ERR(0, 472, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_IsTrue(__pyx_t_3); if (unlikely((__pyx_t_1 < 0))) __PYX_ERR(0, 479, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   if (unlikely(__pyx_t_1)) {
 
-    /* "sat_toolkit/formula.pyx":473
+    /* "sat_toolkit/formula.pyx":480
  *         np_clause[:clause_len] = clause
  *         if np.count_nonzero(np_clause) != clause_len:
  *             raise ValueError('cannot use 0 in clause')             # <<<<<<<<<<<<<<
  *         self._add_clauses(np_clause)
  * 
  */
-    __pyx_t_3 = __Pyx_PyObject_Call(__pyx_builtin_ValueError, __pyx_tuple__23, NULL); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 473, __pyx_L1_error)
+    __pyx_t_3 = __Pyx_PyObject_Call(__pyx_builtin_ValueError, __pyx_tuple__23, NULL); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 480, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
     __Pyx_Raise(__pyx_t_3, 0, 0, 0);
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-    __PYX_ERR(0, 473, __pyx_L1_error)
+    __PYX_ERR(0, 480, __pyx_L1_error)
 
-    /* "sat_toolkit/formula.pyx":472
+    /* "sat_toolkit/formula.pyx":479
  *         np_clause = np.zeros(clause_len + 1, dtype=np.int32)
  *         np_clause[:clause_len] = clause
  *         if np.count_nonzero(np_clause) != clause_len:             # <<<<<<<<<<<<<<
  *             raise ValueError('cannot use 0 in clause')
  *         self._add_clauses(np_clause)
  */
   }
 
-  /* "sat_toolkit/formula.pyx":474
+  /* "sat_toolkit/formula.pyx":481
  *         if np.count_nonzero(np_clause) != clause_len:
  *             raise ValueError('cannot use 0 in clause')
  *         self._add_clauses(np_clause)             # <<<<<<<<<<<<<<
  * 
  *     append = add_clause
  */
-  __pyx_t_11 = __Pyx_PyObject_to_MemoryviewSlice_ds_int__const__(__pyx_v_np_clause, 0); if (unlikely(!__pyx_t_11.memview)) __PYX_ERR(0, 474, __pyx_L1_error)
-  __pyx_t_10 = ((struct __pyx_vtabstruct_11sat_toolkit_7formula__ClauseList *)__pyx_v_self->__pyx_vtab)->_add_clauses(__pyx_v_self, __pyx_t_11); if (unlikely(__pyx_t_10 == ((int)-1))) __PYX_ERR(0, 474, __pyx_L1_error)
+  __pyx_t_11 = __Pyx_PyObject_to_MemoryviewSlice_ds_int__const__(__pyx_v_np_clause, 0); if (unlikely(!__pyx_t_11.memview)) __PYX_ERR(0, 481, __pyx_L1_error)
+  __pyx_t_10 = ((struct __pyx_vtabstruct_11sat_toolkit_7formula__ClauseList *)__pyx_v_self->__pyx_vtab)->_add_clauses(__pyx_v_self, __pyx_t_11); if (unlikely(__pyx_t_10 == ((int)-1))) __PYX_ERR(0, 481, __pyx_L1_error)
   __PYX_XCLEAR_MEMVIEW(&__pyx_t_11, 1);
   __pyx_t_11.memview = NULL; __pyx_t_11.data = NULL;
 
-  /* "sat_toolkit/formula.pyx":463
+  /* "sat_toolkit/formula.pyx":470
  *                 self.nvars = c_clauses.nvars
  * 
  *     def add_clause(self, clause) -> None:             # <<<<<<<<<<<<<<
  *         """Add a single clause to CNF formula. Specify the clause without trailing 0."""
  * 
  */
 
@@ -30199,15 +30336,15 @@
   __pyx_L0:;
   __Pyx_XDECREF(__pyx_v_np_clause);
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "sat_toolkit/formula.pyx":478
+/* "sat_toolkit/formula.pyx":485
  *     append = add_clause
  * 
  *     def __iadd__(self, clauses) -> Self:             # <<<<<<<<<<<<<<
  *         self.add_clauses(clauses)
  *         return self
  */
 
@@ -30234,22 +30371,22 @@
   PyObject *__pyx_t_3 = NULL;
   int __pyx_t_4;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("__iadd__", 1);
 
-  /* "sat_toolkit/formula.pyx":479
+  /* "sat_toolkit/formula.pyx":486
  * 
  *     def __iadd__(self, clauses) -> Self:
  *         self.add_clauses(clauses)             # <<<<<<<<<<<<<<
  *         return self
  * 
  */
-  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_self), __pyx_n_s_add_clauses); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 479, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_self), __pyx_n_s_add_clauses); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 486, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __pyx_t_3 = NULL;
   __pyx_t_4 = 0;
   #if CYTHON_UNPACK_METHODS
   if (likely(PyMethod_Check(__pyx_t_2))) {
     __pyx_t_3 = PyMethod_GET_SELF(__pyx_t_2);
     if (likely(__pyx_t_3)) {
@@ -30261,33 +30398,33 @@
     }
   }
   #endif
   {
     PyObject *__pyx_callargs[2] = {__pyx_t_3, __pyx_v_clauses};
     __pyx_t_1 = __Pyx_PyObject_FastCall(__pyx_t_2, __pyx_callargs+1-__pyx_t_4, 1+__pyx_t_4);
     __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
-    if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 479, __pyx_L1_error)
+    if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 486, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   }
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-  /* "sat_toolkit/formula.pyx":480
+  /* "sat_toolkit/formula.pyx":487
  *     def __iadd__(self, clauses) -> Self:
  *         self.add_clauses(clauses)
  *         return self             # <<<<<<<<<<<<<<
  * 
  *     def __add__(self, _ClauseList other) -> Self:
  */
   __Pyx_XDECREF(__pyx_r);
   __Pyx_INCREF((PyObject *)__pyx_v_self);
   __pyx_r = ((PyObject *)__pyx_v_self);
   goto __pyx_L0;
 
-  /* "sat_toolkit/formula.pyx":478
+  /* "sat_toolkit/formula.pyx":485
  *     append = add_clause
  * 
  *     def __iadd__(self, clauses) -> Self:             # <<<<<<<<<<<<<<
  *         self.add_clauses(clauses)
  *         return self
  */
 
@@ -30300,15 +30437,15 @@
   __pyx_r = NULL;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "sat_toolkit/formula.pyx":482
+/* "sat_toolkit/formula.pyx":489
  *         return self
  * 
  *     def __add__(self, _ClauseList other) -> Self:             # <<<<<<<<<<<<<<
  *         cdef _ClauseList res
  *         res = type(self).__new__(type(self))
  */
 
@@ -30319,15 +30456,15 @@
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   PyObject *__pyx_r = 0;
   __Pyx_RefNannyDeclarations
   __Pyx_RefNannySetupContext("__add__ (wrapper)", 0);
   __pyx_kwvalues = __Pyx_KwValues_VARARGS(__pyx_args, __pyx_nargs);
-  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_other), __pyx_ptype_11sat_toolkit_7formula__ClauseList, 1, "other", 0))) __PYX_ERR(0, 482, __pyx_L1_error)
+  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_other), __pyx_ptype_11sat_toolkit_7formula__ClauseList, 1, "other", 0))) __PYX_ERR(0, 489, __pyx_L1_error)
   __pyx_r = __pyx_pf_11sat_toolkit_7formula_11_ClauseList_16__add__(((struct __pyx_obj_11sat_toolkit_7formula__ClauseList *)__pyx_v_self), ((struct __pyx_obj_11sat_toolkit_7formula__ClauseList *)__pyx_v_other));
 
   /* function exit code */
   goto __pyx_L0;
   __pyx_L1_error:;
   __pyx_r = NULL;
   __pyx_L0:;
@@ -30348,22 +30485,22 @@
   int __pyx_t_7;
   __Pyx_memviewslice __pyx_t_8 = { 0, 0, { 0 }, { 0 }, { 0 } };
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("__add__", 1);
 
-  /* "sat_toolkit/formula.pyx":484
+  /* "sat_toolkit/formula.pyx":491
  *     def __add__(self, _ClauseList other) -> Self:
  *         cdef _ClauseList res
  *         res = type(self).__new__(type(self))             # <<<<<<<<<<<<<<
  *         res.nvars = max(self.nvars, other.nvars)
  *         res._add_clauses(self)
  */
-  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(((PyObject *)Py_TYPE(((PyObject *)__pyx_v_self))), __pyx_n_s_new); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 484, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(((PyObject *)Py_TYPE(((PyObject *)__pyx_v_self))), __pyx_n_s_new); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 491, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __pyx_t_3 = NULL;
   __pyx_t_4 = 0;
   #if CYTHON_UNPACK_METHODS
   if (likely(PyMethod_Check(__pyx_t_2))) {
     __pyx_t_3 = PyMethod_GET_SELF(__pyx_t_2);
     if (likely(__pyx_t_3)) {
@@ -30375,23 +30512,23 @@
     }
   }
   #endif
   {
     PyObject *__pyx_callargs[2] = {__pyx_t_3, ((PyObject *)Py_TYPE(((PyObject *)__pyx_v_self)))};
     __pyx_t_1 = __Pyx_PyObject_FastCall(__pyx_t_2, __pyx_callargs+1-__pyx_t_4, 1+__pyx_t_4);
     __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
-    if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 484, __pyx_L1_error)
+    if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 491, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   }
-  if (!(likely(((__pyx_t_1) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_1, __pyx_ptype_11sat_toolkit_7formula__ClauseList))))) __PYX_ERR(0, 484, __pyx_L1_error)
+  if (!(likely(((__pyx_t_1) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_1, __pyx_ptype_11sat_toolkit_7formula__ClauseList))))) __PYX_ERR(0, 491, __pyx_L1_error)
   __pyx_v_res = ((struct __pyx_obj_11sat_toolkit_7formula__ClauseList *)__pyx_t_1);
   __pyx_t_1 = 0;
 
-  /* "sat_toolkit/formula.pyx":485
+  /* "sat_toolkit/formula.pyx":492
  *         cdef _ClauseList res
  *         res = type(self).__new__(type(self))
  *         res.nvars = max(self.nvars, other.nvars)             # <<<<<<<<<<<<<<
  *         res._add_clauses(self)
  *         res._add_clauses(other)
  */
   __pyx_t_4 = __pyx_v_other->nvars;
@@ -30400,51 +30537,51 @@
   if (__pyx_t_7) {
     __pyx_t_6 = __pyx_t_4;
   } else {
     __pyx_t_6 = __pyx_t_5;
   }
   __pyx_v_res->nvars = __pyx_t_6;
 
-  /* "sat_toolkit/formula.pyx":486
+  /* "sat_toolkit/formula.pyx":493
  *         res = type(self).__new__(type(self))
  *         res.nvars = max(self.nvars, other.nvars)
  *         res._add_clauses(self)             # <<<<<<<<<<<<<<
  *         res._add_clauses(other)
  *         return res
  */
-  __pyx_t_8 = __Pyx_PyObject_to_MemoryviewSlice_ds_int__const__(((PyObject *)__pyx_v_self), 0); if (unlikely(!__pyx_t_8.memview)) __PYX_ERR(0, 486, __pyx_L1_error)
-  __pyx_t_6 = ((struct __pyx_vtabstruct_11sat_toolkit_7formula__ClauseList *)__pyx_v_res->__pyx_vtab)->_add_clauses(__pyx_v_res, __pyx_t_8); if (unlikely(__pyx_t_6 == ((int)-1))) __PYX_ERR(0, 486, __pyx_L1_error)
+  __pyx_t_8 = __Pyx_PyObject_to_MemoryviewSlice_ds_int__const__(((PyObject *)__pyx_v_self), 0); if (unlikely(!__pyx_t_8.memview)) __PYX_ERR(0, 493, __pyx_L1_error)
+  __pyx_t_6 = ((struct __pyx_vtabstruct_11sat_toolkit_7formula__ClauseList *)__pyx_v_res->__pyx_vtab)->_add_clauses(__pyx_v_res, __pyx_t_8); if (unlikely(__pyx_t_6 == ((int)-1))) __PYX_ERR(0, 493, __pyx_L1_error)
   __PYX_XCLEAR_MEMVIEW(&__pyx_t_8, 1);
   __pyx_t_8.memview = NULL; __pyx_t_8.data = NULL;
 
-  /* "sat_toolkit/formula.pyx":487
+  /* "sat_toolkit/formula.pyx":494
  *         res.nvars = max(self.nvars, other.nvars)
  *         res._add_clauses(self)
  *         res._add_clauses(other)             # <<<<<<<<<<<<<<
  *         return res
  * 
  */
-  __pyx_t_8 = __Pyx_PyObject_to_MemoryviewSlice_ds_int__const__(((PyObject *)__pyx_v_other), 0); if (unlikely(!__pyx_t_8.memview)) __PYX_ERR(0, 487, __pyx_L1_error)
-  __pyx_t_6 = ((struct __pyx_vtabstruct_11sat_toolkit_7formula__ClauseList *)__pyx_v_res->__pyx_vtab)->_add_clauses(__pyx_v_res, __pyx_t_8); if (unlikely(__pyx_t_6 == ((int)-1))) __PYX_ERR(0, 487, __pyx_L1_error)
+  __pyx_t_8 = __Pyx_PyObject_to_MemoryviewSlice_ds_int__const__(((PyObject *)__pyx_v_other), 0); if (unlikely(!__pyx_t_8.memview)) __PYX_ERR(0, 494, __pyx_L1_error)
+  __pyx_t_6 = ((struct __pyx_vtabstruct_11sat_toolkit_7formula__ClauseList *)__pyx_v_res->__pyx_vtab)->_add_clauses(__pyx_v_res, __pyx_t_8); if (unlikely(__pyx_t_6 == ((int)-1))) __PYX_ERR(0, 494, __pyx_L1_error)
   __PYX_XCLEAR_MEMVIEW(&__pyx_t_8, 1);
   __pyx_t_8.memview = NULL; __pyx_t_8.data = NULL;
 
-  /* "sat_toolkit/formula.pyx":488
+  /* "sat_toolkit/formula.pyx":495
  *         res._add_clauses(self)
  *         res._add_clauses(other)
  *         return res             # <<<<<<<<<<<<<<
  * 
  *     cdef int[::1] _get_clause(self, ssize_t idx):
  */
   __Pyx_XDECREF(__pyx_r);
   __Pyx_INCREF((PyObject *)__pyx_v_res);
   __pyx_r = ((PyObject *)__pyx_v_res);
   goto __pyx_L0;
 
-  /* "sat_toolkit/formula.pyx":482
+  /* "sat_toolkit/formula.pyx":489
  *         return self
  * 
  *     def __add__(self, _ClauseList other) -> Self:             # <<<<<<<<<<<<<<
  *         cdef _ClauseList res
  *         res = type(self).__new__(type(self))
  */
 
@@ -30459,15 +30596,15 @@
   __pyx_L0:;
   __Pyx_XDECREF((PyObject *)__pyx_v_res);
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "sat_toolkit/formula.pyx":490
+/* "sat_toolkit/formula.pyx":497
  *         return res
  * 
  *     cdef int[::1] _get_clause(self, ssize_t idx):             # <<<<<<<<<<<<<<
  *         cdef size_t begin, end, i
  *         cdef size_t numclauses = self._start_indices.size()
  */
 
@@ -30486,52 +30623,52 @@
   PyObject *__pyx_t_7 = NULL;
   __Pyx_memviewslice __pyx_t_8 = { 0, 0, { 0 }, { 0 }, { 0 } };
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("_get_clause", 1);
 
-  /* "sat_toolkit/formula.pyx":492
+  /* "sat_toolkit/formula.pyx":499
  *     cdef int[::1] _get_clause(self, ssize_t idx):
  *         cdef size_t begin, end, i
  *         cdef size_t numclauses = self._start_indices.size()             # <<<<<<<<<<<<<<
  * 
  *         if idx < 0:
  */
   __pyx_v_numclauses = __pyx_v_self->_start_indices.size();
 
-  /* "sat_toolkit/formula.pyx":494
+  /* "sat_toolkit/formula.pyx":501
  *         cdef size_t numclauses = self._start_indices.size()
  * 
  *         if idx < 0:             # <<<<<<<<<<<<<<
  *             idx += numclauses
  *         if idx < 0 or <size_t> idx >= numclauses:
  */
   __pyx_t_1 = (__pyx_v_idx < 0);
   if (__pyx_t_1) {
 
-    /* "sat_toolkit/formula.pyx":495
+    /* "sat_toolkit/formula.pyx":502
  * 
  *         if idx < 0:
  *             idx += numclauses             # <<<<<<<<<<<<<<
  *         if idx < 0 or <size_t> idx >= numclauses:
  *             raise IndexError('index out of range')
  */
     __pyx_v_idx = (__pyx_v_idx + __pyx_v_numclauses);
 
-    /* "sat_toolkit/formula.pyx":494
+    /* "sat_toolkit/formula.pyx":501
  *         cdef size_t numclauses = self._start_indices.size()
  * 
  *         if idx < 0:             # <<<<<<<<<<<<<<
  *             idx += numclauses
  *         if idx < 0 or <size_t> idx >= numclauses:
  */
   }
 
-  /* "sat_toolkit/formula.pyx":496
+  /* "sat_toolkit/formula.pyx":503
  *         if idx < 0:
  *             idx += numclauses
  *         if idx < 0 or <size_t> idx >= numclauses:             # <<<<<<<<<<<<<<
  *             raise IndexError('index out of range')
  * 
  */
   __pyx_t_2 = (__pyx_v_idx < 0);
@@ -30541,91 +30678,91 @@
     goto __pyx_L5_bool_binop_done;
   }
   __pyx_t_2 = (((size_t)__pyx_v_idx) >= __pyx_v_numclauses);
   __pyx_t_1 = __pyx_t_2;
   __pyx_L5_bool_binop_done:;
   if (unlikely(__pyx_t_1)) {
 
-    /* "sat_toolkit/formula.pyx":497
+    /* "sat_toolkit/formula.pyx":504
  *             idx += numclauses
  *         if idx < 0 or <size_t> idx >= numclauses:
  *             raise IndexError('index out of range')             # <<<<<<<<<<<<<<
  * 
  *         begin = self._start_indices[idx]
  */
-    __pyx_t_3 = __Pyx_PyObject_Call(__pyx_builtin_IndexError, __pyx_tuple__17, NULL); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 497, __pyx_L1_error)
+    __pyx_t_3 = __Pyx_PyObject_Call(__pyx_builtin_IndexError, __pyx_tuple__17, NULL); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 504, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
     __Pyx_Raise(__pyx_t_3, 0, 0, 0);
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-    __PYX_ERR(0, 497, __pyx_L1_error)
+    __PYX_ERR(0, 504, __pyx_L1_error)
 
-    /* "sat_toolkit/formula.pyx":496
+    /* "sat_toolkit/formula.pyx":503
  *         if idx < 0:
  *             idx += numclauses
  *         if idx < 0 or <size_t> idx >= numclauses:             # <<<<<<<<<<<<<<
  *             raise IndexError('index out of range')
  * 
  */
   }
 
-  /* "sat_toolkit/formula.pyx":499
+  /* "sat_toolkit/formula.pyx":506
  *             raise IndexError('index out of range')
  * 
  *         begin = self._start_indices[idx]             # <<<<<<<<<<<<<<
  *         end = self._start_indices[idx + 1] if <size_t> idx + 1 < numclauses else self._clauses.size()
  *         return (<int[:self._clauses.size()]> self._clauses.data())[begin:end - 1]
  */
   __pyx_v_begin = (__pyx_v_self->_start_indices[__pyx_v_idx]);
 
-  /* "sat_toolkit/formula.pyx":500
+  /* "sat_toolkit/formula.pyx":507
  * 
  *         begin = self._start_indices[idx]
  *         end = self._start_indices[idx + 1] if <size_t> idx + 1 < numclauses else self._clauses.size()             # <<<<<<<<<<<<<<
  *         return (<int[:self._clauses.size()]> self._clauses.data())[begin:end - 1]
  * 
  */
   __pyx_t_1 = ((((size_t)__pyx_v_idx) + 1) < __pyx_v_numclauses);
   if (__pyx_t_1) {
     __pyx_t_4 = (__pyx_v_self->_start_indices[(__pyx_v_idx + 1)]);
   } else {
     __pyx_t_4 = __pyx_v_self->_clauses.size();
   }
   __pyx_v_end = __pyx_t_4;
 
-  /* "sat_toolkit/formula.pyx":501
+  /* "sat_toolkit/formula.pyx":508
  *         begin = self._start_indices[idx]
  *         end = self._start_indices[idx + 1] if <size_t> idx + 1 < numclauses else self._clauses.size()
  *         return (<int[:self._clauses.size()]> self._clauses.data())[begin:end - 1]             # <<<<<<<<<<<<<<
  * 
  *     cdef _BaseClause get_clause(self, ssize_t idx):
  */
   __pyx_t_5 = __pyx_v_self->_clauses.data();
   if (!__pyx_t_5) {
     PyErr_SetString(PyExc_ValueError,"Cannot create cython.array from NULL pointer");
-    __PYX_ERR(0, 501, __pyx_L1_error)
+    __PYX_ERR(0, 508, __pyx_L1_error)
   }
-  __pyx_t_7 = __pyx_format_from_typeinfo(&__Pyx_TypeInfo_int); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 501, __pyx_L1_error)
+  __pyx_t_7 = __pyx_format_from_typeinfo(&__Pyx_TypeInfo_int); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 508, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_7);
-  __pyx_t_3 = Py_BuildValue((char*) "("  __PYX_BUILD_PY_SSIZE_T  ")", ((Py_ssize_t)__pyx_v_self->_clauses.size())); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 501, __pyx_L1_error)
+  __pyx_t_3 = Py_BuildValue((char*) "("  __PYX_BUILD_PY_SSIZE_T  ")", ((Py_ssize_t)__pyx_v_self->_clauses.size())); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 508, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  __pyx_t_6 = __pyx_array_new(__pyx_t_3, sizeof(int), PyBytes_AS_STRING(__pyx_t_7), (char *) "c", (char *) __pyx_t_5); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 501, __pyx_L1_error)
+  __pyx_t_6 = __pyx_array_new(__pyx_t_3, sizeof(int), PyBytes_AS_STRING(__pyx_t_7), (char *) "c", (char *) __pyx_t_5); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 508, __pyx_L1_error)
   __Pyx_GOTREF((PyObject *)__pyx_t_6);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-  __pyx_t_7 = __Pyx_PyObject_GetSlice(((PyObject *)__pyx_t_6), __pyx_v_begin, (__pyx_v_end - 1), NULL, NULL, NULL, 1, 1, 0); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 501, __pyx_L1_error)
+  __pyx_t_7 = __Pyx_PyObject_GetSlice(((PyObject *)__pyx_t_6), __pyx_v_begin, (__pyx_v_end - 1), NULL, NULL, NULL, 1, 1, 0); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 508, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_7);
   __Pyx_DECREF((PyObject *)__pyx_t_6); __pyx_t_6 = 0;
-  __pyx_t_8 = __Pyx_PyObject_to_MemoryviewSlice_dc_int(__pyx_t_7, PyBUF_WRITABLE); if (unlikely(!__pyx_t_8.memview)) __PYX_ERR(0, 501, __pyx_L1_error)
+  __pyx_t_8 = __Pyx_PyObject_to_MemoryviewSlice_dc_int(__pyx_t_7, PyBUF_WRITABLE); if (unlikely(!__pyx_t_8.memview)) __PYX_ERR(0, 508, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
   __pyx_r = __pyx_t_8;
   __pyx_t_8.memview = NULL;
   __pyx_t_8.data = NULL;
   goto __pyx_L0;
 
-  /* "sat_toolkit/formula.pyx":490
+  /* "sat_toolkit/formula.pyx":497
  *         return res
  * 
  *     cdef int[::1] _get_clause(self, ssize_t idx):             # <<<<<<<<<<<<<<
  *         cdef size_t begin, end, i
  *         cdef size_t numclauses = self._start_indices.size()
  */
 
@@ -30644,15 +30781,15 @@
     PyErr_SetString(PyExc_TypeError, "Memoryview return value is not initialized");
   }
   __pyx_L2:;
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "sat_toolkit/formula.pyx":503
+/* "sat_toolkit/formula.pyx":510
  *         return (<int[:self._clauses.size()]> self._clauses.data())[begin:end - 1]
  * 
  *     cdef _BaseClause get_clause(self, ssize_t idx):             # <<<<<<<<<<<<<<
  *         raise NotImplementedError('should be implemented by subclass')
  * 
  */
 
@@ -30661,28 +30798,28 @@
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("get_clause", 1);
 
-  /* "sat_toolkit/formula.pyx":504
+  /* "sat_toolkit/formula.pyx":511
  * 
  *     cdef _BaseClause get_clause(self, ssize_t idx):
  *         raise NotImplementedError('should be implemented by subclass')             # <<<<<<<<<<<<<<
  * 
  *     def __getitem__(self, ssize_t idx) -> Clause:
  */
-  __pyx_t_1 = __Pyx_PyObject_Call(__pyx_builtin_NotImplementedError, __pyx_tuple__24, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 504, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_Call(__pyx_builtin_NotImplementedError, __pyx_tuple__24, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 511, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_Raise(__pyx_t_1, 0, 0, 0);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  __PYX_ERR(0, 504, __pyx_L1_error)
+  __PYX_ERR(0, 511, __pyx_L1_error)
 
-  /* "sat_toolkit/formula.pyx":503
+  /* "sat_toolkit/formula.pyx":510
  *         return (<int[:self._clauses.size()]> self._clauses.data())[begin:end - 1]
  * 
  *     cdef _BaseClause get_clause(self, ssize_t idx):             # <<<<<<<<<<<<<<
  *         raise NotImplementedError('should be implemented by subclass')
  * 
  */
 
@@ -30692,15 +30829,15 @@
   __Pyx_AddTraceback("sat_toolkit.formula._ClauseList.get_clause", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __pyx_r = 0;
   __Pyx_XGIVEREF((PyObject *)__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "sat_toolkit/formula.pyx":506
+/* "sat_toolkit/formula.pyx":513
  *         raise NotImplementedError('should be implemented by subclass')
  * 
  *     def __getitem__(self, ssize_t idx) -> Clause:             # <<<<<<<<<<<<<<
  *         return self.get_clause(idx)
  * 
  */
 
@@ -30713,15 +30850,15 @@
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   PyObject *__pyx_r = 0;
   __Pyx_RefNannyDeclarations
   __Pyx_RefNannySetupContext("__getitem__ (wrapper)", 0);
   __pyx_kwvalues = __Pyx_KwValues_VARARGS(__pyx_args, __pyx_nargs);
   assert(__pyx_arg_idx); {
-    __pyx_v_idx = PyInt_AsSsize_t(__pyx_arg_idx); if (unlikely((__pyx_v_idx == (Py_ssize_t)-1) && PyErr_Occurred())) __PYX_ERR(0, 506, __pyx_L3_error)
+    __pyx_v_idx = PyInt_AsSsize_t(__pyx_arg_idx); if (unlikely((__pyx_v_idx == (Py_ssize_t)-1) && PyErr_Occurred())) __PYX_ERR(0, 513, __pyx_L3_error)
   }
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L3_error:;
   __Pyx_AddTraceback("sat_toolkit.formula._ClauseList.__getitem__", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __Pyx_RefNannyFinishContext();
   return NULL;
   __pyx_L4_argument_unpacking_done:;
@@ -30737,29 +30874,29 @@
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("__getitem__", 1);
 
-  /* "sat_toolkit/formula.pyx":507
+  /* "sat_toolkit/formula.pyx":514
  * 
  *     def __getitem__(self, ssize_t idx) -> Clause:
  *         return self.get_clause(idx)             # <<<<<<<<<<<<<<
  * 
  *     def __len__(self) -> int:
  */
   __Pyx_XDECREF(__pyx_r);
-  __pyx_t_1 = ((PyObject *)((struct __pyx_vtabstruct_11sat_toolkit_7formula__ClauseList *)__pyx_v_self->__pyx_vtab)->get_clause(__pyx_v_self, __pyx_v_idx)); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 507, __pyx_L1_error)
+  __pyx_t_1 = ((PyObject *)((struct __pyx_vtabstruct_11sat_toolkit_7formula__ClauseList *)__pyx_v_self->__pyx_vtab)->get_clause(__pyx_v_self, __pyx_v_idx)); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 514, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_r = __pyx_t_1;
   __pyx_t_1 = 0;
   goto __pyx_L0;
 
-  /* "sat_toolkit/formula.pyx":506
+  /* "sat_toolkit/formula.pyx":513
  *         raise NotImplementedError('should be implemented by subclass')
  * 
  *     def __getitem__(self, ssize_t idx) -> Clause:             # <<<<<<<<<<<<<<
  *         return self.get_clause(idx)
  * 
  */
 
@@ -30770,15 +30907,15 @@
   __pyx_r = NULL;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "sat_toolkit/formula.pyx":509
+/* "sat_toolkit/formula.pyx":516
  *         return self.get_clause(idx)
  * 
  *     def __len__(self) -> int:             # <<<<<<<<<<<<<<
  *         return self._start_indices.size()
  * 
  */
 
@@ -30796,39 +30933,39 @@
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
 static Py_ssize_t __pyx_pf_11sat_toolkit_7formula_11_ClauseList_20__len__(struct __pyx_obj_11sat_toolkit_7formula__ClauseList *__pyx_v_self) {
   Py_ssize_t __pyx_r;
 
-  /* "sat_toolkit/formula.pyx":510
+  /* "sat_toolkit/formula.pyx":517
  * 
  *     def __len__(self) -> int:
  *         return self._start_indices.size()             # <<<<<<<<<<<<<<
  * 
  *     def __iter__(self) -> Iterable[Clause]:
  */
   __pyx_r = __pyx_v_self->_start_indices.size();
   goto __pyx_L0;
 
-  /* "sat_toolkit/formula.pyx":509
+  /* "sat_toolkit/formula.pyx":516
  *         return self.get_clause(idx)
  * 
  *     def __len__(self) -> int:             # <<<<<<<<<<<<<<
  *         return self._start_indices.size()
  * 
  */
 
   /* function exit code */
   __pyx_L0:;
   return __pyx_r;
 }
 static PyObject *__pyx_gb_11sat_toolkit_7formula_11_ClauseList_24generator2(__pyx_CoroutineObject *__pyx_generator, CYTHON_UNUSED PyThreadState *__pyx_tstate, PyObject *__pyx_sent_value); /* proto */
 
-/* "sat_toolkit/formula.pyx":512
+/* "sat_toolkit/formula.pyx":519
  *         return self._start_indices.size()
  * 
  *     def __iter__(self) -> Iterable[Clause]:             # <<<<<<<<<<<<<<
  *         cdef size_t i = 0
  *         while i < self._start_indices.size():
  */
 
@@ -30855,23 +30992,23 @@
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("__iter__", 0);
   __pyx_cur_scope = (struct __pyx_obj_11sat_toolkit_7formula___pyx_scope_struct_2___iter__ *)__pyx_tp_new_11sat_toolkit_7formula___pyx_scope_struct_2___iter__(__pyx_ptype_11sat_toolkit_7formula___pyx_scope_struct_2___iter__, __pyx_empty_tuple, NULL);
   if (unlikely(!__pyx_cur_scope)) {
     __pyx_cur_scope = ((struct __pyx_obj_11sat_toolkit_7formula___pyx_scope_struct_2___iter__ *)Py_None);
     __Pyx_INCREF(Py_None);
-    __PYX_ERR(0, 512, __pyx_L1_error)
+    __PYX_ERR(0, 519, __pyx_L1_error)
   } else {
     __Pyx_GOTREF((PyObject *)__pyx_cur_scope);
   }
   __pyx_cur_scope->__pyx_v_self = __pyx_v_self;
   __Pyx_INCREF((PyObject *)__pyx_cur_scope->__pyx_v_self);
   __Pyx_GIVEREF((PyObject *)__pyx_cur_scope->__pyx_v_self);
   {
-    __pyx_CoroutineObject *gen = __Pyx_Generator_New((__pyx_coroutine_body_t) __pyx_gb_11sat_toolkit_7formula_11_ClauseList_24generator2, NULL, (PyObject *) __pyx_cur_scope, __pyx_n_s_iter, __pyx_n_s_ClauseList___iter, __pyx_n_s_sat_toolkit_formula); if (unlikely(!gen)) __PYX_ERR(0, 512, __pyx_L1_error)
+    __pyx_CoroutineObject *gen = __Pyx_Generator_New((__pyx_coroutine_body_t) __pyx_gb_11sat_toolkit_7formula_11_ClauseList_24generator2, NULL, (PyObject *) __pyx_cur_scope, __pyx_n_s_iter, __pyx_n_s_ClauseList___iter, __pyx_n_s_sat_toolkit_formula); if (unlikely(!gen)) __PYX_ERR(0, 519, __pyx_L1_error)
     __Pyx_DECREF(__pyx_cur_scope);
     __Pyx_RefNannyFinishContext();
     return (PyObject *) gen;
   }
 
   /* function exit code */
   __pyx_L1_error:;
@@ -30898,68 +31035,68 @@
     case 0: goto __pyx_L3_first_run;
     case 1: goto __pyx_L6_resume_from_yield;
     default: /* CPython raises the right error here */
     __Pyx_RefNannyFinishContext();
     return NULL;
   }
   __pyx_L3_first_run:;
-  if (unlikely(!__pyx_sent_value)) __PYX_ERR(0, 512, __pyx_L1_error)
+  if (unlikely(!__pyx_sent_value)) __PYX_ERR(0, 519, __pyx_L1_error)
 
-  /* "sat_toolkit/formula.pyx":513
+  /* "sat_toolkit/formula.pyx":520
  * 
  *     def __iter__(self) -> Iterable[Clause]:
  *         cdef size_t i = 0             # <<<<<<<<<<<<<<
  *         while i < self._start_indices.size():
  *             yield self.get_clause(i)
  */
   __pyx_cur_scope->__pyx_v_i = 0;
 
-  /* "sat_toolkit/formula.pyx":514
+  /* "sat_toolkit/formula.pyx":521
  *     def __iter__(self) -> Iterable[Clause]:
  *         cdef size_t i = 0
  *         while i < self._start_indices.size():             # <<<<<<<<<<<<<<
  *             yield self.get_clause(i)
  *             i += 1
  */
   while (1) {
     __pyx_t_1 = (__pyx_cur_scope->__pyx_v_i < __pyx_cur_scope->__pyx_v_self->_start_indices.size());
     if (!__pyx_t_1) break;
 
-    /* "sat_toolkit/formula.pyx":515
+    /* "sat_toolkit/formula.pyx":522
  *         cdef size_t i = 0
  *         while i < self._start_indices.size():
  *             yield self.get_clause(i)             # <<<<<<<<<<<<<<
  *             i += 1
  * 
  */
-    __pyx_t_2 = ((PyObject *)((struct __pyx_vtabstruct_11sat_toolkit_7formula__ClauseList *)__pyx_cur_scope->__pyx_v_self->__pyx_vtab)->get_clause(__pyx_cur_scope->__pyx_v_self, __pyx_cur_scope->__pyx_v_i)); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 515, __pyx_L1_error)
+    __pyx_t_2 = ((PyObject *)((struct __pyx_vtabstruct_11sat_toolkit_7formula__ClauseList *)__pyx_cur_scope->__pyx_v_self->__pyx_vtab)->get_clause(__pyx_cur_scope->__pyx_v_self, __pyx_cur_scope->__pyx_v_i)); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 522, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
     __pyx_r = __pyx_t_2;
     __pyx_t_2 = 0;
     __Pyx_XGIVEREF(__pyx_r);
     __Pyx_RefNannyFinishContext();
     __Pyx_Coroutine_ResetAndClearException(__pyx_generator);
     /* return from generator, yielding value */
     __pyx_generator->resume_label = 1;
     return __pyx_r;
     __pyx_L6_resume_from_yield:;
-    if (unlikely(!__pyx_sent_value)) __PYX_ERR(0, 515, __pyx_L1_error)
+    if (unlikely(!__pyx_sent_value)) __PYX_ERR(0, 522, __pyx_L1_error)
 
-    /* "sat_toolkit/formula.pyx":516
+    /* "sat_toolkit/formula.pyx":523
  *         while i < self._start_indices.size():
  *             yield self.get_clause(i)
  *             i += 1             # <<<<<<<<<<<<<<
  * 
  * 
  */
     __pyx_cur_scope->__pyx_v_i = (__pyx_cur_scope->__pyx_v_i + 1);
   }
   CYTHON_MAYBE_UNUSED_VAR(__pyx_cur_scope);
 
-  /* "sat_toolkit/formula.pyx":512
+  /* "sat_toolkit/formula.pyx":519
  *         return self._start_indices.size()
  * 
  *     def __iter__(self) -> Iterable[Clause]:             # <<<<<<<<<<<<<<
  *         cdef size_t i = 0
  *         while i < self._start_indices.size():
  */
 
@@ -30978,15 +31115,15 @@
   __pyx_generator->resume_label = -1;
   __Pyx_Coroutine_clear((PyObject*)__pyx_generator);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 static PyObject *__pyx_gb_11sat_toolkit_7formula_11_ClauseList_27generator3(__pyx_CoroutineObject *__pyx_generator, CYTHON_UNUSED PyThreadState *__pyx_tstate, PyObject *__pyx_sent_value); /* proto */
 
-/* "sat_toolkit/formula.pyx":519
+/* "sat_toolkit/formula.pyx":526
  * 
  * 
  *     def __reversed__(self) -> Iterable[Clause]:             # <<<<<<<<<<<<<<
  *         cdef size_t i
  *         for i in reversed(range(self._start_indices.size())):
  */
 
@@ -31040,23 +31177,23 @@
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("__reversed__", 0);
   __pyx_cur_scope = (struct __pyx_obj_11sat_toolkit_7formula___pyx_scope_struct_3___reversed__ *)__pyx_tp_new_11sat_toolkit_7formula___pyx_scope_struct_3___reversed__(__pyx_ptype_11sat_toolkit_7formula___pyx_scope_struct_3___reversed__, __pyx_empty_tuple, NULL);
   if (unlikely(!__pyx_cur_scope)) {
     __pyx_cur_scope = ((struct __pyx_obj_11sat_toolkit_7formula___pyx_scope_struct_3___reversed__ *)Py_None);
     __Pyx_INCREF(Py_None);
-    __PYX_ERR(0, 519, __pyx_L1_error)
+    __PYX_ERR(0, 526, __pyx_L1_error)
   } else {
     __Pyx_GOTREF((PyObject *)__pyx_cur_scope);
   }
   __pyx_cur_scope->__pyx_v_self = __pyx_v_self;
   __Pyx_INCREF((PyObject *)__pyx_cur_scope->__pyx_v_self);
   __Pyx_GIVEREF((PyObject *)__pyx_cur_scope->__pyx_v_self);
   {
-    __pyx_CoroutineObject *gen = __Pyx_Generator_New((__pyx_coroutine_body_t) __pyx_gb_11sat_toolkit_7formula_11_ClauseList_27generator3, __pyx_codeobj__25, (PyObject *) __pyx_cur_scope, __pyx_n_s_reversed_2, __pyx_n_s_ClauseList___reversed, __pyx_n_s_sat_toolkit_formula); if (unlikely(!gen)) __PYX_ERR(0, 519, __pyx_L1_error)
+    __pyx_CoroutineObject *gen = __Pyx_Generator_New((__pyx_coroutine_body_t) __pyx_gb_11sat_toolkit_7formula_11_ClauseList_27generator3, __pyx_codeobj__25, (PyObject *) __pyx_cur_scope, __pyx_n_s_reversed_2, __pyx_n_s_ClauseList___reversed, __pyx_n_s_sat_toolkit_formula); if (unlikely(!gen)) __PYX_ERR(0, 526, __pyx_L1_error)
     __Pyx_DECREF(__pyx_cur_scope);
     __Pyx_RefNannyFinishContext();
     return (PyObject *) gen;
   }
 
   /* function exit code */
   __pyx_L1_error:;
@@ -31083,51 +31220,51 @@
     case 0: goto __pyx_L3_first_run;
     case 1: goto __pyx_L6_resume_from_yield;
     default: /* CPython raises the right error here */
     __Pyx_RefNannyFinishContext();
     return NULL;
   }
   __pyx_L3_first_run:;
-  if (unlikely(!__pyx_sent_value)) __PYX_ERR(0, 519, __pyx_L1_error)
+  if (unlikely(!__pyx_sent_value)) __PYX_ERR(0, 526, __pyx_L1_error)
 
-  /* "sat_toolkit/formula.pyx":521
+  /* "sat_toolkit/formula.pyx":528
  *     def __reversed__(self) -> Iterable[Clause]:
  *         cdef size_t i
  *         for i in reversed(range(self._start_indices.size())):             # <<<<<<<<<<<<<<
  *             yield self.get_clause(i)
  * 
  */
   for (__pyx_t_1 = __pyx_cur_scope->__pyx_v_self->_start_indices.size()-1 + 1; __pyx_t_1 >= 0 + 1; ) { __pyx_t_1-=1;
     __pyx_cur_scope->__pyx_v_i = __pyx_t_1;
 
-    /* "sat_toolkit/formula.pyx":522
+    /* "sat_toolkit/formula.pyx":529
  *         cdef size_t i
  *         for i in reversed(range(self._start_indices.size())):
  *             yield self.get_clause(i)             # <<<<<<<<<<<<<<
  * 
  * 
  */
-    __pyx_t_2 = ((PyObject *)((struct __pyx_vtabstruct_11sat_toolkit_7formula__ClauseList *)__pyx_cur_scope->__pyx_v_self->__pyx_vtab)->get_clause(__pyx_cur_scope->__pyx_v_self, __pyx_cur_scope->__pyx_v_i)); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 522, __pyx_L1_error)
+    __pyx_t_2 = ((PyObject *)((struct __pyx_vtabstruct_11sat_toolkit_7formula__ClauseList *)__pyx_cur_scope->__pyx_v_self->__pyx_vtab)->get_clause(__pyx_cur_scope->__pyx_v_self, __pyx_cur_scope->__pyx_v_i)); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 529, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
     __pyx_r = __pyx_t_2;
     __pyx_t_2 = 0;
     __pyx_cur_scope->__pyx_t_0 = __pyx_t_1;
     __Pyx_XGIVEREF(__pyx_r);
     __Pyx_RefNannyFinishContext();
     __Pyx_Coroutine_ResetAndClearException(__pyx_generator);
     /* return from generator, yielding value */
     __pyx_generator->resume_label = 1;
     return __pyx_r;
     __pyx_L6_resume_from_yield:;
     __pyx_t_1 = __pyx_cur_scope->__pyx_t_0;
-    if (unlikely(!__pyx_sent_value)) __PYX_ERR(0, 522, __pyx_L1_error)
+    if (unlikely(!__pyx_sent_value)) __PYX_ERR(0, 529, __pyx_L1_error)
   }
   CYTHON_MAYBE_UNUSED_VAR(__pyx_cur_scope);
 
-  /* "sat_toolkit/formula.pyx":519
+  /* "sat_toolkit/formula.pyx":526
  * 
  * 
  *     def __reversed__(self) -> Iterable[Clause]:             # <<<<<<<<<<<<<<
  *         cdef size_t i
  *         for i in reversed(range(self._start_indices.size())):
  */
 
@@ -31145,15 +31282,15 @@
   #endif
   __pyx_generator->resume_label = -1;
   __Pyx_Coroutine_clear((PyObject*)__pyx_generator);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "sat_toolkit/formula.pyx":525
+/* "sat_toolkit/formula.pyx":532
  * 
  * 
  *     def __eq__(self, other) -> bool:             # <<<<<<<<<<<<<<
  *         if not isinstance(other, type(self)):
  *             return False
  */
 
@@ -31180,164 +31317,164 @@
   int __pyx_t_2;
   PyObject *__pyx_t_3 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("__eq__", 1);
 
-  /* "sat_toolkit/formula.pyx":526
+  /* "sat_toolkit/formula.pyx":533
  * 
  *     def __eq__(self, other) -> bool:
  *         if not isinstance(other, type(self)):             # <<<<<<<<<<<<<<
  *             return False
  * 
  */
-  __pyx_t_1 = PyObject_IsInstance(__pyx_v_other, ((PyObject *)Py_TYPE(((PyObject *)__pyx_v_self)))); if (unlikely(__pyx_t_1 == ((int)-1))) __PYX_ERR(0, 526, __pyx_L1_error)
+  __pyx_t_1 = PyObject_IsInstance(__pyx_v_other, ((PyObject *)Py_TYPE(((PyObject *)__pyx_v_self)))); if (unlikely(__pyx_t_1 == ((int)-1))) __PYX_ERR(0, 533, __pyx_L1_error)
   __pyx_t_2 = (!__pyx_t_1);
   if (__pyx_t_2) {
 
-    /* "sat_toolkit/formula.pyx":527
+    /* "sat_toolkit/formula.pyx":534
  *     def __eq__(self, other) -> bool:
  *         if not isinstance(other, type(self)):
  *             return False             # <<<<<<<<<<<<<<
  * 
  *         cdef _ClauseList c_other = <_ClauseList> other
  */
     __Pyx_XDECREF(__pyx_r);
     __Pyx_INCREF(Py_False);
     __pyx_r = Py_False;
     goto __pyx_L0;
 
-    /* "sat_toolkit/formula.pyx":526
+    /* "sat_toolkit/formula.pyx":533
  * 
  *     def __eq__(self, other) -> bool:
  *         if not isinstance(other, type(self)):             # <<<<<<<<<<<<<<
  *             return False
  * 
  */
   }
 
-  /* "sat_toolkit/formula.pyx":529
+  /* "sat_toolkit/formula.pyx":536
  *             return False
  * 
  *         cdef _ClauseList c_other = <_ClauseList> other             # <<<<<<<<<<<<<<
  * 
  *         if self.nvars != c_other.nvars:
  */
   __pyx_t_3 = __pyx_v_other;
   __Pyx_INCREF(__pyx_t_3);
   __pyx_v_c_other = ((struct __pyx_obj_11sat_toolkit_7formula__ClauseList *)__pyx_t_3);
   __pyx_t_3 = 0;
 
-  /* "sat_toolkit/formula.pyx":531
+  /* "sat_toolkit/formula.pyx":538
  *         cdef _ClauseList c_other = <_ClauseList> other
  * 
  *         if self.nvars != c_other.nvars:             # <<<<<<<<<<<<<<
  *             return False
  *         if self._start_indices != c_other._start_indices:
  */
   __pyx_t_2 = (__pyx_v_self->nvars != __pyx_v_c_other->nvars);
   if (__pyx_t_2) {
 
-    /* "sat_toolkit/formula.pyx":532
+    /* "sat_toolkit/formula.pyx":539
  * 
  *         if self.nvars != c_other.nvars:
  *             return False             # <<<<<<<<<<<<<<
  *         if self._start_indices != c_other._start_indices:
  *             return False
  */
     __Pyx_XDECREF(__pyx_r);
     __Pyx_INCREF(Py_False);
     __pyx_r = Py_False;
     goto __pyx_L0;
 
-    /* "sat_toolkit/formula.pyx":531
+    /* "sat_toolkit/formula.pyx":538
  *         cdef _ClauseList c_other = <_ClauseList> other
  * 
  *         if self.nvars != c_other.nvars:             # <<<<<<<<<<<<<<
  *             return False
  *         if self._start_indices != c_other._start_indices:
  */
   }
 
-  /* "sat_toolkit/formula.pyx":533
+  /* "sat_toolkit/formula.pyx":540
  *         if self.nvars != c_other.nvars:
  *             return False
  *         if self._start_indices != c_other._start_indices:             # <<<<<<<<<<<<<<
  *             return False
  *         if self._clauses != c_other._clauses:
  */
   __pyx_t_2 = (__pyx_v_self->_start_indices != __pyx_v_c_other->_start_indices);
   if (__pyx_t_2) {
 
-    /* "sat_toolkit/formula.pyx":534
+    /* "sat_toolkit/formula.pyx":541
  *             return False
  *         if self._start_indices != c_other._start_indices:
  *             return False             # <<<<<<<<<<<<<<
  *         if self._clauses != c_other._clauses:
  *             return False
  */
     __Pyx_XDECREF(__pyx_r);
     __Pyx_INCREF(Py_False);
     __pyx_r = Py_False;
     goto __pyx_L0;
 
-    /* "sat_toolkit/formula.pyx":533
+    /* "sat_toolkit/formula.pyx":540
  *         if self.nvars != c_other.nvars:
  *             return False
  *         if self._start_indices != c_other._start_indices:             # <<<<<<<<<<<<<<
  *             return False
  *         if self._clauses != c_other._clauses:
  */
   }
 
-  /* "sat_toolkit/formula.pyx":535
+  /* "sat_toolkit/formula.pyx":542
  *         if self._start_indices != c_other._start_indices:
  *             return False
  *         if self._clauses != c_other._clauses:             # <<<<<<<<<<<<<<
  *             return False
  *         return True
  */
   __pyx_t_2 = (__pyx_v_self->_clauses != __pyx_v_c_other->_clauses);
   if (__pyx_t_2) {
 
-    /* "sat_toolkit/formula.pyx":536
+    /* "sat_toolkit/formula.pyx":543
  *             return False
  *         if self._clauses != c_other._clauses:
  *             return False             # <<<<<<<<<<<<<<
  *         return True
  * 
  */
     __Pyx_XDECREF(__pyx_r);
     __Pyx_INCREF(Py_False);
     __pyx_r = Py_False;
     goto __pyx_L0;
 
-    /* "sat_toolkit/formula.pyx":535
+    /* "sat_toolkit/formula.pyx":542
  *         if self._start_indices != c_other._start_indices:
  *             return False
  *         if self._clauses != c_other._clauses:             # <<<<<<<<<<<<<<
  *             return False
  *         return True
  */
   }
 
-  /* "sat_toolkit/formula.pyx":537
+  /* "sat_toolkit/formula.pyx":544
  *         if self._clauses != c_other._clauses:
  *             return False
  *         return True             # <<<<<<<<<<<<<<
  * 
  *     cdef int _check_clause_type(self, _BaseClause clause) noexcept:
  */
   __Pyx_XDECREF(__pyx_r);
   __Pyx_INCREF(Py_True);
   __pyx_r = Py_True;
   goto __pyx_L0;
 
-  /* "sat_toolkit/formula.pyx":525
+  /* "sat_toolkit/formula.pyx":532
  * 
  * 
  *     def __eq__(self, other) -> bool:             # <<<<<<<<<<<<<<
  *         if not isinstance(other, type(self)):
  *             return False
  */
 
@@ -31349,48 +31486,48 @@
   __pyx_L0:;
   __Pyx_XDECREF((PyObject *)__pyx_v_c_other);
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "sat_toolkit/formula.pyx":539
+/* "sat_toolkit/formula.pyx":546
  *         return True
  * 
  *     cdef int _check_clause_type(self, _BaseClause clause) noexcept:             # <<<<<<<<<<<<<<
  *         abort()
  * 
  */
 
 static int __pyx_f_11sat_toolkit_7formula_11_ClauseList__check_clause_type(CYTHON_UNUSED struct __pyx_obj_11sat_toolkit_7formula__ClauseList *__pyx_v_self, CYTHON_UNUSED struct __pyx_obj_11sat_toolkit_7formula__BaseClause *__pyx_v_clause) {
   int __pyx_r;
 
-  /* "sat_toolkit/formula.pyx":540
+  /* "sat_toolkit/formula.pyx":547
  * 
  *     cdef int _check_clause_type(self, _BaseClause clause) noexcept:
  *         abort()             # <<<<<<<<<<<<<<
  * 
  *     cdef int _compare_clause(self, size_t idx, _BaseClause other) except -1 nogil:
  */
   abort();
 
-  /* "sat_toolkit/formula.pyx":539
+  /* "sat_toolkit/formula.pyx":546
  *         return True
  * 
  *     cdef int _check_clause_type(self, _BaseClause clause) noexcept:             # <<<<<<<<<<<<<<
  *         abort()
  * 
  */
 
   /* function exit code */
   __pyx_r = 0;
   return __pyx_r;
 }
 
-/* "sat_toolkit/formula.pyx":542
+/* "sat_toolkit/formula.pyx":549
  *         abort()
  * 
  *     cdef int _compare_clause(self, size_t idx, _BaseClause other) except -1 nogil:             # <<<<<<<<<<<<<<
  *         cdef size_t begin, end, i
  *         cdef size_t numclauses = self._start_indices.size()
  */
 
@@ -31410,61 +31547,61 @@
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   #ifdef WITH_THREAD
   PyGILState_STATE __pyx_gilstate_save;
   #endif
   __Pyx_RefNannySetupContext("_compare_clause", 1);
 
-  /* "sat_toolkit/formula.pyx":544
+  /* "sat_toolkit/formula.pyx":551
  *     cdef int _compare_clause(self, size_t idx, _BaseClause other) except -1 nogil:
  *         cdef size_t begin, end, i
  *         cdef size_t numclauses = self._start_indices.size()             # <<<<<<<<<<<<<<
  * 
  *         if idx >= numclauses:
  */
   __pyx_v_numclauses = __pyx_v_self->_start_indices.size();
 
-  /* "sat_toolkit/formula.pyx":546
+  /* "sat_toolkit/formula.pyx":553
  *         cdef size_t numclauses = self._start_indices.size()
  * 
  *         if idx >= numclauses:             # <<<<<<<<<<<<<<
  *             with gil:
  *                 raise IndexError('index out of range')
  */
   __pyx_t_1 = (__pyx_v_idx >= __pyx_v_numclauses);
   if (unlikely(__pyx_t_1)) {
 
-    /* "sat_toolkit/formula.pyx":547
+    /* "sat_toolkit/formula.pyx":554
  * 
  *         if idx >= numclauses:
  *             with gil:             # <<<<<<<<<<<<<<
  *                 raise IndexError('index out of range')
  * 
  */
     {
         #ifdef WITH_THREAD
         PyGILState_STATE __pyx_gilstate_save = __Pyx_PyGILState_Ensure();
         #endif
         /*try:*/ {
 
-          /* "sat_toolkit/formula.pyx":548
+          /* "sat_toolkit/formula.pyx":555
  *         if idx >= numclauses:
  *             with gil:
  *                 raise IndexError('index out of range')             # <<<<<<<<<<<<<<
  * 
  *         begin = self._start_indices[idx]
  */
-          __pyx_t_2 = __Pyx_PyObject_Call(__pyx_builtin_IndexError, __pyx_tuple__17, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 548, __pyx_L5_error)
+          __pyx_t_2 = __Pyx_PyObject_Call(__pyx_builtin_IndexError, __pyx_tuple__17, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 555, __pyx_L5_error)
           __Pyx_GOTREF(__pyx_t_2);
           __Pyx_Raise(__pyx_t_2, 0, 0, 0);
           __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-          __PYX_ERR(0, 548, __pyx_L5_error)
+          __PYX_ERR(0, 555, __pyx_L5_error)
         }
 
-        /* "sat_toolkit/formula.pyx":547
+        /* "sat_toolkit/formula.pyx":554
  * 
  *         if idx >= numclauses:
  *             with gil:             # <<<<<<<<<<<<<<
  *                 raise IndexError('index out of range')
  * 
  */
         /*finally:*/ {
@@ -31473,129 +31610,129 @@
             __Pyx_PyGILState_Release(__pyx_gilstate_save);
             #endif
             goto __pyx_L1_error;
           }
         }
     }
 
-    /* "sat_toolkit/formula.pyx":546
+    /* "sat_toolkit/formula.pyx":553
  *         cdef size_t numclauses = self._start_indices.size()
  * 
  *         if idx >= numclauses:             # <<<<<<<<<<<<<<
  *             with gil:
  *                 raise IndexError('index out of range')
  */
   }
 
-  /* "sat_toolkit/formula.pyx":550
+  /* "sat_toolkit/formula.pyx":557
  *                 raise IndexError('index out of range')
  * 
  *         begin = self._start_indices[idx]             # <<<<<<<<<<<<<<
  *         end = self._start_indices[idx + 1] if <size_t> idx + 1 < numclauses else self._clauses.size()
  * 
  */
   __pyx_v_begin = (__pyx_v_self->_start_indices[__pyx_v_idx]);
 
-  /* "sat_toolkit/formula.pyx":551
+  /* "sat_toolkit/formula.pyx":558
  * 
  *         begin = self._start_indices[idx]
  *         end = self._start_indices[idx + 1] if <size_t> idx + 1 < numclauses else self._clauses.size()             # <<<<<<<<<<<<<<
  * 
  *         if end - 1 - begin != other._clause.size():
  */
   __pyx_t_1 = ((((size_t)__pyx_v_idx) + 1) < __pyx_v_numclauses);
   if (__pyx_t_1) {
     __pyx_t_3 = (__pyx_v_self->_start_indices[(__pyx_v_idx + 1)]);
   } else {
     __pyx_t_3 = __pyx_v_self->_clauses.size();
   }
   __pyx_v_end = __pyx_t_3;
 
-  /* "sat_toolkit/formula.pyx":553
+  /* "sat_toolkit/formula.pyx":560
  *         end = self._start_indices[idx + 1] if <size_t> idx + 1 < numclauses else self._clauses.size()
  * 
  *         if end - 1 - begin != other._clause.size():             # <<<<<<<<<<<<<<
  *             return 0
  * 
  */
   __pyx_t_1 = (((__pyx_v_end - 1) - __pyx_v_begin) != __pyx_v_other->_clause.size());
   if (__pyx_t_1) {
 
-    /* "sat_toolkit/formula.pyx":554
+    /* "sat_toolkit/formula.pyx":561
  * 
  *         if end - 1 - begin != other._clause.size():
  *             return 0             # <<<<<<<<<<<<<<
  * 
  *         for i in range(end - 1 - begin):
  */
     __pyx_r = 0;
     goto __pyx_L0;
 
-    /* "sat_toolkit/formula.pyx":553
+    /* "sat_toolkit/formula.pyx":560
  *         end = self._start_indices[idx + 1] if <size_t> idx + 1 < numclauses else self._clauses.size()
  * 
  *         if end - 1 - begin != other._clause.size():             # <<<<<<<<<<<<<<
  *             return 0
  * 
  */
   }
 
-  /* "sat_toolkit/formula.pyx":556
+  /* "sat_toolkit/formula.pyx":563
  *             return 0
  * 
  *         for i in range(end - 1 - begin):             # <<<<<<<<<<<<<<
  *             if self._clauses[begin + i] != other._clause[i]:
  *                 return 0
  */
   __pyx_t_3 = ((__pyx_v_end - 1) - __pyx_v_begin);
   __pyx_t_4 = __pyx_t_3;
   for (__pyx_t_5 = 0; __pyx_t_5 < __pyx_t_4; __pyx_t_5+=1) {
     __pyx_v_i = __pyx_t_5;
 
-    /* "sat_toolkit/formula.pyx":557
+    /* "sat_toolkit/formula.pyx":564
  * 
  *         for i in range(end - 1 - begin):
  *             if self._clauses[begin + i] != other._clause[i]:             # <<<<<<<<<<<<<<
  *                 return 0
  * 
  */
     __pyx_t_1 = ((__pyx_v_self->_clauses[(__pyx_v_begin + __pyx_v_i)]) != (__pyx_v_other->_clause[__pyx_v_i]));
     if (__pyx_t_1) {
 
-      /* "sat_toolkit/formula.pyx":558
+      /* "sat_toolkit/formula.pyx":565
  *         for i in range(end - 1 - begin):
  *             if self._clauses[begin + i] != other._clause[i]:
  *                 return 0             # <<<<<<<<<<<<<<
  * 
  *         return 1
  */
       __pyx_r = 0;
       goto __pyx_L0;
 
-      /* "sat_toolkit/formula.pyx":557
+      /* "sat_toolkit/formula.pyx":564
  * 
  *         for i in range(end - 1 - begin):
  *             if self._clauses[begin + i] != other._clause[i]:             # <<<<<<<<<<<<<<
  *                 return 0
  * 
  */
     }
   }
 
-  /* "sat_toolkit/formula.pyx":560
+  /* "sat_toolkit/formula.pyx":567
  *                 return 0
  * 
  *         return 1             # <<<<<<<<<<<<<<
  * 
  *     def __contains__(self, needle) -> bool:
  */
   __pyx_r = 1;
   goto __pyx_L0;
 
-  /* "sat_toolkit/formula.pyx":542
+  /* "sat_toolkit/formula.pyx":549
  *         abort()
  * 
  *     cdef int _compare_clause(self, size_t idx, _BaseClause other) except -1 nogil:             # <<<<<<<<<<<<<<
  *         cdef size_t begin, end, i
  *         cdef size_t numclauses = self._start_indices.size()
  */
 
@@ -31611,15 +31748,15 @@
   __Pyx_PyGILState_Release(__pyx_gilstate_save);
   #endif
   __pyx_L0:;
   __Pyx_RefNannyFinishContextNogil()
   return __pyx_r;
 }
 
-/* "sat_toolkit/formula.pyx":562
+/* "sat_toolkit/formula.pyx":569
  *         return 1
  * 
  *     def __contains__(self, needle) -> bool:             # <<<<<<<<<<<<<<
  *         if not self._check_clause_type(needle):
  *             return False
  */
 
@@ -31650,58 +31787,58 @@
   size_t __pyx_t_5;
   int __pyx_t_6;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("__contains__", 1);
 
-  /* "sat_toolkit/formula.pyx":563
+  /* "sat_toolkit/formula.pyx":570
  * 
  *     def __contains__(self, needle) -> bool:
  *         if not self._check_clause_type(needle):             # <<<<<<<<<<<<<<
  *             return False
  * 
  */
-  if (!(likely(((__pyx_v_needle) == Py_None) || likely(__Pyx_TypeTest(__pyx_v_needle, __pyx_ptype_11sat_toolkit_7formula__BaseClause))))) __PYX_ERR(0, 563, __pyx_L1_error)
+  if (!(likely(((__pyx_v_needle) == Py_None) || likely(__Pyx_TypeTest(__pyx_v_needle, __pyx_ptype_11sat_toolkit_7formula__BaseClause))))) __PYX_ERR(0, 570, __pyx_L1_error)
   __pyx_t_1 = (!(((struct __pyx_vtabstruct_11sat_toolkit_7formula__ClauseList *)__pyx_v_self->__pyx_vtab)->_check_clause_type(__pyx_v_self, ((struct __pyx_obj_11sat_toolkit_7formula__BaseClause *)__pyx_v_needle)) != 0));
   if (__pyx_t_1) {
 
-    /* "sat_toolkit/formula.pyx":564
+    /* "sat_toolkit/formula.pyx":571
  *     def __contains__(self, needle) -> bool:
  *         if not self._check_clause_type(needle):
  *             return False             # <<<<<<<<<<<<<<
  * 
  *         cdef size_t i
  */
     __pyx_r = 0;
     goto __pyx_L0;
 
-    /* "sat_toolkit/formula.pyx":563
+    /* "sat_toolkit/formula.pyx":570
  * 
  *     def __contains__(self, needle) -> bool:
  *         if not self._check_clause_type(needle):             # <<<<<<<<<<<<<<
  *             return False
  * 
  */
   }
 
-  /* "sat_toolkit/formula.pyx":569
+  /* "sat_toolkit/formula.pyx":576
  *         cdef _BaseClause c_needle
  * 
  *         c_needle = needle             # <<<<<<<<<<<<<<
  * 
  *         with nogil:
  */
-  if (!(likely(((__pyx_v_needle) == Py_None) || likely(__Pyx_TypeTest(__pyx_v_needle, __pyx_ptype_11sat_toolkit_7formula__BaseClause))))) __PYX_ERR(0, 569, __pyx_L1_error)
+  if (!(likely(((__pyx_v_needle) == Py_None) || likely(__Pyx_TypeTest(__pyx_v_needle, __pyx_ptype_11sat_toolkit_7formula__BaseClause))))) __PYX_ERR(0, 576, __pyx_L1_error)
   __pyx_t_2 = __pyx_v_needle;
   __Pyx_INCREF(__pyx_t_2);
   __pyx_v_c_needle = ((struct __pyx_obj_11sat_toolkit_7formula__BaseClause *)__pyx_t_2);
   __pyx_t_2 = 0;
 
-  /* "sat_toolkit/formula.pyx":571
+  /* "sat_toolkit/formula.pyx":578
  *         c_needle = needle
  * 
  *         with nogil:             # <<<<<<<<<<<<<<
  *             for i in range(self._start_indices.size()):
  *                 if self._compare_clause(i, c_needle):
  */
   {
@@ -31709,59 +31846,59 @@
       PyThreadState *_save;
       _save = NULL;
       Py_UNBLOCK_THREADS
       __Pyx_FastGIL_Remember();
       #endif
       /*try:*/ {
 
-        /* "sat_toolkit/formula.pyx":572
+        /* "sat_toolkit/formula.pyx":579
  * 
  *         with nogil:
  *             for i in range(self._start_indices.size()):             # <<<<<<<<<<<<<<
  *                 if self._compare_clause(i, c_needle):
  *                     return True
  */
         __pyx_t_3 = __pyx_v_self->_start_indices.size();
         __pyx_t_4 = __pyx_t_3;
         for (__pyx_t_5 = 0; __pyx_t_5 < __pyx_t_4; __pyx_t_5+=1) {
           __pyx_v_i = __pyx_t_5;
 
-          /* "sat_toolkit/formula.pyx":573
+          /* "sat_toolkit/formula.pyx":580
  *         with nogil:
  *             for i in range(self._start_indices.size()):
  *                 if self._compare_clause(i, c_needle):             # <<<<<<<<<<<<<<
  *                     return True
  * 
  */
-          __pyx_t_6 = ((struct __pyx_vtabstruct_11sat_toolkit_7formula__ClauseList *)__pyx_v_self->__pyx_vtab)->_compare_clause(__pyx_v_self, __pyx_v_i, __pyx_v_c_needle); if (unlikely(__pyx_t_6 == ((int)-1))) __PYX_ERR(0, 573, __pyx_L5_error)
+          __pyx_t_6 = ((struct __pyx_vtabstruct_11sat_toolkit_7formula__ClauseList *)__pyx_v_self->__pyx_vtab)->_compare_clause(__pyx_v_self, __pyx_v_i, __pyx_v_c_needle); if (unlikely(__pyx_t_6 == ((int)-1))) __PYX_ERR(0, 580, __pyx_L5_error)
           __pyx_t_1 = (__pyx_t_6 != 0);
           if (__pyx_t_1) {
 
-            /* "sat_toolkit/formula.pyx":574
+            /* "sat_toolkit/formula.pyx":581
  *             for i in range(self._start_indices.size()):
  *                 if self._compare_clause(i, c_needle):
  *                     return True             # <<<<<<<<<<<<<<
  * 
  *     def count(self, needle) -> bool:
  */
             __pyx_r = 1;
             goto __pyx_L4_return;
 
-            /* "sat_toolkit/formula.pyx":573
+            /* "sat_toolkit/formula.pyx":580
  *         with nogil:
  *             for i in range(self._start_indices.size()):
  *                 if self._compare_clause(i, c_needle):             # <<<<<<<<<<<<<<
  *                     return True
  * 
  */
           }
         }
       }
 
-      /* "sat_toolkit/formula.pyx":571
+      /* "sat_toolkit/formula.pyx":578
  *         c_needle = needle
  * 
  *         with nogil:             # <<<<<<<<<<<<<<
  *             for i in range(self._start_indices.size()):
  *                 if self._compare_clause(i, c_needle):
  */
       /*finally:*/ {
@@ -31786,15 +31923,15 @@
           #endif
           goto __pyx_L1_error;
         }
         __pyx_L6:;
       }
   }
 
-  /* "sat_toolkit/formula.pyx":562
+  /* "sat_toolkit/formula.pyx":569
  *         return 1
  * 
  *     def __contains__(self, needle) -> bool:             # <<<<<<<<<<<<<<
  *         if not self._check_clause_type(needle):
  *             return False
  */
 
@@ -31807,15 +31944,15 @@
   __pyx_r = -1;
   __pyx_L0:;
   __Pyx_XDECREF((PyObject *)__pyx_v_c_needle);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "sat_toolkit/formula.pyx":576
+/* "sat_toolkit/formula.pyx":583
  *                     return True
  * 
  *     def count(self, needle) -> bool:             # <<<<<<<<<<<<<<
  *         if not self._check_clause_type(needle):
  *             return False
  */
 
@@ -31869,31 +32006,31 @@
       kw_args = __Pyx_NumKwargs_FASTCALL(__pyx_kwds);
       switch (__pyx_nargs) {
         case  0:
         if (likely((values[0] = __Pyx_GetKwValue_FASTCALL(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_needle)) != 0)) {
           (void)__Pyx_Arg_NewRef_FASTCALL(values[0]);
           kw_args--;
         }
-        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 576, __pyx_L3_error)
+        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 583, __pyx_L3_error)
         else goto __pyx_L5_argtuple_error;
       }
       if (unlikely(kw_args > 0)) {
         const Py_ssize_t kwd_pos_args = __pyx_nargs;
-        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values + 0, kwd_pos_args, "count") < 0)) __PYX_ERR(0, 576, __pyx_L3_error)
+        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values + 0, kwd_pos_args, "count") < 0)) __PYX_ERR(0, 583, __pyx_L3_error)
       }
     } else if (unlikely(__pyx_nargs != 1)) {
       goto __pyx_L5_argtuple_error;
     } else {
       values[0] = __Pyx_Arg_FASTCALL(__pyx_args, 0);
     }
     __pyx_v_needle = values[0];
   }
   goto __pyx_L6_skip;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("count", 1, 1, 1, __pyx_nargs); __PYX_ERR(0, 576, __pyx_L3_error)
+  __Pyx_RaiseArgtupleInvalid("count", 1, 1, 1, __pyx_nargs); __PYX_ERR(0, 583, __pyx_L3_error)
   __pyx_L6_skip:;
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L3_error:;
   {
     Py_ssize_t __pyx_temp;
     for (__pyx_temp=0; __pyx_temp < (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
       __Pyx_Arg_XDECREF_FASTCALL(values[__pyx_temp]);
@@ -31929,69 +32066,69 @@
   size_t __pyx_t_5;
   int __pyx_t_6;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("count", 1);
 
-  /* "sat_toolkit/formula.pyx":577
+  /* "sat_toolkit/formula.pyx":584
  * 
  *     def count(self, needle) -> bool:
  *         if not self._check_clause_type(needle):             # <<<<<<<<<<<<<<
  *             return False
  * 
  */
-  if (!(likely(((__pyx_v_needle) == Py_None) || likely(__Pyx_TypeTest(__pyx_v_needle, __pyx_ptype_11sat_toolkit_7formula__BaseClause))))) __PYX_ERR(0, 577, __pyx_L1_error)
+  if (!(likely(((__pyx_v_needle) == Py_None) || likely(__Pyx_TypeTest(__pyx_v_needle, __pyx_ptype_11sat_toolkit_7formula__BaseClause))))) __PYX_ERR(0, 584, __pyx_L1_error)
   __pyx_t_1 = (!(((struct __pyx_vtabstruct_11sat_toolkit_7formula__ClauseList *)__pyx_v_self->__pyx_vtab)->_check_clause_type(__pyx_v_self, ((struct __pyx_obj_11sat_toolkit_7formula__BaseClause *)__pyx_v_needle)) != 0));
   if (__pyx_t_1) {
 
-    /* "sat_toolkit/formula.pyx":578
+    /* "sat_toolkit/formula.pyx":585
  *     def count(self, needle) -> bool:
  *         if not self._check_clause_type(needle):
  *             return False             # <<<<<<<<<<<<<<
  * 
  *         cdef size_t i, count = 0
  */
     __Pyx_XDECREF(__pyx_r);
     __Pyx_INCREF(Py_False);
     __pyx_r = Py_False;
     goto __pyx_L0;
 
-    /* "sat_toolkit/formula.pyx":577
+    /* "sat_toolkit/formula.pyx":584
  * 
  *     def count(self, needle) -> bool:
  *         if not self._check_clause_type(needle):             # <<<<<<<<<<<<<<
  *             return False
  * 
  */
   }
 
-  /* "sat_toolkit/formula.pyx":580
+  /* "sat_toolkit/formula.pyx":587
  *             return False
  * 
  *         cdef size_t i, count = 0             # <<<<<<<<<<<<<<
  *         cdef _BaseClause c_needle
  * 
  */
   __pyx_v_count = 0;
 
-  /* "sat_toolkit/formula.pyx":583
+  /* "sat_toolkit/formula.pyx":590
  *         cdef _BaseClause c_needle
  * 
  *         c_needle = needle             # <<<<<<<<<<<<<<
  * 
  *         with nogil:
  */
-  if (!(likely(((__pyx_v_needle) == Py_None) || likely(__Pyx_TypeTest(__pyx_v_needle, __pyx_ptype_11sat_toolkit_7formula__BaseClause))))) __PYX_ERR(0, 583, __pyx_L1_error)
+  if (!(likely(((__pyx_v_needle) == Py_None) || likely(__Pyx_TypeTest(__pyx_v_needle, __pyx_ptype_11sat_toolkit_7formula__BaseClause))))) __PYX_ERR(0, 590, __pyx_L1_error)
   __pyx_t_2 = __pyx_v_needle;
   __Pyx_INCREF(__pyx_t_2);
   __pyx_v_c_needle = ((struct __pyx_obj_11sat_toolkit_7formula__BaseClause *)__pyx_t_2);
   __pyx_t_2 = 0;
 
-  /* "sat_toolkit/formula.pyx":585
+  /* "sat_toolkit/formula.pyx":592
  *         c_needle = needle
  * 
  *         with nogil:             # <<<<<<<<<<<<<<
  *             for i in range(self._start_indices.size()):
  *                 if self._compare_clause(i, c_needle):
  */
   {
@@ -31999,58 +32136,58 @@
       PyThreadState *_save;
       _save = NULL;
       Py_UNBLOCK_THREADS
       __Pyx_FastGIL_Remember();
       #endif
       /*try:*/ {
 
-        /* "sat_toolkit/formula.pyx":586
+        /* "sat_toolkit/formula.pyx":593
  * 
  *         with nogil:
  *             for i in range(self._start_indices.size()):             # <<<<<<<<<<<<<<
  *                 if self._compare_clause(i, c_needle):
  *                     count += 1
  */
         __pyx_t_3 = __pyx_v_self->_start_indices.size();
         __pyx_t_4 = __pyx_t_3;
         for (__pyx_t_5 = 0; __pyx_t_5 < __pyx_t_4; __pyx_t_5+=1) {
           __pyx_v_i = __pyx_t_5;
 
-          /* "sat_toolkit/formula.pyx":587
+          /* "sat_toolkit/formula.pyx":594
  *         with nogil:
  *             for i in range(self._start_indices.size()):
  *                 if self._compare_clause(i, c_needle):             # <<<<<<<<<<<<<<
  *                     count += 1
  *         return count
  */
-          __pyx_t_6 = ((struct __pyx_vtabstruct_11sat_toolkit_7formula__ClauseList *)__pyx_v_self->__pyx_vtab)->_compare_clause(__pyx_v_self, __pyx_v_i, __pyx_v_c_needle); if (unlikely(__pyx_t_6 == ((int)-1))) __PYX_ERR(0, 587, __pyx_L5_error)
+          __pyx_t_6 = ((struct __pyx_vtabstruct_11sat_toolkit_7formula__ClauseList *)__pyx_v_self->__pyx_vtab)->_compare_clause(__pyx_v_self, __pyx_v_i, __pyx_v_c_needle); if (unlikely(__pyx_t_6 == ((int)-1))) __PYX_ERR(0, 594, __pyx_L5_error)
           __pyx_t_1 = (__pyx_t_6 != 0);
           if (__pyx_t_1) {
 
-            /* "sat_toolkit/formula.pyx":588
+            /* "sat_toolkit/formula.pyx":595
  *             for i in range(self._start_indices.size()):
  *                 if self._compare_clause(i, c_needle):
  *                     count += 1             # <<<<<<<<<<<<<<
  *         return count
  * 
  */
             __pyx_v_count = (__pyx_v_count + 1);
 
-            /* "sat_toolkit/formula.pyx":587
+            /* "sat_toolkit/formula.pyx":594
  *         with nogil:
  *             for i in range(self._start_indices.size()):
  *                 if self._compare_clause(i, c_needle):             # <<<<<<<<<<<<<<
  *                     count += 1
  *         return count
  */
           }
         }
       }
 
-      /* "sat_toolkit/formula.pyx":585
+      /* "sat_toolkit/formula.pyx":592
  *         c_needle = needle
  * 
  *         with nogil:             # <<<<<<<<<<<<<<
  *             for i in range(self._start_indices.size()):
  *                 if self._compare_clause(i, c_needle):
  */
       /*finally:*/ {
@@ -32068,29 +32205,29 @@
           #endif
           goto __pyx_L1_error;
         }
         __pyx_L6:;
       }
   }
 
-  /* "sat_toolkit/formula.pyx":589
+  /* "sat_toolkit/formula.pyx":596
  *                 if self._compare_clause(i, c_needle):
  *                     count += 1
  *         return count             # <<<<<<<<<<<<<<
  * 
  *     cdef size_t _get_slice_index(self, ssize_t idx):
  */
   __Pyx_XDECREF(__pyx_r);
-  __pyx_t_2 = __Pyx_PyInt_FromSize_t(__pyx_v_count); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 589, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyInt_FromSize_t(__pyx_v_count); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 596, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __pyx_r = __pyx_t_2;
   __pyx_t_2 = 0;
   goto __pyx_L0;
 
-  /* "sat_toolkit/formula.pyx":576
+  /* "sat_toolkit/formula.pyx":583
  *                     return True
  * 
  *     def count(self, needle) -> bool:             # <<<<<<<<<<<<<<
  *         if not self._check_clause_type(needle):
  *             return False
  */
 
@@ -32102,136 +32239,136 @@
   __pyx_L0:;
   __Pyx_XDECREF((PyObject *)__pyx_v_c_needle);
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "sat_toolkit/formula.pyx":591
+/* "sat_toolkit/formula.pyx":598
  *         return count
  * 
  *     cdef size_t _get_slice_index(self, ssize_t idx):             # <<<<<<<<<<<<<<
  *         if idx < 0:
  *             idx += self._start_indices.size()
  */
 
 static size_t __pyx_f_11sat_toolkit_7formula_11_ClauseList__get_slice_index(struct __pyx_obj_11sat_toolkit_7formula__ClauseList *__pyx_v_self, Py_ssize_t __pyx_v_idx) {
   size_t __pyx_r;
   int __pyx_t_1;
 
-  /* "sat_toolkit/formula.pyx":592
+  /* "sat_toolkit/formula.pyx":599
  * 
  *     cdef size_t _get_slice_index(self, ssize_t idx):
  *         if idx < 0:             # <<<<<<<<<<<<<<
  *             idx += self._start_indices.size()
  *         if idx < 0:
  */
   __pyx_t_1 = (__pyx_v_idx < 0);
   if (__pyx_t_1) {
 
-    /* "sat_toolkit/formula.pyx":593
+    /* "sat_toolkit/formula.pyx":600
  *     cdef size_t _get_slice_index(self, ssize_t idx):
  *         if idx < 0:
  *             idx += self._start_indices.size()             # <<<<<<<<<<<<<<
  *         if idx < 0:
  *             return 0
  */
     __pyx_v_idx = (__pyx_v_idx + __pyx_v_self->_start_indices.size());
 
-    /* "sat_toolkit/formula.pyx":592
+    /* "sat_toolkit/formula.pyx":599
  * 
  *     cdef size_t _get_slice_index(self, ssize_t idx):
  *         if idx < 0:             # <<<<<<<<<<<<<<
  *             idx += self._start_indices.size()
  *         if idx < 0:
  */
   }
 
-  /* "sat_toolkit/formula.pyx":594
+  /* "sat_toolkit/formula.pyx":601
  *         if idx < 0:
  *             idx += self._start_indices.size()
  *         if idx < 0:             # <<<<<<<<<<<<<<
  *             return 0
  *         if <size_t> idx >= self._start_indices.size():
  */
   __pyx_t_1 = (__pyx_v_idx < 0);
   if (__pyx_t_1) {
 
-    /* "sat_toolkit/formula.pyx":595
+    /* "sat_toolkit/formula.pyx":602
  *             idx += self._start_indices.size()
  *         if idx < 0:
  *             return 0             # <<<<<<<<<<<<<<
  *         if <size_t> idx >= self._start_indices.size():
  *             return self._start_indices.size()
  */
     __pyx_r = 0;
     goto __pyx_L0;
 
-    /* "sat_toolkit/formula.pyx":594
+    /* "sat_toolkit/formula.pyx":601
  *         if idx < 0:
  *             idx += self._start_indices.size()
  *         if idx < 0:             # <<<<<<<<<<<<<<
  *             return 0
  *         if <size_t> idx >= self._start_indices.size():
  */
   }
 
-  /* "sat_toolkit/formula.pyx":596
+  /* "sat_toolkit/formula.pyx":603
  *         if idx < 0:
  *             return 0
  *         if <size_t> idx >= self._start_indices.size():             # <<<<<<<<<<<<<<
  *             return self._start_indices.size()
  *         return <size_t> idx
  */
   __pyx_t_1 = (((size_t)__pyx_v_idx) >= __pyx_v_self->_start_indices.size());
   if (__pyx_t_1) {
 
-    /* "sat_toolkit/formula.pyx":597
+    /* "sat_toolkit/formula.pyx":604
  *             return 0
  *         if <size_t> idx >= self._start_indices.size():
  *             return self._start_indices.size()             # <<<<<<<<<<<<<<
  *         return <size_t> idx
  * 
  */
     __pyx_r = __pyx_v_self->_start_indices.size();
     goto __pyx_L0;
 
-    /* "sat_toolkit/formula.pyx":596
+    /* "sat_toolkit/formula.pyx":603
  *         if idx < 0:
  *             return 0
  *         if <size_t> idx >= self._start_indices.size():             # <<<<<<<<<<<<<<
  *             return self._start_indices.size()
  *         return <size_t> idx
  */
   }
 
-  /* "sat_toolkit/formula.pyx":598
+  /* "sat_toolkit/formula.pyx":605
  *         if <size_t> idx >= self._start_indices.size():
  *             return self._start_indices.size()
  *         return <size_t> idx             # <<<<<<<<<<<<<<
  * 
  *     def index(self, needle, start=None, end=None) -> int:
  */
   __pyx_r = ((size_t)__pyx_v_idx);
   goto __pyx_L0;
 
-  /* "sat_toolkit/formula.pyx":591
+  /* "sat_toolkit/formula.pyx":598
  *         return count
  * 
  *     cdef size_t _get_slice_index(self, ssize_t idx):             # <<<<<<<<<<<<<<
  *         if idx < 0:
  *             idx += self._start_indices.size()
  */
 
   /* function exit code */
   __pyx_L0:;
   return __pyx_r;
 }
 
-/* "sat_toolkit/formula.pyx":600
+/* "sat_toolkit/formula.pyx":607
  *         return <size_t> idx
  * 
  *     def index(self, needle, start=None, end=None) -> int:             # <<<<<<<<<<<<<<
  *         """
  *         Return zero-based index in the list of the first item whose value is
  */
 
@@ -32293,34 +32430,34 @@
       kw_args = __Pyx_NumKwargs_FASTCALL(__pyx_kwds);
       switch (__pyx_nargs) {
         case  0:
         if (likely((values[0] = __Pyx_GetKwValue_FASTCALL(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_needle)) != 0)) {
           (void)__Pyx_Arg_NewRef_FASTCALL(values[0]);
           kw_args--;
         }
-        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 600, __pyx_L3_error)
+        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 607, __pyx_L3_error)
         else goto __pyx_L5_argtuple_error;
         CYTHON_FALLTHROUGH;
         case  1:
         if (kw_args > 0) {
           PyObject* value = __Pyx_GetKwValue_FASTCALL(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_start);
           if (value) { values[1] = __Pyx_Arg_NewRef_FASTCALL(value); kw_args--; }
-          else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 600, __pyx_L3_error)
+          else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 607, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  2:
         if (kw_args > 0) {
           PyObject* value = __Pyx_GetKwValue_FASTCALL(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_end);
           if (value) { values[2] = __Pyx_Arg_NewRef_FASTCALL(value); kw_args--; }
-          else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 600, __pyx_L3_error)
+          else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 607, __pyx_L3_error)
         }
       }
       if (unlikely(kw_args > 0)) {
         const Py_ssize_t kwd_pos_args = __pyx_nargs;
-        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values + 0, kwd_pos_args, "index") < 0)) __PYX_ERR(0, 600, __pyx_L3_error)
+        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values + 0, kwd_pos_args, "index") < 0)) __PYX_ERR(0, 607, __pyx_L3_error)
       }
     } else {
       switch (__pyx_nargs) {
         case  3: values[2] = __Pyx_Arg_FASTCALL(__pyx_args, 2);
         CYTHON_FALLTHROUGH;
         case  2: values[1] = __Pyx_Arg_FASTCALL(__pyx_args, 1);
         CYTHON_FALLTHROUGH;
@@ -32331,15 +32468,15 @@
     }
     __pyx_v_needle = values[0];
     __pyx_v_start = values[1];
     __pyx_v_end = values[2];
   }
   goto __pyx_L6_skip;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("index", 0, 1, 3, __pyx_nargs); __PYX_ERR(0, 600, __pyx_L3_error)
+  __Pyx_RaiseArgtupleInvalid("index", 0, 1, 3, __pyx_nargs); __PYX_ERR(0, 607, __pyx_L3_error)
   __pyx_L6_skip:;
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L3_error:;
   {
     Py_ssize_t __pyx_temp;
     for (__pyx_temp=0; __pyx_temp < (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
       __Pyx_Arg_XDECREF_FASTCALL(values[__pyx_temp]);
@@ -32380,238 +32517,238 @@
   size_t __pyx_t_10;
   int __pyx_t_11;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("index", 1);
 
-  /* "sat_toolkit/formula.pyx":610
+  /* "sat_toolkit/formula.pyx":617
  *         of the full sequence rather than the start argument.
  *         """
  *         if not self._check_clause_type(needle):             # <<<<<<<<<<<<<<
  *             raise ValueError(f'{needle} is of wrong tpe to be contained in {type(self).__name__}')
  * 
  */
-  if (!(likely(((__pyx_v_needle) == Py_None) || likely(__Pyx_TypeTest(__pyx_v_needle, __pyx_ptype_11sat_toolkit_7formula__BaseClause))))) __PYX_ERR(0, 610, __pyx_L1_error)
+  if (!(likely(((__pyx_v_needle) == Py_None) || likely(__Pyx_TypeTest(__pyx_v_needle, __pyx_ptype_11sat_toolkit_7formula__BaseClause))))) __PYX_ERR(0, 617, __pyx_L1_error)
   __pyx_t_1 = (!(((struct __pyx_vtabstruct_11sat_toolkit_7formula__ClauseList *)__pyx_v_self->__pyx_vtab)->_check_clause_type(__pyx_v_self, ((struct __pyx_obj_11sat_toolkit_7formula__BaseClause *)__pyx_v_needle)) != 0));
   if (unlikely(__pyx_t_1)) {
 
-    /* "sat_toolkit/formula.pyx":611
+    /* "sat_toolkit/formula.pyx":618
  *         """
  *         if not self._check_clause_type(needle):
  *             raise ValueError(f'{needle} is of wrong tpe to be contained in {type(self).__name__}')             # <<<<<<<<<<<<<<
  * 
  *         cdef size_t i, start_idx = 0, end_idx = self._start_indices.size()
  */
-    __pyx_t_2 = PyTuple_New(3); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 611, __pyx_L1_error)
+    __pyx_t_2 = PyTuple_New(3); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 618, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
     __pyx_t_3 = 0;
     __pyx_t_4 = 127;
-    __pyx_t_5 = __Pyx_PyObject_FormatSimple(__pyx_v_needle, __pyx_empty_unicode); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 611, __pyx_L1_error)
+    __pyx_t_5 = __Pyx_PyObject_FormatSimple(__pyx_v_needle, __pyx_empty_unicode); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 618, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
     __pyx_t_4 = (__Pyx_PyUnicode_MAX_CHAR_VALUE(__pyx_t_5) > __pyx_t_4) ? __Pyx_PyUnicode_MAX_CHAR_VALUE(__pyx_t_5) : __pyx_t_4;
     __pyx_t_3 += __Pyx_PyUnicode_GET_LENGTH(__pyx_t_5);
     __Pyx_GIVEREF(__pyx_t_5);
     PyTuple_SET_ITEM(__pyx_t_2, 0, __pyx_t_5);
     __pyx_t_5 = 0;
     __Pyx_INCREF(__pyx_kp_u_is_of_wrong_tpe_to_be_contained);
     __pyx_t_3 += 36;
     __Pyx_GIVEREF(__pyx_kp_u_is_of_wrong_tpe_to_be_contained);
     PyTuple_SET_ITEM(__pyx_t_2, 1, __pyx_kp_u_is_of_wrong_tpe_to_be_contained);
-    __pyx_t_5 = __Pyx_PyObject_GetAttrStr(((PyObject *)Py_TYPE(((PyObject *)__pyx_v_self))), __pyx_n_s_name_2); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 611, __pyx_L1_error)
+    __pyx_t_5 = __Pyx_PyObject_GetAttrStr(((PyObject *)Py_TYPE(((PyObject *)__pyx_v_self))), __pyx_n_s_name_2); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 618, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
-    __pyx_t_6 = __Pyx_PyObject_FormatSimple(__pyx_t_5, __pyx_empty_unicode); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 611, __pyx_L1_error)
+    __pyx_t_6 = __Pyx_PyObject_FormatSimple(__pyx_t_5, __pyx_empty_unicode); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 618, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
     __pyx_t_4 = (__Pyx_PyUnicode_MAX_CHAR_VALUE(__pyx_t_6) > __pyx_t_4) ? __Pyx_PyUnicode_MAX_CHAR_VALUE(__pyx_t_6) : __pyx_t_4;
     __pyx_t_3 += __Pyx_PyUnicode_GET_LENGTH(__pyx_t_6);
     __Pyx_GIVEREF(__pyx_t_6);
     PyTuple_SET_ITEM(__pyx_t_2, 2, __pyx_t_6);
     __pyx_t_6 = 0;
-    __pyx_t_6 = __Pyx_PyUnicode_Join(__pyx_t_2, 3, __pyx_t_3, __pyx_t_4); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 611, __pyx_L1_error)
+    __pyx_t_6 = __Pyx_PyUnicode_Join(__pyx_t_2, 3, __pyx_t_3, __pyx_t_4); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 618, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-    __pyx_t_2 = __Pyx_PyObject_CallOneArg(__pyx_builtin_ValueError, __pyx_t_6); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 611, __pyx_L1_error)
+    __pyx_t_2 = __Pyx_PyObject_CallOneArg(__pyx_builtin_ValueError, __pyx_t_6); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 618, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
     __Pyx_Raise(__pyx_t_2, 0, 0, 0);
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-    __PYX_ERR(0, 611, __pyx_L1_error)
+    __PYX_ERR(0, 618, __pyx_L1_error)
 
-    /* "sat_toolkit/formula.pyx":610
+    /* "sat_toolkit/formula.pyx":617
  *         of the full sequence rather than the start argument.
  *         """
  *         if not self._check_clause_type(needle):             # <<<<<<<<<<<<<<
  *             raise ValueError(f'{needle} is of wrong tpe to be contained in {type(self).__name__}')
  * 
  */
   }
 
-  /* "sat_toolkit/formula.pyx":613
+  /* "sat_toolkit/formula.pyx":620
  *             raise ValueError(f'{needle} is of wrong tpe to be contained in {type(self).__name__}')
  * 
  *         cdef size_t i, start_idx = 0, end_idx = self._start_indices.size()             # <<<<<<<<<<<<<<
  *         cdef _BaseClause c_needle
  * 
  */
   __pyx_v_start_idx = 0;
   __pyx_v_end_idx = __pyx_v_self->_start_indices.size();
 
-  /* "sat_toolkit/formula.pyx":616
+  /* "sat_toolkit/formula.pyx":623
  *         cdef _BaseClause c_needle
  * 
  *         if start is not None:             # <<<<<<<<<<<<<<
  *             start_idx = self._get_slice_index(start)
  *         if end is not None:
  */
   __pyx_t_1 = (__pyx_v_start != Py_None);
   if (__pyx_t_1) {
 
-    /* "sat_toolkit/formula.pyx":617
+    /* "sat_toolkit/formula.pyx":624
  * 
  *         if start is not None:
  *             start_idx = self._get_slice_index(start)             # <<<<<<<<<<<<<<
  *         if end is not None:
  *             end_idx = self._get_slice_index(end)
  */
-    __pyx_t_7 = PyInt_AsSsize_t(__pyx_v_start); if (unlikely((__pyx_t_7 == (Py_ssize_t)-1) && PyErr_Occurred())) __PYX_ERR(0, 617, __pyx_L1_error)
-    __pyx_t_8 = ((struct __pyx_vtabstruct_11sat_toolkit_7formula__ClauseList *)__pyx_v_self->__pyx_vtab)->_get_slice_index(__pyx_v_self, __pyx_t_7); if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 617, __pyx_L1_error)
+    __pyx_t_7 = PyInt_AsSsize_t(__pyx_v_start); if (unlikely((__pyx_t_7 == (Py_ssize_t)-1) && PyErr_Occurred())) __PYX_ERR(0, 624, __pyx_L1_error)
+    __pyx_t_8 = ((struct __pyx_vtabstruct_11sat_toolkit_7formula__ClauseList *)__pyx_v_self->__pyx_vtab)->_get_slice_index(__pyx_v_self, __pyx_t_7); if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 624, __pyx_L1_error)
     __pyx_v_start_idx = __pyx_t_8;
 
-    /* "sat_toolkit/formula.pyx":616
+    /* "sat_toolkit/formula.pyx":623
  *         cdef _BaseClause c_needle
  * 
  *         if start is not None:             # <<<<<<<<<<<<<<
  *             start_idx = self._get_slice_index(start)
  *         if end is not None:
  */
   }
 
-  /* "sat_toolkit/formula.pyx":618
+  /* "sat_toolkit/formula.pyx":625
  *         if start is not None:
  *             start_idx = self._get_slice_index(start)
  *         if end is not None:             # <<<<<<<<<<<<<<
  *             end_idx = self._get_slice_index(end)
  * 
  */
   __pyx_t_1 = (__pyx_v_end != Py_None);
   if (__pyx_t_1) {
 
-    /* "sat_toolkit/formula.pyx":619
+    /* "sat_toolkit/formula.pyx":626
  *             start_idx = self._get_slice_index(start)
  *         if end is not None:
  *             end_idx = self._get_slice_index(end)             # <<<<<<<<<<<<<<
  * 
  *         for i in range(start_idx, end_idx):
  */
-    __pyx_t_7 = PyInt_AsSsize_t(__pyx_v_end); if (unlikely((__pyx_t_7 == (Py_ssize_t)-1) && PyErr_Occurred())) __PYX_ERR(0, 619, __pyx_L1_error)
-    __pyx_t_8 = ((struct __pyx_vtabstruct_11sat_toolkit_7formula__ClauseList *)__pyx_v_self->__pyx_vtab)->_get_slice_index(__pyx_v_self, __pyx_t_7); if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 619, __pyx_L1_error)
+    __pyx_t_7 = PyInt_AsSsize_t(__pyx_v_end); if (unlikely((__pyx_t_7 == (Py_ssize_t)-1) && PyErr_Occurred())) __PYX_ERR(0, 626, __pyx_L1_error)
+    __pyx_t_8 = ((struct __pyx_vtabstruct_11sat_toolkit_7formula__ClauseList *)__pyx_v_self->__pyx_vtab)->_get_slice_index(__pyx_v_self, __pyx_t_7); if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 626, __pyx_L1_error)
     __pyx_v_end_idx = __pyx_t_8;
 
-    /* "sat_toolkit/formula.pyx":618
+    /* "sat_toolkit/formula.pyx":625
  *         if start is not None:
  *             start_idx = self._get_slice_index(start)
  *         if end is not None:             # <<<<<<<<<<<<<<
  *             end_idx = self._get_slice_index(end)
  * 
  */
   }
 
-  /* "sat_toolkit/formula.pyx":621
+  /* "sat_toolkit/formula.pyx":628
  *             end_idx = self._get_slice_index(end)
  * 
  *         for i in range(start_idx, end_idx):             # <<<<<<<<<<<<<<
  *             if self._compare_clause(i, needle):
  *                 return i
  */
   __pyx_t_8 = __pyx_v_end_idx;
   __pyx_t_9 = __pyx_t_8;
   for (__pyx_t_10 = __pyx_v_start_idx; __pyx_t_10 < __pyx_t_9; __pyx_t_10+=1) {
     __pyx_v_i = __pyx_t_10;
 
-    /* "sat_toolkit/formula.pyx":622
+    /* "sat_toolkit/formula.pyx":629
  * 
  *         for i in range(start_idx, end_idx):
  *             if self._compare_clause(i, needle):             # <<<<<<<<<<<<<<
  *                 return i
  * 
  */
-    if (!(likely(((__pyx_v_needle) == Py_None) || likely(__Pyx_TypeTest(__pyx_v_needle, __pyx_ptype_11sat_toolkit_7formula__BaseClause))))) __PYX_ERR(0, 622, __pyx_L1_error)
-    __pyx_t_11 = ((struct __pyx_vtabstruct_11sat_toolkit_7formula__ClauseList *)__pyx_v_self->__pyx_vtab)->_compare_clause(__pyx_v_self, __pyx_v_i, ((struct __pyx_obj_11sat_toolkit_7formula__BaseClause *)__pyx_v_needle)); if (unlikely(__pyx_t_11 == ((int)-1))) __PYX_ERR(0, 622, __pyx_L1_error)
+    if (!(likely(((__pyx_v_needle) == Py_None) || likely(__Pyx_TypeTest(__pyx_v_needle, __pyx_ptype_11sat_toolkit_7formula__BaseClause))))) __PYX_ERR(0, 629, __pyx_L1_error)
+    __pyx_t_11 = ((struct __pyx_vtabstruct_11sat_toolkit_7formula__ClauseList *)__pyx_v_self->__pyx_vtab)->_compare_clause(__pyx_v_self, __pyx_v_i, ((struct __pyx_obj_11sat_toolkit_7formula__BaseClause *)__pyx_v_needle)); if (unlikely(__pyx_t_11 == ((int)-1))) __PYX_ERR(0, 629, __pyx_L1_error)
     __pyx_t_1 = (__pyx_t_11 != 0);
     if (__pyx_t_1) {
 
-      /* "sat_toolkit/formula.pyx":623
+      /* "sat_toolkit/formula.pyx":630
  *         for i in range(start_idx, end_idx):
  *             if self._compare_clause(i, needle):
  *                 return i             # <<<<<<<<<<<<<<
  * 
  *         raise ValueError(f'{needle} is not in {type(self).__name__}')
  */
       __Pyx_XDECREF(__pyx_r);
-      __pyx_t_2 = __Pyx_PyInt_FromSize_t(__pyx_v_i); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 623, __pyx_L1_error)
+      __pyx_t_2 = __Pyx_PyInt_FromSize_t(__pyx_v_i); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 630, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_2);
-      if (!(likely(__Pyx_Py3Int_CheckExact(__pyx_t_2)) || __Pyx_RaiseUnexpectedTypeError("int", __pyx_t_2))) __PYX_ERR(0, 623, __pyx_L1_error)
+      if (!(likely(__Pyx_Py3Int_CheckExact(__pyx_t_2)) || __Pyx_RaiseUnexpectedTypeError("int", __pyx_t_2))) __PYX_ERR(0, 630, __pyx_L1_error)
       __pyx_r = ((PyObject*)__pyx_t_2);
       __pyx_t_2 = 0;
       goto __pyx_L0;
 
-      /* "sat_toolkit/formula.pyx":622
+      /* "sat_toolkit/formula.pyx":629
  * 
  *         for i in range(start_idx, end_idx):
  *             if self._compare_clause(i, needle):             # <<<<<<<<<<<<<<
  *                 return i
  * 
  */
     }
   }
 
-  /* "sat_toolkit/formula.pyx":625
+  /* "sat_toolkit/formula.pyx":632
  *                 return i
  * 
  *         raise ValueError(f'{needle} is not in {type(self).__name__}')             # <<<<<<<<<<<<<<
  * 
  *     # pickle support
  */
-  __pyx_t_2 = PyTuple_New(3); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 625, __pyx_L1_error)
+  __pyx_t_2 = PyTuple_New(3); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 632, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __pyx_t_3 = 0;
   __pyx_t_4 = 127;
-  __pyx_t_6 = __Pyx_PyObject_FormatSimple(__pyx_v_needle, __pyx_empty_unicode); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 625, __pyx_L1_error)
+  __pyx_t_6 = __Pyx_PyObject_FormatSimple(__pyx_v_needle, __pyx_empty_unicode); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 632, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_6);
   __pyx_t_4 = (__Pyx_PyUnicode_MAX_CHAR_VALUE(__pyx_t_6) > __pyx_t_4) ? __Pyx_PyUnicode_MAX_CHAR_VALUE(__pyx_t_6) : __pyx_t_4;
   __pyx_t_3 += __Pyx_PyUnicode_GET_LENGTH(__pyx_t_6);
   __Pyx_GIVEREF(__pyx_t_6);
   PyTuple_SET_ITEM(__pyx_t_2, 0, __pyx_t_6);
   __pyx_t_6 = 0;
   __Pyx_INCREF(__pyx_kp_u_is_not_in);
   __pyx_t_3 += 11;
   __Pyx_GIVEREF(__pyx_kp_u_is_not_in);
   PyTuple_SET_ITEM(__pyx_t_2, 1, __pyx_kp_u_is_not_in);
-  __pyx_t_6 = __Pyx_PyObject_GetAttrStr(((PyObject *)Py_TYPE(((PyObject *)__pyx_v_self))), __pyx_n_s_name_2); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 625, __pyx_L1_error)
+  __pyx_t_6 = __Pyx_PyObject_GetAttrStr(((PyObject *)Py_TYPE(((PyObject *)__pyx_v_self))), __pyx_n_s_name_2); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 632, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_6);
-  __pyx_t_5 = __Pyx_PyObject_FormatSimple(__pyx_t_6, __pyx_empty_unicode); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 625, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyObject_FormatSimple(__pyx_t_6, __pyx_empty_unicode); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 632, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
   __pyx_t_4 = (__Pyx_PyUnicode_MAX_CHAR_VALUE(__pyx_t_5) > __pyx_t_4) ? __Pyx_PyUnicode_MAX_CHAR_VALUE(__pyx_t_5) : __pyx_t_4;
   __pyx_t_3 += __Pyx_PyUnicode_GET_LENGTH(__pyx_t_5);
   __Pyx_GIVEREF(__pyx_t_5);
   PyTuple_SET_ITEM(__pyx_t_2, 2, __pyx_t_5);
   __pyx_t_5 = 0;
-  __pyx_t_5 = __Pyx_PyUnicode_Join(__pyx_t_2, 3, __pyx_t_3, __pyx_t_4); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 625, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyUnicode_Join(__pyx_t_2, 3, __pyx_t_3, __pyx_t_4); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 632, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __pyx_t_2 = __Pyx_PyObject_CallOneArg(__pyx_builtin_ValueError, __pyx_t_5); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 625, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_CallOneArg(__pyx_builtin_ValueError, __pyx_t_5); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 632, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
   __Pyx_Raise(__pyx_t_2, 0, 0, 0);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __PYX_ERR(0, 625, __pyx_L1_error)
+  __PYX_ERR(0, 632, __pyx_L1_error)
 
-  /* "sat_toolkit/formula.pyx":600
+  /* "sat_toolkit/formula.pyx":607
  *         return <size_t> idx
  * 
  *     def index(self, needle, start=None, end=None) -> int:             # <<<<<<<<<<<<<<
  *         """
  *         Return zero-based index in the list of the first item whose value is
  */
 
@@ -32624,15 +32761,15 @@
   __pyx_r = NULL;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "sat_toolkit/formula.pyx":628
+/* "sat_toolkit/formula.pyx":635
  * 
  *     # pickle support
  *     def __reduce__(self):             # <<<<<<<<<<<<<<
  *         return type(self), (np.array(self), self.nvars)
  * 
  */
 
@@ -32686,25 +32823,25 @@
   PyObject *__pyx_t_3 = NULL;
   int __pyx_t_4;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("__reduce__", 1);
 
-  /* "sat_toolkit/formula.pyx":629
+  /* "sat_toolkit/formula.pyx":636
  *     # pickle support
  *     def __reduce__(self):
  *         return type(self), (np.array(self), self.nvars)             # <<<<<<<<<<<<<<
  * 
  *     # buffer support
  */
   __Pyx_XDECREF(__pyx_r);
-  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 629, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 636, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_array); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 629, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_array); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 636, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   __pyx_t_2 = NULL;
   __pyx_t_4 = 0;
   #if CYTHON_UNPACK_METHODS
   if (unlikely(PyMethod_Check(__pyx_t_3))) {
     __pyx_t_2 = PyMethod_GET_SELF(__pyx_t_3);
@@ -32717,41 +32854,41 @@
     }
   }
   #endif
   {
     PyObject *__pyx_callargs[2] = {__pyx_t_2, ((PyObject *)__pyx_v_self)};
     __pyx_t_1 = __Pyx_PyObject_FastCall(__pyx_t_3, __pyx_callargs+1-__pyx_t_4, 1+__pyx_t_4);
     __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
-    if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 629, __pyx_L1_error)
+    if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 636, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   }
-  __pyx_t_3 = __Pyx_PyInt_From_int(__pyx_v_self->nvars); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 629, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyInt_From_int(__pyx_v_self->nvars); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 636, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  __pyx_t_2 = PyTuple_New(2); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 629, __pyx_L1_error)
+  __pyx_t_2 = PyTuple_New(2); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 636, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_GIVEREF(__pyx_t_1);
-  if (__Pyx_PyTuple_SET_ITEM(__pyx_t_2, 0, __pyx_t_1)) __PYX_ERR(0, 629, __pyx_L1_error);
+  if (__Pyx_PyTuple_SET_ITEM(__pyx_t_2, 0, __pyx_t_1)) __PYX_ERR(0, 636, __pyx_L1_error);
   __Pyx_GIVEREF(__pyx_t_3);
-  if (__Pyx_PyTuple_SET_ITEM(__pyx_t_2, 1, __pyx_t_3)) __PYX_ERR(0, 629, __pyx_L1_error);
+  if (__Pyx_PyTuple_SET_ITEM(__pyx_t_2, 1, __pyx_t_3)) __PYX_ERR(0, 636, __pyx_L1_error);
   __pyx_t_1 = 0;
   __pyx_t_3 = 0;
-  __pyx_t_3 = PyTuple_New(2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 629, __pyx_L1_error)
+  __pyx_t_3 = PyTuple_New(2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 636, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_INCREF(((PyObject *)Py_TYPE(((PyObject *)__pyx_v_self))));
   __Pyx_GIVEREF(((PyObject *)Py_TYPE(((PyObject *)__pyx_v_self))));
-  if (__Pyx_PyTuple_SET_ITEM(__pyx_t_3, 0, ((PyObject *)Py_TYPE(((PyObject *)__pyx_v_self))))) __PYX_ERR(0, 629, __pyx_L1_error);
+  if (__Pyx_PyTuple_SET_ITEM(__pyx_t_3, 0, ((PyObject *)Py_TYPE(((PyObject *)__pyx_v_self))))) __PYX_ERR(0, 636, __pyx_L1_error);
   __Pyx_GIVEREF(__pyx_t_2);
-  if (__Pyx_PyTuple_SET_ITEM(__pyx_t_3, 1, __pyx_t_2)) __PYX_ERR(0, 629, __pyx_L1_error);
+  if (__Pyx_PyTuple_SET_ITEM(__pyx_t_3, 1, __pyx_t_2)) __PYX_ERR(0, 636, __pyx_L1_error);
   __pyx_t_2 = 0;
   __pyx_r = __pyx_t_3;
   __pyx_t_3 = 0;
   goto __pyx_L0;
 
-  /* "sat_toolkit/formula.pyx":628
+  /* "sat_toolkit/formula.pyx":635
  * 
  *     # pickle support
  *     def __reduce__(self):             # <<<<<<<<<<<<<<
  *         return type(self), (np.array(self), self.nvars)
  * 
  */
 
@@ -32764,15 +32901,15 @@
   __pyx_r = NULL;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "sat_toolkit/formula.pyx":632
+/* "sat_toolkit/formula.pyx":639
  * 
  *     # buffer support
  *     def __getbuffer__(self, cython.Py_buffer *buffer, int flags):             # <<<<<<<<<<<<<<
  *         if flags & PyBUF_WRITABLE:
  *             raise ValueError(f'cannot provide a writable buffer for {type(self).__name__}')
  */
 
@@ -32804,282 +32941,282 @@
     PyErr_SetString(PyExc_BufferError, "PyObject_GetBuffer: view==NULL argument is obsolete");
     return -1;
   }
   __Pyx_RefNannySetupContext("__getbuffer__", 0);
   __pyx_v_buffer->obj = Py_None; __Pyx_INCREF(Py_None);
   __Pyx_GIVEREF(__pyx_v_buffer->obj);
 
-  /* "sat_toolkit/formula.pyx":633
+  /* "sat_toolkit/formula.pyx":640
  *     # buffer support
  *     def __getbuffer__(self, cython.Py_buffer *buffer, int flags):
  *         if flags & PyBUF_WRITABLE:             # <<<<<<<<<<<<<<
  *             raise ValueError(f'cannot provide a writable buffer for {type(self).__name__}')
  * 
  */
   __pyx_t_1 = ((__pyx_v_flags & PyBUF_WRITABLE) != 0);
   if (unlikely(__pyx_t_1)) {
 
-    /* "sat_toolkit/formula.pyx":634
+    /* "sat_toolkit/formula.pyx":641
  *     def __getbuffer__(self, cython.Py_buffer *buffer, int flags):
  *         if flags & PyBUF_WRITABLE:
  *             raise ValueError(f'cannot provide a writable buffer for {type(self).__name__}')             # <<<<<<<<<<<<<<
  * 
  *         self.shape[0] = self._clauses.size()
  */
-    __pyx_t_2 = __Pyx_PyObject_GetAttrStr(((PyObject *)Py_TYPE(((PyObject *)__pyx_v_self))), __pyx_n_s_name_2); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 634, __pyx_L1_error)
+    __pyx_t_2 = __Pyx_PyObject_GetAttrStr(((PyObject *)Py_TYPE(((PyObject *)__pyx_v_self))), __pyx_n_s_name_2); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 641, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
-    __pyx_t_3 = __Pyx_PyObject_FormatSimple(__pyx_t_2, __pyx_empty_unicode); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 634, __pyx_L1_error)
+    __pyx_t_3 = __Pyx_PyObject_FormatSimple(__pyx_t_2, __pyx_empty_unicode); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 641, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-    __pyx_t_2 = __Pyx_PyUnicode_Concat(__pyx_kp_u_cannot_provide_a_writable_buffer, __pyx_t_3); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 634, __pyx_L1_error)
+    __pyx_t_2 = __Pyx_PyUnicode_Concat(__pyx_kp_u_cannot_provide_a_writable_buffer, __pyx_t_3); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 641, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-    __pyx_t_3 = __Pyx_PyObject_CallOneArg(__pyx_builtin_ValueError, __pyx_t_2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 634, __pyx_L1_error)
+    __pyx_t_3 = __Pyx_PyObject_CallOneArg(__pyx_builtin_ValueError, __pyx_t_2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 641, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
     __Pyx_Raise(__pyx_t_3, 0, 0, 0);
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-    __PYX_ERR(0, 634, __pyx_L1_error)
+    __PYX_ERR(0, 641, __pyx_L1_error)
 
-    /* "sat_toolkit/formula.pyx":633
+    /* "sat_toolkit/formula.pyx":640
  *     # buffer support
  *     def __getbuffer__(self, cython.Py_buffer *buffer, int flags):
  *         if flags & PyBUF_WRITABLE:             # <<<<<<<<<<<<<<
  *             raise ValueError(f'cannot provide a writable buffer for {type(self).__name__}')
  * 
  */
   }
 
-  /* "sat_toolkit/formula.pyx":636
+  /* "sat_toolkit/formula.pyx":643
  *             raise ValueError(f'cannot provide a writable buffer for {type(self).__name__}')
  * 
  *         self.shape[0] = self._clauses.size()             # <<<<<<<<<<<<<<
  *         self.view_count += 1
  * 
  */
   (__pyx_v_self->shape[0]) = __pyx_v_self->_clauses.size();
 
-  /* "sat_toolkit/formula.pyx":637
+  /* "sat_toolkit/formula.pyx":644
  * 
  *         self.shape[0] = self._clauses.size()
  *         self.view_count += 1             # <<<<<<<<<<<<<<
  * 
  *         buffer.buf = <char *>&(self._clauses[0])
  */
   __pyx_v_self->view_count = (__pyx_v_self->view_count + 1);
 
-  /* "sat_toolkit/formula.pyx":639
+  /* "sat_toolkit/formula.pyx":646
  *         self.view_count += 1
  * 
  *         buffer.buf = <char *>&(self._clauses[0])             # <<<<<<<<<<<<<<
  * 
  *         if (flags & PyBUF_FORMAT) == PyBUF_FORMAT:
  */
   __pyx_v_buffer->buf = ((char *)(&(__pyx_v_self->_clauses[0])));
 
-  /* "sat_toolkit/formula.pyx":641
+  /* "sat_toolkit/formula.pyx":648
  *         buffer.buf = <char *>&(self._clauses[0])
  * 
  *         if (flags & PyBUF_FORMAT) == PyBUF_FORMAT:             # <<<<<<<<<<<<<<
  *             buffer.format = 'i'                     # int
  *         else:
  */
   __pyx_t_1 = ((__pyx_v_flags & PyBUF_FORMAT) == PyBUF_FORMAT);
   if (__pyx_t_1) {
 
-    /* "sat_toolkit/formula.pyx":642
+    /* "sat_toolkit/formula.pyx":649
  * 
  *         if (flags & PyBUF_FORMAT) == PyBUF_FORMAT:
  *             buffer.format = 'i'                     # int             # <<<<<<<<<<<<<<
  *         else:
  *             buffer.format = NULL
  */
     __pyx_v_buffer->format = ((char *)"i");
 
-    /* "sat_toolkit/formula.pyx":641
+    /* "sat_toolkit/formula.pyx":648
  *         buffer.buf = <char *>&(self._clauses[0])
  * 
  *         if (flags & PyBUF_FORMAT) == PyBUF_FORMAT:             # <<<<<<<<<<<<<<
  *             buffer.format = 'i'                     # int
  *         else:
  */
     goto __pyx_L4;
   }
 
-  /* "sat_toolkit/formula.pyx":644
+  /* "sat_toolkit/formula.pyx":651
  *             buffer.format = 'i'                     # int
  *         else:
  *             buffer.format = NULL             # <<<<<<<<<<<<<<
  *         buffer.internal = NULL
  *         buffer.itemsize = sizeof(int)
  */
   /*else*/ {
     __pyx_v_buffer->format = NULL;
   }
   __pyx_L4:;
 
-  /* "sat_toolkit/formula.pyx":645
+  /* "sat_toolkit/formula.pyx":652
  *         else:
  *             buffer.format = NULL
  *         buffer.internal = NULL             # <<<<<<<<<<<<<<
  *         buffer.itemsize = sizeof(int)
  *         buffer.len = self.shape[0] * sizeof(int)
  */
   __pyx_v_buffer->internal = NULL;
 
-  /* "sat_toolkit/formula.pyx":646
+  /* "sat_toolkit/formula.pyx":653
  *             buffer.format = NULL
  *         buffer.internal = NULL
  *         buffer.itemsize = sizeof(int)             # <<<<<<<<<<<<<<
  *         buffer.len = self.shape[0] * sizeof(int)
  *         buffer.obj = self
  */
   __pyx_v_buffer->itemsize = (sizeof(int));
 
-  /* "sat_toolkit/formula.pyx":647
+  /* "sat_toolkit/formula.pyx":654
  *         buffer.internal = NULL
  *         buffer.itemsize = sizeof(int)
  *         buffer.len = self.shape[0] * sizeof(int)             # <<<<<<<<<<<<<<
  *         buffer.obj = self
  *         buffer.readonly = 1
  */
   __pyx_v_buffer->len = ((__pyx_v_self->shape[0]) * (sizeof(int)));
 
-  /* "sat_toolkit/formula.pyx":648
+  /* "sat_toolkit/formula.pyx":655
  *         buffer.itemsize = sizeof(int)
  *         buffer.len = self.shape[0] * sizeof(int)
  *         buffer.obj = self             # <<<<<<<<<<<<<<
  *         buffer.readonly = 1
  *         if (flags & PyBUF_ND) == PyBUF_ND:
  */
   __Pyx_INCREF((PyObject *)__pyx_v_self);
   __Pyx_GIVEREF((PyObject *)__pyx_v_self);
   __Pyx_GOTREF(__pyx_v_buffer->obj);
   __Pyx_DECREF(__pyx_v_buffer->obj);
   __pyx_v_buffer->obj = ((PyObject *)__pyx_v_self);
 
-  /* "sat_toolkit/formula.pyx":649
+  /* "sat_toolkit/formula.pyx":656
  *         buffer.len = self.shape[0] * sizeof(int)
  *         buffer.obj = self
  *         buffer.readonly = 1             # <<<<<<<<<<<<<<
  *         if (flags & PyBUF_ND) == PyBUF_ND:
  *             buffer.ndim = 1
  */
   __pyx_v_buffer->readonly = 1;
 
-  /* "sat_toolkit/formula.pyx":650
+  /* "sat_toolkit/formula.pyx":657
  *         buffer.obj = self
  *         buffer.readonly = 1
  *         if (flags & PyBUF_ND) == PyBUF_ND:             # <<<<<<<<<<<<<<
  *             buffer.ndim = 1
  *             buffer.shape = &self.shape[0]
  */
   __pyx_t_1 = ((__pyx_v_flags & PyBUF_ND) == PyBUF_ND);
   if (__pyx_t_1) {
 
-    /* "sat_toolkit/formula.pyx":651
+    /* "sat_toolkit/formula.pyx":658
  *         buffer.readonly = 1
  *         if (flags & PyBUF_ND) == PyBUF_ND:
  *             buffer.ndim = 1             # <<<<<<<<<<<<<<
  *             buffer.shape = &self.shape[0]
  *         else:
  */
     __pyx_v_buffer->ndim = 1;
 
-    /* "sat_toolkit/formula.pyx":652
+    /* "sat_toolkit/formula.pyx":659
  *         if (flags & PyBUF_ND) == PyBUF_ND:
  *             buffer.ndim = 1
  *             buffer.shape = &self.shape[0]             # <<<<<<<<<<<<<<
  *         else:
  *             buffer.ndim = 0
  */
     __pyx_v_buffer->shape = ((Py_ssize_t *)(&(__pyx_v_self->shape[0])));
 
-    /* "sat_toolkit/formula.pyx":650
+    /* "sat_toolkit/formula.pyx":657
  *         buffer.obj = self
  *         buffer.readonly = 1
  *         if (flags & PyBUF_ND) == PyBUF_ND:             # <<<<<<<<<<<<<<
  *             buffer.ndim = 1
  *             buffer.shape = &self.shape[0]
  */
     goto __pyx_L5;
   }
 
-  /* "sat_toolkit/formula.pyx":654
+  /* "sat_toolkit/formula.pyx":661
  *             buffer.shape = &self.shape[0]
  *         else:
  *             buffer.ndim = 0             # <<<<<<<<<<<<<<
  *             buffer.shape = NULL
  * 
  */
   /*else*/ {
     __pyx_v_buffer->ndim = 0;
 
-    /* "sat_toolkit/formula.pyx":655
+    /* "sat_toolkit/formula.pyx":662
  *         else:
  *             buffer.ndim = 0
  *             buffer.shape = NULL             # <<<<<<<<<<<<<<
  * 
  *         if (flags & PyBUF_STRIDES) == PyBUF_STRIDES:
  */
     __pyx_v_buffer->shape = NULL;
   }
   __pyx_L5:;
 
-  /* "sat_toolkit/formula.pyx":657
+  /* "sat_toolkit/formula.pyx":664
  *             buffer.shape = NULL
  * 
  *         if (flags & PyBUF_STRIDES) == PyBUF_STRIDES:             # <<<<<<<<<<<<<<
  *             buffer.strides = &buffer.itemsize
  *         else:
  */
   __pyx_t_1 = ((__pyx_v_flags & PyBUF_STRIDES) == PyBUF_STRIDES);
   if (__pyx_t_1) {
 
-    /* "sat_toolkit/formula.pyx":658
+    /* "sat_toolkit/formula.pyx":665
  * 
  *         if (flags & PyBUF_STRIDES) == PyBUF_STRIDES:
  *             buffer.strides = &buffer.itemsize             # <<<<<<<<<<<<<<
  *         else:
  *             buffer.strides = NULL
  */
     __pyx_v_buffer->strides = (&__pyx_v_buffer->itemsize);
 
-    /* "sat_toolkit/formula.pyx":657
+    /* "sat_toolkit/formula.pyx":664
  *             buffer.shape = NULL
  * 
  *         if (flags & PyBUF_STRIDES) == PyBUF_STRIDES:             # <<<<<<<<<<<<<<
  *             buffer.strides = &buffer.itemsize
  *         else:
  */
     goto __pyx_L6;
   }
 
-  /* "sat_toolkit/formula.pyx":660
+  /* "sat_toolkit/formula.pyx":667
  *             buffer.strides = &buffer.itemsize
  *         else:
  *             buffer.strides = NULL             # <<<<<<<<<<<<<<
  * 
  *         buffer.suboffsets = NULL                # for pointer arrays only
  */
   /*else*/ {
     __pyx_v_buffer->strides = NULL;
   }
   __pyx_L6:;
 
-  /* "sat_toolkit/formula.pyx":662
+  /* "sat_toolkit/formula.pyx":669
  *             buffer.strides = NULL
  * 
  *         buffer.suboffsets = NULL                # for pointer arrays only             # <<<<<<<<<<<<<<
  * 
  *     def __releasebuffer__(self, Py_buffer *buffer):
  */
   __pyx_v_buffer->suboffsets = NULL;
 
-  /* "sat_toolkit/formula.pyx":632
+  /* "sat_toolkit/formula.pyx":639
  * 
  *     # buffer support
  *     def __getbuffer__(self, cython.Py_buffer *buffer, int flags):             # <<<<<<<<<<<<<<
  *         if flags & PyBUF_WRITABLE:
  *             raise ValueError(f'cannot provide a writable buffer for {type(self).__name__}')
  */
 
@@ -33102,15 +33239,15 @@
     __Pyx_DECREF(__pyx_v_buffer->obj); __pyx_v_buffer->obj = 0;
   }
   __pyx_L2:;
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "sat_toolkit/formula.pyx":664
+/* "sat_toolkit/formula.pyx":671
  *         buffer.suboffsets = NULL                # for pointer arrays only
  * 
  *     def __releasebuffer__(self, Py_buffer *buffer):             # <<<<<<<<<<<<<<
  *         buffer.buf = NULL;
  *         self.view_count -= 1
  */
 
@@ -33125,33 +33262,33 @@
 
   /* function exit code */
   __Pyx_RefNannyFinishContext();
 }
 
 static void __pyx_pf_11sat_toolkit_7formula_11_ClauseList_40__releasebuffer__(struct __pyx_obj_11sat_toolkit_7formula__ClauseList *__pyx_v_self, Py_buffer *__pyx_v_buffer) {
 
-  /* "sat_toolkit/formula.pyx":665
+  /* "sat_toolkit/formula.pyx":672
  * 
  *     def __releasebuffer__(self, Py_buffer *buffer):
  *         buffer.buf = NULL;             # <<<<<<<<<<<<<<
  *         self.view_count -= 1
  * 
  */
   __pyx_v_buffer->buf = NULL;
 
-  /* "sat_toolkit/formula.pyx":666
+  /* "sat_toolkit/formula.pyx":673
  *     def __releasebuffer__(self, Py_buffer *buffer):
  *         buffer.buf = NULL;
  *         self.view_count -= 1             # <<<<<<<<<<<<<<
  * 
  * 
  */
   __pyx_v_self->view_count = (__pyx_v_self->view_count - 1);
 
-  /* "sat_toolkit/formula.pyx":664
+  /* "sat_toolkit/formula.pyx":671
  *         buffer.suboffsets = NULL                # for pointer arrays only
  * 
  *     def __releasebuffer__(self, Py_buffer *buffer):             # <<<<<<<<<<<<<<
  *         buffer.buf = NULL;
  *         self.view_count -= 1
  */
 
@@ -33252,15 +33389,15 @@
   __pyx_r = NULL;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "sat_toolkit/formula.pyx":684
+/* "sat_toolkit/formula.pyx":691
  *     """
  * 
  *     @staticmethod             # <<<<<<<<<<<<<<
  *     def from_dimacs(dimacs: str) -> CNF:
  *         cdef XorCNF tmp = XorCNF.from_dimacs(dimacs)
  */
 
@@ -33314,45 +33451,45 @@
       kw_args = __Pyx_NumKwargs_FASTCALL(__pyx_kwds);
       switch (__pyx_nargs) {
         case  0:
         if (likely((values[0] = __Pyx_GetKwValue_FASTCALL(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_dimacs)) != 0)) {
           (void)__Pyx_Arg_NewRef_FASTCALL(values[0]);
           kw_args--;
         }
-        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 684, __pyx_L3_error)
+        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 691, __pyx_L3_error)
         else goto __pyx_L5_argtuple_error;
       }
       if (unlikely(kw_args > 0)) {
         const Py_ssize_t kwd_pos_args = __pyx_nargs;
-        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values + 0, kwd_pos_args, "from_dimacs") < 0)) __PYX_ERR(0, 684, __pyx_L3_error)
+        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values + 0, kwd_pos_args, "from_dimacs") < 0)) __PYX_ERR(0, 691, __pyx_L3_error)
       }
     } else if (unlikely(__pyx_nargs != 1)) {
       goto __pyx_L5_argtuple_error;
     } else {
       values[0] = __Pyx_Arg_FASTCALL(__pyx_args, 0);
     }
     __pyx_v_dimacs = ((PyObject*)values[0]);
   }
   goto __pyx_L6_skip;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("from_dimacs", 1, 1, 1, __pyx_nargs); __PYX_ERR(0, 684, __pyx_L3_error)
+  __Pyx_RaiseArgtupleInvalid("from_dimacs", 1, 1, 1, __pyx_nargs); __PYX_ERR(0, 691, __pyx_L3_error)
   __pyx_L6_skip:;
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L3_error:;
   {
     Py_ssize_t __pyx_temp;
     for (__pyx_temp=0; __pyx_temp < (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
       __Pyx_Arg_XDECREF_FASTCALL(values[__pyx_temp]);
     }
   }
   __Pyx_AddTraceback("sat_toolkit.formula.CNF.from_dimacs", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __Pyx_RefNannyFinishContext();
   return NULL;
   __pyx_L4_argument_unpacking_done:;
-  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_dimacs), (&PyUnicode_Type), 0, "dimacs", 1))) __PYX_ERR(0, 685, __pyx_L1_error)
+  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_dimacs), (&PyUnicode_Type), 0, "dimacs", 1))) __PYX_ERR(0, 692, __pyx_L1_error)
   __pyx_r = __pyx_pf_11sat_toolkit_7formula_3CNF_from_dimacs(__pyx_v_dimacs);
 
   /* function exit code */
   goto __pyx_L0;
   __pyx_L1_error:;
   __pyx_r = NULL;
   __pyx_L0:;
@@ -33377,22 +33514,22 @@
   Py_ssize_t __pyx_t_5;
   int __pyx_t_6;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("from_dimacs", 1);
 
-  /* "sat_toolkit/formula.pyx":686
+  /* "sat_toolkit/formula.pyx":693
  *     @staticmethod
  *     def from_dimacs(dimacs: str) -> CNF:
  *         cdef XorCNF tmp = XorCNF.from_dimacs(dimacs)             # <<<<<<<<<<<<<<
  *         if len(tmp._xor_clauses) > 0:
  *             raise ValueError('CNF must not contain xor clauses')
  */
-  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_ptype_11sat_toolkit_7formula_XorCNF), __pyx_n_s_from_dimacs); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 686, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_ptype_11sat_toolkit_7formula_XorCNF), __pyx_n_s_from_dimacs); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 693, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __pyx_t_3 = NULL;
   __pyx_t_4 = 0;
   #if CYTHON_UNPACK_METHODS
   if (likely(PyMethod_Check(__pyx_t_2))) {
     __pyx_t_3 = PyMethod_GET_SELF(__pyx_t_2);
     if (likely(__pyx_t_3)) {
@@ -33404,71 +33541,71 @@
     }
   }
   #endif
   {
     PyObject *__pyx_callargs[2] = {__pyx_t_3, __pyx_v_dimacs};
     __pyx_t_1 = __Pyx_PyObject_FastCall(__pyx_t_2, __pyx_callargs+1-__pyx_t_4, 1+__pyx_t_4);
     __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
-    if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 686, __pyx_L1_error)
+    if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 693, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   }
-  if (!(likely(((__pyx_t_1) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_1, __pyx_ptype_11sat_toolkit_7formula_XorCNF))))) __PYX_ERR(0, 686, __pyx_L1_error)
+  if (!(likely(((__pyx_t_1) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_1, __pyx_ptype_11sat_toolkit_7formula_XorCNF))))) __PYX_ERR(0, 693, __pyx_L1_error)
   __pyx_v_tmp = ((struct __pyx_obj_11sat_toolkit_7formula_XorCNF *)__pyx_t_1);
   __pyx_t_1 = 0;
 
-  /* "sat_toolkit/formula.pyx":687
+  /* "sat_toolkit/formula.pyx":694
  *     def from_dimacs(dimacs: str) -> CNF:
  *         cdef XorCNF tmp = XorCNF.from_dimacs(dimacs)
  *         if len(tmp._xor_clauses) > 0:             # <<<<<<<<<<<<<<
  *             raise ValueError('CNF must not contain xor clauses')
  * 
  */
   __pyx_t_1 = ((PyObject *)__pyx_v_tmp->_xor_clauses);
   __Pyx_INCREF(__pyx_t_1);
-  __pyx_t_5 = PyObject_Length(__pyx_t_1); if (unlikely(__pyx_t_5 == ((Py_ssize_t)-1))) __PYX_ERR(0, 687, __pyx_L1_error)
+  __pyx_t_5 = PyObject_Length(__pyx_t_1); if (unlikely(__pyx_t_5 == ((Py_ssize_t)-1))) __PYX_ERR(0, 694, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __pyx_t_6 = (__pyx_t_5 > 0);
   if (unlikely(__pyx_t_6)) {
 
-    /* "sat_toolkit/formula.pyx":688
+    /* "sat_toolkit/formula.pyx":695
  *         cdef XorCNF tmp = XorCNF.from_dimacs(dimacs)
  *         if len(tmp._xor_clauses) > 0:
  *             raise ValueError('CNF must not contain xor clauses')             # <<<<<<<<<<<<<<
  * 
  *         return tmp._clauses
  */
-    __pyx_t_1 = __Pyx_PyObject_Call(__pyx_builtin_ValueError, __pyx_tuple__26, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 688, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyObject_Call(__pyx_builtin_ValueError, __pyx_tuple__26, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 695, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_Raise(__pyx_t_1, 0, 0, 0);
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-    __PYX_ERR(0, 688, __pyx_L1_error)
+    __PYX_ERR(0, 695, __pyx_L1_error)
 
-    /* "sat_toolkit/formula.pyx":687
+    /* "sat_toolkit/formula.pyx":694
  *     def from_dimacs(dimacs: str) -> CNF:
  *         cdef XorCNF tmp = XorCNF.from_dimacs(dimacs)
  *         if len(tmp._xor_clauses) > 0:             # <<<<<<<<<<<<<<
  *             raise ValueError('CNF must not contain xor clauses')
  * 
  */
   }
 
-  /* "sat_toolkit/formula.pyx":690
+  /* "sat_toolkit/formula.pyx":697
  *             raise ValueError('CNF must not contain xor clauses')
  * 
  *         return tmp._clauses             # <<<<<<<<<<<<<<
  * 
  *     @staticmethod
  */
   __Pyx_XDECREF((PyObject *)__pyx_r);
   __Pyx_INCREF((PyObject *)__pyx_v_tmp->_clauses);
   __pyx_r = __pyx_v_tmp->_clauses;
   goto __pyx_L0;
 
-  /* "sat_toolkit/formula.pyx":684
+  /* "sat_toolkit/formula.pyx":691
  *     """
  * 
  *     @staticmethod             # <<<<<<<<<<<<<<
  *     def from_dimacs(dimacs: str) -> CNF:
  *         cdef XorCNF tmp = XorCNF.from_dimacs(dimacs)
  */
 
@@ -33482,15 +33619,15 @@
   __pyx_L0:;
   __Pyx_XDECREF((PyObject *)__pyx_v_tmp);
   __Pyx_XGIVEREF((PyObject *)__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "sat_toolkit/formula.pyx":692
+/* "sat_toolkit/formula.pyx":699
  *         return tmp._clauses
  * 
  *     @staticmethod             # <<<<<<<<<<<<<<
  *     def from_espresso(espresso: str) -> CNF:
  *         cdef vector[int] clauses
  */
 
@@ -33544,45 +33681,45 @@
       kw_args = __Pyx_NumKwargs_FASTCALL(__pyx_kwds);
       switch (__pyx_nargs) {
         case  0:
         if (likely((values[0] = __Pyx_GetKwValue_FASTCALL(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_espresso)) != 0)) {
           (void)__Pyx_Arg_NewRef_FASTCALL(values[0]);
           kw_args--;
         }
-        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 692, __pyx_L3_error)
+        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 699, __pyx_L3_error)
         else goto __pyx_L5_argtuple_error;
       }
       if (unlikely(kw_args > 0)) {
         const Py_ssize_t kwd_pos_args = __pyx_nargs;
-        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values + 0, kwd_pos_args, "from_espresso") < 0)) __PYX_ERR(0, 692, __pyx_L3_error)
+        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values + 0, kwd_pos_args, "from_espresso") < 0)) __PYX_ERR(0, 699, __pyx_L3_error)
       }
     } else if (unlikely(__pyx_nargs != 1)) {
       goto __pyx_L5_argtuple_error;
     } else {
       values[0] = __Pyx_Arg_FASTCALL(__pyx_args, 0);
     }
     __pyx_v_espresso = ((PyObject*)values[0]);
   }
   goto __pyx_L6_skip;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("from_espresso", 1, 1, 1, __pyx_nargs); __PYX_ERR(0, 692, __pyx_L3_error)
+  __Pyx_RaiseArgtupleInvalid("from_espresso", 1, 1, 1, __pyx_nargs); __PYX_ERR(0, 699, __pyx_L3_error)
   __pyx_L6_skip:;
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L3_error:;
   {
     Py_ssize_t __pyx_temp;
     for (__pyx_temp=0; __pyx_temp < (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
       __Pyx_Arg_XDECREF_FASTCALL(values[__pyx_temp]);
     }
   }
   __Pyx_AddTraceback("sat_toolkit.formula.CNF.from_espresso", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __Pyx_RefNannyFinishContext();
   return NULL;
   __pyx_L4_argument_unpacking_done:;
-  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_espresso), (&PyUnicode_Type), 0, "espresso", 1))) __PYX_ERR(0, 693, __pyx_L1_error)
+  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_espresso), (&PyUnicode_Type), 0, "espresso", 1))) __PYX_ERR(0, 700, __pyx_L1_error)
   __pyx_r = __pyx_pf_11sat_toolkit_7formula_3CNF_2from_espresso(__pyx_v_espresso);
 
   /* function exit code */
   goto __pyx_L0;
   __pyx_L1_error:;
   __pyx_r = NULL;
   __pyx_L0:;
@@ -33632,36 +33769,36 @@
   struct __pyx_array_obj *__pyx_t_21 = NULL;
   __Pyx_memviewslice __pyx_t_22 = { 0, 0, { 0 }, { 0 }, { 0 } };
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("from_espresso", 1);
 
-  /* "sat_toolkit/formula.pyx":699
+  /* "sat_toolkit/formula.pyx":706
  *         cdef char val
  *         cdef uint64_t mask, sign
  *         cdef unsigned int numbits = 0             # <<<<<<<<<<<<<<
  *         cdef size_t i
  * 
  */
   __pyx_v_numbits = 0;
 
-  /* "sat_toolkit/formula.pyx":702
+  /* "sat_toolkit/formula.pyx":709
  *         cdef size_t i
  * 
  *         f = io.BytesIO(espresso.encode())             # <<<<<<<<<<<<<<
  * 
  *         for line_py in f:
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_io); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 702, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_io); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 709, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_BytesIO); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 702, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_BytesIO); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 709, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __pyx_t_2 = PyUnicode_AsEncodedString(__pyx_v_espresso, NULL, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 702, __pyx_L1_error)
+  __pyx_t_2 = PyUnicode_AsEncodedString(__pyx_v_espresso, NULL, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 709, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __pyx_t_4 = NULL;
   __pyx_t_5 = 0;
   #if CYTHON_UNPACK_METHODS
   if (unlikely(PyMethod_Check(__pyx_t_3))) {
     __pyx_t_4 = PyMethod_GET_SELF(__pyx_t_3);
     if (likely(__pyx_t_4)) {
@@ -33674,91 +33811,91 @@
   }
   #endif
   {
     PyObject *__pyx_callargs[2] = {__pyx_t_4, __pyx_t_2};
     __pyx_t_1 = __Pyx_PyObject_FastCall(__pyx_t_3, __pyx_callargs+1-__pyx_t_5, 1+__pyx_t_5);
     __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-    if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 702, __pyx_L1_error)
+    if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 709, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   }
   __pyx_v_f = __pyx_t_1;
   __pyx_t_1 = 0;
 
-  /* "sat_toolkit/formula.pyx":704
+  /* "sat_toolkit/formula.pyx":711
  *         f = io.BytesIO(espresso.encode())
  * 
  *         for line_py in f:             # <<<<<<<<<<<<<<
  *             line = line_py.rstrip()
  *             if startswith(line, b'.i '):
  */
   if (likely(PyList_CheckExact(__pyx_v_f)) || PyTuple_CheckExact(__pyx_v_f)) {
     __pyx_t_1 = __pyx_v_f; __Pyx_INCREF(__pyx_t_1);
     __pyx_t_6 = 0;
     __pyx_t_7 = NULL;
   } else {
-    __pyx_t_6 = -1; __pyx_t_1 = PyObject_GetIter(__pyx_v_f); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 704, __pyx_L1_error)
+    __pyx_t_6 = -1; __pyx_t_1 = PyObject_GetIter(__pyx_v_f); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 711, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
-    __pyx_t_7 = __Pyx_PyObject_GetIterNextFunc(__pyx_t_1); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 704, __pyx_L1_error)
+    __pyx_t_7 = __Pyx_PyObject_GetIterNextFunc(__pyx_t_1); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 711, __pyx_L1_error)
   }
   for (;;) {
     if (likely(!__pyx_t_7)) {
       if (likely(PyList_CheckExact(__pyx_t_1))) {
         {
           Py_ssize_t __pyx_temp = __Pyx_PyList_GET_SIZE(__pyx_t_1);
           #if !CYTHON_ASSUME_SAFE_MACROS
-          if (unlikely((__pyx_temp < 0))) __PYX_ERR(0, 704, __pyx_L1_error)
+          if (unlikely((__pyx_temp < 0))) __PYX_ERR(0, 711, __pyx_L1_error)
           #endif
           if (__pyx_t_6 >= __pyx_temp) break;
         }
         #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-        __pyx_t_3 = PyList_GET_ITEM(__pyx_t_1, __pyx_t_6); __Pyx_INCREF(__pyx_t_3); __pyx_t_6++; if (unlikely((0 < 0))) __PYX_ERR(0, 704, __pyx_L1_error)
+        __pyx_t_3 = PyList_GET_ITEM(__pyx_t_1, __pyx_t_6); __Pyx_INCREF(__pyx_t_3); __pyx_t_6++; if (unlikely((0 < 0))) __PYX_ERR(0, 711, __pyx_L1_error)
         #else
-        __pyx_t_3 = __Pyx_PySequence_ITEM(__pyx_t_1, __pyx_t_6); __pyx_t_6++; if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 704, __pyx_L1_error)
+        __pyx_t_3 = __Pyx_PySequence_ITEM(__pyx_t_1, __pyx_t_6); __pyx_t_6++; if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 711, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_3);
         #endif
       } else {
         {
           Py_ssize_t __pyx_temp = __Pyx_PyTuple_GET_SIZE(__pyx_t_1);
           #if !CYTHON_ASSUME_SAFE_MACROS
-          if (unlikely((__pyx_temp < 0))) __PYX_ERR(0, 704, __pyx_L1_error)
+          if (unlikely((__pyx_temp < 0))) __PYX_ERR(0, 711, __pyx_L1_error)
           #endif
           if (__pyx_t_6 >= __pyx_temp) break;
         }
         #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-        __pyx_t_3 = PyTuple_GET_ITEM(__pyx_t_1, __pyx_t_6); __Pyx_INCREF(__pyx_t_3); __pyx_t_6++; if (unlikely((0 < 0))) __PYX_ERR(0, 704, __pyx_L1_error)
+        __pyx_t_3 = PyTuple_GET_ITEM(__pyx_t_1, __pyx_t_6); __Pyx_INCREF(__pyx_t_3); __pyx_t_6++; if (unlikely((0 < 0))) __PYX_ERR(0, 711, __pyx_L1_error)
         #else
-        __pyx_t_3 = __Pyx_PySequence_ITEM(__pyx_t_1, __pyx_t_6); __pyx_t_6++; if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 704, __pyx_L1_error)
+        __pyx_t_3 = __Pyx_PySequence_ITEM(__pyx_t_1, __pyx_t_6); __pyx_t_6++; if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 711, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_3);
         #endif
       }
     } else {
       __pyx_t_3 = __pyx_t_7(__pyx_t_1);
       if (unlikely(!__pyx_t_3)) {
         PyObject* exc_type = PyErr_Occurred();
         if (exc_type) {
           if (likely(__Pyx_PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
-          else __PYX_ERR(0, 704, __pyx_L1_error)
+          else __PYX_ERR(0, 711, __pyx_L1_error)
         }
         break;
       }
       __Pyx_GOTREF(__pyx_t_3);
     }
     __Pyx_XDECREF_SET(__pyx_v_line_py, __pyx_t_3);
     __pyx_t_3 = 0;
 
-    /* "sat_toolkit/formula.pyx":705
+    /* "sat_toolkit/formula.pyx":712
  * 
  *         for line_py in f:
  *             line = line_py.rstrip()             # <<<<<<<<<<<<<<
  *             if startswith(line, b'.i '):
  *                 _, bits = line_py.split()
  */
-    __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_line_py, __pyx_n_s_rstrip); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 705, __pyx_L1_error)
+    __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_line_py, __pyx_n_s_rstrip); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 712, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
     __pyx_t_4 = NULL;
     __pyx_t_5 = 0;
     #if CYTHON_UNPACK_METHODS
     if (likely(PyMethod_Check(__pyx_t_2))) {
       __pyx_t_4 = PyMethod_GET_SELF(__pyx_t_2);
       if (likely(__pyx_t_4)) {
@@ -33770,43 +33907,43 @@
       }
     }
     #endif
     {
       PyObject *__pyx_callargs[2] = {__pyx_t_4, NULL};
       __pyx_t_3 = __Pyx_PyObject_FastCall(__pyx_t_2, __pyx_callargs+1-__pyx_t_5, 0+__pyx_t_5);
       __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
-      if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 705, __pyx_L1_error)
+      if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 712, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_3);
       __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
     }
-    __pyx_t_8 = __Pyx_PyObject_to_MemoryviewSlice_ds_unsigned_char__const__(__pyx_t_3, 0); if (unlikely(!__pyx_t_8.memview)) __PYX_ERR(0, 705, __pyx_L1_error)
+    __pyx_t_8 = __Pyx_PyObject_to_MemoryviewSlice_ds_unsigned_char__const__(__pyx_t_3, 0); if (unlikely(!__pyx_t_8.memview)) __PYX_ERR(0, 712, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
     __PYX_XCLEAR_MEMVIEW(&__pyx_v_line, 1);
     __pyx_v_line = __pyx_t_8;
     __pyx_t_8.memview = NULL;
     __pyx_t_8.data = NULL;
 
-    /* "sat_toolkit/formula.pyx":706
+    /* "sat_toolkit/formula.pyx":713
  *         for line_py in f:
  *             line = line_py.rstrip()
  *             if startswith(line, b'.i '):             # <<<<<<<<<<<<<<
  *                 _, bits = line_py.split()
  *                 numbits = int(bits)
  */
     __pyx_t_9 = (__pyx_f_11sat_toolkit_7formula_startswith(__pyx_v_line, ((char const *)".i ")) != 0);
     if (__pyx_t_9) {
 
-      /* "sat_toolkit/formula.pyx":707
+      /* "sat_toolkit/formula.pyx":714
  *             line = line_py.rstrip()
  *             if startswith(line, b'.i '):
  *                 _, bits = line_py.split()             # <<<<<<<<<<<<<<
  *                 numbits = int(bits)
  *             if startswith(line, b'.p '):
  */
-      __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_line_py, __pyx_n_s_split); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 707, __pyx_L1_error)
+      __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_line_py, __pyx_n_s_split); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 714, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_2);
       __pyx_t_4 = NULL;
       __pyx_t_5 = 0;
       #if CYTHON_UNPACK_METHODS
       if (likely(PyMethod_Check(__pyx_t_2))) {
         __pyx_t_4 = PyMethod_GET_SELF(__pyx_t_2);
         if (likely(__pyx_t_4)) {
@@ -33818,103 +33955,103 @@
         }
       }
       #endif
       {
         PyObject *__pyx_callargs[2] = {__pyx_t_4, NULL};
         __pyx_t_3 = __Pyx_PyObject_FastCall(__pyx_t_2, __pyx_callargs+1-__pyx_t_5, 0+__pyx_t_5);
         __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
-        if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 707, __pyx_L1_error)
+        if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 714, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_3);
         __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
       }
       if ((likely(PyTuple_CheckExact(__pyx_t_3))) || (PyList_CheckExact(__pyx_t_3))) {
         PyObject* sequence = __pyx_t_3;
         Py_ssize_t size = __Pyx_PySequence_SIZE(sequence);
         if (unlikely(size != 2)) {
           if (size > 2) __Pyx_RaiseTooManyValuesError(2);
           else if (size >= 0) __Pyx_RaiseNeedMoreValuesError(size);
-          __PYX_ERR(0, 707, __pyx_L1_error)
+          __PYX_ERR(0, 714, __pyx_L1_error)
         }
         #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
         if (likely(PyTuple_CheckExact(sequence))) {
           __pyx_t_2 = PyTuple_GET_ITEM(sequence, 0); 
           __pyx_t_4 = PyTuple_GET_ITEM(sequence, 1); 
         } else {
           __pyx_t_2 = PyList_GET_ITEM(sequence, 0); 
           __pyx_t_4 = PyList_GET_ITEM(sequence, 1); 
         }
         __Pyx_INCREF(__pyx_t_2);
         __Pyx_INCREF(__pyx_t_4);
         #else
-        __pyx_t_2 = PySequence_ITEM(sequence, 0); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 707, __pyx_L1_error)
+        __pyx_t_2 = PySequence_ITEM(sequence, 0); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 714, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_2);
-        __pyx_t_4 = PySequence_ITEM(sequence, 1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 707, __pyx_L1_error)
+        __pyx_t_4 = PySequence_ITEM(sequence, 1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 714, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_4);
         #endif
         __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
       } else {
         Py_ssize_t index = -1;
-        __pyx_t_10 = PyObject_GetIter(__pyx_t_3); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 707, __pyx_L1_error)
+        __pyx_t_10 = PyObject_GetIter(__pyx_t_3); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 714, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_10);
         __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
         __pyx_t_11 = __Pyx_PyObject_GetIterNextFunc(__pyx_t_10);
         index = 0; __pyx_t_2 = __pyx_t_11(__pyx_t_10); if (unlikely(!__pyx_t_2)) goto __pyx_L6_unpacking_failed;
         __Pyx_GOTREF(__pyx_t_2);
         index = 1; __pyx_t_4 = __pyx_t_11(__pyx_t_10); if (unlikely(!__pyx_t_4)) goto __pyx_L6_unpacking_failed;
         __Pyx_GOTREF(__pyx_t_4);
-        if (__Pyx_IternextUnpackEndCheck(__pyx_t_11(__pyx_t_10), 2) < 0) __PYX_ERR(0, 707, __pyx_L1_error)
+        if (__Pyx_IternextUnpackEndCheck(__pyx_t_11(__pyx_t_10), 2) < 0) __PYX_ERR(0, 714, __pyx_L1_error)
         __pyx_t_11 = NULL;
         __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
         goto __pyx_L7_unpacking_done;
         __pyx_L6_unpacking_failed:;
         __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
         __pyx_t_11 = NULL;
         if (__Pyx_IterFinish() == 0) __Pyx_RaiseNeedMoreValuesError(index);
-        __PYX_ERR(0, 707, __pyx_L1_error)
+        __PYX_ERR(0, 714, __pyx_L1_error)
         __pyx_L7_unpacking_done:;
       }
       __Pyx_XDECREF_SET(__pyx_v__, __pyx_t_2);
       __pyx_t_2 = 0;
       __Pyx_XDECREF_SET(__pyx_v_bits, __pyx_t_4);
       __pyx_t_4 = 0;
 
-      /* "sat_toolkit/formula.pyx":708
+      /* "sat_toolkit/formula.pyx":715
  *             if startswith(line, b'.i '):
  *                 _, bits = line_py.split()
  *                 numbits = int(bits)             # <<<<<<<<<<<<<<
  *             if startswith(line, b'.p '):
  *                 ...
  */
-      __pyx_t_3 = __Pyx_PyNumber_Int(__pyx_v_bits); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 708, __pyx_L1_error)
+      __pyx_t_3 = __Pyx_PyNumber_Int(__pyx_v_bits); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 715, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_3);
-      __pyx_t_12 = __Pyx_PyInt_As_unsigned_int(__pyx_t_3); if (unlikely((__pyx_t_12 == (unsigned int)-1) && PyErr_Occurred())) __PYX_ERR(0, 708, __pyx_L1_error)
+      __pyx_t_12 = __Pyx_PyInt_As_unsigned_int(__pyx_t_3); if (unlikely((__pyx_t_12 == (unsigned int)-1) && PyErr_Occurred())) __PYX_ERR(0, 715, __pyx_L1_error)
       __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
       __pyx_v_numbits = __pyx_t_12;
 
-      /* "sat_toolkit/formula.pyx":706
+      /* "sat_toolkit/formula.pyx":713
  *         for line_py in f:
  *             line = line_py.rstrip()
  *             if startswith(line, b'.i '):             # <<<<<<<<<<<<<<
  *                 _, bits = line_py.split()
  *                 numbits = int(bits)
  */
     }
 
-    /* "sat_toolkit/formula.pyx":709
+    /* "sat_toolkit/formula.pyx":716
  *                 _, bits = line_py.split()
  *                 numbits = int(bits)
  *             if startswith(line, b'.p '):             # <<<<<<<<<<<<<<
  *                 ...
  *             if startswith(line, b'#') or startswith(line, b'.'):
  */
     __pyx_t_9 = (__pyx_f_11sat_toolkit_7formula_startswith(__pyx_v_line, ((char const *)".p ")) != 0);
     if (__pyx_t_9) {
     }
 
-    /* "sat_toolkit/formula.pyx":711
+    /* "sat_toolkit/formula.pyx":718
  *             if startswith(line, b'.p '):
  *                 ...
  *             if startswith(line, b'#') or startswith(line, b'.'):             # <<<<<<<<<<<<<<
  *                 continue
  * 
  */
     __pyx_t_13 = (__pyx_f_11sat_toolkit_7formula_startswith(__pyx_v_line, ((char const *)"#")) != 0);
@@ -33924,43 +34061,43 @@
       goto __pyx_L10_bool_binop_done;
     }
     __pyx_t_13 = (__pyx_f_11sat_toolkit_7formula_startswith(__pyx_v_line, ((char const *)".")) != 0);
     __pyx_t_9 = __pyx_t_13;
     __pyx_L10_bool_binop_done:;
     if (__pyx_t_9) {
 
-      /* "sat_toolkit/formula.pyx":712
+      /* "sat_toolkit/formula.pyx":719
  *                 ...
  *             if startswith(line, b'#') or startswith(line, b'.'):
  *                 continue             # <<<<<<<<<<<<<<
  * 
  *             val = line[line.shape[0] - 1]
  */
       goto __pyx_L3_continue;
 
-      /* "sat_toolkit/formula.pyx":711
+      /* "sat_toolkit/formula.pyx":718
  *             if startswith(line, b'.p '):
  *                 ...
  *             if startswith(line, b'#') or startswith(line, b'.'):             # <<<<<<<<<<<<<<
  *                 continue
  * 
  */
     }
 
-    /* "sat_toolkit/formula.pyx":714
+    /* "sat_toolkit/formula.pyx":721
  *                 continue
  * 
  *             val = line[line.shape[0] - 1]             # <<<<<<<<<<<<<<
  *             if line.shape[0] != numbits + 2 or line[line.shape[0] - 2] != b' ':
  *                 raise ValueError('file format error')
  */
     __pyx_t_14 = ((__pyx_v_line.shape[0]) - 1);
     __pyx_v_val = (*((unsigned char const  *) ( /* dim=0 */ (__pyx_v_line.data + __pyx_t_14 * __pyx_v_line.strides[0]) )));
 
-    /* "sat_toolkit/formula.pyx":715
+    /* "sat_toolkit/formula.pyx":722
  * 
  *             val = line[line.shape[0] - 1]
  *             if line.shape[0] != numbits + 2 or line[line.shape[0] - 2] != b' ':             # <<<<<<<<<<<<<<
  *                 raise ValueError('file format error')
  * 
  */
     __pyx_t_13 = ((__pyx_v_line.shape[0]) != (__pyx_v_numbits + 2));
@@ -33971,374 +34108,374 @@
     }
     __pyx_t_14 = ((__pyx_v_line.shape[0]) - 2);
     __pyx_t_13 = ((*((unsigned char const  *) ( /* dim=0 */ (__pyx_v_line.data + __pyx_t_14 * __pyx_v_line.strides[0]) ))) != ' ');
     __pyx_t_9 = __pyx_t_13;
     __pyx_L13_bool_binop_done:;
     if (unlikely(__pyx_t_9)) {
 
-      /* "sat_toolkit/formula.pyx":716
+      /* "sat_toolkit/formula.pyx":723
  *             val = line[line.shape[0] - 1]
  *             if line.shape[0] != numbits + 2 or line[line.shape[0] - 2] != b' ':
  *                 raise ValueError('file format error')             # <<<<<<<<<<<<<<
  * 
  *             #espresso_mask, val = line.split()
  */
-      __pyx_t_3 = __Pyx_PyObject_Call(__pyx_builtin_ValueError, __pyx_tuple__27, NULL); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 716, __pyx_L1_error)
+      __pyx_t_3 = __Pyx_PyObject_Call(__pyx_builtin_ValueError, __pyx_tuple__27, NULL); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 723, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_3);
       __Pyx_Raise(__pyx_t_3, 0, 0, 0);
       __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-      __PYX_ERR(0, 716, __pyx_L1_error)
+      __PYX_ERR(0, 723, __pyx_L1_error)
 
-      /* "sat_toolkit/formula.pyx":715
+      /* "sat_toolkit/formula.pyx":722
  * 
  *             val = line[line.shape[0] - 1]
  *             if line.shape[0] != numbits + 2 or line[line.shape[0] - 2] != b' ':             # <<<<<<<<<<<<<<
  *                 raise ValueError('file format error')
  * 
  */
     }
 
-    /* "sat_toolkit/formula.pyx":720
+    /* "sat_toolkit/formula.pyx":727
  *             #espresso_mask, val = line.split()
  * 
  *             if val != b'1':             # <<<<<<<<<<<<<<
  *                 raise ValueError(f'got unexpected value for product term: {val!r} expected \'1\'.')
  * 
  */
     __pyx_t_9 = (__pyx_v_val != '1');
     if (unlikely(__pyx_t_9)) {
 
-      /* "sat_toolkit/formula.pyx":721
+      /* "sat_toolkit/formula.pyx":728
  * 
  *             if val != b'1':
  *                 raise ValueError(f'got unexpected value for product term: {val!r} expected \'1\'.')             # <<<<<<<<<<<<<<
  * 
  *             for i in range(numbits):
  */
-      __pyx_t_3 = PyTuple_New(3); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 721, __pyx_L1_error)
+      __pyx_t_3 = PyTuple_New(3); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 728, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_3);
       __pyx_t_15 = 0;
       __pyx_t_16 = 127;
       __Pyx_INCREF(__pyx_kp_u_got_unexpected_value_for_product);
       __pyx_t_15 += 39;
       __Pyx_GIVEREF(__pyx_kp_u_got_unexpected_value_for_product);
       PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_kp_u_got_unexpected_value_for_product);
-      __pyx_t_4 = __Pyx_PyUnicode_From_char(__pyx_v_val, 0, ' ', 'd'); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 721, __pyx_L1_error)
+      __pyx_t_4 = __Pyx_PyUnicode_From_char(__pyx_v_val, 0, ' ', 'd'); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 728, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_4);
       __pyx_t_15 += __Pyx_PyUnicode_GET_LENGTH(__pyx_t_4);
       __Pyx_GIVEREF(__pyx_t_4);
       PyTuple_SET_ITEM(__pyx_t_3, 1, __pyx_t_4);
       __pyx_t_4 = 0;
       __Pyx_INCREF(__pyx_kp_u_expected_1);
       __pyx_t_15 += 14;
       __Pyx_GIVEREF(__pyx_kp_u_expected_1);
       PyTuple_SET_ITEM(__pyx_t_3, 2, __pyx_kp_u_expected_1);
-      __pyx_t_4 = __Pyx_PyUnicode_Join(__pyx_t_3, 3, __pyx_t_15, __pyx_t_16); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 721, __pyx_L1_error)
+      __pyx_t_4 = __Pyx_PyUnicode_Join(__pyx_t_3, 3, __pyx_t_15, __pyx_t_16); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 728, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_4);
       __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-      __pyx_t_3 = __Pyx_PyObject_CallOneArg(__pyx_builtin_ValueError, __pyx_t_4); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 721, __pyx_L1_error)
+      __pyx_t_3 = __Pyx_PyObject_CallOneArg(__pyx_builtin_ValueError, __pyx_t_4); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 728, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_3);
       __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
       __Pyx_Raise(__pyx_t_3, 0, 0, 0);
       __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-      __PYX_ERR(0, 721, __pyx_L1_error)
+      __PYX_ERR(0, 728, __pyx_L1_error)
 
-      /* "sat_toolkit/formula.pyx":720
+      /* "sat_toolkit/formula.pyx":727
  *             #espresso_mask, val = line.split()
  * 
  *             if val != b'1':             # <<<<<<<<<<<<<<
  *                 raise ValueError(f'got unexpected value for product term: {val!r} expected \'1\'.')
  * 
  */
     }
 
-    /* "sat_toolkit/formula.pyx":723
+    /* "sat_toolkit/formula.pyx":730
  *                 raise ValueError(f'got unexpected value for product term: {val!r} expected \'1\'.')
  * 
  *             for i in range(numbits):             # <<<<<<<<<<<<<<
  *                 val = line[numbits - 1 - i]
  *                 if val == b'-':
  */
     __pyx_t_12 = __pyx_v_numbits;
     __pyx_t_17 = __pyx_t_12;
     for (__pyx_t_18 = 0; __pyx_t_18 < __pyx_t_17; __pyx_t_18+=1) {
       __pyx_v_i = __pyx_t_18;
 
-      /* "sat_toolkit/formula.pyx":724
+      /* "sat_toolkit/formula.pyx":731
  * 
  *             for i in range(numbits):
  *                 val = line[numbits - 1 - i]             # <<<<<<<<<<<<<<
  *                 if val == b'-':
  *                     continue
  */
       __pyx_t_19 = ((__pyx_v_numbits - 1) - __pyx_v_i);
       __pyx_v_val = (*((unsigned char const  *) ( /* dim=0 */ (__pyx_v_line.data + __pyx_t_19 * __pyx_v_line.strides[0]) )));
 
-      /* "sat_toolkit/formula.pyx":725
+      /* "sat_toolkit/formula.pyx":732
  *             for i in range(numbits):
  *                 val = line[numbits - 1 - i]
  *                 if val == b'-':             # <<<<<<<<<<<<<<
  *                     continue
  *                 # 0/1 swapped according to De Morgan's law
  */
       __pyx_t_9 = (__pyx_v_val == '-');
       if (__pyx_t_9) {
 
-        /* "sat_toolkit/formula.pyx":726
+        /* "sat_toolkit/formula.pyx":733
  *                 val = line[numbits - 1 - i]
  *                 if val == b'-':
  *                     continue             # <<<<<<<<<<<<<<
  *                 # 0/1 swapped according to De Morgan's law
  *                 if val == b'0':
  */
         goto __pyx_L16_continue;
 
-        /* "sat_toolkit/formula.pyx":725
+        /* "sat_toolkit/formula.pyx":732
  *             for i in range(numbits):
  *                 val = line[numbits - 1 - i]
  *                 if val == b'-':             # <<<<<<<<<<<<<<
  *                     continue
  *                 # 0/1 swapped according to De Morgan's law
  */
       }
 
-      /* "sat_toolkit/formula.pyx":728
+      /* "sat_toolkit/formula.pyx":735
  *                     continue
  *                 # 0/1 swapped according to De Morgan's law
  *                 if val == b'0':             # <<<<<<<<<<<<<<
  *                     clauses.push_back((i + 1))
  *                     continue
  */
       __pyx_t_9 = (__pyx_v_val == '0');
       if (__pyx_t_9) {
 
-        /* "sat_toolkit/formula.pyx":729
+        /* "sat_toolkit/formula.pyx":736
  *                 # 0/1 swapped according to De Morgan's law
  *                 if val == b'0':
  *                     clauses.push_back((i + 1))             # <<<<<<<<<<<<<<
  *                     continue
  *                 if val == b'1':
  */
         try {
           __pyx_v_clauses.push_back((__pyx_v_i + 1));
         } catch(...) {
           __Pyx_CppExn2PyErr();
-          __PYX_ERR(0, 729, __pyx_L1_error)
+          __PYX_ERR(0, 736, __pyx_L1_error)
         }
 
-        /* "sat_toolkit/formula.pyx":730
+        /* "sat_toolkit/formula.pyx":737
  *                 if val == b'0':
  *                     clauses.push_back((i + 1))
  *                     continue             # <<<<<<<<<<<<<<
  *                 if val == b'1':
  *                     clauses.push_back(-(i + 1))
  */
         goto __pyx_L16_continue;
 
-        /* "sat_toolkit/formula.pyx":728
+        /* "sat_toolkit/formula.pyx":735
  *                     continue
  *                 # 0/1 swapped according to De Morgan's law
  *                 if val == b'0':             # <<<<<<<<<<<<<<
  *                     clauses.push_back((i + 1))
  *                     continue
  */
       }
 
-      /* "sat_toolkit/formula.pyx":731
+      /* "sat_toolkit/formula.pyx":738
  *                     clauses.push_back((i + 1))
  *                     continue
  *                 if val == b'1':             # <<<<<<<<<<<<<<
  *                     clauses.push_back(-(i + 1))
  *                     continue
  */
       __pyx_t_9 = (__pyx_v_val == '1');
       if (__pyx_t_9) {
 
-        /* "sat_toolkit/formula.pyx":732
+        /* "sat_toolkit/formula.pyx":739
  *                     continue
  *                 if val == b'1':
  *                     clauses.push_back(-(i + 1))             # <<<<<<<<<<<<<<
  *                     continue
  *                 raise ValueError(f'file format error in line {bytes(line)}')
  */
         try {
           __pyx_v_clauses.push_back((-(__pyx_v_i + 1)));
         } catch(...) {
           __Pyx_CppExn2PyErr();
-          __PYX_ERR(0, 732, __pyx_L1_error)
+          __PYX_ERR(0, 739, __pyx_L1_error)
         }
 
-        /* "sat_toolkit/formula.pyx":733
+        /* "sat_toolkit/formula.pyx":740
  *                 if val == b'1':
  *                     clauses.push_back(-(i + 1))
  *                     continue             # <<<<<<<<<<<<<<
  *                 raise ValueError(f'file format error in line {bytes(line)}')
  *             clauses.push_back(0)
  */
         goto __pyx_L16_continue;
 
-        /* "sat_toolkit/formula.pyx":731
+        /* "sat_toolkit/formula.pyx":738
  *                     clauses.push_back((i + 1))
  *                     continue
  *                 if val == b'1':             # <<<<<<<<<<<<<<
  *                     clauses.push_back(-(i + 1))
  *                     continue
  */
       }
 
-      /* "sat_toolkit/formula.pyx":734
+      /* "sat_toolkit/formula.pyx":741
  *                     clauses.push_back(-(i + 1))
  *                     continue
  *                 raise ValueError(f'file format error in line {bytes(line)}')             # <<<<<<<<<<<<<<
  *             clauses.push_back(0)
  * 
  */
-      __pyx_t_3 = __pyx_memoryview_fromslice(__pyx_v_line, 1, (PyObject *(*)(char *)) __pyx_memview_get_unsigned_char__const__, (int (*)(char *, PyObject *)) NULL, 0);; if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 734, __pyx_L1_error)
+      __pyx_t_3 = __pyx_memoryview_fromslice(__pyx_v_line, 1, (PyObject *(*)(char *)) __pyx_memview_get_unsigned_char__const__, (int (*)(char *, PyObject *)) NULL, 0);; if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 741, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_3);
-      __pyx_t_4 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyBytes_Type)), __pyx_t_3); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 734, __pyx_L1_error)
+      __pyx_t_4 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyBytes_Type)), __pyx_t_3); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 741, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_4);
       __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-      __pyx_t_3 = __Pyx_PyObject_FormatSimple(__pyx_t_4, __pyx_empty_unicode); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 734, __pyx_L1_error)
+      __pyx_t_3 = __Pyx_PyObject_FormatSimple(__pyx_t_4, __pyx_empty_unicode); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 741, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_3);
       __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-      __pyx_t_4 = __Pyx_PyUnicode_Concat(__pyx_kp_u_file_format_error_in_line, __pyx_t_3); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 734, __pyx_L1_error)
+      __pyx_t_4 = __Pyx_PyUnicode_Concat(__pyx_kp_u_file_format_error_in_line, __pyx_t_3); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 741, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_4);
       __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-      __pyx_t_3 = __Pyx_PyObject_CallOneArg(__pyx_builtin_ValueError, __pyx_t_4); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 734, __pyx_L1_error)
+      __pyx_t_3 = __Pyx_PyObject_CallOneArg(__pyx_builtin_ValueError, __pyx_t_4); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 741, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_3);
       __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
       __Pyx_Raise(__pyx_t_3, 0, 0, 0);
       __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-      __PYX_ERR(0, 734, __pyx_L1_error)
+      __PYX_ERR(0, 741, __pyx_L1_error)
       __pyx_L16_continue:;
     }
 
-    /* "sat_toolkit/formula.pyx":735
+    /* "sat_toolkit/formula.pyx":742
  *                     continue
  *                 raise ValueError(f'file format error in line {bytes(line)}')
  *             clauses.push_back(0)             # <<<<<<<<<<<<<<
  * 
  *         cdef CNF res = CNF.__new__(CNF)
  */
     try {
       __pyx_v_clauses.push_back(0);
     } catch(...) {
       __Pyx_CppExn2PyErr();
-      __PYX_ERR(0, 735, __pyx_L1_error)
+      __PYX_ERR(0, 742, __pyx_L1_error)
     }
 
-    /* "sat_toolkit/formula.pyx":704
+    /* "sat_toolkit/formula.pyx":711
  *         f = io.BytesIO(espresso.encode())
  * 
  *         for line_py in f:             # <<<<<<<<<<<<<<
  *             line = line_py.rstrip()
  *             if startswith(line, b'.i '):
  */
     __pyx_L3_continue:;
   }
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-  /* "sat_toolkit/formula.pyx":737
+  /* "sat_toolkit/formula.pyx":744
  *             clauses.push_back(0)
  * 
  *         cdef CNF res = CNF.__new__(CNF)             # <<<<<<<<<<<<<<
  *         if clauses.size() > 0:
  *             res._add_clauses(<int[:clauses.size()]> clauses.data())
  */
-  __pyx_t_1 = ((PyObject *)__pyx_tp_new_11sat_toolkit_7formula_CNF(((PyTypeObject *)__pyx_ptype_11sat_toolkit_7formula_CNF), __pyx_empty_tuple, NULL)); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 737, __pyx_L1_error)
+  __pyx_t_1 = ((PyObject *)__pyx_tp_new_11sat_toolkit_7formula_CNF(((PyTypeObject *)__pyx_ptype_11sat_toolkit_7formula_CNF), __pyx_empty_tuple, NULL)); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 744, __pyx_L1_error)
   __Pyx_GOTREF((PyObject *)__pyx_t_1);
   __pyx_v_res = ((struct __pyx_obj_11sat_toolkit_7formula_CNF *)__pyx_t_1);
   __pyx_t_1 = 0;
 
-  /* "sat_toolkit/formula.pyx":738
+  /* "sat_toolkit/formula.pyx":745
  * 
  *         cdef CNF res = CNF.__new__(CNF)
  *         if clauses.size() > 0:             # <<<<<<<<<<<<<<
  *             res._add_clauses(<int[:clauses.size()]> clauses.data())
  *         assert numbits >= <unsigned int> res.nvars
  */
   __pyx_t_9 = (__pyx_v_clauses.size() > 0);
   if (__pyx_t_9) {
 
-    /* "sat_toolkit/formula.pyx":739
+    /* "sat_toolkit/formula.pyx":746
  *         cdef CNF res = CNF.__new__(CNF)
  *         if clauses.size() > 0:
  *             res._add_clauses(<int[:clauses.size()]> clauses.data())             # <<<<<<<<<<<<<<
  *         assert numbits >= <unsigned int> res.nvars
  *         res.nvars = numbits
  */
     __pyx_t_20 = __pyx_v_clauses.data();
     if (!__pyx_t_20) {
       PyErr_SetString(PyExc_ValueError,"Cannot create cython.array from NULL pointer");
-      __PYX_ERR(0, 739, __pyx_L1_error)
+      __PYX_ERR(0, 746, __pyx_L1_error)
     }
-    __pyx_t_3 = __pyx_format_from_typeinfo(&__Pyx_TypeInfo_int); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 739, __pyx_L1_error)
+    __pyx_t_3 = __pyx_format_from_typeinfo(&__Pyx_TypeInfo_int); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 746, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
-    __pyx_t_1 = Py_BuildValue((char*) "("  __PYX_BUILD_PY_SSIZE_T  ")", ((Py_ssize_t)__pyx_v_clauses.size())); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 739, __pyx_L1_error)
+    __pyx_t_1 = Py_BuildValue((char*) "("  __PYX_BUILD_PY_SSIZE_T  ")", ((Py_ssize_t)__pyx_v_clauses.size())); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 746, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
-    __pyx_t_21 = __pyx_array_new(__pyx_t_1, sizeof(int), PyBytes_AS_STRING(__pyx_t_3), (char *) "c", (char *) __pyx_t_20); if (unlikely(!__pyx_t_21)) __PYX_ERR(0, 739, __pyx_L1_error)
+    __pyx_t_21 = __pyx_array_new(__pyx_t_1, sizeof(int), PyBytes_AS_STRING(__pyx_t_3), (char *) "c", (char *) __pyx_t_20); if (unlikely(!__pyx_t_21)) __PYX_ERR(0, 746, __pyx_L1_error)
     __Pyx_GOTREF((PyObject *)__pyx_t_21);
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-    __pyx_t_22 = __Pyx_PyObject_to_MemoryviewSlice_ds_int__const__(((PyObject *)__pyx_t_21), 0); if (unlikely(!__pyx_t_22.memview)) __PYX_ERR(0, 739, __pyx_L1_error)
+    __pyx_t_22 = __Pyx_PyObject_to_MemoryviewSlice_ds_int__const__(((PyObject *)__pyx_t_21), 0); if (unlikely(!__pyx_t_22.memview)) __PYX_ERR(0, 746, __pyx_L1_error)
     __Pyx_DECREF((PyObject *)__pyx_t_21); __pyx_t_21 = 0;
-    __pyx_t_5 = ((struct __pyx_vtabstruct_11sat_toolkit_7formula_CNF *)__pyx_v_res->__pyx_base.__pyx_vtab)->__pyx_base._add_clauses(((struct __pyx_obj_11sat_toolkit_7formula__ClauseList *)__pyx_v_res), __pyx_t_22); if (unlikely(__pyx_t_5 == ((int)-1))) __PYX_ERR(0, 739, __pyx_L1_error)
+    __pyx_t_5 = ((struct __pyx_vtabstruct_11sat_toolkit_7formula_CNF *)__pyx_v_res->__pyx_base.__pyx_vtab)->__pyx_base._add_clauses(((struct __pyx_obj_11sat_toolkit_7formula__ClauseList *)__pyx_v_res), __pyx_t_22); if (unlikely(__pyx_t_5 == ((int)-1))) __PYX_ERR(0, 746, __pyx_L1_error)
     __PYX_XCLEAR_MEMVIEW(&__pyx_t_22, 1);
     __pyx_t_22.memview = NULL; __pyx_t_22.data = NULL;
 
-    /* "sat_toolkit/formula.pyx":738
+    /* "sat_toolkit/formula.pyx":745
  * 
  *         cdef CNF res = CNF.__new__(CNF)
  *         if clauses.size() > 0:             # <<<<<<<<<<<<<<
  *             res._add_clauses(<int[:clauses.size()]> clauses.data())
  *         assert numbits >= <unsigned int> res.nvars
  */
   }
 
-  /* "sat_toolkit/formula.pyx":740
+  /* "sat_toolkit/formula.pyx":747
  *         if clauses.size() > 0:
  *             res._add_clauses(<int[:clauses.size()]> clauses.data())
  *         assert numbits >= <unsigned int> res.nvars             # <<<<<<<<<<<<<<
  *         res.nvars = numbits
  *         return res
  */
   #ifndef CYTHON_WITHOUT_ASSERTIONS
   if (unlikely(__pyx_assertions_enabled())) {
     __pyx_t_9 = (__pyx_v_numbits >= ((unsigned int)__pyx_v_res->__pyx_base.nvars));
     if (unlikely(!__pyx_t_9)) {
       __Pyx_Raise(__pyx_builtin_AssertionError, 0, 0, 0);
-      __PYX_ERR(0, 740, __pyx_L1_error)
+      __PYX_ERR(0, 747, __pyx_L1_error)
     }
   }
   #else
-  if ((1)); else __PYX_ERR(0, 740, __pyx_L1_error)
+  if ((1)); else __PYX_ERR(0, 747, __pyx_L1_error)
   #endif
 
-  /* "sat_toolkit/formula.pyx":741
+  /* "sat_toolkit/formula.pyx":748
  *             res._add_clauses(<int[:clauses.size()]> clauses.data())
  *         assert numbits >= <unsigned int> res.nvars
  *         res.nvars = numbits             # <<<<<<<<<<<<<<
  *         return res
  * 
  */
   __pyx_v_res->__pyx_base.nvars = __pyx_v_numbits;
 
-  /* "sat_toolkit/formula.pyx":742
+  /* "sat_toolkit/formula.pyx":749
  *         assert numbits >= <unsigned int> res.nvars
  *         res.nvars = numbits
  *         return res             # <<<<<<<<<<<<<<
  * 
  *     @staticmethod
  */
   __Pyx_XDECREF((PyObject *)__pyx_r);
   __Pyx_INCREF((PyObject *)__pyx_v_res);
   __pyx_r = __pyx_v_res;
   goto __pyx_L0;
 
-  /* "sat_toolkit/formula.pyx":692
+  /* "sat_toolkit/formula.pyx":699
  *         return tmp._clauses
  * 
  *     @staticmethod             # <<<<<<<<<<<<<<
  *     def from_espresso(espresso: str) -> CNF:
  *         cdef vector[int] clauses
  */
 
@@ -34362,15 +34499,15 @@
   __Pyx_XDECREF(__pyx_v_bits);
   __Pyx_XDECREF((PyObject *)__pyx_v_res);
   __Pyx_XGIVEREF((PyObject *)__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "sat_toolkit/formula.pyx":744
+/* "sat_toolkit/formula.pyx":751
  *         return res
  * 
  *     @staticmethod             # <<<<<<<<<<<<<<
  *     def create_all_zero(indices) -> CNF:
  *         """
  */
 
@@ -34424,31 +34561,31 @@
       kw_args = __Pyx_NumKwargs_FASTCALL(__pyx_kwds);
       switch (__pyx_nargs) {
         case  0:
         if (likely((values[0] = __Pyx_GetKwValue_FASTCALL(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_indices)) != 0)) {
           (void)__Pyx_Arg_NewRef_FASTCALL(values[0]);
           kw_args--;
         }
-        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 744, __pyx_L3_error)
+        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 751, __pyx_L3_error)
         else goto __pyx_L5_argtuple_error;
       }
       if (unlikely(kw_args > 0)) {
         const Py_ssize_t kwd_pos_args = __pyx_nargs;
-        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values + 0, kwd_pos_args, "create_all_zero") < 0)) __PYX_ERR(0, 744, __pyx_L3_error)
+        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values + 0, kwd_pos_args, "create_all_zero") < 0)) __PYX_ERR(0, 751, __pyx_L3_error)
       }
     } else if (unlikely(__pyx_nargs != 1)) {
       goto __pyx_L5_argtuple_error;
     } else {
       values[0] = __Pyx_Arg_FASTCALL(__pyx_args, 0);
     }
     __pyx_v_indices = values[0];
   }
   goto __pyx_L6_skip;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("create_all_zero", 1, 1, 1, __pyx_nargs); __PYX_ERR(0, 744, __pyx_L3_error)
+  __Pyx_RaiseArgtupleInvalid("create_all_zero", 1, 1, 1, __pyx_nargs); __PYX_ERR(0, 751, __pyx_L3_error)
   __pyx_L6_skip:;
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L3_error:;
   {
     Py_ssize_t __pyx_temp;
     for (__pyx_temp=0; __pyx_temp < (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
       __Pyx_Arg_XDECREF_FASTCALL(values[__pyx_temp]);
@@ -34482,58 +34619,58 @@
   int __pyx_t_6;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("create_all_zero", 0);
   __Pyx_INCREF(__pyx_v_indices);
 
-  /* "sat_toolkit/formula.pyx":750
+  /* "sat_toolkit/formula.pyx":757
  *         are zero.
  *         """
  *         indices = np.array(indices, dtype=np.int32, copy=False)             # <<<<<<<<<<<<<<
  *         return CNF._create_all_zero(indices)
  * 
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 750, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 757, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_array); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 750, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_array); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 757, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  __pyx_t_1 = PyTuple_New(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 750, __pyx_L1_error)
+  __pyx_t_1 = PyTuple_New(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 757, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_INCREF(__pyx_v_indices);
   __Pyx_GIVEREF(__pyx_v_indices);
-  if (__Pyx_PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_v_indices)) __PYX_ERR(0, 750, __pyx_L1_error);
-  __pyx_t_3 = __Pyx_PyDict_NewPresized(2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 750, __pyx_L1_error)
+  if (__Pyx_PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_v_indices)) __PYX_ERR(0, 757, __pyx_L1_error);
+  __pyx_t_3 = __Pyx_PyDict_NewPresized(2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 757, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_np); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 750, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_np); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 757, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
-  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_int32); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 750, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_int32); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 757, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-  if (PyDict_SetItem(__pyx_t_3, __pyx_n_s_dtype, __pyx_t_5) < 0) __PYX_ERR(0, 750, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_3, __pyx_n_s_dtype, __pyx_t_5) < 0) __PYX_ERR(0, 757, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-  if (PyDict_SetItem(__pyx_t_3, __pyx_n_s_copy, Py_False) < 0) __PYX_ERR(0, 750, __pyx_L1_error)
-  __pyx_t_5 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_t_1, __pyx_t_3); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 750, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_3, __pyx_n_s_copy, Py_False) < 0) __PYX_ERR(0, 757, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_t_1, __pyx_t_3); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 757, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   __Pyx_DECREF_SET(__pyx_v_indices, __pyx_t_5);
   __pyx_t_5 = 0;
 
-  /* "sat_toolkit/formula.pyx":751
+  /* "sat_toolkit/formula.pyx":758
  *         """
  *         indices = np.array(indices, dtype=np.int32, copy=False)
  *         return CNF._create_all_zero(indices)             # <<<<<<<<<<<<<<
  * 
  *     @staticmethod
  */
   __Pyx_XDECREF((PyObject *)__pyx_r);
-  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_ptype_11sat_toolkit_7formula_CNF), __pyx_n_s_create_all_zero); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 751, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_ptype_11sat_toolkit_7formula_CNF), __pyx_n_s_create_all_zero); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 758, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __pyx_t_1 = NULL;
   __pyx_t_6 = 0;
   #if CYTHON_UNPACK_METHODS
   if (likely(PyMethod_Check(__pyx_t_3))) {
     __pyx_t_1 = PyMethod_GET_SELF(__pyx_t_3);
     if (likely(__pyx_t_1)) {
@@ -34545,24 +34682,24 @@
     }
   }
   #endif
   {
     PyObject *__pyx_callargs[2] = {__pyx_t_1, __pyx_v_indices};
     __pyx_t_5 = __Pyx_PyObject_FastCall(__pyx_t_3, __pyx_callargs+1-__pyx_t_6, 1+__pyx_t_6);
     __Pyx_XDECREF(__pyx_t_1); __pyx_t_1 = 0;
-    if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 751, __pyx_L1_error)
+    if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 758, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   }
-  if (!(likely(((__pyx_t_5) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_5, __pyx_ptype_11sat_toolkit_7formula_CNF))))) __PYX_ERR(0, 751, __pyx_L1_error)
+  if (!(likely(((__pyx_t_5) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_5, __pyx_ptype_11sat_toolkit_7formula_CNF))))) __PYX_ERR(0, 758, __pyx_L1_error)
   __pyx_r = ((struct __pyx_obj_11sat_toolkit_7formula_CNF *)__pyx_t_5);
   __pyx_t_5 = 0;
   goto __pyx_L0;
 
-  /* "sat_toolkit/formula.pyx":744
+  /* "sat_toolkit/formula.pyx":751
  *         return res
  * 
  *     @staticmethod             # <<<<<<<<<<<<<<
  *     def create_all_zero(indices) -> CNF:
  *         """
  */
 
@@ -34578,15 +34715,15 @@
   __pyx_L0:;
   __Pyx_XDECREF(__pyx_v_indices);
   __Pyx_XGIVEREF((PyObject *)__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "sat_toolkit/formula.pyx":753
+/* "sat_toolkit/formula.pyx":760
  *         return CNF._create_all_zero(indices)
  * 
  *     @staticmethod             # <<<<<<<<<<<<<<
  *     def _create_all_zero(const int[:] indices not None) -> CNF:
  *         cdef vector[int] clauses
  */
 
@@ -34640,31 +34777,31 @@
       kw_args = __Pyx_NumKwargs_FASTCALL(__pyx_kwds);
       switch (__pyx_nargs) {
         case  0:
         if (likely((values[0] = __Pyx_GetKwValue_FASTCALL(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_indices)) != 0)) {
           (void)__Pyx_Arg_NewRef_FASTCALL(values[0]);
           kw_args--;
         }
-        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 753, __pyx_L3_error)
+        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 760, __pyx_L3_error)
         else goto __pyx_L5_argtuple_error;
       }
       if (unlikely(kw_args > 0)) {
         const Py_ssize_t kwd_pos_args = __pyx_nargs;
-        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values + 0, kwd_pos_args, "_create_all_zero") < 0)) __PYX_ERR(0, 753, __pyx_L3_error)
+        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values + 0, kwd_pos_args, "_create_all_zero") < 0)) __PYX_ERR(0, 760, __pyx_L3_error)
       }
     } else if (unlikely(__pyx_nargs != 1)) {
       goto __pyx_L5_argtuple_error;
     } else {
       values[0] = __Pyx_Arg_FASTCALL(__pyx_args, 0);
     }
-    __pyx_v_indices = __Pyx_PyObject_to_MemoryviewSlice_ds_int__const__(values[0], 0); if (unlikely(!__pyx_v_indices.memview)) __PYX_ERR(0, 754, __pyx_L3_error)
+    __pyx_v_indices = __Pyx_PyObject_to_MemoryviewSlice_ds_int__const__(values[0], 0); if (unlikely(!__pyx_v_indices.memview)) __PYX_ERR(0, 761, __pyx_L3_error)
   }
   goto __pyx_L6_skip;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("_create_all_zero", 1, 1, 1, __pyx_nargs); __PYX_ERR(0, 753, __pyx_L3_error)
+  __Pyx_RaiseArgtupleInvalid("_create_all_zero", 1, 1, 1, __pyx_nargs); __PYX_ERR(0, 760, __pyx_L3_error)
   __pyx_L6_skip:;
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L3_error:;
   {
     Py_ssize_t __pyx_temp;
     for (__pyx_temp=0; __pyx_temp < (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
       __Pyx_Arg_XDECREF_FASTCALL(values[__pyx_temp]);
@@ -34672,15 +34809,15 @@
   }
   __PYX_XCLEAR_MEMVIEW(&__pyx_v_indices, 1);
   __Pyx_AddTraceback("sat_toolkit.formula.CNF._create_all_zero", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __Pyx_RefNannyFinishContext();
   return NULL;
   __pyx_L4_argument_unpacking_done:;
   if (unlikely(((PyObject *)__pyx_v_indices.memview) == Py_None)) {
-    PyErr_Format(PyExc_TypeError, "Argument '%.200s' must not be None", "indices"); __PYX_ERR(0, 754, __pyx_L1_error)
+    PyErr_Format(PyExc_TypeError, "Argument '%.200s' must not be None", "indices"); __PYX_ERR(0, 761, __pyx_L1_error)
   }
   __pyx_r = __pyx_pf_11sat_toolkit_7formula_3CNF_6_create_all_zero(__pyx_v_indices);
 
   /* function exit code */
   goto __pyx_L0;
   __pyx_L1_error:;
   __pyx_r = NULL;
@@ -34716,171 +34853,171 @@
   __Pyx_memviewslice __pyx_t_10 = { 0, 0, { 0 }, { 0 }, { 0 } };
   int __pyx_t_11;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("_create_all_zero", 1);
 
-  /* "sat_toolkit/formula.pyx":759
+  /* "sat_toolkit/formula.pyx":766
  *         cdef int val
  * 
  *         l = indices.shape[0]             # <<<<<<<<<<<<<<
  * 
  *         clauses.resize(l * 2)
  */
   __pyx_v_l = (__pyx_v_indices.shape[0]);
 
-  /* "sat_toolkit/formula.pyx":761
+  /* "sat_toolkit/formula.pyx":768
  *         l = indices.shape[0]
  * 
  *         clauses.resize(l * 2)             # <<<<<<<<<<<<<<
  *         for i in range(l):
  *             val = indices[i]
  */
   try {
     __pyx_v_clauses.resize((__pyx_v_l * 2));
   } catch(...) {
     __Pyx_CppExn2PyErr();
-    __PYX_ERR(0, 761, __pyx_L1_error)
+    __PYX_ERR(0, 768, __pyx_L1_error)
   }
 
-  /* "sat_toolkit/formula.pyx":762
+  /* "sat_toolkit/formula.pyx":769
  * 
  *         clauses.resize(l * 2)
  *         for i in range(l):             # <<<<<<<<<<<<<<
  *             val = indices[i]
  *             if val == 0:
  */
   __pyx_t_1 = __pyx_v_l;
   __pyx_t_2 = __pyx_t_1;
   for (__pyx_t_3 = 0; __pyx_t_3 < __pyx_t_2; __pyx_t_3+=1) {
     __pyx_v_i = __pyx_t_3;
 
-    /* "sat_toolkit/formula.pyx":763
+    /* "sat_toolkit/formula.pyx":770
  *         clauses.resize(l * 2)
  *         for i in range(l):
  *             val = indices[i]             # <<<<<<<<<<<<<<
  *             if val == 0:
  *                 raise ValueError('all indices must be nonzero')
  */
     __pyx_t_4 = __pyx_v_i;
     __pyx_v_val = (*((int const  *) ( /* dim=0 */ (__pyx_v_indices.data + __pyx_t_4 * __pyx_v_indices.strides[0]) )));
 
-    /* "sat_toolkit/formula.pyx":764
+    /* "sat_toolkit/formula.pyx":771
  *         for i in range(l):
  *             val = indices[i]
  *             if val == 0:             # <<<<<<<<<<<<<<
  *                 raise ValueError('all indices must be nonzero')
  *             clauses[2*i] = -val
  */
     __pyx_t_5 = (__pyx_v_val == 0);
     if (unlikely(__pyx_t_5)) {
 
-      /* "sat_toolkit/formula.pyx":765
+      /* "sat_toolkit/formula.pyx":772
  *             val = indices[i]
  *             if val == 0:
  *                 raise ValueError('all indices must be nonzero')             # <<<<<<<<<<<<<<
  *             clauses[2*i] = -val
  * 
  */
-      __pyx_t_6 = __Pyx_PyObject_Call(__pyx_builtin_ValueError, __pyx_tuple__28, NULL); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 765, __pyx_L1_error)
+      __pyx_t_6 = __Pyx_PyObject_Call(__pyx_builtin_ValueError, __pyx_tuple__28, NULL); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 772, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_6);
       __Pyx_Raise(__pyx_t_6, 0, 0, 0);
       __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-      __PYX_ERR(0, 765, __pyx_L1_error)
+      __PYX_ERR(0, 772, __pyx_L1_error)
 
-      /* "sat_toolkit/formula.pyx":764
+      /* "sat_toolkit/formula.pyx":771
  *         for i in range(l):
  *             val = indices[i]
  *             if val == 0:             # <<<<<<<<<<<<<<
  *                 raise ValueError('all indices must be nonzero')
  *             clauses[2*i] = -val
  */
     }
 
-    /* "sat_toolkit/formula.pyx":766
+    /* "sat_toolkit/formula.pyx":773
  *             if val == 0:
  *                 raise ValueError('all indices must be nonzero')
  *             clauses[2*i] = -val             # <<<<<<<<<<<<<<
  * 
  * 
  */
     (__pyx_v_clauses[(2 * __pyx_v_i)]) = (-__pyx_v_val);
   }
 
-  /* "sat_toolkit/formula.pyx":769
+  /* "sat_toolkit/formula.pyx":776
  * 
  * 
  *         cdef CNF res = CNF.__new__(CNF)             # <<<<<<<<<<<<<<
  *         if clauses.size() > 0:
  *             res._add_clauses(<int[:clauses.size()]> clauses.data())
  */
-  __pyx_t_6 = ((PyObject *)__pyx_tp_new_11sat_toolkit_7formula_CNF(((PyTypeObject *)__pyx_ptype_11sat_toolkit_7formula_CNF), __pyx_empty_tuple, NULL)); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 769, __pyx_L1_error)
+  __pyx_t_6 = ((PyObject *)__pyx_tp_new_11sat_toolkit_7formula_CNF(((PyTypeObject *)__pyx_ptype_11sat_toolkit_7formula_CNF), __pyx_empty_tuple, NULL)); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 776, __pyx_L1_error)
   __Pyx_GOTREF((PyObject *)__pyx_t_6);
   __pyx_v_res = ((struct __pyx_obj_11sat_toolkit_7formula_CNF *)__pyx_t_6);
   __pyx_t_6 = 0;
 
-  /* "sat_toolkit/formula.pyx":770
+  /* "sat_toolkit/formula.pyx":777
  * 
  *         cdef CNF res = CNF.__new__(CNF)
  *         if clauses.size() > 0:             # <<<<<<<<<<<<<<
  *             res._add_clauses(<int[:clauses.size()]> clauses.data())
  *         return res
  */
   __pyx_t_5 = (__pyx_v_clauses.size() > 0);
   if (__pyx_t_5) {
 
-    /* "sat_toolkit/formula.pyx":771
+    /* "sat_toolkit/formula.pyx":778
  *         cdef CNF res = CNF.__new__(CNF)
  *         if clauses.size() > 0:
  *             res._add_clauses(<int[:clauses.size()]> clauses.data())             # <<<<<<<<<<<<<<
  *         return res
  * 
  */
     __pyx_t_7 = __pyx_v_clauses.data();
     if (!__pyx_t_7) {
       PyErr_SetString(PyExc_ValueError,"Cannot create cython.array from NULL pointer");
-      __PYX_ERR(0, 771, __pyx_L1_error)
+      __PYX_ERR(0, 778, __pyx_L1_error)
     }
-    __pyx_t_9 = __pyx_format_from_typeinfo(&__Pyx_TypeInfo_int); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 771, __pyx_L1_error)
+    __pyx_t_9 = __pyx_format_from_typeinfo(&__Pyx_TypeInfo_int); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 778, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_9);
-    __pyx_t_6 = Py_BuildValue((char*) "("  __PYX_BUILD_PY_SSIZE_T  ")", ((Py_ssize_t)__pyx_v_clauses.size())); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 771, __pyx_L1_error)
+    __pyx_t_6 = Py_BuildValue((char*) "("  __PYX_BUILD_PY_SSIZE_T  ")", ((Py_ssize_t)__pyx_v_clauses.size())); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 778, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
-    __pyx_t_8 = __pyx_array_new(__pyx_t_6, sizeof(int), PyBytes_AS_STRING(__pyx_t_9), (char *) "c", (char *) __pyx_t_7); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 771, __pyx_L1_error)
+    __pyx_t_8 = __pyx_array_new(__pyx_t_6, sizeof(int), PyBytes_AS_STRING(__pyx_t_9), (char *) "c", (char *) __pyx_t_7); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 778, __pyx_L1_error)
     __Pyx_GOTREF((PyObject *)__pyx_t_8);
     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
     __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
-    __pyx_t_10 = __Pyx_PyObject_to_MemoryviewSlice_ds_int__const__(((PyObject *)__pyx_t_8), 0); if (unlikely(!__pyx_t_10.memview)) __PYX_ERR(0, 771, __pyx_L1_error)
+    __pyx_t_10 = __Pyx_PyObject_to_MemoryviewSlice_ds_int__const__(((PyObject *)__pyx_t_8), 0); if (unlikely(!__pyx_t_10.memview)) __PYX_ERR(0, 778, __pyx_L1_error)
     __Pyx_DECREF((PyObject *)__pyx_t_8); __pyx_t_8 = 0;
-    __pyx_t_11 = ((struct __pyx_vtabstruct_11sat_toolkit_7formula_CNF *)__pyx_v_res->__pyx_base.__pyx_vtab)->__pyx_base._add_clauses(((struct __pyx_obj_11sat_toolkit_7formula__ClauseList *)__pyx_v_res), __pyx_t_10); if (unlikely(__pyx_t_11 == ((int)-1))) __PYX_ERR(0, 771, __pyx_L1_error)
+    __pyx_t_11 = ((struct __pyx_vtabstruct_11sat_toolkit_7formula_CNF *)__pyx_v_res->__pyx_base.__pyx_vtab)->__pyx_base._add_clauses(((struct __pyx_obj_11sat_toolkit_7formula__ClauseList *)__pyx_v_res), __pyx_t_10); if (unlikely(__pyx_t_11 == ((int)-1))) __PYX_ERR(0, 778, __pyx_L1_error)
     __PYX_XCLEAR_MEMVIEW(&__pyx_t_10, 1);
     __pyx_t_10.memview = NULL; __pyx_t_10.data = NULL;
 
-    /* "sat_toolkit/formula.pyx":770
+    /* "sat_toolkit/formula.pyx":777
  * 
  *         cdef CNF res = CNF.__new__(CNF)
  *         if clauses.size() > 0:             # <<<<<<<<<<<<<<
  *             res._add_clauses(<int[:clauses.size()]> clauses.data())
  *         return res
  */
   }
 
-  /* "sat_toolkit/formula.pyx":772
+  /* "sat_toolkit/formula.pyx":779
  *         if clauses.size() > 0:
  *             res._add_clauses(<int[:clauses.size()]> clauses.data())
  *         return res             # <<<<<<<<<<<<<<
  * 
  *     @staticmethod
  */
   __Pyx_XDECREF((PyObject *)__pyx_r);
   __Pyx_INCREF((PyObject *)__pyx_v_res);
   __pyx_r = __pyx_v_res;
   goto __pyx_L0;
 
-  /* "sat_toolkit/formula.pyx":753
+  /* "sat_toolkit/formula.pyx":760
  *         return CNF._create_all_zero(indices)
  * 
  *     @staticmethod             # <<<<<<<<<<<<<<
  *     def _create_all_zero(const int[:] indices not None) -> CNF:
  *         cdef vector[int] clauses
  */
 
@@ -34895,15 +35032,15 @@
   __pyx_L0:;
   __Pyx_XDECREF((PyObject *)__pyx_v_res);
   __Pyx_XGIVEREF((PyObject *)__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "sat_toolkit/formula.pyx":774
+/* "sat_toolkit/formula.pyx":781
  *         return res
  * 
  *     @staticmethod             # <<<<<<<<<<<<<<
  *     def create_all_equal(lhs, rhs) -> CNF:
  *         "creates a CNF that asserts lhs[i] == rhs[i] for all i."
  */
 
@@ -34960,43 +35097,43 @@
       kw_args = __Pyx_NumKwargs_FASTCALL(__pyx_kwds);
       switch (__pyx_nargs) {
         case  0:
         if (likely((values[0] = __Pyx_GetKwValue_FASTCALL(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_lhs)) != 0)) {
           (void)__Pyx_Arg_NewRef_FASTCALL(values[0]);
           kw_args--;
         }
-        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 774, __pyx_L3_error)
+        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 781, __pyx_L3_error)
         else goto __pyx_L5_argtuple_error;
         CYTHON_FALLTHROUGH;
         case  1:
         if (likely((values[1] = __Pyx_GetKwValue_FASTCALL(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_rhs)) != 0)) {
           (void)__Pyx_Arg_NewRef_FASTCALL(values[1]);
           kw_args--;
         }
-        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 774, __pyx_L3_error)
+        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 781, __pyx_L3_error)
         else {
-          __Pyx_RaiseArgtupleInvalid("create_all_equal", 1, 2, 2, 1); __PYX_ERR(0, 774, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("create_all_equal", 1, 2, 2, 1); __PYX_ERR(0, 781, __pyx_L3_error)
         }
       }
       if (unlikely(kw_args > 0)) {
         const Py_ssize_t kwd_pos_args = __pyx_nargs;
-        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values + 0, kwd_pos_args, "create_all_equal") < 0)) __PYX_ERR(0, 774, __pyx_L3_error)
+        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values + 0, kwd_pos_args, "create_all_equal") < 0)) __PYX_ERR(0, 781, __pyx_L3_error)
       }
     } else if (unlikely(__pyx_nargs != 2)) {
       goto __pyx_L5_argtuple_error;
     } else {
       values[0] = __Pyx_Arg_FASTCALL(__pyx_args, 0);
       values[1] = __Pyx_Arg_FASTCALL(__pyx_args, 1);
     }
     __pyx_v_lhs = values[0];
     __pyx_v_rhs = values[1];
   }
   goto __pyx_L6_skip;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("create_all_equal", 1, 2, 2, __pyx_nargs); __PYX_ERR(0, 774, __pyx_L3_error)
+  __Pyx_RaiseArgtupleInvalid("create_all_equal", 1, 2, 2, __pyx_nargs); __PYX_ERR(0, 781, __pyx_L3_error)
   __pyx_L6_skip:;
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L3_error:;
   {
     Py_ssize_t __pyx_temp;
     for (__pyx_temp=0; __pyx_temp < (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
       __Pyx_Arg_XDECREF_FASTCALL(values[__pyx_temp]);
@@ -35031,93 +35168,93 @@
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("create_all_equal", 0);
   __Pyx_INCREF(__pyx_v_lhs);
   __Pyx_INCREF(__pyx_v_rhs);
 
-  /* "sat_toolkit/formula.pyx":777
+  /* "sat_toolkit/formula.pyx":784
  *     def create_all_equal(lhs, rhs) -> CNF:
  *         "creates a CNF that asserts lhs[i] == rhs[i] for all i."
  *         lhs = np.array(lhs, dtype=np.int32, copy=False)             # <<<<<<<<<<<<<<
  *         rhs = np.array(rhs, dtype=np.int32, copy=False)
  *         return CNF._create_all_equal(lhs, rhs)
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 777, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 784, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_array); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 777, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_array); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 784, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  __pyx_t_1 = PyTuple_New(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 777, __pyx_L1_error)
+  __pyx_t_1 = PyTuple_New(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 784, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_INCREF(__pyx_v_lhs);
   __Pyx_GIVEREF(__pyx_v_lhs);
-  if (__Pyx_PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_v_lhs)) __PYX_ERR(0, 777, __pyx_L1_error);
-  __pyx_t_3 = __Pyx_PyDict_NewPresized(2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 777, __pyx_L1_error)
+  if (__Pyx_PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_v_lhs)) __PYX_ERR(0, 784, __pyx_L1_error);
+  __pyx_t_3 = __Pyx_PyDict_NewPresized(2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 784, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_np); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 777, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_np); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 784, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
-  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_int32); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 777, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_int32); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 784, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-  if (PyDict_SetItem(__pyx_t_3, __pyx_n_s_dtype, __pyx_t_5) < 0) __PYX_ERR(0, 777, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_3, __pyx_n_s_dtype, __pyx_t_5) < 0) __PYX_ERR(0, 784, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-  if (PyDict_SetItem(__pyx_t_3, __pyx_n_s_copy, Py_False) < 0) __PYX_ERR(0, 777, __pyx_L1_error)
-  __pyx_t_5 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_t_1, __pyx_t_3); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 777, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_3, __pyx_n_s_copy, Py_False) < 0) __PYX_ERR(0, 784, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_t_1, __pyx_t_3); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 784, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   __Pyx_DECREF_SET(__pyx_v_lhs, __pyx_t_5);
   __pyx_t_5 = 0;
 
-  /* "sat_toolkit/formula.pyx":778
+  /* "sat_toolkit/formula.pyx":785
  *         "creates a CNF that asserts lhs[i] == rhs[i] for all i."
  *         lhs = np.array(lhs, dtype=np.int32, copy=False)
  *         rhs = np.array(rhs, dtype=np.int32, copy=False)             # <<<<<<<<<<<<<<
  *         return CNF._create_all_equal(lhs, rhs)
  * 
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_np); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 778, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_np); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 785, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
-  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_array); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 778, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_array); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 785, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-  __pyx_t_5 = PyTuple_New(1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 778, __pyx_L1_error)
+  __pyx_t_5 = PyTuple_New(1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 785, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_INCREF(__pyx_v_rhs);
   __Pyx_GIVEREF(__pyx_v_rhs);
-  if (__Pyx_PyTuple_SET_ITEM(__pyx_t_5, 0, __pyx_v_rhs)) __PYX_ERR(0, 778, __pyx_L1_error);
-  __pyx_t_1 = __Pyx_PyDict_NewPresized(2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 778, __pyx_L1_error)
+  if (__Pyx_PyTuple_SET_ITEM(__pyx_t_5, 0, __pyx_v_rhs)) __PYX_ERR(0, 785, __pyx_L1_error);
+  __pyx_t_1 = __Pyx_PyDict_NewPresized(2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 785, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 778, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 785, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_int32); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 778, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_int32); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 785, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  if (PyDict_SetItem(__pyx_t_1, __pyx_n_s_dtype, __pyx_t_4) < 0) __PYX_ERR(0, 778, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_1, __pyx_n_s_dtype, __pyx_t_4) < 0) __PYX_ERR(0, 785, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-  if (PyDict_SetItem(__pyx_t_1, __pyx_n_s_copy, Py_False) < 0) __PYX_ERR(0, 778, __pyx_L1_error)
-  __pyx_t_4 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_5, __pyx_t_1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 778, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_1, __pyx_n_s_copy, Py_False) < 0) __PYX_ERR(0, 785, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_5, __pyx_t_1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 785, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __Pyx_DECREF_SET(__pyx_v_rhs, __pyx_t_4);
   __pyx_t_4 = 0;
 
-  /* "sat_toolkit/formula.pyx":779
+  /* "sat_toolkit/formula.pyx":786
  *         lhs = np.array(lhs, dtype=np.int32, copy=False)
  *         rhs = np.array(rhs, dtype=np.int32, copy=False)
  *         return CNF._create_all_equal(lhs, rhs)             # <<<<<<<<<<<<<<
  * 
  *     @staticmethod
  */
   __Pyx_XDECREF((PyObject *)__pyx_r);
-  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_ptype_11sat_toolkit_7formula_CNF), __pyx_n_s_create_all_equal); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 779, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_ptype_11sat_toolkit_7formula_CNF), __pyx_n_s_create_all_equal); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 786, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_t_5 = NULL;
   __pyx_t_6 = 0;
   #if CYTHON_UNPACK_METHODS
   if (likely(PyMethod_Check(__pyx_t_1))) {
     __pyx_t_5 = PyMethod_GET_SELF(__pyx_t_1);
     if (likely(__pyx_t_5)) {
@@ -35129,24 +35266,24 @@
     }
   }
   #endif
   {
     PyObject *__pyx_callargs[3] = {__pyx_t_5, __pyx_v_lhs, __pyx_v_rhs};
     __pyx_t_4 = __Pyx_PyObject_FastCall(__pyx_t_1, __pyx_callargs+1-__pyx_t_6, 2+__pyx_t_6);
     __Pyx_XDECREF(__pyx_t_5); __pyx_t_5 = 0;
-    if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 779, __pyx_L1_error)
+    if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 786, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   }
-  if (!(likely(((__pyx_t_4) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_4, __pyx_ptype_11sat_toolkit_7formula_CNF))))) __PYX_ERR(0, 779, __pyx_L1_error)
+  if (!(likely(((__pyx_t_4) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_4, __pyx_ptype_11sat_toolkit_7formula_CNF))))) __PYX_ERR(0, 786, __pyx_L1_error)
   __pyx_r = ((struct __pyx_obj_11sat_toolkit_7formula_CNF *)__pyx_t_4);
   __pyx_t_4 = 0;
   goto __pyx_L0;
 
-  /* "sat_toolkit/formula.pyx":774
+  /* "sat_toolkit/formula.pyx":781
  *         return res
  * 
  *     @staticmethod             # <<<<<<<<<<<<<<
  *     def create_all_equal(lhs, rhs) -> CNF:
  *         "creates a CNF that asserts lhs[i] == rhs[i] for all i."
  */
 
@@ -35163,15 +35300,15 @@
   __Pyx_XDECREF(__pyx_v_lhs);
   __Pyx_XDECREF(__pyx_v_rhs);
   __Pyx_XGIVEREF((PyObject *)__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "sat_toolkit/formula.pyx":781
+/* "sat_toolkit/formula.pyx":788
  *         return CNF._create_all_equal(lhs, rhs)
  * 
  *     @staticmethod             # <<<<<<<<<<<<<<
  *     def _create_all_equal(const int[:] lhs not None, const int[:] rhs not None) -> CNF:
  *         cdef vector[int] clauses
  */
 
@@ -35228,43 +35365,43 @@
       kw_args = __Pyx_NumKwargs_FASTCALL(__pyx_kwds);
       switch (__pyx_nargs) {
         case  0:
         if (likely((values[0] = __Pyx_GetKwValue_FASTCALL(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_lhs)) != 0)) {
           (void)__Pyx_Arg_NewRef_FASTCALL(values[0]);
           kw_args--;
         }
-        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 781, __pyx_L3_error)
+        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 788, __pyx_L3_error)
         else goto __pyx_L5_argtuple_error;
         CYTHON_FALLTHROUGH;
         case  1:
         if (likely((values[1] = __Pyx_GetKwValue_FASTCALL(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_rhs)) != 0)) {
           (void)__Pyx_Arg_NewRef_FASTCALL(values[1]);
           kw_args--;
         }
-        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 781, __pyx_L3_error)
+        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 788, __pyx_L3_error)
         else {
-          __Pyx_RaiseArgtupleInvalid("_create_all_equal", 1, 2, 2, 1); __PYX_ERR(0, 781, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("_create_all_equal", 1, 2, 2, 1); __PYX_ERR(0, 788, __pyx_L3_error)
         }
       }
       if (unlikely(kw_args > 0)) {
         const Py_ssize_t kwd_pos_args = __pyx_nargs;
-        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values + 0, kwd_pos_args, "_create_all_equal") < 0)) __PYX_ERR(0, 781, __pyx_L3_error)
+        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values + 0, kwd_pos_args, "_create_all_equal") < 0)) __PYX_ERR(0, 788, __pyx_L3_error)
       }
     } else if (unlikely(__pyx_nargs != 2)) {
       goto __pyx_L5_argtuple_error;
     } else {
       values[0] = __Pyx_Arg_FASTCALL(__pyx_args, 0);
       values[1] = __Pyx_Arg_FASTCALL(__pyx_args, 1);
     }
-    __pyx_v_lhs = __Pyx_PyObject_to_MemoryviewSlice_ds_int__const__(values[0], 0); if (unlikely(!__pyx_v_lhs.memview)) __PYX_ERR(0, 782, __pyx_L3_error)
-    __pyx_v_rhs = __Pyx_PyObject_to_MemoryviewSlice_ds_int__const__(values[1], 0); if (unlikely(!__pyx_v_rhs.memview)) __PYX_ERR(0, 782, __pyx_L3_error)
+    __pyx_v_lhs = __Pyx_PyObject_to_MemoryviewSlice_ds_int__const__(values[0], 0); if (unlikely(!__pyx_v_lhs.memview)) __PYX_ERR(0, 789, __pyx_L3_error)
+    __pyx_v_rhs = __Pyx_PyObject_to_MemoryviewSlice_ds_int__const__(values[1], 0); if (unlikely(!__pyx_v_rhs.memview)) __PYX_ERR(0, 789, __pyx_L3_error)
   }
   goto __pyx_L6_skip;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("_create_all_equal", 1, 2, 2, __pyx_nargs); __PYX_ERR(0, 781, __pyx_L3_error)
+  __Pyx_RaiseArgtupleInvalid("_create_all_equal", 1, 2, 2, __pyx_nargs); __PYX_ERR(0, 788, __pyx_L3_error)
   __pyx_L6_skip:;
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L3_error:;
   {
     Py_ssize_t __pyx_temp;
     for (__pyx_temp=0; __pyx_temp < (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
       __Pyx_Arg_XDECREF_FASTCALL(values[__pyx_temp]);
@@ -35273,18 +35410,18 @@
   __PYX_XCLEAR_MEMVIEW(&__pyx_v_lhs, 1);
   __PYX_XCLEAR_MEMVIEW(&__pyx_v_rhs, 1);
   __Pyx_AddTraceback("sat_toolkit.formula.CNF._create_all_equal", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __Pyx_RefNannyFinishContext();
   return NULL;
   __pyx_L4_argument_unpacking_done:;
   if (unlikely(((PyObject *)__pyx_v_lhs.memview) == Py_None)) {
-    PyErr_Format(PyExc_TypeError, "Argument '%.200s' must not be None", "lhs"); __PYX_ERR(0, 782, __pyx_L1_error)
+    PyErr_Format(PyExc_TypeError, "Argument '%.200s' must not be None", "lhs"); __PYX_ERR(0, 789, __pyx_L1_error)
   }
   if (unlikely(((PyObject *)__pyx_v_rhs.memview) == Py_None)) {
-    PyErr_Format(PyExc_TypeError, "Argument '%.200s' must not be None", "rhs"); __PYX_ERR(0, 782, __pyx_L1_error)
+    PyErr_Format(PyExc_TypeError, "Argument '%.200s' must not be None", "rhs"); __PYX_ERR(0, 789, __pyx_L1_error)
   }
   __pyx_r = __pyx_pf_11sat_toolkit_7formula_3CNF_10_create_all_equal(__pyx_v_lhs, __pyx_v_rhs);
 
   /* function exit code */
   goto __pyx_L0;
   __pyx_L1_error:;
   __pyx_r = NULL;
@@ -35323,102 +35460,102 @@
   __Pyx_memviewslice __pyx_t_11 = { 0, 0, { 0 }, { 0 }, { 0 } };
   int __pyx_t_12;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("_create_all_equal", 1);
 
-  /* "sat_toolkit/formula.pyx":787
+  /* "sat_toolkit/formula.pyx":794
  *         cdef int l, r
  * 
  *         length = lhs.shape[0]             # <<<<<<<<<<<<<<
  *         if rhs.shape[0] != length:
  *             raise ValueError('lhs and rhs must have the same length')
  */
   __pyx_v_length = (__pyx_v_lhs.shape[0]);
 
-  /* "sat_toolkit/formula.pyx":788
+  /* "sat_toolkit/formula.pyx":795
  * 
  *         length = lhs.shape[0]
  *         if rhs.shape[0] != length:             # <<<<<<<<<<<<<<
  *             raise ValueError('lhs and rhs must have the same length')
  * 
  */
   __pyx_t_1 = ((__pyx_v_rhs.shape[0]) != __pyx_v_length);
   if (unlikely(__pyx_t_1)) {
 
-    /* "sat_toolkit/formula.pyx":789
+    /* "sat_toolkit/formula.pyx":796
  *         length = lhs.shape[0]
  *         if rhs.shape[0] != length:
  *             raise ValueError('lhs and rhs must have the same length')             # <<<<<<<<<<<<<<
  * 
  *         clauses.resize(length * 6)
  */
-    __pyx_t_2 = __Pyx_PyObject_Call(__pyx_builtin_ValueError, __pyx_tuple__29, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 789, __pyx_L1_error)
+    __pyx_t_2 = __Pyx_PyObject_Call(__pyx_builtin_ValueError, __pyx_tuple__29, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 796, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
     __Pyx_Raise(__pyx_t_2, 0, 0, 0);
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-    __PYX_ERR(0, 789, __pyx_L1_error)
+    __PYX_ERR(0, 796, __pyx_L1_error)
 
-    /* "sat_toolkit/formula.pyx":788
+    /* "sat_toolkit/formula.pyx":795
  * 
  *         length = lhs.shape[0]
  *         if rhs.shape[0] != length:             # <<<<<<<<<<<<<<
  *             raise ValueError('lhs and rhs must have the same length')
  * 
  */
   }
 
-  /* "sat_toolkit/formula.pyx":791
+  /* "sat_toolkit/formula.pyx":798
  *             raise ValueError('lhs and rhs must have the same length')
  * 
  *         clauses.resize(length * 6)             # <<<<<<<<<<<<<<
  *         for i in range(length):
  *             l = lhs[i]
  */
   try {
     __pyx_v_clauses.resize((__pyx_v_length * 6));
   } catch(...) {
     __Pyx_CppExn2PyErr();
-    __PYX_ERR(0, 791, __pyx_L1_error)
+    __PYX_ERR(0, 798, __pyx_L1_error)
   }
 
-  /* "sat_toolkit/formula.pyx":792
+  /* "sat_toolkit/formula.pyx":799
  * 
  *         clauses.resize(length * 6)
  *         for i in range(length):             # <<<<<<<<<<<<<<
  *             l = lhs[i]
  *             r = rhs[i]
  */
   __pyx_t_3 = __pyx_v_length;
   __pyx_t_4 = __pyx_t_3;
   for (__pyx_t_5 = 0; __pyx_t_5 < __pyx_t_4; __pyx_t_5+=1) {
     __pyx_v_i = __pyx_t_5;
 
-    /* "sat_toolkit/formula.pyx":793
+    /* "sat_toolkit/formula.pyx":800
  *         clauses.resize(length * 6)
  *         for i in range(length):
  *             l = lhs[i]             # <<<<<<<<<<<<<<
  *             r = rhs[i]
  *             if l == 0 or r == 0:
  */
     __pyx_t_6 = __pyx_v_i;
     __pyx_v_l = (*((int const  *) ( /* dim=0 */ (__pyx_v_lhs.data + __pyx_t_6 * __pyx_v_lhs.strides[0]) )));
 
-    /* "sat_toolkit/formula.pyx":794
+    /* "sat_toolkit/formula.pyx":801
  *         for i in range(length):
  *             l = lhs[i]
  *             r = rhs[i]             # <<<<<<<<<<<<<<
  *             if l == 0 or r == 0:
  *                 raise ValueError('all indices must be nonzero')
  */
     __pyx_t_6 = __pyx_v_i;
     __pyx_v_r = (*((int const  *) ( /* dim=0 */ (__pyx_v_rhs.data + __pyx_t_6 * __pyx_v_rhs.strides[0]) )));
 
-    /* "sat_toolkit/formula.pyx":795
+    /* "sat_toolkit/formula.pyx":802
  *             l = lhs[i]
  *             r = rhs[i]
  *             if l == 0 or r == 0:             # <<<<<<<<<<<<<<
  *                 raise ValueError('all indices must be nonzero')
  * 
  */
     __pyx_t_7 = (__pyx_v_l == 0);
@@ -35428,161 +35565,161 @@
       goto __pyx_L7_bool_binop_done;
     }
     __pyx_t_7 = (__pyx_v_r == 0);
     __pyx_t_1 = __pyx_t_7;
     __pyx_L7_bool_binop_done:;
     if (unlikely(__pyx_t_1)) {
 
-      /* "sat_toolkit/formula.pyx":796
+      /* "sat_toolkit/formula.pyx":803
  *             r = rhs[i]
  *             if l == 0 or r == 0:
  *                 raise ValueError('all indices must be nonzero')             # <<<<<<<<<<<<<<
  * 
  *             clauses[6 * i + 0] = -l
  */
-      __pyx_t_2 = __Pyx_PyObject_Call(__pyx_builtin_ValueError, __pyx_tuple__28, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 796, __pyx_L1_error)
+      __pyx_t_2 = __Pyx_PyObject_Call(__pyx_builtin_ValueError, __pyx_tuple__28, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 803, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_2);
       __Pyx_Raise(__pyx_t_2, 0, 0, 0);
       __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-      __PYX_ERR(0, 796, __pyx_L1_error)
+      __PYX_ERR(0, 803, __pyx_L1_error)
 
-      /* "sat_toolkit/formula.pyx":795
+      /* "sat_toolkit/formula.pyx":802
  *             l = lhs[i]
  *             r = rhs[i]
  *             if l == 0 or r == 0:             # <<<<<<<<<<<<<<
  *                 raise ValueError('all indices must be nonzero')
  * 
  */
     }
 
-    /* "sat_toolkit/formula.pyx":798
+    /* "sat_toolkit/formula.pyx":805
  *                 raise ValueError('all indices must be nonzero')
  * 
  *             clauses[6 * i + 0] = -l             # <<<<<<<<<<<<<<
  *             clauses[6 * i + 1] = r
  *             clauses[6 * i + 2] = 0
  */
     (__pyx_v_clauses[((6 * __pyx_v_i) + 0)]) = (-__pyx_v_l);
 
-    /* "sat_toolkit/formula.pyx":799
+    /* "sat_toolkit/formula.pyx":806
  * 
  *             clauses[6 * i + 0] = -l
  *             clauses[6 * i + 1] = r             # <<<<<<<<<<<<<<
  *             clauses[6 * i + 2] = 0
  * 
  */
     (__pyx_v_clauses[((6 * __pyx_v_i) + 1)]) = __pyx_v_r;
 
-    /* "sat_toolkit/formula.pyx":800
+    /* "sat_toolkit/formula.pyx":807
  *             clauses[6 * i + 0] = -l
  *             clauses[6 * i + 1] = r
  *             clauses[6 * i + 2] = 0             # <<<<<<<<<<<<<<
  * 
  *             clauses[6 * i + 3] = l
  */
     (__pyx_v_clauses[((6 * __pyx_v_i) + 2)]) = 0;
 
-    /* "sat_toolkit/formula.pyx":802
+    /* "sat_toolkit/formula.pyx":809
  *             clauses[6 * i + 2] = 0
  * 
  *             clauses[6 * i + 3] = l             # <<<<<<<<<<<<<<
  *             clauses[6 * i + 4] = -r
  *             clauses[6 * i + 5] = 0
  */
     (__pyx_v_clauses[((6 * __pyx_v_i) + 3)]) = __pyx_v_l;
 
-    /* "sat_toolkit/formula.pyx":803
+    /* "sat_toolkit/formula.pyx":810
  * 
  *             clauses[6 * i + 3] = l
  *             clauses[6 * i + 4] = -r             # <<<<<<<<<<<<<<
  *             clauses[6 * i + 5] = 0
  * 
  */
     (__pyx_v_clauses[((6 * __pyx_v_i) + 4)]) = (-__pyx_v_r);
 
-    /* "sat_toolkit/formula.pyx":804
+    /* "sat_toolkit/formula.pyx":811
  *             clauses[6 * i + 3] = l
  *             clauses[6 * i + 4] = -r
  *             clauses[6 * i + 5] = 0             # <<<<<<<<<<<<<<
  * 
  *         cdef CNF res = CNF.__new__(CNF)
  */
     (__pyx_v_clauses[((6 * __pyx_v_i) + 5)]) = 0;
   }
 
-  /* "sat_toolkit/formula.pyx":806
+  /* "sat_toolkit/formula.pyx":813
  *             clauses[6 * i + 5] = 0
  * 
  *         cdef CNF res = CNF.__new__(CNF)             # <<<<<<<<<<<<<<
  *         if clauses.size() > 0:
  *             res._add_clauses(<int[:clauses.size()]> clauses.data())
  */
-  __pyx_t_2 = ((PyObject *)__pyx_tp_new_11sat_toolkit_7formula_CNF(((PyTypeObject *)__pyx_ptype_11sat_toolkit_7formula_CNF), __pyx_empty_tuple, NULL)); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 806, __pyx_L1_error)
+  __pyx_t_2 = ((PyObject *)__pyx_tp_new_11sat_toolkit_7formula_CNF(((PyTypeObject *)__pyx_ptype_11sat_toolkit_7formula_CNF), __pyx_empty_tuple, NULL)); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 813, __pyx_L1_error)
   __Pyx_GOTREF((PyObject *)__pyx_t_2);
   __pyx_v_res = ((struct __pyx_obj_11sat_toolkit_7formula_CNF *)__pyx_t_2);
   __pyx_t_2 = 0;
 
-  /* "sat_toolkit/formula.pyx":807
+  /* "sat_toolkit/formula.pyx":814
  * 
  *         cdef CNF res = CNF.__new__(CNF)
  *         if clauses.size() > 0:             # <<<<<<<<<<<<<<
  *             res._add_clauses(<int[:clauses.size()]> clauses.data())
  *         return res
  */
   __pyx_t_1 = (__pyx_v_clauses.size() > 0);
   if (__pyx_t_1) {
 
-    /* "sat_toolkit/formula.pyx":808
+    /* "sat_toolkit/formula.pyx":815
  *         cdef CNF res = CNF.__new__(CNF)
  *         if clauses.size() > 0:
  *             res._add_clauses(<int[:clauses.size()]> clauses.data())             # <<<<<<<<<<<<<<
  *         return res
  * 
  */
     __pyx_t_8 = __pyx_v_clauses.data();
     if (!__pyx_t_8) {
       PyErr_SetString(PyExc_ValueError,"Cannot create cython.array from NULL pointer");
-      __PYX_ERR(0, 808, __pyx_L1_error)
+      __PYX_ERR(0, 815, __pyx_L1_error)
     }
-    __pyx_t_10 = __pyx_format_from_typeinfo(&__Pyx_TypeInfo_int); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 808, __pyx_L1_error)
+    __pyx_t_10 = __pyx_format_from_typeinfo(&__Pyx_TypeInfo_int); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 815, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_10);
-    __pyx_t_2 = Py_BuildValue((char*) "("  __PYX_BUILD_PY_SSIZE_T  ")", ((Py_ssize_t)__pyx_v_clauses.size())); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 808, __pyx_L1_error)
+    __pyx_t_2 = Py_BuildValue((char*) "("  __PYX_BUILD_PY_SSIZE_T  ")", ((Py_ssize_t)__pyx_v_clauses.size())); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 815, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
-    __pyx_t_9 = __pyx_array_new(__pyx_t_2, sizeof(int), PyBytes_AS_STRING(__pyx_t_10), (char *) "c", (char *) __pyx_t_8); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 808, __pyx_L1_error)
+    __pyx_t_9 = __pyx_array_new(__pyx_t_2, sizeof(int), PyBytes_AS_STRING(__pyx_t_10), (char *) "c", (char *) __pyx_t_8); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 815, __pyx_L1_error)
     __Pyx_GOTREF((PyObject *)__pyx_t_9);
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
     __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
-    __pyx_t_11 = __Pyx_PyObject_to_MemoryviewSlice_ds_int__const__(((PyObject *)__pyx_t_9), 0); if (unlikely(!__pyx_t_11.memview)) __PYX_ERR(0, 808, __pyx_L1_error)
+    __pyx_t_11 = __Pyx_PyObject_to_MemoryviewSlice_ds_int__const__(((PyObject *)__pyx_t_9), 0); if (unlikely(!__pyx_t_11.memview)) __PYX_ERR(0, 815, __pyx_L1_error)
     __Pyx_DECREF((PyObject *)__pyx_t_9); __pyx_t_9 = 0;
-    __pyx_t_12 = ((struct __pyx_vtabstruct_11sat_toolkit_7formula_CNF *)__pyx_v_res->__pyx_base.__pyx_vtab)->__pyx_base._add_clauses(((struct __pyx_obj_11sat_toolkit_7formula__ClauseList *)__pyx_v_res), __pyx_t_11); if (unlikely(__pyx_t_12 == ((int)-1))) __PYX_ERR(0, 808, __pyx_L1_error)
+    __pyx_t_12 = ((struct __pyx_vtabstruct_11sat_toolkit_7formula_CNF *)__pyx_v_res->__pyx_base.__pyx_vtab)->__pyx_base._add_clauses(((struct __pyx_obj_11sat_toolkit_7formula__ClauseList *)__pyx_v_res), __pyx_t_11); if (unlikely(__pyx_t_12 == ((int)-1))) __PYX_ERR(0, 815, __pyx_L1_error)
     __PYX_XCLEAR_MEMVIEW(&__pyx_t_11, 1);
     __pyx_t_11.memview = NULL; __pyx_t_11.data = NULL;
 
-    /* "sat_toolkit/formula.pyx":807
+    /* "sat_toolkit/formula.pyx":814
  * 
  *         cdef CNF res = CNF.__new__(CNF)
  *         if clauses.size() > 0:             # <<<<<<<<<<<<<<
  *             res._add_clauses(<int[:clauses.size()]> clauses.data())
  *         return res
  */
   }
 
-  /* "sat_toolkit/formula.pyx":809
+  /* "sat_toolkit/formula.pyx":816
  *         if clauses.size() > 0:
  *             res._add_clauses(<int[:clauses.size()]> clauses.data())
  *         return res             # <<<<<<<<<<<<<<
  * 
  *     cdef int _add_xor_clause(self, const int[::1] xor_clause, int rhs=0) except -1 nogil:
  */
   __Pyx_XDECREF((PyObject *)__pyx_r);
   __Pyx_INCREF((PyObject *)__pyx_v_res);
   __pyx_r = __pyx_v_res;
   goto __pyx_L0;
 
-  /* "sat_toolkit/formula.pyx":781
+  /* "sat_toolkit/formula.pyx":788
  *         return CNF._create_all_equal(lhs, rhs)
  * 
  *     @staticmethod             # <<<<<<<<<<<<<<
  *     def _create_all_equal(const int[:] lhs not None, const int[:] rhs not None) -> CNF:
  *         cdef vector[int] clauses
  */
 
@@ -35597,15 +35734,15 @@
   __pyx_L0:;
   __Pyx_XDECREF((PyObject *)__pyx_v_res);
   __Pyx_XGIVEREF((PyObject *)__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "sat_toolkit/formula.pyx":811
+/* "sat_toolkit/formula.pyx":818
  *         return res
  * 
  *     cdef int _add_xor_clause(self, const int[::1] xor_clause, int rhs=0) except -1 nogil:             # <<<<<<<<<<<<<<
  *         if rhs not in [0, 1]:
  *             raise ValueError(f"right hand side must be 0 or 1, not {rhs}")
  */
 
@@ -35650,15 +35787,15 @@
   __Pyx_RefNannySetupContext("_add_xor_clause", 1);
   if (__pyx_optional_args) {
     if (__pyx_optional_args->__pyx_n > 0) {
       __pyx_v_rhs = __pyx_optional_args->rhs;
     }
   }
 
-  /* "sat_toolkit/formula.pyx":812
+  /* "sat_toolkit/formula.pyx":819
  * 
  *     cdef int _add_xor_clause(self, const int[::1] xor_clause, int rhs=0) except -1 nogil:
  *         if rhs not in [0, 1]:             # <<<<<<<<<<<<<<
  *             raise ValueError(f"right hand side must be 0 or 1, not {rhs}")
  * 
  */
   switch (__pyx_v_rhs) {
@@ -35669,235 +35806,235 @@
     default:
     __pyx_t_1 = 1;
     break;
   }
   __pyx_t_2 = __pyx_t_1;
   if (unlikely(__pyx_t_2)) {
 
-    /* "sat_toolkit/formula.pyx":813
+    /* "sat_toolkit/formula.pyx":820
  *     cdef int _add_xor_clause(self, const int[::1] xor_clause, int rhs=0) except -1 nogil:
  *         if rhs not in [0, 1]:
  *             raise ValueError(f"right hand side must be 0 or 1, not {rhs}")             # <<<<<<<<<<<<<<
  * 
  *         cdef size_t num_inputs = xor_clause.shape[0]
  */
     {
         #ifdef WITH_THREAD
         PyGILState_STATE __pyx_gilstate_save = __Pyx_PyGILState_Ensure();
         #endif
         /*try:*/ {
-          __pyx_t_3 = __Pyx_PyUnicode_From_int(__pyx_v_rhs, 0, ' ', 'd'); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 813, __pyx_L5_error)
+          __pyx_t_3 = __Pyx_PyUnicode_From_int(__pyx_v_rhs, 0, ' ', 'd'); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 820, __pyx_L5_error)
           __Pyx_GOTREF(__pyx_t_3);
-          __pyx_t_4 = __Pyx_PyUnicode_Concat(__pyx_kp_u_right_hand_side_must_be_0_or_1_n, __pyx_t_3); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 813, __pyx_L5_error)
+          __pyx_t_4 = __Pyx_PyUnicode_Concat(__pyx_kp_u_right_hand_side_must_be_0_or_1_n, __pyx_t_3); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 820, __pyx_L5_error)
           __Pyx_GOTREF(__pyx_t_4);
           __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-          __pyx_t_3 = __Pyx_PyObject_CallOneArg(__pyx_builtin_ValueError, __pyx_t_4); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 813, __pyx_L5_error)
+          __pyx_t_3 = __Pyx_PyObject_CallOneArg(__pyx_builtin_ValueError, __pyx_t_4); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 820, __pyx_L5_error)
           __Pyx_GOTREF(__pyx_t_3);
           __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
           __Pyx_Raise(__pyx_t_3, 0, 0, 0);
           __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-          __PYX_ERR(0, 813, __pyx_L5_error)
+          __PYX_ERR(0, 820, __pyx_L5_error)
         }
         /*finally:*/ {
           __pyx_L5_error: {
             #ifdef WITH_THREAD
             __Pyx_PyGILState_Release(__pyx_gilstate_save);
             #endif
             goto __pyx_L1_error;
           }
         }
     }
 
-    /* "sat_toolkit/formula.pyx":812
+    /* "sat_toolkit/formula.pyx":819
  * 
  *     cdef int _add_xor_clause(self, const int[::1] xor_clause, int rhs=0) except -1 nogil:
  *         if rhs not in [0, 1]:             # <<<<<<<<<<<<<<
  *             raise ValueError(f"right hand side must be 0 or 1, not {rhs}")
  * 
  */
   }
 
-  /* "sat_toolkit/formula.pyx":815
+  /* "sat_toolkit/formula.pyx":822
  *             raise ValueError(f"right hand side must be 0 or 1, not {rhs}")
  * 
  *         cdef size_t num_inputs = xor_clause.shape[0]             # <<<<<<<<<<<<<<
  *         cdef size_t num_clauses = 1 << (num_inputs - 1)
  *         cdef size_t mask, col
  */
   __pyx_v_num_inputs = (__pyx_v_xor_clause.shape[0]);
 
-  /* "sat_toolkit/formula.pyx":816
+  /* "sat_toolkit/formula.pyx":823
  * 
  *         cdef size_t num_inputs = xor_clause.shape[0]
  *         cdef size_t num_clauses = 1 << (num_inputs - 1)             # <<<<<<<<<<<<<<
  *         cdef size_t mask, col
  *         cdef int var_idx
  */
   __pyx_v_num_clauses = (1 << (__pyx_v_num_inputs - 1));
 
-  /* "sat_toolkit/formula.pyx":820
+  /* "sat_toolkit/formula.pyx":827
  *         cdef int var_idx
  * 
  *         cdef size_t buffer_elements = (num_clauses) * (num_inputs + 1)             # <<<<<<<<<<<<<<
  *         cdef int *buffer = <int *> malloc(buffer_elements * sizeof(int))
  *         cdef size_t buffer_offset = 0
  */
   __pyx_v_buffer_elements = (__pyx_v_num_clauses * (__pyx_v_num_inputs + 1));
 
-  /* "sat_toolkit/formula.pyx":821
+  /* "sat_toolkit/formula.pyx":828
  * 
  *         cdef size_t buffer_elements = (num_clauses) * (num_inputs + 1)
  *         cdef int *buffer = <int *> malloc(buffer_elements * sizeof(int))             # <<<<<<<<<<<<<<
  *         cdef size_t buffer_offset = 0
  * 
  */
   __pyx_v_buffer = ((int *)malloc((__pyx_v_buffer_elements * (sizeof(int)))));
 
-  /* "sat_toolkit/formula.pyx":822
+  /* "sat_toolkit/formula.pyx":829
  *         cdef size_t buffer_elements = (num_clauses) * (num_inputs + 1)
  *         cdef int *buffer = <int *> malloc(buffer_elements * sizeof(int))
  *         cdef size_t buffer_offset = 0             # <<<<<<<<<<<<<<
  * 
  *         for col in range(num_inputs):
  */
   __pyx_v_buffer_offset = 0;
 
-  /* "sat_toolkit/formula.pyx":824
+  /* "sat_toolkit/formula.pyx":831
  *         cdef size_t buffer_offset = 0
  * 
  *         for col in range(num_inputs):             # <<<<<<<<<<<<<<
  *             if xor_clause[col] == 0:
  *                 raise ValueError('all indices must be nonzero')
  */
   __pyx_t_5 = __pyx_v_num_inputs;
   __pyx_t_6 = __pyx_t_5;
   for (__pyx_t_7 = 0; __pyx_t_7 < __pyx_t_6; __pyx_t_7+=1) {
     __pyx_v_col = __pyx_t_7;
 
-    /* "sat_toolkit/formula.pyx":825
+    /* "sat_toolkit/formula.pyx":832
  * 
  *         for col in range(num_inputs):
  *             if xor_clause[col] == 0:             # <<<<<<<<<<<<<<
  *                 raise ValueError('all indices must be nonzero')
  * 
  */
     __pyx_t_8 = __pyx_v_col;
     __pyx_t_2 = ((*((int const  *) ( /* dim=0 */ ((char *) (((int const  *) __pyx_v_xor_clause.data) + __pyx_t_8)) ))) == 0);
     if (unlikely(__pyx_t_2)) {
 
-      /* "sat_toolkit/formula.pyx":826
+      /* "sat_toolkit/formula.pyx":833
  *         for col in range(num_inputs):
  *             if xor_clause[col] == 0:
  *                 raise ValueError('all indices must be nonzero')             # <<<<<<<<<<<<<<
  * 
  *         try:
  */
       {
           #ifdef WITH_THREAD
           PyGILState_STATE __pyx_gilstate_save = __Pyx_PyGILState_Ensure();
           #endif
           /*try:*/ {
-            __pyx_t_3 = __Pyx_PyObject_Call(__pyx_builtin_ValueError, __pyx_tuple__28, NULL); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 826, __pyx_L13_error)
+            __pyx_t_3 = __Pyx_PyObject_Call(__pyx_builtin_ValueError, __pyx_tuple__28, NULL); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 833, __pyx_L13_error)
             __Pyx_GOTREF(__pyx_t_3);
             __Pyx_Raise(__pyx_t_3, 0, 0, 0);
             __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-            __PYX_ERR(0, 826, __pyx_L13_error)
+            __PYX_ERR(0, 833, __pyx_L13_error)
           }
           /*finally:*/ {
             __pyx_L13_error: {
               #ifdef WITH_THREAD
               __Pyx_PyGILState_Release(__pyx_gilstate_save);
               #endif
               goto __pyx_L1_error;
             }
           }
       }
 
-      /* "sat_toolkit/formula.pyx":825
+      /* "sat_toolkit/formula.pyx":832
  * 
  *         for col in range(num_inputs):
  *             if xor_clause[col] == 0:             # <<<<<<<<<<<<<<
  *                 raise ValueError('all indices must be nonzero')
  * 
  */
     }
   }
 
-  /* "sat_toolkit/formula.pyx":828
+  /* "sat_toolkit/formula.pyx":835
  *                 raise ValueError('all indices must be nonzero')
  * 
  *         try:             # <<<<<<<<<<<<<<
  *             for mask in range(1 << num_inputs):
  *                 if popcount(mask) % 2 == rhs:
  */
   /*try:*/ {
 
-    /* "sat_toolkit/formula.pyx":829
+    /* "sat_toolkit/formula.pyx":836
  * 
  *         try:
  *             for mask in range(1 << num_inputs):             # <<<<<<<<<<<<<<
  *                 if popcount(mask) % 2 == rhs:
  *                     continue
  */
     __pyx_t_5 = (1 << __pyx_v_num_inputs);
     __pyx_t_6 = __pyx_t_5;
     for (__pyx_t_7 = 0; __pyx_t_7 < __pyx_t_6; __pyx_t_7+=1) {
       __pyx_v_mask = __pyx_t_7;
 
-      /* "sat_toolkit/formula.pyx":830
+      /* "sat_toolkit/formula.pyx":837
  *         try:
  *             for mask in range(1 << num_inputs):
  *                 if popcount(mask) % 2 == rhs:             # <<<<<<<<<<<<<<
  *                     continue
  * 
  */
       __pyx_t_2 = ((popcount(__pyx_v_mask) % 2) == __pyx_v_rhs);
       if (__pyx_t_2) {
 
-        /* "sat_toolkit/formula.pyx":831
+        /* "sat_toolkit/formula.pyx":838
  *             for mask in range(1 << num_inputs):
  *                 if popcount(mask) % 2 == rhs:
  *                     continue             # <<<<<<<<<<<<<<
  * 
  *                 for col in range(num_inputs):
  */
         goto __pyx_L18_continue;
 
-        /* "sat_toolkit/formula.pyx":830
+        /* "sat_toolkit/formula.pyx":837
  *         try:
  *             for mask in range(1 << num_inputs):
  *                 if popcount(mask) % 2 == rhs:             # <<<<<<<<<<<<<<
  *                     continue
  * 
  */
       }
 
-      /* "sat_toolkit/formula.pyx":833
+      /* "sat_toolkit/formula.pyx":840
  *                     continue
  * 
  *                 for col in range(num_inputs):             # <<<<<<<<<<<<<<
  *                     var_idx = xor_clause[col]
  * 
  */
       __pyx_t_8 = __pyx_v_num_inputs;
       __pyx_t_9 = __pyx_t_8;
       for (__pyx_t_10 = 0; __pyx_t_10 < __pyx_t_9; __pyx_t_10+=1) {
         __pyx_v_col = __pyx_t_10;
 
-        /* "sat_toolkit/formula.pyx":834
+        /* "sat_toolkit/formula.pyx":841
  * 
  *                 for col in range(num_inputs):
  *                     var_idx = xor_clause[col]             # <<<<<<<<<<<<<<
  * 
  *                     # FIXME row offset
  */
         __pyx_t_11 = __pyx_v_col;
         __pyx_v_var_idx = (*((int const  *) ( /* dim=0 */ ((char *) (((int const  *) __pyx_v_xor_clause.data) + __pyx_t_11)) )));
 
-        /* "sat_toolkit/formula.pyx":837
+        /* "sat_toolkit/formula.pyx":844
  * 
  *                     # FIXME row offset
  *                     buffer[buffer_offset + col] = -var_idx if (mask >> col) & 1 else var_idx             # <<<<<<<<<<<<<<
  * 
  *                 buffer[buffer_offset + num_inputs] = 0
  */
         __pyx_t_2 = (((__pyx_v_mask >> __pyx_v_col) & 1) != 0);
@@ -35905,35 +36042,35 @@
           __pyx_t_12 = (-__pyx_v_var_idx);
         } else {
           __pyx_t_12 = __pyx_v_var_idx;
         }
         (__pyx_v_buffer[(__pyx_v_buffer_offset + __pyx_v_col)]) = __pyx_t_12;
       }
 
-      /* "sat_toolkit/formula.pyx":839
+      /* "sat_toolkit/formula.pyx":846
  *                     buffer[buffer_offset + col] = -var_idx if (mask >> col) & 1 else var_idx
  * 
  *                 buffer[buffer_offset + num_inputs] = 0             # <<<<<<<<<<<<<<
  * 
  *                 buffer_offset += num_inputs + 1
  */
       (__pyx_v_buffer[(__pyx_v_buffer_offset + __pyx_v_num_inputs)]) = 0;
 
-      /* "sat_toolkit/formula.pyx":841
+      /* "sat_toolkit/formula.pyx":848
  *                 buffer[buffer_offset + num_inputs] = 0
  * 
  *                 buffer_offset += num_inputs + 1             # <<<<<<<<<<<<<<
  * 
  *             assert buffer_offset == buffer_elements
  */
       __pyx_v_buffer_offset = (__pyx_v_buffer_offset + (__pyx_v_num_inputs + 1));
       __pyx_L18_continue:;
     }
 
-    /* "sat_toolkit/formula.pyx":843
+    /* "sat_toolkit/formula.pyx":850
  *                 buffer_offset += num_inputs + 1
  * 
  *             assert buffer_offset == buffer_elements             # <<<<<<<<<<<<<<
  *             self._add_clauses_raw(buffer, buffer_elements)
  *         finally:
  */
     #ifndef CYTHON_WITHOUT_ASSERTIONS
@@ -35942,42 +36079,42 @@
       if (unlikely(!__pyx_t_2)) {
         {
             #ifdef WITH_THREAD
             PyGILState_STATE __pyx_gilstate_save = __Pyx_PyGILState_Ensure();
             #endif
             /*try:*/ {
               __Pyx_Raise(__pyx_builtin_AssertionError, 0, 0, 0);
-              __PYX_ERR(0, 843, __pyx_L24_error)
+              __PYX_ERR(0, 850, __pyx_L24_error)
             }
             /*finally:*/ {
               __pyx_L24_error: {
                 #ifdef WITH_THREAD
                 __Pyx_PyGILState_Release(__pyx_gilstate_save);
                 #endif
                 goto __pyx_L16_error;
               }
             }
         }
       }
     }
     #else
-    if ((1)); else __PYX_ERR(0, 843, __pyx_L16_error)
+    if ((1)); else __PYX_ERR(0, 850, __pyx_L16_error)
     #endif
 
-    /* "sat_toolkit/formula.pyx":844
+    /* "sat_toolkit/formula.pyx":851
  * 
  *             assert buffer_offset == buffer_elements
  *             self._add_clauses_raw(buffer, buffer_elements)             # <<<<<<<<<<<<<<
  *         finally:
  *             free(&buffer[0])
  */
-    __pyx_t_12 = ((struct __pyx_vtabstruct_11sat_toolkit_7formula_CNF *)__pyx_v_self->__pyx_base.__pyx_vtab)->__pyx_base._add_clauses_raw(((struct __pyx_obj_11sat_toolkit_7formula__ClauseList *)__pyx_v_self), __pyx_v_buffer, __pyx_v_buffer_elements); if (unlikely(__pyx_t_12 == ((int)-1))) __PYX_ERR(0, 844, __pyx_L16_error)
+    __pyx_t_12 = ((struct __pyx_vtabstruct_11sat_toolkit_7formula_CNF *)__pyx_v_self->__pyx_base.__pyx_vtab)->__pyx_base._add_clauses_raw(((struct __pyx_obj_11sat_toolkit_7formula__ClauseList *)__pyx_v_self), __pyx_v_buffer, __pyx_v_buffer_elements); if (unlikely(__pyx_t_12 == ((int)-1))) __PYX_ERR(0, 851, __pyx_L16_error)
   }
 
-  /* "sat_toolkit/formula.pyx":846
+  /* "sat_toolkit/formula.pyx":853
  *             self._add_clauses_raw(buffer, buffer_elements)
  *         finally:
  *             free(&buffer[0])             # <<<<<<<<<<<<<<
  * 
  *         return 0
  */
   /*finally:*/ {
@@ -36033,25 +36170,25 @@
       __pyx_t_15 = 0; __pyx_t_16 = 0; __pyx_t_17 = 0; __pyx_t_18 = 0; __pyx_t_19 = 0; __pyx_t_20 = 0;
       __pyx_lineno = __pyx_t_12; __pyx_clineno = __pyx_t_13; __pyx_filename = __pyx_t_14;
       goto __pyx_L1_error;
     }
     __pyx_L17:;
   }
 
-  /* "sat_toolkit/formula.pyx":848
+  /* "sat_toolkit/formula.pyx":855
  *             free(&buffer[0])
  * 
  *         return 0             # <<<<<<<<<<<<<<
  * 
  *     @staticmethod
  */
   __pyx_r = 0;
   goto __pyx_L0;
 
-  /* "sat_toolkit/formula.pyx":811
+  /* "sat_toolkit/formula.pyx":818
  *         return res
  * 
  *     cdef int _add_xor_clause(self, const int[::1] xor_clause, int rhs=0) except -1 nogil:             # <<<<<<<<<<<<<<
  *         if rhs not in [0, 1]:
  *             raise ValueError(f"right hand side must be 0 or 1, not {rhs}")
  */
 
@@ -36068,15 +36205,15 @@
   __Pyx_PyGILState_Release(__pyx_gilstate_save);
   #endif
   __pyx_L0:;
   __Pyx_RefNannyFinishContextNogil()
   return __pyx_r;
 }
 
-/* "sat_toolkit/formula.pyx":851
+/* "sat_toolkit/formula.pyx":858
  * 
  *     @staticmethod
  *     cdef CNF _create_xor(const int[:, ::1] packed_args):             # <<<<<<<<<<<<<<
  *         cdef CNF res = CNF.__new__(CNF)
  * 
  */
 
@@ -36105,70 +36242,70 @@
   __Pyx_memviewslice __pyx_t_13 = { 0, 0, { 0 }, { 0 }, { 0 } };
   struct __pyx_opt_args_11sat_toolkit_7formula_3CNF__add_xor_clause __pyx_t_14;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("_create_xor", 1);
 
-  /* "sat_toolkit/formula.pyx":852
+  /* "sat_toolkit/formula.pyx":859
  *     @staticmethod
  *     cdef CNF _create_xor(const int[:, ::1] packed_args):
  *         cdef CNF res = CNF.__new__(CNF)             # <<<<<<<<<<<<<<
  * 
  *         cdef size_t num_inputs, num_xors
  */
-  __pyx_t_1 = ((PyObject *)__pyx_tp_new_11sat_toolkit_7formula_CNF(((PyTypeObject *)__pyx_ptype_11sat_toolkit_7formula_CNF), __pyx_empty_tuple, NULL)); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 852, __pyx_L1_error)
+  __pyx_t_1 = ((PyObject *)__pyx_tp_new_11sat_toolkit_7formula_CNF(((PyTypeObject *)__pyx_ptype_11sat_toolkit_7formula_CNF), __pyx_empty_tuple, NULL)); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 859, __pyx_L1_error)
   __Pyx_GOTREF((PyObject *)__pyx_t_1);
   __pyx_v_res = ((struct __pyx_obj_11sat_toolkit_7formula_CNF *)__pyx_t_1);
   __pyx_t_1 = 0;
 
-  /* "sat_toolkit/formula.pyx":859
+  /* "sat_toolkit/formula.pyx":866
  *         cdef int rhs, var_idx
  * 
  *         num_xors = packed_args.shape[0]             # <<<<<<<<<<<<<<
  *         num_inputs = packed_args.shape[1] - 1
  * 
  */
   __pyx_v_num_xors = (__pyx_v_packed_args.shape[0]);
 
-  /* "sat_toolkit/formula.pyx":860
+  /* "sat_toolkit/formula.pyx":867
  * 
  *         num_xors = packed_args.shape[0]
  *         num_inputs = packed_args.shape[1] - 1             # <<<<<<<<<<<<<<
  * 
  *         cdef size_t needed_space = num_inputs * ((1 << (num_inputs - 1)) + 1)
  */
   __pyx_v_num_inputs = ((__pyx_v_packed_args.shape[1]) - 1);
 
-  /* "sat_toolkit/formula.pyx":862
+  /* "sat_toolkit/formula.pyx":869
  *         num_inputs = packed_args.shape[1] - 1
  * 
  *         cdef size_t needed_space = num_inputs * ((1 << (num_inputs - 1)) + 1)             # <<<<<<<<<<<<<<
  *         cdef int[::1] tmp_clause = np.empty(num_inputs + 1, np.int32)
  *         tmp_clause[num_inputs] = 0
  */
   __pyx_v_needed_space = (__pyx_v_num_inputs * ((1 << (__pyx_v_num_inputs - 1)) + 1));
 
-  /* "sat_toolkit/formula.pyx":863
+  /* "sat_toolkit/formula.pyx":870
  * 
  *         cdef size_t needed_space = num_inputs * ((1 << (num_inputs - 1)) + 1)
  *         cdef int[::1] tmp_clause = np.empty(num_inputs + 1, np.int32)             # <<<<<<<<<<<<<<
  *         tmp_clause[num_inputs] = 0
  * 
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 863, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 870, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_empty); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 863, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_empty); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 870, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __pyx_t_2 = __Pyx_PyInt_FromSize_t((__pyx_v_num_inputs + 1)); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 863, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyInt_FromSize_t((__pyx_v_num_inputs + 1)); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 870, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_np); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 863, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_np); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 870, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
-  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_int32); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 863, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_int32); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 870, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
   __pyx_t_4 = NULL;
   __pyx_t_6 = 0;
   #if CYTHON_UNPACK_METHODS
   if (unlikely(PyMethod_Check(__pyx_t_3))) {
     __pyx_t_4 = PyMethod_GET_SELF(__pyx_t_3);
@@ -36183,58 +36320,58 @@
   #endif
   {
     PyObject *__pyx_callargs[3] = {__pyx_t_4, __pyx_t_2, __pyx_t_5};
     __pyx_t_1 = __Pyx_PyObject_FastCall(__pyx_t_3, __pyx_callargs+1-__pyx_t_6, 2+__pyx_t_6);
     __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-    if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 863, __pyx_L1_error)
+    if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 870, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   }
-  __pyx_t_7 = __Pyx_PyObject_to_MemoryviewSlice_dc_int(__pyx_t_1, PyBUF_WRITABLE); if (unlikely(!__pyx_t_7.memview)) __PYX_ERR(0, 863, __pyx_L1_error)
+  __pyx_t_7 = __Pyx_PyObject_to_MemoryviewSlice_dc_int(__pyx_t_1, PyBUF_WRITABLE); if (unlikely(!__pyx_t_7.memview)) __PYX_ERR(0, 870, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __pyx_v_tmp_clause = __pyx_t_7;
   __pyx_t_7.memview = NULL;
   __pyx_t_7.data = NULL;
 
-  /* "sat_toolkit/formula.pyx":864
+  /* "sat_toolkit/formula.pyx":871
  *         cdef size_t needed_space = num_inputs * ((1 << (num_inputs - 1)) + 1)
  *         cdef int[::1] tmp_clause = np.empty(num_inputs + 1, np.int32)
  *         tmp_clause[num_inputs] = 0             # <<<<<<<<<<<<<<
  * 
  * 
  */
   __pyx_t_8 = __pyx_v_num_inputs;
   *((int *) ( /* dim=0 */ ((char *) (((int *) __pyx_v_tmp_clause.data) + __pyx_t_8)) )) = 0;
 
-  /* "sat_toolkit/formula.pyx":867
+  /* "sat_toolkit/formula.pyx":874
  * 
  * 
  *         for row in range(num_xors):             # <<<<<<<<<<<<<<
  *             rhs = packed_args[row, num_inputs]
  *             res._add_xor_clause(packed_args[row, :num_inputs], rhs)
  */
   __pyx_t_8 = __pyx_v_num_xors;
   __pyx_t_9 = __pyx_t_8;
   for (__pyx_t_10 = 0; __pyx_t_10 < __pyx_t_9; __pyx_t_10+=1) {
     __pyx_v_row = __pyx_t_10;
 
-    /* "sat_toolkit/formula.pyx":868
+    /* "sat_toolkit/formula.pyx":875
  * 
  *         for row in range(num_xors):
  *             rhs = packed_args[row, num_inputs]             # <<<<<<<<<<<<<<
  *             res._add_xor_clause(packed_args[row, :num_inputs], rhs)
  * 
  */
     __pyx_t_11 = __pyx_v_row;
     __pyx_t_12 = __pyx_v_num_inputs;
     __pyx_v_rhs = (*((int const  *) ( /* dim=1 */ ((char *) (((int const  *) ( /* dim=0 */ (__pyx_v_packed_args.data + __pyx_t_11 * __pyx_v_packed_args.strides[0]) )) + __pyx_t_12)) )));
 
-    /* "sat_toolkit/formula.pyx":869
+    /* "sat_toolkit/formula.pyx":876
  *         for row in range(num_xors):
  *             rhs = packed_args[row, num_inputs]
  *             res._add_xor_clause(packed_args[row, :num_inputs], rhs)             # <<<<<<<<<<<<<<
  * 
  *         return res
  */
     __pyx_t_13.data = __pyx_v_packed_args.data;
@@ -36257,37 +36394,37 @@
     __pyx_v_num_inputs,
     0,
     0,
     1,
     0,
     1) < 0))
 {
-    __PYX_ERR(0, 869, __pyx_L1_error)
+    __PYX_ERR(0, 876, __pyx_L1_error)
 }
 
 __pyx_t_14.__pyx_n = 1;
     __pyx_t_14.rhs = __pyx_v_rhs;
-    __pyx_t_6 = ((struct __pyx_vtabstruct_11sat_toolkit_7formula_CNF *)__pyx_v_res->__pyx_base.__pyx_vtab)->_add_xor_clause(__pyx_v_res, __pyx_t_13, &__pyx_t_14); if (unlikely(__pyx_t_6 == ((int)-1))) __PYX_ERR(0, 869, __pyx_L1_error)
+    __pyx_t_6 = ((struct __pyx_vtabstruct_11sat_toolkit_7formula_CNF *)__pyx_v_res->__pyx_base.__pyx_vtab)->_add_xor_clause(__pyx_v_res, __pyx_t_13, &__pyx_t_14); if (unlikely(__pyx_t_6 == ((int)-1))) __PYX_ERR(0, 876, __pyx_L1_error)
     __PYX_XCLEAR_MEMVIEW(&__pyx_t_13, 1);
     __pyx_t_13.memview = NULL; __pyx_t_13.data = NULL;
   }
 
-  /* "sat_toolkit/formula.pyx":871
+  /* "sat_toolkit/formula.pyx":878
  *             res._add_xor_clause(packed_args[row, :num_inputs], rhs)
  * 
  *         return res             # <<<<<<<<<<<<<<
  * 
  *     @staticmethod
  */
   __Pyx_XDECREF((PyObject *)__pyx_r);
   __Pyx_INCREF((PyObject *)__pyx_v_res);
   __pyx_r = __pyx_v_res;
   goto __pyx_L0;
 
-  /* "sat_toolkit/formula.pyx":851
+  /* "sat_toolkit/formula.pyx":858
  * 
  *     @staticmethod
  *     cdef CNF _create_xor(const int[:, ::1] packed_args):             # <<<<<<<<<<<<<<
  *         cdef CNF res = CNF.__new__(CNF)
  * 
  */
 
@@ -36306,15 +36443,15 @@
   __Pyx_XDECREF((PyObject *)__pyx_v_res);
   __PYX_XCLEAR_MEMVIEW(&__pyx_v_tmp_clause, 1);
   __Pyx_XGIVEREF((PyObject *)__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "sat_toolkit/formula.pyx":873
+/* "sat_toolkit/formula.pyx":880
  *         return res
  * 
  *     @staticmethod             # <<<<<<<<<<<<<<
  *     def create_xor(*args, rhs=None) -> CNF:
  *         """
  */
 
@@ -36341,15 +36478,15 @@
   #endif
   __pyx_kwvalues = __Pyx_KwValues_VARARGS(__pyx_args, __pyx_nargs);
   __Pyx_INCREF(__pyx_args);
   __pyx_v_args = __pyx_args;
   {
     PyObject **__pyx_pyargnames[] = {&__pyx_n_s_rhs,0};
 
-    /* "sat_toolkit/formula.pyx":874
+    /* "sat_toolkit/formula.pyx":881
  * 
  *     @staticmethod
  *     def create_xor(*args, rhs=None) -> CNF:             # <<<<<<<<<<<<<<
  *         """
  *         creates a CNF specifying the xor of the arguments is equal to the right
  */
     values[0] = __Pyx_Arg_NewRef_VARARGS(((PyObject *)Py_None));
@@ -36360,28 +36497,28 @@
         case  0: break;
       }
       kw_args = __Pyx_NumKwargs_VARARGS(__pyx_kwds);
       if (kw_args == 1) {
         const Py_ssize_t index = 0;
         PyObject* value = __Pyx_GetKwValue_VARARGS(__pyx_kwds, __pyx_kwvalues, *__pyx_pyargnames[index]);
         if (value) { values[index] = __Pyx_Arg_NewRef_VARARGS(value); kw_args--; }
-        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 873, __pyx_L3_error)
+        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 880, __pyx_L3_error)
       }
       if (unlikely(kw_args > 0)) {
-        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values + 0, 0, "create_xor") < 0)) __PYX_ERR(0, 873, __pyx_L3_error)
+        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values + 0, 0, "create_xor") < 0)) __PYX_ERR(0, 880, __pyx_L3_error)
       }
     } else if (unlikely(__pyx_nargs < 0)) {
       goto __pyx_L5_argtuple_error;
     } else {
     }
     __pyx_v_rhs = values[0];
   }
   goto __pyx_L6_skip;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("create_xor", 0, 0, 0, __pyx_nargs); __PYX_ERR(0, 873, __pyx_L3_error)
+  __Pyx_RaiseArgtupleInvalid("create_xor", 0, 0, 0, __pyx_nargs); __PYX_ERR(0, 880, __pyx_L3_error)
   __pyx_L6_skip:;
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L3_error:;
   {
     Py_ssize_t __pyx_temp;
     for (__pyx_temp=0; __pyx_temp < (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
       __Pyx_Arg_XDECREF_VARARGS(values[__pyx_temp]);
@@ -36390,15 +36527,15 @@
   __Pyx_DECREF(__pyx_v_args); __pyx_v_args = 0;
   __Pyx_AddTraceback("sat_toolkit.formula.CNF.create_xor", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __Pyx_RefNannyFinishContext();
   return NULL;
   __pyx_L4_argument_unpacking_done:;
   __pyx_r = __pyx_pf_11sat_toolkit_7formula_3CNF_12create_xor(__pyx_v_rhs, __pyx_v_args);
 
-  /* "sat_toolkit/formula.pyx":873
+  /* "sat_toolkit/formula.pyx":880
  *         return res
  * 
  *     @staticmethod             # <<<<<<<<<<<<<<
  *     def create_xor(*args, rhs=None) -> CNF:
  *         """
  */
 
@@ -36433,105 +36570,105 @@
   size_t __pyx_t_9;
   __Pyx_memviewslice __pyx_t_10 = { 0, 0, { 0 }, { 0 }, { 0 } };
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("create_xor", 1);
 
-  /* "sat_toolkit/formula.pyx":883
+  /* "sat_toolkit/formula.pyx":890
  *         Each argument is a 1-D array. The xors are computed elementwise.
  *         """
  *         cdef size_t num_args = len(args)             # <<<<<<<<<<<<<<
  *         cdef size_t num_xors = -1
  *         cdef size_t i
  */
-  __pyx_t_1 = __Pyx_PyTuple_GET_SIZE(__pyx_v_args); if (unlikely(__pyx_t_1 == ((Py_ssize_t)-1))) __PYX_ERR(0, 883, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyTuple_GET_SIZE(__pyx_v_args); if (unlikely(__pyx_t_1 == ((Py_ssize_t)-1))) __PYX_ERR(0, 890, __pyx_L1_error)
   __pyx_v_num_args = __pyx_t_1;
 
-  /* "sat_toolkit/formula.pyx":884
+  /* "sat_toolkit/formula.pyx":891
  *         """
  *         cdef size_t num_args = len(args)
  *         cdef size_t num_xors = -1             # <<<<<<<<<<<<<<
  *         cdef size_t i
  * 
  */
   __pyx_v_num_xors = -1L;
 
-  /* "sat_toolkit/formula.pyx":888
+  /* "sat_toolkit/formula.pyx":895
  * 
  * 
  *         if num_args < 1:             # <<<<<<<<<<<<<<
  *             raise ValueError('must provide at least one argument')
  * 
  */
   __pyx_t_2 = (__pyx_v_num_args < 1);
   if (unlikely(__pyx_t_2)) {
 
-    /* "sat_toolkit/formula.pyx":889
+    /* "sat_toolkit/formula.pyx":896
  * 
  *         if num_args < 1:
  *             raise ValueError('must provide at least one argument')             # <<<<<<<<<<<<<<
  * 
  *         num_xors = len(args[0])
  */
-    __pyx_t_3 = __Pyx_PyObject_Call(__pyx_builtin_ValueError, __pyx_tuple__30, NULL); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 889, __pyx_L1_error)
+    __pyx_t_3 = __Pyx_PyObject_Call(__pyx_builtin_ValueError, __pyx_tuple__30, NULL); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 896, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
     __Pyx_Raise(__pyx_t_3, 0, 0, 0);
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-    __PYX_ERR(0, 889, __pyx_L1_error)
+    __PYX_ERR(0, 896, __pyx_L1_error)
 
-    /* "sat_toolkit/formula.pyx":888
+    /* "sat_toolkit/formula.pyx":895
  * 
  * 
  *         if num_args < 1:             # <<<<<<<<<<<<<<
  *             raise ValueError('must provide at least one argument')
  * 
  */
   }
 
-  /* "sat_toolkit/formula.pyx":891
+  /* "sat_toolkit/formula.pyx":898
  *             raise ValueError('must provide at least one argument')
  * 
  *         num_xors = len(args[0])             # <<<<<<<<<<<<<<
  * 
  *         packed_args = np.zeros((num_xors, num_args + 1), np.int32)
  */
   __pyx_t_3 = PyTuple_GET_ITEM(__pyx_v_args, 0);
   __Pyx_INCREF(__pyx_t_3);
-  __pyx_t_1 = PyObject_Length(__pyx_t_3); if (unlikely(__pyx_t_1 == ((Py_ssize_t)-1))) __PYX_ERR(0, 891, __pyx_L1_error)
+  __pyx_t_1 = PyObject_Length(__pyx_t_3); if (unlikely(__pyx_t_1 == ((Py_ssize_t)-1))) __PYX_ERR(0, 898, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   __pyx_v_num_xors = __pyx_t_1;
 
-  /* "sat_toolkit/formula.pyx":893
+  /* "sat_toolkit/formula.pyx":900
  *         num_xors = len(args[0])
  * 
  *         packed_args = np.zeros((num_xors, num_args + 1), np.int32)             # <<<<<<<<<<<<<<
  * 
  *         for i, arg in enumerate(args):
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_np); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 893, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_np); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 900, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
-  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_zeros); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 893, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_zeros); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 900, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-  __pyx_t_4 = __Pyx_PyInt_FromSize_t(__pyx_v_num_xors); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 893, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyInt_FromSize_t(__pyx_v_num_xors); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 900, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
-  __pyx_t_6 = __Pyx_PyInt_FromSize_t((__pyx_v_num_args + 1)); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 893, __pyx_L1_error)
+  __pyx_t_6 = __Pyx_PyInt_FromSize_t((__pyx_v_num_args + 1)); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 900, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_6);
-  __pyx_t_7 = PyTuple_New(2); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 893, __pyx_L1_error)
+  __pyx_t_7 = PyTuple_New(2); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 900, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_7);
   __Pyx_GIVEREF(__pyx_t_4);
-  if (__Pyx_PyTuple_SET_ITEM(__pyx_t_7, 0, __pyx_t_4)) __PYX_ERR(0, 893, __pyx_L1_error);
+  if (__Pyx_PyTuple_SET_ITEM(__pyx_t_7, 0, __pyx_t_4)) __PYX_ERR(0, 900, __pyx_L1_error);
   __Pyx_GIVEREF(__pyx_t_6);
-  if (__Pyx_PyTuple_SET_ITEM(__pyx_t_7, 1, __pyx_t_6)) __PYX_ERR(0, 893, __pyx_L1_error);
+  if (__Pyx_PyTuple_SET_ITEM(__pyx_t_7, 1, __pyx_t_6)) __PYX_ERR(0, 900, __pyx_L1_error);
   __pyx_t_4 = 0;
   __pyx_t_6 = 0;
-  __Pyx_GetModuleGlobalName(__pyx_t_6, __pyx_n_s_np); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 893, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_6, __pyx_n_s_np); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 900, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_6);
-  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_6, __pyx_n_s_int32); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 893, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_6, __pyx_n_s_int32); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 900, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
   __pyx_t_6 = NULL;
   __pyx_t_8 = 0;
   #if CYTHON_UNPACK_METHODS
   if (unlikely(PyMethod_Check(__pyx_t_5))) {
     __pyx_t_6 = PyMethod_GET_SELF(__pyx_t_5);
@@ -36546,137 +36683,137 @@
   #endif
   {
     PyObject *__pyx_callargs[3] = {__pyx_t_6, __pyx_t_7, __pyx_t_4};
     __pyx_t_3 = __Pyx_PyObject_FastCall(__pyx_t_5, __pyx_callargs+1-__pyx_t_8, 2+__pyx_t_8);
     __Pyx_XDECREF(__pyx_t_6); __pyx_t_6 = 0;
     __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-    if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 893, __pyx_L1_error)
+    if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 900, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
   }
   __pyx_v_packed_args = __pyx_t_3;
   __pyx_t_3 = 0;
 
-  /* "sat_toolkit/formula.pyx":895
+  /* "sat_toolkit/formula.pyx":902
  *         packed_args = np.zeros((num_xors, num_args + 1), np.int32)
  * 
  *         for i, arg in enumerate(args):             # <<<<<<<<<<<<<<
  *             packed_args[:, i] = arg
  * 
  */
   __pyx_t_9 = 0;
   __pyx_t_3 = __pyx_v_args; __Pyx_INCREF(__pyx_t_3);
   __pyx_t_1 = 0;
   for (;;) {
     {
       Py_ssize_t __pyx_temp = __Pyx_PyTuple_GET_SIZE(__pyx_t_3);
       #if !CYTHON_ASSUME_SAFE_MACROS
-      if (unlikely((__pyx_temp < 0))) __PYX_ERR(0, 895, __pyx_L1_error)
+      if (unlikely((__pyx_temp < 0))) __PYX_ERR(0, 902, __pyx_L1_error)
       #endif
       if (__pyx_t_1 >= __pyx_temp) break;
     }
     #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-    __pyx_t_5 = PyTuple_GET_ITEM(__pyx_t_3, __pyx_t_1); __Pyx_INCREF(__pyx_t_5); __pyx_t_1++; if (unlikely((0 < 0))) __PYX_ERR(0, 895, __pyx_L1_error)
+    __pyx_t_5 = PyTuple_GET_ITEM(__pyx_t_3, __pyx_t_1); __Pyx_INCREF(__pyx_t_5); __pyx_t_1++; if (unlikely((0 < 0))) __PYX_ERR(0, 902, __pyx_L1_error)
     #else
-    __pyx_t_5 = __Pyx_PySequence_ITEM(__pyx_t_3, __pyx_t_1); __pyx_t_1++; if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 895, __pyx_L1_error)
+    __pyx_t_5 = __Pyx_PySequence_ITEM(__pyx_t_3, __pyx_t_1); __pyx_t_1++; if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 902, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
     #endif
     __Pyx_XDECREF_SET(__pyx_v_arg, __pyx_t_5);
     __pyx_t_5 = 0;
     __pyx_v_i = __pyx_t_9;
     __pyx_t_9 = (__pyx_t_9 + 1);
 
-    /* "sat_toolkit/formula.pyx":896
+    /* "sat_toolkit/formula.pyx":903
  * 
  *         for i, arg in enumerate(args):
  *             packed_args[:, i] = arg             # <<<<<<<<<<<<<<
  * 
  *         if rhs is not None:
  */
-    __pyx_t_5 = __Pyx_PyInt_FromSize_t(__pyx_v_i); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 896, __pyx_L1_error)
+    __pyx_t_5 = __Pyx_PyInt_FromSize_t(__pyx_v_i); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 903, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
-    __pyx_t_4 = PyTuple_New(2); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 896, __pyx_L1_error)
+    __pyx_t_4 = PyTuple_New(2); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 903, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
     __Pyx_INCREF(__pyx_slice__5);
     __Pyx_GIVEREF(__pyx_slice__5);
-    if (__Pyx_PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_slice__5)) __PYX_ERR(0, 896, __pyx_L1_error);
+    if (__Pyx_PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_slice__5)) __PYX_ERR(0, 903, __pyx_L1_error);
     __Pyx_GIVEREF(__pyx_t_5);
-    if (__Pyx_PyTuple_SET_ITEM(__pyx_t_4, 1, __pyx_t_5)) __PYX_ERR(0, 896, __pyx_L1_error);
+    if (__Pyx_PyTuple_SET_ITEM(__pyx_t_4, 1, __pyx_t_5)) __PYX_ERR(0, 903, __pyx_L1_error);
     __pyx_t_5 = 0;
-    if (unlikely((PyObject_SetItem(__pyx_v_packed_args, __pyx_t_4, __pyx_v_arg) < 0))) __PYX_ERR(0, 896, __pyx_L1_error)
+    if (unlikely((PyObject_SetItem(__pyx_v_packed_args, __pyx_t_4, __pyx_v_arg) < 0))) __PYX_ERR(0, 903, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
 
-    /* "sat_toolkit/formula.pyx":895
+    /* "sat_toolkit/formula.pyx":902
  *         packed_args = np.zeros((num_xors, num_args + 1), np.int32)
  * 
  *         for i, arg in enumerate(args):             # <<<<<<<<<<<<<<
  *             packed_args[:, i] = arg
  * 
  */
   }
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
 
-  /* "sat_toolkit/formula.pyx":898
+  /* "sat_toolkit/formula.pyx":905
  *             packed_args[:, i] = arg
  * 
  *         if rhs is not None:             # <<<<<<<<<<<<<<
  *             packed_args[:, num_args] = rhs
  * 
  */
   __pyx_t_2 = (__pyx_v_rhs != Py_None);
   if (__pyx_t_2) {
 
-    /* "sat_toolkit/formula.pyx":899
+    /* "sat_toolkit/formula.pyx":906
  * 
  *         if rhs is not None:
  *             packed_args[:, num_args] = rhs             # <<<<<<<<<<<<<<
  * 
  *         return CNF._create_xor(packed_args)
  */
-    __pyx_t_3 = __Pyx_PyInt_FromSize_t(__pyx_v_num_args); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 899, __pyx_L1_error)
+    __pyx_t_3 = __Pyx_PyInt_FromSize_t(__pyx_v_num_args); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 906, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
-    __pyx_t_4 = PyTuple_New(2); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 899, __pyx_L1_error)
+    __pyx_t_4 = PyTuple_New(2); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 906, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
     __Pyx_INCREF(__pyx_slice__5);
     __Pyx_GIVEREF(__pyx_slice__5);
-    if (__Pyx_PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_slice__5)) __PYX_ERR(0, 899, __pyx_L1_error);
+    if (__Pyx_PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_slice__5)) __PYX_ERR(0, 906, __pyx_L1_error);
     __Pyx_GIVEREF(__pyx_t_3);
-    if (__Pyx_PyTuple_SET_ITEM(__pyx_t_4, 1, __pyx_t_3)) __PYX_ERR(0, 899, __pyx_L1_error);
+    if (__Pyx_PyTuple_SET_ITEM(__pyx_t_4, 1, __pyx_t_3)) __PYX_ERR(0, 906, __pyx_L1_error);
     __pyx_t_3 = 0;
-    if (unlikely((PyObject_SetItem(__pyx_v_packed_args, __pyx_t_4, __pyx_v_rhs) < 0))) __PYX_ERR(0, 899, __pyx_L1_error)
+    if (unlikely((PyObject_SetItem(__pyx_v_packed_args, __pyx_t_4, __pyx_v_rhs) < 0))) __PYX_ERR(0, 906, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
 
-    /* "sat_toolkit/formula.pyx":898
+    /* "sat_toolkit/formula.pyx":905
  *             packed_args[:, i] = arg
  * 
  *         if rhs is not None:             # <<<<<<<<<<<<<<
  *             packed_args[:, num_args] = rhs
  * 
  */
   }
 
-  /* "sat_toolkit/formula.pyx":901
+  /* "sat_toolkit/formula.pyx":908
  *             packed_args[:, num_args] = rhs
  * 
  *         return CNF._create_xor(packed_args)             # <<<<<<<<<<<<<<
  * 
  * 
  */
   __Pyx_XDECREF((PyObject *)__pyx_r);
-  __pyx_t_10 = __Pyx_PyObject_to_MemoryviewSlice_d_dc_int__const__(__pyx_v_packed_args, 0); if (unlikely(!__pyx_t_10.memview)) __PYX_ERR(0, 901, __pyx_L1_error)
-  __pyx_t_4 = ((PyObject *)__pyx_f_11sat_toolkit_7formula_3CNF__create_xor(__pyx_t_10)); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 901, __pyx_L1_error)
+  __pyx_t_10 = __Pyx_PyObject_to_MemoryviewSlice_d_dc_int__const__(__pyx_v_packed_args, 0); if (unlikely(!__pyx_t_10.memview)) __PYX_ERR(0, 908, __pyx_L1_error)
+  __pyx_t_4 = ((PyObject *)__pyx_f_11sat_toolkit_7formula_3CNF__create_xor(__pyx_t_10)); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 908, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __PYX_XCLEAR_MEMVIEW(&__pyx_t_10, 1);
   __pyx_t_10.memview = NULL; __pyx_t_10.data = NULL;
   __pyx_r = ((struct __pyx_obj_11sat_toolkit_7formula_CNF *)__pyx_t_4);
   __pyx_t_4 = 0;
   goto __pyx_L0;
 
-  /* "sat_toolkit/formula.pyx":873
+  /* "sat_toolkit/formula.pyx":880
  *         return res
  * 
  *     @staticmethod             # <<<<<<<<<<<<<<
  *     def create_xor(*args, rhs=None) -> CNF:
  *         """
  */
 
@@ -36694,15 +36831,15 @@
   __Pyx_XDECREF(__pyx_v_packed_args);
   __Pyx_XDECREF(__pyx_v_arg);
   __Pyx_XGIVEREF((PyObject *)__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "sat_toolkit/formula.pyx":904
+/* "sat_toolkit/formula.pyx":911
  * 
  * 
  *     def logical_or(self, int var) -> CNF:             # <<<<<<<<<<<<<<
  *         """
  *         return a new CNF corresponding to (var or self). I.e., the new CNF is
  */
 
@@ -36756,31 +36893,31 @@
       kw_args = __Pyx_NumKwargs_FASTCALL(__pyx_kwds);
       switch (__pyx_nargs) {
         case  0:
         if (likely((values[0] = __Pyx_GetKwValue_FASTCALL(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_var)) != 0)) {
           (void)__Pyx_Arg_NewRef_FASTCALL(values[0]);
           kw_args--;
         }
-        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 904, __pyx_L3_error)
+        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 911, __pyx_L3_error)
         else goto __pyx_L5_argtuple_error;
       }
       if (unlikely(kw_args > 0)) {
         const Py_ssize_t kwd_pos_args = __pyx_nargs;
-        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values + 0, kwd_pos_args, "logical_or") < 0)) __PYX_ERR(0, 904, __pyx_L3_error)
+        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values + 0, kwd_pos_args, "logical_or") < 0)) __PYX_ERR(0, 911, __pyx_L3_error)
       }
     } else if (unlikely(__pyx_nargs != 1)) {
       goto __pyx_L5_argtuple_error;
     } else {
       values[0] = __Pyx_Arg_FASTCALL(__pyx_args, 0);
     }
-    __pyx_v_var = __Pyx_PyInt_As_int(values[0]); if (unlikely((__pyx_v_var == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 904, __pyx_L3_error)
+    __pyx_v_var = __Pyx_PyInt_As_int(values[0]); if (unlikely((__pyx_v_var == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 911, __pyx_L3_error)
   }
   goto __pyx_L6_skip;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("logical_or", 1, 1, 1, __pyx_nargs); __PYX_ERR(0, 904, __pyx_L3_error)
+  __Pyx_RaiseArgtupleInvalid("logical_or", 1, 1, 1, __pyx_nargs); __PYX_ERR(0, 911, __pyx_L3_error)
   __pyx_L6_skip:;
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L3_error:;
   {
     Py_ssize_t __pyx_temp;
     for (__pyx_temp=0; __pyx_temp < (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
       __Pyx_Arg_XDECREF_FASTCALL(values[__pyx_temp]);
@@ -36821,189 +36958,189 @@
   __Pyx_memviewslice __pyx_t_9 = { 0, 0, { 0 }, { 0 }, { 0 } };
   int __pyx_t_10;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("logical_or", 1);
 
-  /* "sat_toolkit/formula.pyx":922
+  /* "sat_toolkit/formula.pyx":929
  *         -1 -2 -5 0
  *         """
  *         if var == 0:             # <<<<<<<<<<<<<<
  *             raise ValueError("var must not be zero")
  * 
  */
   __pyx_t_1 = (__pyx_v_var == 0);
   if (unlikely(__pyx_t_1)) {
 
-    /* "sat_toolkit/formula.pyx":923
+    /* "sat_toolkit/formula.pyx":930
  *         """
  *         if var == 0:
  *             raise ValueError("var must not be zero")             # <<<<<<<<<<<<<<
  * 
  *         cdef vector[int] new_clauses
  */
-    __pyx_t_2 = __Pyx_PyObject_Call(__pyx_builtin_ValueError, __pyx_tuple__31, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 923, __pyx_L1_error)
+    __pyx_t_2 = __Pyx_PyObject_Call(__pyx_builtin_ValueError, __pyx_tuple__31, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 930, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
     __Pyx_Raise(__pyx_t_2, 0, 0, 0);
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-    __PYX_ERR(0, 923, __pyx_L1_error)
+    __PYX_ERR(0, 930, __pyx_L1_error)
 
-    /* "sat_toolkit/formula.pyx":922
+    /* "sat_toolkit/formula.pyx":929
  *         -1 -2 -5 0
  *         """
  *         if var == 0:             # <<<<<<<<<<<<<<
  *             raise ValueError("var must not be zero")
  * 
  */
   }
 
-  /* "sat_toolkit/formula.pyx":926
+  /* "sat_toolkit/formula.pyx":933
  * 
  *         cdef vector[int] new_clauses
  *         cdef ssize_t src = 0, dst = 0             # <<<<<<<<<<<<<<
  *         new_clauses.resize(self._clauses.size() + self._start_indices.size())
  * 
  */
   __pyx_v_src = 0;
   __pyx_v_dst = 0;
 
-  /* "sat_toolkit/formula.pyx":927
+  /* "sat_toolkit/formula.pyx":934
  *         cdef vector[int] new_clauses
  *         cdef ssize_t src = 0, dst = 0
  *         new_clauses.resize(self._clauses.size() + self._start_indices.size())             # <<<<<<<<<<<<<<
  * 
  *         for src in range(<ssize_t> self._clauses.size()):
  */
   try {
     __pyx_v_new_clauses.resize((__pyx_v_self->__pyx_base._clauses.size() + __pyx_v_self->__pyx_base._start_indices.size()));
   } catch(...) {
     __Pyx_CppExn2PyErr();
-    __PYX_ERR(0, 927, __pyx_L1_error)
+    __PYX_ERR(0, 934, __pyx_L1_error)
   }
 
-  /* "sat_toolkit/formula.pyx":929
+  /* "sat_toolkit/formula.pyx":936
  *         new_clauses.resize(self._clauses.size() + self._start_indices.size())
  * 
  *         for src in range(<ssize_t> self._clauses.size()):             # <<<<<<<<<<<<<<
  *             if self._clauses[src] == 0:
  *                 new_clauses[dst] = var
  */
   __pyx_t_3 = ((Py_ssize_t)__pyx_v_self->__pyx_base._clauses.size());
   __pyx_t_4 = __pyx_t_3;
   for (__pyx_t_5 = 0; __pyx_t_5 < __pyx_t_4; __pyx_t_5+=1) {
     __pyx_v_src = __pyx_t_5;
 
-    /* "sat_toolkit/formula.pyx":930
+    /* "sat_toolkit/formula.pyx":937
  * 
  *         for src in range(<ssize_t> self._clauses.size()):
  *             if self._clauses[src] == 0:             # <<<<<<<<<<<<<<
  *                 new_clauses[dst] = var
  *                 dst += 1
  */
     __pyx_t_1 = ((__pyx_v_self->__pyx_base._clauses[__pyx_v_src]) == 0);
     if (__pyx_t_1) {
 
-      /* "sat_toolkit/formula.pyx":931
+      /* "sat_toolkit/formula.pyx":938
  *         for src in range(<ssize_t> self._clauses.size()):
  *             if self._clauses[src] == 0:
  *                 new_clauses[dst] = var             # <<<<<<<<<<<<<<
  *                 dst += 1
  *             new_clauses[dst] = self._clauses[src]
  */
       (__pyx_v_new_clauses[__pyx_v_dst]) = __pyx_v_var;
 
-      /* "sat_toolkit/formula.pyx":932
+      /* "sat_toolkit/formula.pyx":939
  *             if self._clauses[src] == 0:
  *                 new_clauses[dst] = var
  *                 dst += 1             # <<<<<<<<<<<<<<
  *             new_clauses[dst] = self._clauses[src]
  *             dst += 1
  */
       __pyx_v_dst = (__pyx_v_dst + 1);
 
-      /* "sat_toolkit/formula.pyx":930
+      /* "sat_toolkit/formula.pyx":937
  * 
  *         for src in range(<ssize_t> self._clauses.size()):
  *             if self._clauses[src] == 0:             # <<<<<<<<<<<<<<
  *                 new_clauses[dst] = var
  *                 dst += 1
  */
     }
 
-    /* "sat_toolkit/formula.pyx":933
+    /* "sat_toolkit/formula.pyx":940
  *                 new_clauses[dst] = var
  *                 dst += 1
  *             new_clauses[dst] = self._clauses[src]             # <<<<<<<<<<<<<<
  *             dst += 1
  * 
  */
     (__pyx_v_new_clauses[__pyx_v_dst]) = (__pyx_v_self->__pyx_base._clauses[__pyx_v_src]);
 
-    /* "sat_toolkit/formula.pyx":934
+    /* "sat_toolkit/formula.pyx":941
  *                 dst += 1
  *             new_clauses[dst] = self._clauses[src]
  *             dst += 1             # <<<<<<<<<<<<<<
  * 
  *         cdef CNF res = CNF.__new__(CNF)
  */
     __pyx_v_dst = (__pyx_v_dst + 1);
   }
 
-  /* "sat_toolkit/formula.pyx":936
+  /* "sat_toolkit/formula.pyx":943
  *             dst += 1
  * 
  *         cdef CNF res = CNF.__new__(CNF)             # <<<<<<<<<<<<<<
  *         res._add_clauses(<int[:new_clauses.size()]> new_clauses.data())
  *         return res
  */
-  __pyx_t_2 = ((PyObject *)__pyx_tp_new_11sat_toolkit_7formula_CNF(((PyTypeObject *)__pyx_ptype_11sat_toolkit_7formula_CNF), __pyx_empty_tuple, NULL)); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 936, __pyx_L1_error)
+  __pyx_t_2 = ((PyObject *)__pyx_tp_new_11sat_toolkit_7formula_CNF(((PyTypeObject *)__pyx_ptype_11sat_toolkit_7formula_CNF), __pyx_empty_tuple, NULL)); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 943, __pyx_L1_error)
   __Pyx_GOTREF((PyObject *)__pyx_t_2);
   __pyx_v_res = ((struct __pyx_obj_11sat_toolkit_7formula_CNF *)__pyx_t_2);
   __pyx_t_2 = 0;
 
-  /* "sat_toolkit/formula.pyx":937
+  /* "sat_toolkit/formula.pyx":944
  * 
  *         cdef CNF res = CNF.__new__(CNF)
  *         res._add_clauses(<int[:new_clauses.size()]> new_clauses.data())             # <<<<<<<<<<<<<<
  *         return res
  * 
  */
   __pyx_t_6 = __pyx_v_new_clauses.data();
   if (!__pyx_t_6) {
     PyErr_SetString(PyExc_ValueError,"Cannot create cython.array from NULL pointer");
-    __PYX_ERR(0, 937, __pyx_L1_error)
+    __PYX_ERR(0, 944, __pyx_L1_error)
   }
-  __pyx_t_8 = __pyx_format_from_typeinfo(&__Pyx_TypeInfo_int); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 937, __pyx_L1_error)
+  __pyx_t_8 = __pyx_format_from_typeinfo(&__Pyx_TypeInfo_int); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 944, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_8);
-  __pyx_t_2 = Py_BuildValue((char*) "("  __PYX_BUILD_PY_SSIZE_T  ")", ((Py_ssize_t)__pyx_v_new_clauses.size())); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 937, __pyx_L1_error)
+  __pyx_t_2 = Py_BuildValue((char*) "("  __PYX_BUILD_PY_SSIZE_T  ")", ((Py_ssize_t)__pyx_v_new_clauses.size())); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 944, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_7 = __pyx_array_new(__pyx_t_2, sizeof(int), PyBytes_AS_STRING(__pyx_t_8), (char *) "c", (char *) __pyx_t_6); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 937, __pyx_L1_error)
+  __pyx_t_7 = __pyx_array_new(__pyx_t_2, sizeof(int), PyBytes_AS_STRING(__pyx_t_8), (char *) "c", (char *) __pyx_t_6); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 944, __pyx_L1_error)
   __Pyx_GOTREF((PyObject *)__pyx_t_7);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
-  __pyx_t_9 = __Pyx_PyObject_to_MemoryviewSlice_ds_int__const__(((PyObject *)__pyx_t_7), 0); if (unlikely(!__pyx_t_9.memview)) __PYX_ERR(0, 937, __pyx_L1_error)
+  __pyx_t_9 = __Pyx_PyObject_to_MemoryviewSlice_ds_int__const__(((PyObject *)__pyx_t_7), 0); if (unlikely(!__pyx_t_9.memview)) __PYX_ERR(0, 944, __pyx_L1_error)
   __Pyx_DECREF((PyObject *)__pyx_t_7); __pyx_t_7 = 0;
-  __pyx_t_10 = ((struct __pyx_vtabstruct_11sat_toolkit_7formula_CNF *)__pyx_v_res->__pyx_base.__pyx_vtab)->__pyx_base._add_clauses(((struct __pyx_obj_11sat_toolkit_7formula__ClauseList *)__pyx_v_res), __pyx_t_9); if (unlikely(__pyx_t_10 == ((int)-1))) __PYX_ERR(0, 937, __pyx_L1_error)
+  __pyx_t_10 = ((struct __pyx_vtabstruct_11sat_toolkit_7formula_CNF *)__pyx_v_res->__pyx_base.__pyx_vtab)->__pyx_base._add_clauses(((struct __pyx_obj_11sat_toolkit_7formula__ClauseList *)__pyx_v_res), __pyx_t_9); if (unlikely(__pyx_t_10 == ((int)-1))) __PYX_ERR(0, 944, __pyx_L1_error)
   __PYX_XCLEAR_MEMVIEW(&__pyx_t_9, 1);
   __pyx_t_9.memview = NULL; __pyx_t_9.data = NULL;
 
-  /* "sat_toolkit/formula.pyx":938
+  /* "sat_toolkit/formula.pyx":945
  *         cdef CNF res = CNF.__new__(CNF)
  *         res._add_clauses(<int[:new_clauses.size()]> new_clauses.data())
  *         return res             # <<<<<<<<<<<<<<
  * 
  *     def implied_by(self, int var) -> CNF:
  */
   __Pyx_XDECREF((PyObject *)__pyx_r);
   __Pyx_INCREF((PyObject *)__pyx_v_res);
   __pyx_r = __pyx_v_res;
   goto __pyx_L0;
 
-  /* "sat_toolkit/formula.pyx":904
+  /* "sat_toolkit/formula.pyx":911
  * 
  * 
  *     def logical_or(self, int var) -> CNF:             # <<<<<<<<<<<<<<
  *         """
  *         return a new CNF corresponding to (var or self). I.e., the new CNF is
  */
 
@@ -37018,15 +37155,15 @@
   __pyx_L0:;
   __Pyx_XDECREF((PyObject *)__pyx_v_res);
   __Pyx_XGIVEREF((PyObject *)__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "sat_toolkit/formula.pyx":940
+/* "sat_toolkit/formula.pyx":947
  *         return res
  * 
  *     def implied_by(self, int var) -> CNF:             # <<<<<<<<<<<<<<
  *         """
  *         return a new CNF corresponding to (var -> self). I.e., the new CNF is
  */
 
@@ -37080,31 +37217,31 @@
       kw_args = __Pyx_NumKwargs_FASTCALL(__pyx_kwds);
       switch (__pyx_nargs) {
         case  0:
         if (likely((values[0] = __Pyx_GetKwValue_FASTCALL(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_var)) != 0)) {
           (void)__Pyx_Arg_NewRef_FASTCALL(values[0]);
           kw_args--;
         }
-        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 940, __pyx_L3_error)
+        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 947, __pyx_L3_error)
         else goto __pyx_L5_argtuple_error;
       }
       if (unlikely(kw_args > 0)) {
         const Py_ssize_t kwd_pos_args = __pyx_nargs;
-        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values + 0, kwd_pos_args, "implied_by") < 0)) __PYX_ERR(0, 940, __pyx_L3_error)
+        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values + 0, kwd_pos_args, "implied_by") < 0)) __PYX_ERR(0, 947, __pyx_L3_error)
       }
     } else if (unlikely(__pyx_nargs != 1)) {
       goto __pyx_L5_argtuple_error;
     } else {
       values[0] = __Pyx_Arg_FASTCALL(__pyx_args, 0);
     }
-    __pyx_v_var = __Pyx_PyInt_As_int(values[0]); if (unlikely((__pyx_v_var == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 940, __pyx_L3_error)
+    __pyx_v_var = __Pyx_PyInt_As_int(values[0]); if (unlikely((__pyx_v_var == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 947, __pyx_L3_error)
   }
   goto __pyx_L6_skip;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("implied_by", 1, 1, 1, __pyx_nargs); __PYX_ERR(0, 940, __pyx_L3_error)
+  __Pyx_RaiseArgtupleInvalid("implied_by", 1, 1, 1, __pyx_nargs); __PYX_ERR(0, 947, __pyx_L3_error)
   __pyx_L6_skip:;
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L3_error:;
   {
     Py_ssize_t __pyx_temp;
     for (__pyx_temp=0; __pyx_temp < (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
       __Pyx_Arg_XDECREF_FASTCALL(values[__pyx_temp]);
@@ -37136,25 +37273,25 @@
   PyObject *__pyx_t_4 = NULL;
   int __pyx_t_5;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("implied_by", 1);
 
-  /* "sat_toolkit/formula.pyx":945
+  /* "sat_toolkit/formula.pyx":952
  *         build by appending ~var to each clause
  *         """
  *         return self.logical_or(-var)             # <<<<<<<<<<<<<<
  * 
  *     cdef vector[int] _get_units(CNF self):
  */
   __Pyx_XDECREF((PyObject *)__pyx_r);
-  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_self), __pyx_n_s_logical_or); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 945, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_self), __pyx_n_s_logical_or); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 952, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_3 = __Pyx_PyInt_From_int((-__pyx_v_var)); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 945, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyInt_From_int((-__pyx_v_var)); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 952, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __pyx_t_4 = NULL;
   __pyx_t_5 = 0;
   #if CYTHON_UNPACK_METHODS
   if (likely(PyMethod_Check(__pyx_t_2))) {
     __pyx_t_4 = PyMethod_GET_SELF(__pyx_t_2);
     if (likely(__pyx_t_4)) {
@@ -37167,24 +37304,24 @@
   }
   #endif
   {
     PyObject *__pyx_callargs[2] = {__pyx_t_4, __pyx_t_3};
     __pyx_t_1 = __Pyx_PyObject_FastCall(__pyx_t_2, __pyx_callargs+1-__pyx_t_5, 1+__pyx_t_5);
     __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-    if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 945, __pyx_L1_error)
+    if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 952, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   }
-  if (!(likely(((__pyx_t_1) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_1, __pyx_ptype_11sat_toolkit_7formula_CNF))))) __PYX_ERR(0, 945, __pyx_L1_error)
+  if (!(likely(((__pyx_t_1) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_1, __pyx_ptype_11sat_toolkit_7formula_CNF))))) __PYX_ERR(0, 952, __pyx_L1_error)
   __pyx_r = ((struct __pyx_obj_11sat_toolkit_7formula_CNF *)__pyx_t_1);
   __pyx_t_1 = 0;
   goto __pyx_L0;
 
-  /* "sat_toolkit/formula.pyx":940
+  /* "sat_toolkit/formula.pyx":947
  *         return res
  * 
  *     def implied_by(self, int var) -> CNF:             # <<<<<<<<<<<<<<
  *         """
  *         return a new CNF corresponding to (var -> self). I.e., the new CNF is
  */
 
@@ -37198,15 +37335,15 @@
   __pyx_r = NULL;
   __pyx_L0:;
   __Pyx_XGIVEREF((PyObject *)__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "sat_toolkit/formula.pyx":947
+/* "sat_toolkit/formula.pyx":954
  *         return self.logical_or(-var)
  * 
  *     cdef vector[int] _get_units(CNF self):             # <<<<<<<<<<<<<<
  *         """
  *         Returns all unit clauses in the CNF. The unit clauses are returned as
  */
 
@@ -37222,118 +37359,118 @@
   Py_ssize_t __pyx_t_3;
   size_t __pyx_t_4;
   int __pyx_t_5;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
 
-  /* "sat_toolkit/formula.pyx":954
+  /* "sat_toolkit/formula.pyx":961
  *         cdef vector[int] units
  *         cdef ssize_t idx, begin, end
  *         cdef size_t numclauses = self._start_indices.size()             # <<<<<<<<<<<<<<
  * 
  *         for idx in range(numclauses):
  */
   __pyx_v_numclauses = __pyx_v_self->__pyx_base._start_indices.size();
 
-  /* "sat_toolkit/formula.pyx":956
+  /* "sat_toolkit/formula.pyx":963
  *         cdef size_t numclauses = self._start_indices.size()
  * 
  *         for idx in range(numclauses):             # <<<<<<<<<<<<<<
  *             begin = self._start_indices[idx]
  *             end = self._start_indices[idx + 1] if <size_t> idx + 1 < numclauses else self._clauses.size()
  */
   __pyx_t_1 = __pyx_v_numclauses;
   __pyx_t_2 = __pyx_t_1;
   for (__pyx_t_3 = 0; __pyx_t_3 < __pyx_t_2; __pyx_t_3+=1) {
     __pyx_v_idx = __pyx_t_3;
 
-    /* "sat_toolkit/formula.pyx":957
+    /* "sat_toolkit/formula.pyx":964
  * 
  *         for idx in range(numclauses):
  *             begin = self._start_indices[idx]             # <<<<<<<<<<<<<<
  *             end = self._start_indices[idx + 1] if <size_t> idx + 1 < numclauses else self._clauses.size()
  * 
  */
     __pyx_v_begin = (__pyx_v_self->__pyx_base._start_indices[__pyx_v_idx]);
 
-    /* "sat_toolkit/formula.pyx":958
+    /* "sat_toolkit/formula.pyx":965
  *         for idx in range(numclauses):
  *             begin = self._start_indices[idx]
  *             end = self._start_indices[idx + 1] if <size_t> idx + 1 < numclauses else self._clauses.size()             # <<<<<<<<<<<<<<
  * 
  *             if end == begin + 2:
  */
     __pyx_t_5 = ((((size_t)__pyx_v_idx) + 1) < __pyx_v_numclauses);
     if (__pyx_t_5) {
       __pyx_t_4 = (__pyx_v_self->__pyx_base._start_indices[(__pyx_v_idx + 1)]);
     } else {
       __pyx_t_4 = __pyx_v_self->__pyx_base._clauses.size();
     }
     __pyx_v_end = __pyx_t_4;
 
-    /* "sat_toolkit/formula.pyx":960
+    /* "sat_toolkit/formula.pyx":967
  *             end = self._start_indices[idx + 1] if <size_t> idx + 1 < numclauses else self._clauses.size()
  * 
  *             if end == begin + 2:             # <<<<<<<<<<<<<<
  *                 units.push_back(self._clauses[begin])
  * 
  */
     __pyx_t_5 = (__pyx_v_end == (__pyx_v_begin + 2));
     if (__pyx_t_5) {
 
-      /* "sat_toolkit/formula.pyx":961
+      /* "sat_toolkit/formula.pyx":968
  * 
  *             if end == begin + 2:
  *                 units.push_back(self._clauses[begin])             # <<<<<<<<<<<<<<
  * 
  *         units.shrink_to_fit()
  */
       try {
         __pyx_v_units.push_back((__pyx_v_self->__pyx_base._clauses[__pyx_v_begin]));
       } catch(...) {
         __Pyx_CppExn2PyErr();
-        __PYX_ERR(0, 961, __pyx_L1_error)
+        __PYX_ERR(0, 968, __pyx_L1_error)
       }
 
-      /* "sat_toolkit/formula.pyx":960
+      /* "sat_toolkit/formula.pyx":967
  *             end = self._start_indices[idx + 1] if <size_t> idx + 1 < numclauses else self._clauses.size()
  * 
  *             if end == begin + 2:             # <<<<<<<<<<<<<<
  *                 units.push_back(self._clauses[begin])
  * 
  */
     }
   }
 
-  /* "sat_toolkit/formula.pyx":963
+  /* "sat_toolkit/formula.pyx":970
  *                 units.push_back(self._clauses[begin])
  * 
  *         units.shrink_to_fit()             # <<<<<<<<<<<<<<
  * 
  *         return units
  */
   try {
     __pyx_v_units.shrink_to_fit();
   } catch(...) {
     __Pyx_CppExn2PyErr();
-    __PYX_ERR(0, 963, __pyx_L1_error)
+    __PYX_ERR(0, 970, __pyx_L1_error)
   }
 
-  /* "sat_toolkit/formula.pyx":965
+  /* "sat_toolkit/formula.pyx":972
  *         units.shrink_to_fit()
  * 
  *         return units             # <<<<<<<<<<<<<<
  * 
  *     def get_units(self) -> np.ndarray:
  */
   __pyx_r = __pyx_v_units;
   goto __pyx_L0;
 
-  /* "sat_toolkit/formula.pyx":947
+  /* "sat_toolkit/formula.pyx":954
  *         return self.logical_or(-var)
  * 
  *     cdef vector[int] _get_units(CNF self):             # <<<<<<<<<<<<<<
  *         """
  *         Returns all unit clauses in the CNF. The unit clauses are returned as
  */
 
@@ -37341,15 +37478,15 @@
   __pyx_L1_error:;
   __Pyx_AddTraceback("sat_toolkit.formula.CNF._get_units", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __Pyx_pretend_to_initialize(&__pyx_r);
   __pyx_L0:;
   return __pyx_r;
 }
 
-/* "sat_toolkit/formula.pyx":967
+/* "sat_toolkit/formula.pyx":974
  *         return units
  * 
  *     def get_units(self) -> np.ndarray:             # <<<<<<<<<<<<<<
  *         """
  *         Returns all unit clauses in the CNF. The unit clauses are returned as
  */
 
@@ -37414,108 +37551,108 @@
   Py_ssize_t __pyx_t_10;
   Py_ssize_t __pyx_t_11;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("get_units", 1);
 
-  /* "sat_toolkit/formula.pyx":980
+  /* "sat_toolkit/formula.pyx":987
  *         cdef ssize_t idx
  * 
  *         vec_result = self._get_units()             # <<<<<<<<<<<<<<
  *         result = np.empty(vec_result.size(), dtype=np.int32)
  *         result_view = result
  */
-  __pyx_t_1 = ((struct __pyx_vtabstruct_11sat_toolkit_7formula_CNF *)__pyx_v_self->__pyx_base.__pyx_vtab)->_get_units(__pyx_v_self); if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 980, __pyx_L1_error)
+  __pyx_t_1 = ((struct __pyx_vtabstruct_11sat_toolkit_7formula_CNF *)__pyx_v_self->__pyx_base.__pyx_vtab)->_get_units(__pyx_v_self); if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 987, __pyx_L1_error)
   __pyx_v_vec_result = __PYX_STD_MOVE_IF_SUPPORTED(__pyx_t_1);
 
-  /* "sat_toolkit/formula.pyx":981
+  /* "sat_toolkit/formula.pyx":988
  * 
  *         vec_result = self._get_units()
  *         result = np.empty(vec_result.size(), dtype=np.int32)             # <<<<<<<<<<<<<<
  *         result_view = result
  * 
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 981, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 988, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_empty); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 981, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_empty); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 988, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __pyx_t_2 = __Pyx_PyInt_FromSize_t(__pyx_v_vec_result.size()); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 981, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyInt_FromSize_t(__pyx_v_vec_result.size()); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 988, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 981, __pyx_L1_error)
+  __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 988, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __Pyx_GIVEREF(__pyx_t_2);
-  if (__Pyx_PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_2)) __PYX_ERR(0, 981, __pyx_L1_error);
+  if (__Pyx_PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_2)) __PYX_ERR(0, 988, __pyx_L1_error);
   __pyx_t_2 = 0;
-  __pyx_t_2 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 981, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 988, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_np); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 981, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_np); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 988, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
-  __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_int32); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 981, __pyx_L1_error)
+  __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_int32); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 988, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_6);
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-  if (PyDict_SetItem(__pyx_t_2, __pyx_n_s_dtype, __pyx_t_6) < 0) __PYX_ERR(0, 981, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_2, __pyx_n_s_dtype, __pyx_t_6) < 0) __PYX_ERR(0, 988, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-  __pyx_t_6 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_4, __pyx_t_2); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 981, __pyx_L1_error)
+  __pyx_t_6 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_4, __pyx_t_2); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 988, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_6);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   __pyx_v_result = __pyx_t_6;
   __pyx_t_6 = 0;
 
-  /* "sat_toolkit/formula.pyx":982
+  /* "sat_toolkit/formula.pyx":989
  *         vec_result = self._get_units()
  *         result = np.empty(vec_result.size(), dtype=np.int32)
  *         result_view = result             # <<<<<<<<<<<<<<
  * 
  *         for idx in range(vec_result.size()):
  */
-  __pyx_t_7 = __Pyx_PyObject_to_MemoryviewSlice_dc_int(__pyx_v_result, PyBUF_WRITABLE); if (unlikely(!__pyx_t_7.memview)) __PYX_ERR(0, 982, __pyx_L1_error)
+  __pyx_t_7 = __Pyx_PyObject_to_MemoryviewSlice_dc_int(__pyx_v_result, PyBUF_WRITABLE); if (unlikely(!__pyx_t_7.memview)) __PYX_ERR(0, 989, __pyx_L1_error)
   __pyx_v_result_view = __pyx_t_7;
   __pyx_t_7.memview = NULL;
   __pyx_t_7.data = NULL;
 
-  /* "sat_toolkit/formula.pyx":984
+  /* "sat_toolkit/formula.pyx":991
  *         result_view = result
  * 
  *         for idx in range(vec_result.size()):             # <<<<<<<<<<<<<<
  *             result_view[idx] = vec_result[idx]
  * 
  */
   __pyx_t_8 = __pyx_v_vec_result.size();
   __pyx_t_9 = __pyx_t_8;
   for (__pyx_t_10 = 0; __pyx_t_10 < __pyx_t_9; __pyx_t_10+=1) {
     __pyx_v_idx = __pyx_t_10;
 
-    /* "sat_toolkit/formula.pyx":985
+    /* "sat_toolkit/formula.pyx":992
  * 
  *         for idx in range(vec_result.size()):
  *             result_view[idx] = vec_result[idx]             # <<<<<<<<<<<<<<
  * 
  *         return result
  */
     __pyx_t_11 = __pyx_v_idx;
     *((int *) ( /* dim=0 */ ((char *) (((int *) __pyx_v_result_view.data) + __pyx_t_11)) )) = (__pyx_v_vec_result[__pyx_v_idx]);
   }
 
-  /* "sat_toolkit/formula.pyx":987
+  /* "sat_toolkit/formula.pyx":994
  *             result_view[idx] = vec_result[idx]
  * 
  *         return result             # <<<<<<<<<<<<<<
  * 
  * 
  */
   __Pyx_XDECREF(__pyx_r);
   __Pyx_INCREF(__pyx_v_result);
   __pyx_r = __pyx_v_result;
   goto __pyx_L0;
 
-  /* "sat_toolkit/formula.pyx":967
+  /* "sat_toolkit/formula.pyx":974
  *         return units
  * 
  *     def get_units(self) -> np.ndarray:             # <<<<<<<<<<<<<<
  *         """
  *         Returns all unit clauses in the CNF. The unit clauses are returned as
  */
 
@@ -37533,15 +37670,15 @@
   __PYX_XCLEAR_MEMVIEW(&__pyx_v_result_view, 1);
   __Pyx_XDECREF(__pyx_v_result);
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "sat_toolkit/formula.pyx":990
+/* "sat_toolkit/formula.pyx":997
  * 
  * 
  *     def to_dimacs(self) -> str:             # <<<<<<<<<<<<<<
  *         '''
  *         return the CNF formatted in the DIMACS file format
  */
 
@@ -37606,306 +37743,306 @@
   PyObject *__pyx_t_6 = NULL;
   PyObject *__pyx_t_7 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("to_dimacs", 1);
 
-  /* "sat_toolkit/formula.pyx":994
+  /* "sat_toolkit/formula.pyx":1001
  *         return the CNF formatted in the DIMACS file format
  *         '''
  *         cdef size_t max_len = snprintf(NULL, 0, "%d", -self.nvars)             # <<<<<<<<<<<<<<
  *         cdef size_t nclauses = self._start_indices.size()
  *         cdef ssize_t buf_size = (self._clauses.size() - nclauses) * (max_len + 1) + nclauses * (2)
  */
   __pyx_v_max_len = snprintf(NULL, 0, ((char const *)"%d"), (-__pyx_v_self->__pyx_base.nvars));
 
-  /* "sat_toolkit/formula.pyx":995
+  /* "sat_toolkit/formula.pyx":1002
  *         '''
  *         cdef size_t max_len = snprintf(NULL, 0, "%d", -self.nvars)
  *         cdef size_t nclauses = self._start_indices.size()             # <<<<<<<<<<<<<<
  *         cdef ssize_t buf_size = (self._clauses.size() - nclauses) * (max_len + 1) + nclauses * (2)
  *         cdef char *buf = <char *> malloc(buf_size + 1)
  */
   __pyx_v_nclauses = __pyx_v_self->__pyx_base._start_indices.size();
 
-  /* "sat_toolkit/formula.pyx":996
+  /* "sat_toolkit/formula.pyx":1003
  *         cdef size_t max_len = snprintf(NULL, 0, "%d", -self.nvars)
  *         cdef size_t nclauses = self._start_indices.size()
  *         cdef ssize_t buf_size = (self._clauses.size() - nclauses) * (max_len + 1) + nclauses * (2)             # <<<<<<<<<<<<<<
  *         cdef char *buf = <char *> malloc(buf_size + 1)
  *         cdef ssize_t buf_idx = 0, written
  */
   __pyx_v_buf_size = (((__pyx_v_self->__pyx_base._clauses.size() - __pyx_v_nclauses) * (__pyx_v_max_len + 1)) + (__pyx_v_nclauses * 2));
 
-  /* "sat_toolkit/formula.pyx":997
+  /* "sat_toolkit/formula.pyx":1004
  *         cdef size_t nclauses = self._start_indices.size()
  *         cdef ssize_t buf_size = (self._clauses.size() - nclauses) * (max_len + 1) + nclauses * (2)
  *         cdef char *buf = <char *> malloc(buf_size + 1)             # <<<<<<<<<<<<<<
  *         cdef ssize_t buf_idx = 0, written
  *         cdef size_t i
  */
   __pyx_v_buf = ((char *)malloc((__pyx_v_buf_size + 1)));
 
-  /* "sat_toolkit/formula.pyx":998
+  /* "sat_toolkit/formula.pyx":1005
  *         cdef ssize_t buf_size = (self._clauses.size() - nclauses) * (max_len + 1) + nclauses * (2)
  *         cdef char *buf = <char *> malloc(buf_size + 1)
  *         cdef ssize_t buf_idx = 0, written             # <<<<<<<<<<<<<<
  *         cdef size_t i
  * 
  */
   __pyx_v_buf_idx = 0;
 
-  /* "sat_toolkit/formula.pyx":1001
+  /* "sat_toolkit/formula.pyx":1008
  *         cdef size_t i
  * 
  *         for i in range(self._clauses.size()):             # <<<<<<<<<<<<<<
  *             if self._clauses[i] == 0:
  *                 written = snprintf(&buf[buf_idx], buf_size, "0\n")
  */
   __pyx_t_1 = __pyx_v_self->__pyx_base._clauses.size();
   __pyx_t_2 = __pyx_t_1;
   for (__pyx_t_3 = 0; __pyx_t_3 < __pyx_t_2; __pyx_t_3+=1) {
     __pyx_v_i = __pyx_t_3;
 
-    /* "sat_toolkit/formula.pyx":1002
+    /* "sat_toolkit/formula.pyx":1009
  * 
  *         for i in range(self._clauses.size()):
  *             if self._clauses[i] == 0:             # <<<<<<<<<<<<<<
  *                 written = snprintf(&buf[buf_idx], buf_size, "0\n")
  *                 if written < 0:
  */
     __pyx_t_4 = ((__pyx_v_self->__pyx_base._clauses[__pyx_v_i]) == 0);
     if (__pyx_t_4) {
 
-      /* "sat_toolkit/formula.pyx":1003
+      /* "sat_toolkit/formula.pyx":1010
  *         for i in range(self._clauses.size()):
  *             if self._clauses[i] == 0:
  *                 written = snprintf(&buf[buf_idx], buf_size, "0\n")             # <<<<<<<<<<<<<<
  *                 if written < 0:
  *                     assert 0
  */
       __pyx_v_written = snprintf((&(__pyx_v_buf[__pyx_v_buf_idx])), __pyx_v_buf_size, ((char const *)"0\n"));
 
-      /* "sat_toolkit/formula.pyx":1004
+      /* "sat_toolkit/formula.pyx":1011
  *             if self._clauses[i] == 0:
  *                 written = snprintf(&buf[buf_idx], buf_size, "0\n")
  *                 if written < 0:             # <<<<<<<<<<<<<<
  *                     assert 0
  *                 buf_idx += written
  */
       __pyx_t_4 = (__pyx_v_written < 0);
       if (__pyx_t_4) {
 
-        /* "sat_toolkit/formula.pyx":1005
+        /* "sat_toolkit/formula.pyx":1012
  *                 written = snprintf(&buf[buf_idx], buf_size, "0\n")
  *                 if written < 0:
  *                     assert 0             # <<<<<<<<<<<<<<
  *                 buf_idx += written
  *                 buf_size -= written
  */
         #ifndef CYTHON_WITHOUT_ASSERTIONS
         if (unlikely(__pyx_assertions_enabled())) {
           if (unlikely(!0)) {
             __Pyx_Raise(__pyx_builtin_AssertionError, 0, 0, 0);
-            __PYX_ERR(0, 1005, __pyx_L1_error)
+            __PYX_ERR(0, 1012, __pyx_L1_error)
           }
         }
         #else
-        if ((1)); else __PYX_ERR(0, 1005, __pyx_L1_error)
+        if ((1)); else __PYX_ERR(0, 1012, __pyx_L1_error)
         #endif
 
-        /* "sat_toolkit/formula.pyx":1004
+        /* "sat_toolkit/formula.pyx":1011
  *             if self._clauses[i] == 0:
  *                 written = snprintf(&buf[buf_idx], buf_size, "0\n")
  *                 if written < 0:             # <<<<<<<<<<<<<<
  *                     assert 0
  *                 buf_idx += written
  */
       }
 
-      /* "sat_toolkit/formula.pyx":1006
+      /* "sat_toolkit/formula.pyx":1013
  *                 if written < 0:
  *                     assert 0
  *                 buf_idx += written             # <<<<<<<<<<<<<<
  *                 buf_size -= written
  *             else:
  */
       __pyx_v_buf_idx = (__pyx_v_buf_idx + __pyx_v_written);
 
-      /* "sat_toolkit/formula.pyx":1007
+      /* "sat_toolkit/formula.pyx":1014
  *                     assert 0
  *                 buf_idx += written
  *                 buf_size -= written             # <<<<<<<<<<<<<<
  *             else:
  *                 written = snprintf(&buf[buf_idx], buf_size, "%d ", self._clauses[i])
  */
       __pyx_v_buf_size = (__pyx_v_buf_size - __pyx_v_written);
 
-      /* "sat_toolkit/formula.pyx":1002
+      /* "sat_toolkit/formula.pyx":1009
  * 
  *         for i in range(self._clauses.size()):
  *             if self._clauses[i] == 0:             # <<<<<<<<<<<<<<
  *                 written = snprintf(&buf[buf_idx], buf_size, "0\n")
  *                 if written < 0:
  */
       goto __pyx_L5;
     }
 
-    /* "sat_toolkit/formula.pyx":1009
+    /* "sat_toolkit/formula.pyx":1016
  *                 buf_size -= written
  *             else:
  *                 written = snprintf(&buf[buf_idx], buf_size, "%d ", self._clauses[i])             # <<<<<<<<<<<<<<
  *                 if written < 0:
  *                     assert 0
  */
     /*else*/ {
       __pyx_v_written = snprintf((&(__pyx_v_buf[__pyx_v_buf_idx])), __pyx_v_buf_size, ((char const *)"%d "), (__pyx_v_self->__pyx_base._clauses[__pyx_v_i]));
 
-      /* "sat_toolkit/formula.pyx":1010
+      /* "sat_toolkit/formula.pyx":1017
  *             else:
  *                 written = snprintf(&buf[buf_idx], buf_size, "%d ", self._clauses[i])
  *                 if written < 0:             # <<<<<<<<<<<<<<
  *                     assert 0
  *                 buf_idx += written
  */
       __pyx_t_4 = (__pyx_v_written < 0);
       if (__pyx_t_4) {
 
-        /* "sat_toolkit/formula.pyx":1011
+        /* "sat_toolkit/formula.pyx":1018
  *                 written = snprintf(&buf[buf_idx], buf_size, "%d ", self._clauses[i])
  *                 if written < 0:
  *                     assert 0             # <<<<<<<<<<<<<<
  *                 buf_idx += written
  *                 buf_size -= written
  */
         #ifndef CYTHON_WITHOUT_ASSERTIONS
         if (unlikely(__pyx_assertions_enabled())) {
           if (unlikely(!0)) {
             __Pyx_Raise(__pyx_builtin_AssertionError, 0, 0, 0);
-            __PYX_ERR(0, 1011, __pyx_L1_error)
+            __PYX_ERR(0, 1018, __pyx_L1_error)
           }
         }
         #else
-        if ((1)); else __PYX_ERR(0, 1011, __pyx_L1_error)
+        if ((1)); else __PYX_ERR(0, 1018, __pyx_L1_error)
         #endif
 
-        /* "sat_toolkit/formula.pyx":1010
+        /* "sat_toolkit/formula.pyx":1017
  *             else:
  *                 written = snprintf(&buf[buf_idx], buf_size, "%d ", self._clauses[i])
  *                 if written < 0:             # <<<<<<<<<<<<<<
  *                     assert 0
  *                 buf_idx += written
  */
       }
 
-      /* "sat_toolkit/formula.pyx":1012
+      /* "sat_toolkit/formula.pyx":1019
  *                 if written < 0:
  *                     assert 0
  *                 buf_idx += written             # <<<<<<<<<<<<<<
  *                 buf_size -= written
  * 
  */
       __pyx_v_buf_idx = (__pyx_v_buf_idx + __pyx_v_written);
 
-      /* "sat_toolkit/formula.pyx":1013
+      /* "sat_toolkit/formula.pyx":1020
  *                     assert 0
  *                 buf_idx += written
  *                 buf_size -= written             # <<<<<<<<<<<<<<
  * 
  *         assert buf_size >= 0
  */
       __pyx_v_buf_size = (__pyx_v_buf_size - __pyx_v_written);
     }
     __pyx_L5:;
   }
 
-  /* "sat_toolkit/formula.pyx":1015
+  /* "sat_toolkit/formula.pyx":1022
  *                 buf_size -= written
  * 
  *         assert buf_size >= 0             # <<<<<<<<<<<<<<
  *         py_str = buf[:buf_idx]
  *         free(buf)
  */
   #ifndef CYTHON_WITHOUT_ASSERTIONS
   if (unlikely(__pyx_assertions_enabled())) {
     __pyx_t_4 = (__pyx_v_buf_size >= 0);
     if (unlikely(!__pyx_t_4)) {
       __Pyx_Raise(__pyx_builtin_AssertionError, 0, 0, 0);
-      __PYX_ERR(0, 1015, __pyx_L1_error)
+      __PYX_ERR(0, 1022, __pyx_L1_error)
     }
   }
   #else
-  if ((1)); else __PYX_ERR(0, 1015, __pyx_L1_error)
+  if ((1)); else __PYX_ERR(0, 1022, __pyx_L1_error)
   #endif
 
-  /* "sat_toolkit/formula.pyx":1016
+  /* "sat_toolkit/formula.pyx":1023
  * 
  *         assert buf_size >= 0
  *         py_str = buf[:buf_idx]             # <<<<<<<<<<<<<<
  *         free(buf)
  * 
  */
-  __pyx_t_5 = __Pyx_PyBytes_FromStringAndSize(__pyx_v_buf + 0, __pyx_v_buf_idx - 0); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1016, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyBytes_FromStringAndSize(__pyx_v_buf + 0, __pyx_v_buf_idx - 0); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1023, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
   __pyx_v_py_str = ((PyObject*)__pyx_t_5);
   __pyx_t_5 = 0;
 
-  /* "sat_toolkit/formula.pyx":1017
+  /* "sat_toolkit/formula.pyx":1024
  *         assert buf_size >= 0
  *         py_str = buf[:buf_idx]
  *         free(buf)             # <<<<<<<<<<<<<<
  * 
  *         return 'p cnf ' + str(self.nvars) + ' ' + str(nclauses) + '\n' + py_str.decode()
  */
   free(__pyx_v_buf);
 
-  /* "sat_toolkit/formula.pyx":1019
+  /* "sat_toolkit/formula.pyx":1026
  *         free(buf)
  * 
  *         return 'p cnf ' + str(self.nvars) + ' ' + str(nclauses) + '\n' + py_str.decode()             # <<<<<<<<<<<<<<
  * 
  *     def to_espresso(self, print_numvars: bool = True) -> str:
  */
   __Pyx_XDECREF(__pyx_r);
-  __pyx_t_5 = __Pyx_PyInt_From_int(__pyx_v_self->__pyx_base.nvars); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1019, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyInt_From_int(__pyx_v_self->__pyx_base.nvars); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1026, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
-  __pyx_t_6 = __Pyx_PyObject_Str(__pyx_t_5); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1019, __pyx_L1_error)
+  __pyx_t_6 = __Pyx_PyObject_Str(__pyx_t_5); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1026, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_6);
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-  __pyx_t_5 = PyNumber_Add(__pyx_kp_u_p_cnf, __pyx_t_6); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1019, __pyx_L1_error)
+  __pyx_t_5 = PyNumber_Add(__pyx_kp_u_p_cnf, __pyx_t_6); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1026, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-  __pyx_t_6 = __Pyx_PyUnicode_ConcatInPlace(__pyx_t_5, __pyx_kp_u__32); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1019, __pyx_L1_error)
+  __pyx_t_6 = __Pyx_PyUnicode_ConcatInPlace(__pyx_t_5, __pyx_kp_u__32); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1026, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_6);
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-  __pyx_t_5 = __Pyx_PyInt_FromSize_t(__pyx_v_nclauses); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1019, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyInt_FromSize_t(__pyx_v_nclauses); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1026, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
-  __pyx_t_7 = __Pyx_PyObject_Str(__pyx_t_5); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1019, __pyx_L1_error)
+  __pyx_t_7 = __Pyx_PyObject_Str(__pyx_t_5); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1026, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_7);
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-  __pyx_t_5 = PyNumber_Add(__pyx_t_6, __pyx_t_7); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1019, __pyx_L1_error)
+  __pyx_t_5 = PyNumber_Add(__pyx_t_6, __pyx_t_7); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1026, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
   __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-  __pyx_t_7 = __Pyx_PyUnicode_ConcatInPlace(__pyx_t_5, __pyx_kp_u__33); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1019, __pyx_L1_error)
+  __pyx_t_7 = __Pyx_PyUnicode_ConcatInPlace(__pyx_t_5, __pyx_kp_u__33); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1026, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_7);
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-  __pyx_t_5 = __Pyx_decode_bytes(__pyx_v_py_str, 0, PY_SSIZE_T_MAX, NULL, NULL, NULL); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1019, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_decode_bytes(__pyx_v_py_str, 0, PY_SSIZE_T_MAX, NULL, NULL, NULL); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1026, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
-  __pyx_t_6 = __Pyx_PyUnicode_ConcatInPlace(__pyx_t_7, __pyx_t_5); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1019, __pyx_L1_error)
+  __pyx_t_6 = __Pyx_PyUnicode_ConcatInPlace(__pyx_t_7, __pyx_t_5); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1026, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_6);
   __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-  if (!(likely(PyUnicode_CheckExact(__pyx_t_6)) || __Pyx_RaiseUnexpectedTypeError("unicode", __pyx_t_6))) __PYX_ERR(0, 1019, __pyx_L1_error)
+  if (!(likely(PyUnicode_CheckExact(__pyx_t_6)) || __Pyx_RaiseUnexpectedTypeError("unicode", __pyx_t_6))) __PYX_ERR(0, 1026, __pyx_L1_error)
   __pyx_r = ((PyObject*)__pyx_t_6);
   __pyx_t_6 = 0;
   goto __pyx_L0;
 
-  /* "sat_toolkit/formula.pyx":990
+  /* "sat_toolkit/formula.pyx":997
  * 
  * 
  *     def to_dimacs(self) -> str:             # <<<<<<<<<<<<<<
  *         '''
  *         return the CNF formatted in the DIMACS file format
  */
 
@@ -37919,15 +38056,15 @@
   __pyx_L0:;
   __Pyx_XDECREF(__pyx_v_py_str);
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "sat_toolkit/formula.pyx":1021
+/* "sat_toolkit/formula.pyx":1028
  *         return 'p cnf ' + str(self.nvars) + ' ' + str(nclauses) + '\n' + py_str.decode()
  * 
  *     def to_espresso(self, print_numvars: bool = True) -> str:             # <<<<<<<<<<<<<<
  *         '''
  *         return the CNF formatted in the espresso file format
  */
 
@@ -37981,34 +38118,34 @@
       }
       kw_args = __Pyx_NumKwargs_FASTCALL(__pyx_kwds);
       switch (__pyx_nargs) {
         case  0:
         if (kw_args > 0) {
           PyObject* value = __Pyx_GetKwValue_FASTCALL(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_print_numvars);
           if (value) { values[0] = __Pyx_Arg_NewRef_FASTCALL(value); kw_args--; }
-          else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 1021, __pyx_L3_error)
+          else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 1028, __pyx_L3_error)
         }
       }
       if (unlikely(kw_args > 0)) {
         const Py_ssize_t kwd_pos_args = __pyx_nargs;
-        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values + 0, kwd_pos_args, "to_espresso") < 0)) __PYX_ERR(0, 1021, __pyx_L3_error)
+        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values + 0, kwd_pos_args, "to_espresso") < 0)) __PYX_ERR(0, 1028, __pyx_L3_error)
       }
     } else {
       switch (__pyx_nargs) {
         case  1: values[0] = __Pyx_Arg_FASTCALL(__pyx_args, 0);
         CYTHON_FALLTHROUGH;
         case  0: break;
         default: goto __pyx_L5_argtuple_error;
       }
     }
     __pyx_v_print_numvars = values[0];
   }
   goto __pyx_L6_skip;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("to_espresso", 0, 0, 1, __pyx_nargs); __PYX_ERR(0, 1021, __pyx_L3_error)
+  __Pyx_RaiseArgtupleInvalid("to_espresso", 0, 0, 1, __pyx_nargs); __PYX_ERR(0, 1028, __pyx_L3_error)
   __pyx_L6_skip:;
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L3_error:;
   {
     Py_ssize_t __pyx_temp;
     for (__pyx_temp=0; __pyx_temp < (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
       __Pyx_Arg_XDECREF_FASTCALL(values[__pyx_temp]);
@@ -38047,303 +38184,303 @@
   size_t __pyx_t_4;
   PyObject *__pyx_t_5 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("to_espresso", 1);
 
-  /* "sat_toolkit/formula.pyx":1029
+  /* "sat_toolkit/formula.pyx":1036
  *         cdef char target_char
  *         cdef char *line_buf
  *         cdef fmt_buf buf = make_buf()             # <<<<<<<<<<<<<<
  * 
  *         if print_numvars:
  */
   __pyx_v_buf = make_buf();
 
-  /* "sat_toolkit/formula.pyx":1031
+  /* "sat_toolkit/formula.pyx":1038
  *         cdef fmt_buf buf = make_buf()
  * 
  *         if print_numvars:             # <<<<<<<<<<<<<<
  *             buf_printf(&buf, ".i %d\n", self.nvars)
  *             buf_printf(&buf, ".o 1\n", self.nvars)
  */
-  __pyx_t_1 = __Pyx_PyObject_IsTrue(__pyx_v_print_numvars); if (unlikely((__pyx_t_1 < 0))) __PYX_ERR(0, 1031, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_IsTrue(__pyx_v_print_numvars); if (unlikely((__pyx_t_1 < 0))) __PYX_ERR(0, 1038, __pyx_L1_error)
   if (__pyx_t_1) {
 
-    /* "sat_toolkit/formula.pyx":1032
+    /* "sat_toolkit/formula.pyx":1039
  * 
  *         if print_numvars:
  *             buf_printf(&buf, ".i %d\n", self.nvars)             # <<<<<<<<<<<<<<
  *             buf_printf(&buf, ".o 1\n", self.nvars)
  *         buf_printf(&buf, ".p %zd\n", self._start_indices.size())
  */
     (void)(buf_printf((&__pyx_v_buf), ((char const *)".i %d\n"), __pyx_v_self->__pyx_base.nvars));
 
-    /* "sat_toolkit/formula.pyx":1033
+    /* "sat_toolkit/formula.pyx":1040
  *         if print_numvars:
  *             buf_printf(&buf, ".i %d\n", self.nvars)
  *             buf_printf(&buf, ".o 1\n", self.nvars)             # <<<<<<<<<<<<<<
  *         buf_printf(&buf, ".p %zd\n", self._start_indices.size())
  * 
  */
     (void)(buf_printf((&__pyx_v_buf), ((char const *)".o 1\n"), __pyx_v_self->__pyx_base.nvars));
 
-    /* "sat_toolkit/formula.pyx":1031
+    /* "sat_toolkit/formula.pyx":1038
  *         cdef fmt_buf buf = make_buf()
  * 
  *         if print_numvars:             # <<<<<<<<<<<<<<
  *             buf_printf(&buf, ".i %d\n", self.nvars)
  *             buf_printf(&buf, ".o 1\n", self.nvars)
  */
   }
 
-  /* "sat_toolkit/formula.pyx":1034
+  /* "sat_toolkit/formula.pyx":1041
  *             buf_printf(&buf, ".i %d\n", self.nvars)
  *             buf_printf(&buf, ".o 1\n", self.nvars)
  *         buf_printf(&buf, ".p %zd\n", self._start_indices.size())             # <<<<<<<<<<<<<<
  * 
  *         line_buf = <char *> malloc(self.nvars + 4)
  */
   (void)(buf_printf((&__pyx_v_buf), ((char const *)".p %zd\n"), __pyx_v_self->__pyx_base._start_indices.size()));
 
-  /* "sat_toolkit/formula.pyx":1036
+  /* "sat_toolkit/formula.pyx":1043
  *         buf_printf(&buf, ".p %zd\n", self._start_indices.size())
  * 
  *         line_buf = <char *> malloc(self.nvars + 4)             # <<<<<<<<<<<<<<
  *         strcpy(line_buf + self.nvars, " 1\n");
  * 
  */
   __pyx_v_line_buf = ((char *)malloc((__pyx_v_self->__pyx_base.nvars + 4)));
 
-  /* "sat_toolkit/formula.pyx":1037
+  /* "sat_toolkit/formula.pyx":1044
  * 
  *         line_buf = <char *> malloc(self.nvars + 4)
  *         strcpy(line_buf + self.nvars, " 1\n");             # <<<<<<<<<<<<<<
  * 
  *         for i in range(self._start_indices.size()):
  */
   (void)(strcpy((__pyx_v_line_buf + __pyx_v_self->__pyx_base.nvars), ((char const *)" 1\n")));
 
-  /* "sat_toolkit/formula.pyx":1039
+  /* "sat_toolkit/formula.pyx":1046
  *         strcpy(line_buf + self.nvars, " 1\n");
  * 
  *         for i in range(self._start_indices.size()):             # <<<<<<<<<<<<<<
  *             memset(line_buf, b'-', self.nvars);
  * 
  */
   __pyx_t_2 = __pyx_v_self->__pyx_base._start_indices.size();
   __pyx_t_3 = __pyx_t_2;
   for (__pyx_t_4 = 0; __pyx_t_4 < __pyx_t_3; __pyx_t_4+=1) {
     __pyx_v_i = __pyx_t_4;
 
-    /* "sat_toolkit/formula.pyx":1040
+    /* "sat_toolkit/formula.pyx":1047
  * 
  *         for i in range(self._start_indices.size()):
  *             memset(line_buf, b'-', self.nvars);             # <<<<<<<<<<<<<<
  * 
  *             j = 0
  */
     (void)(memset(__pyx_v_line_buf, '-', __pyx_v_self->__pyx_base.nvars));
 
-    /* "sat_toolkit/formula.pyx":1042
+    /* "sat_toolkit/formula.pyx":1049
  *             memset(line_buf, b'-', self.nvars);
  * 
  *             j = 0             # <<<<<<<<<<<<<<
  *             while self._clauses[self._start_indices[i] + j] != 0:
  *                 lit = self._clauses[self._start_indices[i] + j]
  */
     __pyx_v_j = 0;
 
-    /* "sat_toolkit/formula.pyx":1043
+    /* "sat_toolkit/formula.pyx":1050
  * 
  *             j = 0
  *             while self._clauses[self._start_indices[i] + j] != 0:             # <<<<<<<<<<<<<<
  *                 lit = self._clauses[self._start_indices[i] + j]
  * 
  */
     while (1) {
       __pyx_t_1 = ((__pyx_v_self->__pyx_base._clauses[((__pyx_v_self->__pyx_base._start_indices[__pyx_v_i]) + __pyx_v_j)]) != 0);
       if (!__pyx_t_1) break;
 
-      /* "sat_toolkit/formula.pyx":1044
+      /* "sat_toolkit/formula.pyx":1051
  *             j = 0
  *             while self._clauses[self._start_indices[i] + j] != 0:
  *                 lit = self._clauses[self._start_indices[i] + j]             # <<<<<<<<<<<<<<
  * 
  *                 target_char = b'0'
  */
       __pyx_v_lit = (__pyx_v_self->__pyx_base._clauses[((__pyx_v_self->__pyx_base._start_indices[__pyx_v_i]) + __pyx_v_j)]);
 
-      /* "sat_toolkit/formula.pyx":1046
+      /* "sat_toolkit/formula.pyx":1053
  *                 lit = self._clauses[self._start_indices[i] + j]
  * 
  *                 target_char = b'0'             # <<<<<<<<<<<<<<
  *                 if lit < 0:
  *                     target_char = b'1'
  */
       __pyx_v_target_char = '0';
 
-      /* "sat_toolkit/formula.pyx":1047
+      /* "sat_toolkit/formula.pyx":1054
  * 
  *                 target_char = b'0'
  *                 if lit < 0:             # <<<<<<<<<<<<<<
  *                     target_char = b'1'
  *                     lit = -lit
  */
       __pyx_t_1 = (__pyx_v_lit < 0);
       if (__pyx_t_1) {
 
-        /* "sat_toolkit/formula.pyx":1048
+        /* "sat_toolkit/formula.pyx":1055
  *                 target_char = b'0'
  *                 if lit < 0:
  *                     target_char = b'1'             # <<<<<<<<<<<<<<
  *                     lit = -lit
  * 
  */
         __pyx_v_target_char = '1';
 
-        /* "sat_toolkit/formula.pyx":1049
+        /* "sat_toolkit/formula.pyx":1056
  *                 if lit < 0:
  *                     target_char = b'1'
  *                     lit = -lit             # <<<<<<<<<<<<<<
  * 
  *                 line_buf[self.nvars - lit] = target_char
  */
         __pyx_v_lit = (-__pyx_v_lit);
 
-        /* "sat_toolkit/formula.pyx":1047
+        /* "sat_toolkit/formula.pyx":1054
  * 
  *                 target_char = b'0'
  *                 if lit < 0:             # <<<<<<<<<<<<<<
  *                     target_char = b'1'
  *                     lit = -lit
  */
       }
 
-      /* "sat_toolkit/formula.pyx":1051
+      /* "sat_toolkit/formula.pyx":1058
  *                     lit = -lit
  * 
  *                 line_buf[self.nvars - lit] = target_char             # <<<<<<<<<<<<<<
  * 
  *                 j += 1
  */
       (__pyx_v_line_buf[(__pyx_v_self->__pyx_base.nvars - __pyx_v_lit)]) = __pyx_v_target_char;
 
-      /* "sat_toolkit/formula.pyx":1053
+      /* "sat_toolkit/formula.pyx":1060
  *                 line_buf[self.nvars - lit] = target_char
  * 
  *                 j += 1             # <<<<<<<<<<<<<<
  * 
  *             buf_printf(&buf, "%s", line_buf)
  */
       __pyx_v_j = (__pyx_v_j + 1);
     }
 
-    /* "sat_toolkit/formula.pyx":1055
+    /* "sat_toolkit/formula.pyx":1062
  *                 j += 1
  * 
  *             buf_printf(&buf, "%s", line_buf)             # <<<<<<<<<<<<<<
  * 
  *         # handle the case of a CNF with 0 clauses, a.k.a. a tautology
  */
     (void)(buf_printf((&__pyx_v_buf), ((char const *)"%s"), __pyx_v_line_buf));
   }
 
-  /* "sat_toolkit/formula.pyx":1058
+  /* "sat_toolkit/formula.pyx":1065
  * 
  *         # handle the case of a CNF with 0 clauses, a.k.a. a tautology
  *         if self._start_indices.size() == 0:             # <<<<<<<<<<<<<<
  *             memset(line_buf, b'-', self.nvars);
  *             line_buf[self.nvars + 1] = b'0'
  */
   __pyx_t_1 = (__pyx_v_self->__pyx_base._start_indices.size() == 0);
   if (__pyx_t_1) {
 
-    /* "sat_toolkit/formula.pyx":1059
+    /* "sat_toolkit/formula.pyx":1066
  *         # handle the case of a CNF with 0 clauses, a.k.a. a tautology
  *         if self._start_indices.size() == 0:
  *             memset(line_buf, b'-', self.nvars);             # <<<<<<<<<<<<<<
  *             line_buf[self.nvars + 1] = b'0'
  *             buf_printf(&buf, "%s", line_buf)
  */
     (void)(memset(__pyx_v_line_buf, '-', __pyx_v_self->__pyx_base.nvars));
 
-    /* "sat_toolkit/formula.pyx":1060
+    /* "sat_toolkit/formula.pyx":1067
  *         if self._start_indices.size() == 0:
  *             memset(line_buf, b'-', self.nvars);
  *             line_buf[self.nvars + 1] = b'0'             # <<<<<<<<<<<<<<
  *             buf_printf(&buf, "%s", line_buf)
  * 
  */
     (__pyx_v_line_buf[(__pyx_v_self->__pyx_base.nvars + 1)]) = '0';
 
-    /* "sat_toolkit/formula.pyx":1061
+    /* "sat_toolkit/formula.pyx":1068
  *             memset(line_buf, b'-', self.nvars);
  *             line_buf[self.nvars + 1] = b'0'
  *             buf_printf(&buf, "%s", line_buf)             # <<<<<<<<<<<<<<
  * 
  *         buf_printf(&buf, ".e\n")
  */
     (void)(buf_printf((&__pyx_v_buf), ((char const *)"%s"), __pyx_v_line_buf));
 
-    /* "sat_toolkit/formula.pyx":1058
+    /* "sat_toolkit/formula.pyx":1065
  * 
  *         # handle the case of a CNF with 0 clauses, a.k.a. a tautology
  *         if self._start_indices.size() == 0:             # <<<<<<<<<<<<<<
  *             memset(line_buf, b'-', self.nvars);
  *             line_buf[self.nvars + 1] = b'0'
  */
   }
 
-  /* "sat_toolkit/formula.pyx":1063
+  /* "sat_toolkit/formula.pyx":1070
  *             buf_printf(&buf, "%s", line_buf)
  * 
  *         buf_printf(&buf, ".e\n")             # <<<<<<<<<<<<<<
  *         py_bytes = buf.buf[:buf.len]
  * 
  */
   (void)(buf_printf((&__pyx_v_buf), ((char const *)".e\n")));
 
-  /* "sat_toolkit/formula.pyx":1064
+  /* "sat_toolkit/formula.pyx":1071
  * 
  *         buf_printf(&buf, ".e\n")
  *         py_bytes = buf.buf[:buf.len]             # <<<<<<<<<<<<<<
  * 
  *         free_buf(&buf)
  */
-  __pyx_t_5 = __Pyx_PyBytes_FromStringAndSize(__pyx_v_buf.buf + 0, __pyx_v_buf.len - 0); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1064, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyBytes_FromStringAndSize(__pyx_v_buf.buf + 0, __pyx_v_buf.len - 0); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1071, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
   __pyx_v_py_bytes = ((PyObject*)__pyx_t_5);
   __pyx_t_5 = 0;
 
-  /* "sat_toolkit/formula.pyx":1066
+  /* "sat_toolkit/formula.pyx":1073
  *         py_bytes = buf.buf[:buf.len]
  * 
  *         free_buf(&buf)             # <<<<<<<<<<<<<<
  *         return py_bytes.decode()
  * 
  */
   free_buf((&__pyx_v_buf));
 
-  /* "sat_toolkit/formula.pyx":1067
+  /* "sat_toolkit/formula.pyx":1074
  * 
  *         free_buf(&buf)
  *         return py_bytes.decode()             # <<<<<<<<<<<<<<
  * 
  *     def minimize_espresso(self, espresso_args: List[str] = []) -> CNF:
  */
   __Pyx_XDECREF(__pyx_r);
-  __pyx_t_5 = __Pyx_decode_bytes(__pyx_v_py_bytes, 0, PY_SSIZE_T_MAX, NULL, NULL, NULL); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1067, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_decode_bytes(__pyx_v_py_bytes, 0, PY_SSIZE_T_MAX, NULL, NULL, NULL); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1074, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
   __pyx_r = ((PyObject*)__pyx_t_5);
   __pyx_t_5 = 0;
   goto __pyx_L0;
 
-  /* "sat_toolkit/formula.pyx":1021
+  /* "sat_toolkit/formula.pyx":1028
  *         return 'p cnf ' + str(self.nvars) + ' ' + str(nclauses) + '\n' + py_str.decode()
  * 
  *     def to_espresso(self, print_numvars: bool = True) -> str:             # <<<<<<<<<<<<<<
  *         '''
  *         return the CNF formatted in the espresso file format
  */
 
@@ -38355,15 +38492,15 @@
   __pyx_L0:;
   __Pyx_XDECREF(__pyx_v_py_bytes);
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "sat_toolkit/formula.pyx":1069
+/* "sat_toolkit/formula.pyx":1076
  *         return py_bytes.decode()
  * 
  *     def minimize_espresso(self, espresso_args: List[str] = []) -> CNF:             # <<<<<<<<<<<<<<
  *         """
  *         Uses espresso to minimize the given CNF.
  */
 
@@ -38417,34 +38554,34 @@
       }
       kw_args = __Pyx_NumKwargs_FASTCALL(__pyx_kwds);
       switch (__pyx_nargs) {
         case  0:
         if (kw_args > 0) {
           PyObject* value = __Pyx_GetKwValue_FASTCALL(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_espresso_args);
           if (value) { values[0] = __Pyx_Arg_NewRef_FASTCALL(value); kw_args--; }
-          else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 1069, __pyx_L3_error)
+          else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 1076, __pyx_L3_error)
         }
       }
       if (unlikely(kw_args > 0)) {
         const Py_ssize_t kwd_pos_args = __pyx_nargs;
-        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values + 0, kwd_pos_args, "minimize_espresso") < 0)) __PYX_ERR(0, 1069, __pyx_L3_error)
+        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values + 0, kwd_pos_args, "minimize_espresso") < 0)) __PYX_ERR(0, 1076, __pyx_L3_error)
       }
     } else {
       switch (__pyx_nargs) {
         case  1: values[0] = __Pyx_Arg_FASTCALL(__pyx_args, 0);
         CYTHON_FALLTHROUGH;
         case  0: break;
         default: goto __pyx_L5_argtuple_error;
       }
     }
     __pyx_v_espresso_args = values[0];
   }
   goto __pyx_L6_skip;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("minimize_espresso", 0, 0, 1, __pyx_nargs); __PYX_ERR(0, 1069, __pyx_L3_error)
+  __Pyx_RaiseArgtupleInvalid("minimize_espresso", 0, 0, 1, __pyx_nargs); __PYX_ERR(0, 1076, __pyx_L3_error)
   __pyx_L6_skip:;
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L3_error:;
   {
     Py_ssize_t __pyx_temp;
     for (__pyx_temp=0; __pyx_temp < (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
       __Pyx_Arg_XDECREF_FASTCALL(values[__pyx_temp]);
@@ -38488,65 +38625,65 @@
   int __pyx_t_13;
   struct __pyx_obj_11sat_toolkit_7formula_CNF *__pyx_t_14 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("minimize_espresso", 1);
 
-  /* "sat_toolkit/formula.pyx":1080
+  /* "sat_toolkit/formula.pyx":1087
  *         cdef int ret_code
  * 
  *         with sp.Popen(['espresso'] + espresso_args, stdin=sp.PIPE, stdout=sp.PIPE, text=True) as espresso:             # <<<<<<<<<<<<<<
  *             espresso.stdin.write(self.to_espresso())
  *             espresso.stdin.close()
  */
   /*with:*/ {
-    __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_sp); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1080, __pyx_L1_error)
+    __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_sp); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1087, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
-    __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_Popen); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1080, __pyx_L1_error)
+    __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_Popen); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1087, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-    __pyx_t_1 = PyList_New(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1080, __pyx_L1_error)
+    __pyx_t_1 = PyList_New(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1087, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_INCREF(__pyx_n_u_espresso);
     __Pyx_GIVEREF(__pyx_n_u_espresso);
-    if (__Pyx_PyList_SET_ITEM(__pyx_t_1, 0, __pyx_n_u_espresso)) __PYX_ERR(0, 1080, __pyx_L1_error);
-    __pyx_t_3 = PyNumber_Add(__pyx_t_1, __pyx_v_espresso_args); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1080, __pyx_L1_error)
+    if (__Pyx_PyList_SET_ITEM(__pyx_t_1, 0, __pyx_n_u_espresso)) __PYX_ERR(0, 1087, __pyx_L1_error);
+    __pyx_t_3 = PyNumber_Add(__pyx_t_1, __pyx_v_espresso_args); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1087, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-    __pyx_t_1 = PyTuple_New(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1080, __pyx_L1_error)
+    __pyx_t_1 = PyTuple_New(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1087, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_GIVEREF(__pyx_t_3);
-    if (__Pyx_PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_t_3)) __PYX_ERR(0, 1080, __pyx_L1_error);
+    if (__Pyx_PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_t_3)) __PYX_ERR(0, 1087, __pyx_L1_error);
     __pyx_t_3 = 0;
-    __pyx_t_3 = __Pyx_PyDict_NewPresized(3); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1080, __pyx_L1_error)
+    __pyx_t_3 = __Pyx_PyDict_NewPresized(3); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1087, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
-    __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_sp); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1080, __pyx_L1_error)
+    __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_sp); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1087, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
-    __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_PIPE); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1080, __pyx_L1_error)
+    __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_PIPE); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1087, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-    if (PyDict_SetItem(__pyx_t_3, __pyx_n_s_stdin, __pyx_t_5) < 0) __PYX_ERR(0, 1080, __pyx_L1_error)
+    if (PyDict_SetItem(__pyx_t_3, __pyx_n_s_stdin, __pyx_t_5) < 0) __PYX_ERR(0, 1087, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-    __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_sp); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1080, __pyx_L1_error)
+    __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_sp); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1087, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
-    __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_PIPE); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1080, __pyx_L1_error)
+    __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_PIPE); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1087, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-    if (PyDict_SetItem(__pyx_t_3, __pyx_n_s_stdout, __pyx_t_4) < 0) __PYX_ERR(0, 1080, __pyx_L1_error)
+    if (PyDict_SetItem(__pyx_t_3, __pyx_n_s_stdout, __pyx_t_4) < 0) __PYX_ERR(0, 1087, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-    if (PyDict_SetItem(__pyx_t_3, __pyx_n_s_text, Py_True) < 0) __PYX_ERR(0, 1080, __pyx_L1_error)
-    __pyx_t_4 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_t_1, __pyx_t_3); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1080, __pyx_L1_error)
+    if (PyDict_SetItem(__pyx_t_3, __pyx_n_s_text, Py_True) < 0) __PYX_ERR(0, 1087, __pyx_L1_error)
+    __pyx_t_4 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_t_1, __pyx_t_3); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1087, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-    __pyx_t_6 = __Pyx_PyObject_LookupSpecial(__pyx_t_4, __pyx_n_s_exit); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1080, __pyx_L1_error)
+    __pyx_t_6 = __Pyx_PyObject_LookupSpecial(__pyx_t_4, __pyx_n_s_exit); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1087, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
-    __pyx_t_1 = __Pyx_PyObject_LookupSpecial(__pyx_t_4, __pyx_n_s_enter); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1080, __pyx_L3_error)
+    __pyx_t_1 = __Pyx_PyObject_LookupSpecial(__pyx_t_4, __pyx_n_s_enter); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1087, __pyx_L3_error)
     __Pyx_GOTREF(__pyx_t_1);
     __pyx_t_2 = NULL;
     __pyx_t_7 = 0;
     #if CYTHON_UNPACK_METHODS
     if (likely(PyMethod_Check(__pyx_t_1))) {
       __pyx_t_2 = PyMethod_GET_SELF(__pyx_t_1);
       if (likely(__pyx_t_2)) {
@@ -38558,15 +38695,15 @@
       }
     }
     #endif
     {
       PyObject *__pyx_callargs[2] = {__pyx_t_2, NULL};
       __pyx_t_3 = __Pyx_PyObject_FastCall(__pyx_t_1, __pyx_callargs+1-__pyx_t_7, 0+__pyx_t_7);
       __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
-      if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1080, __pyx_L3_error)
+      if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1087, __pyx_L3_error)
       __Pyx_GOTREF(__pyx_t_3);
       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
     }
     __pyx_t_1 = __pyx_t_3;
     __pyx_t_3 = 0;
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
     /*try:*/ {
@@ -38577,27 +38714,27 @@
         __Pyx_XGOTREF(__pyx_t_8);
         __Pyx_XGOTREF(__pyx_t_9);
         __Pyx_XGOTREF(__pyx_t_10);
         /*try:*/ {
           __pyx_v_espresso = __pyx_t_1;
           __pyx_t_1 = 0;
 
-          /* "sat_toolkit/formula.pyx":1081
+          /* "sat_toolkit/formula.pyx":1088
  * 
  *         with sp.Popen(['espresso'] + espresso_args, stdin=sp.PIPE, stdout=sp.PIPE, text=True) as espresso:
  *             espresso.stdin.write(self.to_espresso())             # <<<<<<<<<<<<<<
  *             espresso.stdin.close()
  * 
  */
-          __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_v_espresso, __pyx_n_s_stdin); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1081, __pyx_L7_error)
+          __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_v_espresso, __pyx_n_s_stdin); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1088, __pyx_L7_error)
           __Pyx_GOTREF(__pyx_t_4);
-          __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_write); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1081, __pyx_L7_error)
+          __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_write); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1088, __pyx_L7_error)
           __Pyx_GOTREF(__pyx_t_3);
           __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-          __pyx_t_2 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_self), __pyx_n_s_to_espresso); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1081, __pyx_L7_error)
+          __pyx_t_2 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_self), __pyx_n_s_to_espresso); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1088, __pyx_L7_error)
           __Pyx_GOTREF(__pyx_t_2);
           __pyx_t_5 = NULL;
           __pyx_t_7 = 0;
           #if CYTHON_UNPACK_METHODS
           if (likely(PyMethod_Check(__pyx_t_2))) {
             __pyx_t_5 = PyMethod_GET_SELF(__pyx_t_2);
             if (likely(__pyx_t_5)) {
@@ -38609,15 +38746,15 @@
             }
           }
           #endif
           {
             PyObject *__pyx_callargs[2] = {__pyx_t_5, NULL};
             __pyx_t_4 = __Pyx_PyObject_FastCall(__pyx_t_2, __pyx_callargs+1-__pyx_t_7, 0+__pyx_t_7);
             __Pyx_XDECREF(__pyx_t_5); __pyx_t_5 = 0;
-            if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1081, __pyx_L7_error)
+            if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1088, __pyx_L7_error)
             __Pyx_GOTREF(__pyx_t_4);
             __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
           }
           __pyx_t_2 = NULL;
           __pyx_t_7 = 0;
           #if CYTHON_UNPACK_METHODS
           if (likely(PyMethod_Check(__pyx_t_3))) {
@@ -38632,30 +38769,30 @@
           }
           #endif
           {
             PyObject *__pyx_callargs[2] = {__pyx_t_2, __pyx_t_4};
             __pyx_t_1 = __Pyx_PyObject_FastCall(__pyx_t_3, __pyx_callargs+1-__pyx_t_7, 1+__pyx_t_7);
             __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
             __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-            if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1081, __pyx_L7_error)
+            if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1088, __pyx_L7_error)
             __Pyx_GOTREF(__pyx_t_1);
             __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
           }
           __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-          /* "sat_toolkit/formula.pyx":1082
+          /* "sat_toolkit/formula.pyx":1089
  *         with sp.Popen(['espresso'] + espresso_args, stdin=sp.PIPE, stdout=sp.PIPE, text=True) as espresso:
  *             espresso.stdin.write(self.to_espresso())
  *             espresso.stdin.close()             # <<<<<<<<<<<<<<
  * 
  *             cnf = CNF.from_espresso(espresso.stdout.read())
  */
-          __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_v_espresso, __pyx_n_s_stdin); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1082, __pyx_L7_error)
+          __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_v_espresso, __pyx_n_s_stdin); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1089, __pyx_L7_error)
           __Pyx_GOTREF(__pyx_t_3);
-          __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_close); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1082, __pyx_L7_error)
+          __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_close); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1089, __pyx_L7_error)
           __Pyx_GOTREF(__pyx_t_4);
           __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
           __pyx_t_3 = NULL;
           __pyx_t_7 = 0;
           #if CYTHON_UNPACK_METHODS
           if (likely(PyMethod_Check(__pyx_t_4))) {
             __pyx_t_3 = PyMethod_GET_SELF(__pyx_t_4);
@@ -38668,32 +38805,32 @@
             }
           }
           #endif
           {
             PyObject *__pyx_callargs[2] = {__pyx_t_3, NULL};
             __pyx_t_1 = __Pyx_PyObject_FastCall(__pyx_t_4, __pyx_callargs+1-__pyx_t_7, 0+__pyx_t_7);
             __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
-            if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1082, __pyx_L7_error)
+            if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1089, __pyx_L7_error)
             __Pyx_GOTREF(__pyx_t_1);
             __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
           }
           __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-          /* "sat_toolkit/formula.pyx":1084
+          /* "sat_toolkit/formula.pyx":1091
  *             espresso.stdin.close()
  * 
  *             cnf = CNF.from_espresso(espresso.stdout.read())             # <<<<<<<<<<<<<<
  * 
  *             ret_code = espresso.wait()
  */
-          __pyx_t_4 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_ptype_11sat_toolkit_7formula_CNF), __pyx_n_s_from_espresso); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1084, __pyx_L7_error)
+          __pyx_t_4 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_ptype_11sat_toolkit_7formula_CNF), __pyx_n_s_from_espresso); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1091, __pyx_L7_error)
           __Pyx_GOTREF(__pyx_t_4);
-          __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_espresso, __pyx_n_s_stdout); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1084, __pyx_L7_error)
+          __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_espresso, __pyx_n_s_stdout); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1091, __pyx_L7_error)
           __Pyx_GOTREF(__pyx_t_2);
-          __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_read); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1084, __pyx_L7_error)
+          __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_read); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1091, __pyx_L7_error)
           __Pyx_GOTREF(__pyx_t_5);
           __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
           __pyx_t_2 = NULL;
           __pyx_t_7 = 0;
           #if CYTHON_UNPACK_METHODS
           if (likely(PyMethod_Check(__pyx_t_5))) {
             __pyx_t_2 = PyMethod_GET_SELF(__pyx_t_5);
@@ -38706,15 +38843,15 @@
             }
           }
           #endif
           {
             PyObject *__pyx_callargs[2] = {__pyx_t_2, NULL};
             __pyx_t_3 = __Pyx_PyObject_FastCall(__pyx_t_5, __pyx_callargs+1-__pyx_t_7, 0+__pyx_t_7);
             __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
-            if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1084, __pyx_L7_error)
+            if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1091, __pyx_L7_error)
             __Pyx_GOTREF(__pyx_t_3);
             __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
           }
           __pyx_t_5 = NULL;
           __pyx_t_7 = 0;
           #if CYTHON_UNPACK_METHODS
           if (likely(PyMethod_Check(__pyx_t_4))) {
@@ -38729,29 +38866,29 @@
           }
           #endif
           {
             PyObject *__pyx_callargs[2] = {__pyx_t_5, __pyx_t_3};
             __pyx_t_1 = __Pyx_PyObject_FastCall(__pyx_t_4, __pyx_callargs+1-__pyx_t_7, 1+__pyx_t_7);
             __Pyx_XDECREF(__pyx_t_5); __pyx_t_5 = 0;
             __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-            if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1084, __pyx_L7_error)
+            if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1091, __pyx_L7_error)
             __Pyx_GOTREF(__pyx_t_1);
             __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
           }
           __pyx_v_cnf = __pyx_t_1;
           __pyx_t_1 = 0;
 
-          /* "sat_toolkit/formula.pyx":1086
+          /* "sat_toolkit/formula.pyx":1093
  *             cnf = CNF.from_espresso(espresso.stdout.read())
  * 
  *             ret_code = espresso.wait()             # <<<<<<<<<<<<<<
  *             if ret_code != 0:
  *                 raise sp.CalledProcessError(ret_code, ' '.join(espresso.args))
  */
-          __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_v_espresso, __pyx_n_s_wait); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1086, __pyx_L7_error)
+          __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_v_espresso, __pyx_n_s_wait); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1093, __pyx_L7_error)
           __Pyx_GOTREF(__pyx_t_4);
           __pyx_t_3 = NULL;
           __pyx_t_7 = 0;
           #if CYTHON_UNPACK_METHODS
           if (likely(PyMethod_Check(__pyx_t_4))) {
             __pyx_t_3 = PyMethod_GET_SELF(__pyx_t_4);
             if (likely(__pyx_t_3)) {
@@ -38763,49 +38900,49 @@
             }
           }
           #endif
           {
             PyObject *__pyx_callargs[2] = {__pyx_t_3, NULL};
             __pyx_t_1 = __Pyx_PyObject_FastCall(__pyx_t_4, __pyx_callargs+1-__pyx_t_7, 0+__pyx_t_7);
             __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
-            if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1086, __pyx_L7_error)
+            if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1093, __pyx_L7_error)
             __Pyx_GOTREF(__pyx_t_1);
             __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
           }
-          __pyx_t_7 = __Pyx_PyInt_As_int(__pyx_t_1); if (unlikely((__pyx_t_7 == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 1086, __pyx_L7_error)
+          __pyx_t_7 = __Pyx_PyInt_As_int(__pyx_t_1); if (unlikely((__pyx_t_7 == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 1093, __pyx_L7_error)
           __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
           __pyx_v_ret_code = __pyx_t_7;
 
-          /* "sat_toolkit/formula.pyx":1087
+          /* "sat_toolkit/formula.pyx":1094
  * 
  *             ret_code = espresso.wait()
  *             if ret_code != 0:             # <<<<<<<<<<<<<<
  *                 raise sp.CalledProcessError(ret_code, ' '.join(espresso.args))
  * 
  */
           __pyx_t_11 = (__pyx_v_ret_code != 0);
           if (unlikely(__pyx_t_11)) {
 
-            /* "sat_toolkit/formula.pyx":1088
+            /* "sat_toolkit/formula.pyx":1095
  *             ret_code = espresso.wait()
  *             if ret_code != 0:
  *                 raise sp.CalledProcessError(ret_code, ' '.join(espresso.args))             # <<<<<<<<<<<<<<
  * 
  *             return cnf
  */
-            __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_sp); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1088, __pyx_L7_error)
+            __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_sp); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1095, __pyx_L7_error)
             __Pyx_GOTREF(__pyx_t_4);
-            __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_CalledProcessError); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1088, __pyx_L7_error)
+            __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_CalledProcessError); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1095, __pyx_L7_error)
             __Pyx_GOTREF(__pyx_t_3);
             __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-            __pyx_t_4 = __Pyx_PyInt_From_int(__pyx_v_ret_code); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1088, __pyx_L7_error)
+            __pyx_t_4 = __Pyx_PyInt_From_int(__pyx_v_ret_code); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1095, __pyx_L7_error)
             __Pyx_GOTREF(__pyx_t_4);
-            __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_v_espresso, __pyx_n_s_args); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1088, __pyx_L7_error)
+            __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_v_espresso, __pyx_n_s_args); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1095, __pyx_L7_error)
             __Pyx_GOTREF(__pyx_t_5);
-            __pyx_t_2 = PyUnicode_Join(__pyx_kp_u__32, __pyx_t_5); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1088, __pyx_L7_error)
+            __pyx_t_2 = PyUnicode_Join(__pyx_kp_u__32, __pyx_t_5); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1095, __pyx_L7_error)
             __Pyx_GOTREF(__pyx_t_2);
             __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
             __pyx_t_5 = NULL;
             __pyx_t_7 = 0;
             #if CYTHON_UNPACK_METHODS
             if (unlikely(PyMethod_Check(__pyx_t_3))) {
               __pyx_t_5 = PyMethod_GET_SELF(__pyx_t_3);
@@ -38820,45 +38957,45 @@
             #endif
             {
               PyObject *__pyx_callargs[3] = {__pyx_t_5, __pyx_t_4, __pyx_t_2};
               __pyx_t_1 = __Pyx_PyObject_FastCall(__pyx_t_3, __pyx_callargs+1-__pyx_t_7, 2+__pyx_t_7);
               __Pyx_XDECREF(__pyx_t_5); __pyx_t_5 = 0;
               __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
               __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-              if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1088, __pyx_L7_error)
+              if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1095, __pyx_L7_error)
               __Pyx_GOTREF(__pyx_t_1);
               __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
             }
             __Pyx_Raise(__pyx_t_1, 0, 0, 0);
             __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-            __PYX_ERR(0, 1088, __pyx_L7_error)
+            __PYX_ERR(0, 1095, __pyx_L7_error)
 
-            /* "sat_toolkit/formula.pyx":1087
+            /* "sat_toolkit/formula.pyx":1094
  * 
  *             ret_code = espresso.wait()
  *             if ret_code != 0:             # <<<<<<<<<<<<<<
  *                 raise sp.CalledProcessError(ret_code, ' '.join(espresso.args))
  * 
  */
           }
 
-          /* "sat_toolkit/formula.pyx":1090
+          /* "sat_toolkit/formula.pyx":1097
  *                 raise sp.CalledProcessError(ret_code, ' '.join(espresso.args))
  * 
  *             return cnf             # <<<<<<<<<<<<<<
  * 
  *     def _minimize_dimacs(self, args: List[str], outfile: str) -> CNF:
  */
           __Pyx_XDECREF((PyObject *)__pyx_r);
-          if (!(likely(((__pyx_v_cnf) == Py_None) || likely(__Pyx_TypeTest(__pyx_v_cnf, __pyx_ptype_11sat_toolkit_7formula_CNF))))) __PYX_ERR(0, 1090, __pyx_L7_error)
+          if (!(likely(((__pyx_v_cnf) == Py_None) || likely(__Pyx_TypeTest(__pyx_v_cnf, __pyx_ptype_11sat_toolkit_7formula_CNF))))) __PYX_ERR(0, 1097, __pyx_L7_error)
           __Pyx_INCREF(__pyx_v_cnf);
           __pyx_r = ((struct __pyx_obj_11sat_toolkit_7formula_CNF *)__pyx_v_cnf);
           goto __pyx_L11_try_return;
 
-          /* "sat_toolkit/formula.pyx":1080
+          /* "sat_toolkit/formula.pyx":1087
  *         cdef int ret_code
  * 
  *         with sp.Popen(['espresso'] + espresso_args, stdin=sp.PIPE, stdout=sp.PIPE, text=True) as espresso:             # <<<<<<<<<<<<<<
  *             espresso.stdin.write(self.to_espresso())
  *             espresso.stdin.close()
  */
         }
@@ -38866,36 +39003,36 @@
         __Pyx_XDECREF(__pyx_t_1); __pyx_t_1 = 0;
         __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
         __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
         __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
         __Pyx_XDECREF(__pyx_t_5); __pyx_t_5 = 0;
         /*except:*/ {
           __Pyx_AddTraceback("sat_toolkit.formula.CNF.minimize_espresso", __pyx_clineno, __pyx_lineno, __pyx_filename);
-          if (__Pyx_GetException(&__pyx_t_1, &__pyx_t_3, &__pyx_t_2) < 0) __PYX_ERR(0, 1080, __pyx_L9_except_error)
+          if (__Pyx_GetException(&__pyx_t_1, &__pyx_t_3, &__pyx_t_2) < 0) __PYX_ERR(0, 1087, __pyx_L9_except_error)
           __Pyx_XGOTREF(__pyx_t_1);
           __Pyx_XGOTREF(__pyx_t_3);
           __Pyx_XGOTREF(__pyx_t_2);
-          __pyx_t_4 = PyTuple_Pack(3, __pyx_t_1, __pyx_t_3, __pyx_t_2); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1080, __pyx_L9_except_error)
+          __pyx_t_4 = PyTuple_Pack(3, __pyx_t_1, __pyx_t_3, __pyx_t_2); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1087, __pyx_L9_except_error)
           __Pyx_GOTREF(__pyx_t_4);
           __pyx_t_12 = __Pyx_PyObject_Call(__pyx_t_6, __pyx_t_4, NULL);
           __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
           __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-          if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 1080, __pyx_L9_except_error)
+          if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 1087, __pyx_L9_except_error)
           __Pyx_GOTREF(__pyx_t_12);
           __pyx_t_11 = __Pyx_PyObject_IsTrue(__pyx_t_12);
           __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;
-          if (__pyx_t_11 < 0) __PYX_ERR(0, 1080, __pyx_L9_except_error)
+          if (__pyx_t_11 < 0) __PYX_ERR(0, 1087, __pyx_L9_except_error)
           __pyx_t_13 = (!__pyx_t_11);
           if (unlikely(__pyx_t_13)) {
             __Pyx_GIVEREF(__pyx_t_1);
             __Pyx_GIVEREF(__pyx_t_3);
             __Pyx_XGIVEREF(__pyx_t_2);
             __Pyx_ErrRestoreWithState(__pyx_t_1, __pyx_t_3, __pyx_t_2);
             __pyx_t_1 = 0; __pyx_t_3 = 0; __pyx_t_2 = 0; 
-            __PYX_ERR(0, 1080, __pyx_L9_except_error)
+            __PYX_ERR(0, 1087, __pyx_L9_except_error)
           }
           __Pyx_XDECREF(__pyx_t_1); __pyx_t_1 = 0;
           __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
           __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
           goto __pyx_L8_exception_handled;
         }
         __pyx_L9_except_error:;
@@ -38918,27 +39055,27 @@
       }
     }
     /*finally:*/ {
       /*normal exit:*/{
         if (__pyx_t_6) {
           __pyx_t_10 = __Pyx_PyObject_Call(__pyx_t_6, __pyx_tuple__35, NULL);
           __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-          if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1080, __pyx_L1_error)
+          if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1087, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_10);
           __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
         }
         goto __pyx_L6;
       }
       __pyx_L4_return: {
         __pyx_t_14 = __pyx_r;
         __pyx_r = 0;
         if (__pyx_t_6) {
           __pyx_t_10 = __Pyx_PyObject_Call(__pyx_t_6, __pyx_tuple__35, NULL);
           __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-          if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1080, __pyx_L1_error)
+          if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1087, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_10);
           __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
         }
         __pyx_r = __pyx_t_14;
         __pyx_t_14 = 0;
         goto __pyx_L0;
       }
@@ -38947,15 +39084,15 @@
     goto __pyx_L17;
     __pyx_L3_error:;
     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
     goto __pyx_L1_error;
     __pyx_L17:;
   }
 
-  /* "sat_toolkit/formula.pyx":1069
+  /* "sat_toolkit/formula.pyx":1076
  *         return py_bytes.decode()
  * 
  *     def minimize_espresso(self, espresso_args: List[str] = []) -> CNF:             # <<<<<<<<<<<<<<
  *         """
  *         Uses espresso to minimize the given CNF.
  */
 
@@ -38974,15 +39111,15 @@
   __Pyx_XDECREF(__pyx_v_espresso);
   __Pyx_XDECREF(__pyx_v_cnf);
   __Pyx_XGIVEREF((PyObject *)__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "sat_toolkit/formula.pyx":1092
+/* "sat_toolkit/formula.pyx":1099
  *             return cnf
  * 
  *     def _minimize_dimacs(self, args: List[str], outfile: str) -> CNF:             # <<<<<<<<<<<<<<
  *         """
  *         calls args with self.to_dimacs() as stdin, waits for the command to
  */
 
@@ -39039,57 +39176,57 @@
       kw_args = __Pyx_NumKwargs_FASTCALL(__pyx_kwds);
       switch (__pyx_nargs) {
         case  0:
         if (likely((values[0] = __Pyx_GetKwValue_FASTCALL(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_args)) != 0)) {
           (void)__Pyx_Arg_NewRef_FASTCALL(values[0]);
           kw_args--;
         }
-        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 1092, __pyx_L3_error)
+        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 1099, __pyx_L3_error)
         else goto __pyx_L5_argtuple_error;
         CYTHON_FALLTHROUGH;
         case  1:
         if (likely((values[1] = __Pyx_GetKwValue_FASTCALL(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_outfile)) != 0)) {
           (void)__Pyx_Arg_NewRef_FASTCALL(values[1]);
           kw_args--;
         }
-        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 1092, __pyx_L3_error)
+        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 1099, __pyx_L3_error)
         else {
-          __Pyx_RaiseArgtupleInvalid("_minimize_dimacs", 1, 2, 2, 1); __PYX_ERR(0, 1092, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("_minimize_dimacs", 1, 2, 2, 1); __PYX_ERR(0, 1099, __pyx_L3_error)
         }
       }
       if (unlikely(kw_args > 0)) {
         const Py_ssize_t kwd_pos_args = __pyx_nargs;
-        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values + 0, kwd_pos_args, "_minimize_dimacs") < 0)) __PYX_ERR(0, 1092, __pyx_L3_error)
+        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values + 0, kwd_pos_args, "_minimize_dimacs") < 0)) __PYX_ERR(0, 1099, __pyx_L3_error)
       }
     } else if (unlikely(__pyx_nargs != 2)) {
       goto __pyx_L5_argtuple_error;
     } else {
       values[0] = __Pyx_Arg_FASTCALL(__pyx_args, 0);
       values[1] = __Pyx_Arg_FASTCALL(__pyx_args, 1);
     }
     __pyx_v_args = values[0];
     __pyx_v_outfile = ((PyObject*)values[1]);
   }
   goto __pyx_L6_skip;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("_minimize_dimacs", 1, 2, 2, __pyx_nargs); __PYX_ERR(0, 1092, __pyx_L3_error)
+  __Pyx_RaiseArgtupleInvalid("_minimize_dimacs", 1, 2, 2, __pyx_nargs); __PYX_ERR(0, 1099, __pyx_L3_error)
   __pyx_L6_skip:;
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L3_error:;
   {
     Py_ssize_t __pyx_temp;
     for (__pyx_temp=0; __pyx_temp < (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
       __Pyx_Arg_XDECREF_FASTCALL(values[__pyx_temp]);
     }
   }
   __Pyx_AddTraceback("sat_toolkit.formula.CNF._minimize_dimacs", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __Pyx_RefNannyFinishContext();
   return NULL;
   __pyx_L4_argument_unpacking_done:;
-  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_outfile), (&PyUnicode_Type), 0, "outfile", 1))) __PYX_ERR(0, 1092, __pyx_L1_error)
+  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_outfile), (&PyUnicode_Type), 0, "outfile", 1))) __PYX_ERR(0, 1099, __pyx_L1_error)
   __pyx_r = __pyx_pf_11sat_toolkit_7formula_3CNF_26_minimize_dimacs(((struct __pyx_obj_11sat_toolkit_7formula_CNF *)__pyx_v_self), __pyx_v_args, __pyx_v_outfile);
 
   /* function exit code */
   goto __pyx_L0;
   __pyx_L1_error:;
   __pyx_r = NULL;
   __pyx_L0:;
@@ -39124,59 +39261,59 @@
   PyObject *__pyx_t_13 = NULL;
   struct __pyx_obj_11sat_toolkit_7formula_CNF *__pyx_t_14 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("_minimize_dimacs", 1);
 
-  /* "sat_toolkit/formula.pyx":1100
+  /* "sat_toolkit/formula.pyx":1107
  *         :rtype: CNF
  *         """
  *         cdef int ret_code = 0             # <<<<<<<<<<<<<<
  *         with sp.Popen(args, stdin=sp.PIPE, text=True) as minimizer:
  *             minimizer.stdin.write(self.to_dimacs())
  */
   __pyx_v_ret_code = 0;
 
-  /* "sat_toolkit/formula.pyx":1101
+  /* "sat_toolkit/formula.pyx":1108
  *         """
  *         cdef int ret_code = 0
  *         with sp.Popen(args, stdin=sp.PIPE, text=True) as minimizer:             # <<<<<<<<<<<<<<
  *             minimizer.stdin.write(self.to_dimacs())
  *             minimizer.stdin.close()
  */
   /*with:*/ {
-    __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_sp); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1101, __pyx_L1_error)
+    __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_sp); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1108, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
-    __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_Popen); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1101, __pyx_L1_error)
+    __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_Popen); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1108, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-    __pyx_t_1 = PyTuple_New(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1101, __pyx_L1_error)
+    __pyx_t_1 = PyTuple_New(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1108, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_INCREF(__pyx_v_args);
     __Pyx_GIVEREF(__pyx_v_args);
-    if (__Pyx_PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_v_args)) __PYX_ERR(0, 1101, __pyx_L1_error);
-    __pyx_t_3 = __Pyx_PyDict_NewPresized(2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1101, __pyx_L1_error)
+    if (__Pyx_PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_v_args)) __PYX_ERR(0, 1108, __pyx_L1_error);
+    __pyx_t_3 = __Pyx_PyDict_NewPresized(2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1108, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
-    __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_sp); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1101, __pyx_L1_error)
+    __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_sp); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1108, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
-    __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_PIPE); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1101, __pyx_L1_error)
+    __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_PIPE); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1108, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-    if (PyDict_SetItem(__pyx_t_3, __pyx_n_s_stdin, __pyx_t_5) < 0) __PYX_ERR(0, 1101, __pyx_L1_error)
+    if (PyDict_SetItem(__pyx_t_3, __pyx_n_s_stdin, __pyx_t_5) < 0) __PYX_ERR(0, 1108, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-    if (PyDict_SetItem(__pyx_t_3, __pyx_n_s_text, Py_True) < 0) __PYX_ERR(0, 1101, __pyx_L1_error)
-    __pyx_t_5 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_t_1, __pyx_t_3); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1101, __pyx_L1_error)
+    if (PyDict_SetItem(__pyx_t_3, __pyx_n_s_text, Py_True) < 0) __PYX_ERR(0, 1108, __pyx_L1_error)
+    __pyx_t_5 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_t_1, __pyx_t_3); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1108, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-    __pyx_t_6 = __Pyx_PyObject_LookupSpecial(__pyx_t_5, __pyx_n_s_exit); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1101, __pyx_L1_error)
+    __pyx_t_6 = __Pyx_PyObject_LookupSpecial(__pyx_t_5, __pyx_n_s_exit); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1108, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
-    __pyx_t_1 = __Pyx_PyObject_LookupSpecial(__pyx_t_5, __pyx_n_s_enter); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1101, __pyx_L3_error)
+    __pyx_t_1 = __Pyx_PyObject_LookupSpecial(__pyx_t_5, __pyx_n_s_enter); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1108, __pyx_L3_error)
     __Pyx_GOTREF(__pyx_t_1);
     __pyx_t_2 = NULL;
     __pyx_t_7 = 0;
     #if CYTHON_UNPACK_METHODS
     if (likely(PyMethod_Check(__pyx_t_1))) {
       __pyx_t_2 = PyMethod_GET_SELF(__pyx_t_1);
       if (likely(__pyx_t_2)) {
@@ -39188,15 +39325,15 @@
       }
     }
     #endif
     {
       PyObject *__pyx_callargs[2] = {__pyx_t_2, NULL};
       __pyx_t_3 = __Pyx_PyObject_FastCall(__pyx_t_1, __pyx_callargs+1-__pyx_t_7, 0+__pyx_t_7);
       __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
-      if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1101, __pyx_L3_error)
+      if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1108, __pyx_L3_error)
       __Pyx_GOTREF(__pyx_t_3);
       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
     }
     __pyx_t_1 = __pyx_t_3;
     __pyx_t_3 = 0;
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
     /*try:*/ {
@@ -39207,27 +39344,27 @@
         __Pyx_XGOTREF(__pyx_t_8);
         __Pyx_XGOTREF(__pyx_t_9);
         __Pyx_XGOTREF(__pyx_t_10);
         /*try:*/ {
           __pyx_v_minimizer = __pyx_t_1;
           __pyx_t_1 = 0;
 
-          /* "sat_toolkit/formula.pyx":1102
+          /* "sat_toolkit/formula.pyx":1109
  *         cdef int ret_code = 0
  *         with sp.Popen(args, stdin=sp.PIPE, text=True) as minimizer:
  *             minimizer.stdin.write(self.to_dimacs())             # <<<<<<<<<<<<<<
  *             minimizer.stdin.close()
  * 
  */
-          __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_v_minimizer, __pyx_n_s_stdin); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1102, __pyx_L7_error)
+          __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_v_minimizer, __pyx_n_s_stdin); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1109, __pyx_L7_error)
           __Pyx_GOTREF(__pyx_t_5);
-          __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_write); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1102, __pyx_L7_error)
+          __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_write); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1109, __pyx_L7_error)
           __Pyx_GOTREF(__pyx_t_3);
           __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-          __pyx_t_2 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_self), __pyx_n_s_to_dimacs); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1102, __pyx_L7_error)
+          __pyx_t_2 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_self), __pyx_n_s_to_dimacs); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1109, __pyx_L7_error)
           __Pyx_GOTREF(__pyx_t_2);
           __pyx_t_4 = NULL;
           __pyx_t_7 = 0;
           #if CYTHON_UNPACK_METHODS
           if (likely(PyMethod_Check(__pyx_t_2))) {
             __pyx_t_4 = PyMethod_GET_SELF(__pyx_t_2);
             if (likely(__pyx_t_4)) {
@@ -39239,15 +39376,15 @@
             }
           }
           #endif
           {
             PyObject *__pyx_callargs[2] = {__pyx_t_4, NULL};
             __pyx_t_5 = __Pyx_PyObject_FastCall(__pyx_t_2, __pyx_callargs+1-__pyx_t_7, 0+__pyx_t_7);
             __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
-            if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1102, __pyx_L7_error)
+            if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1109, __pyx_L7_error)
             __Pyx_GOTREF(__pyx_t_5);
             __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
           }
           __pyx_t_2 = NULL;
           __pyx_t_7 = 0;
           #if CYTHON_UNPACK_METHODS
           if (likely(PyMethod_Check(__pyx_t_3))) {
@@ -39262,30 +39399,30 @@
           }
           #endif
           {
             PyObject *__pyx_callargs[2] = {__pyx_t_2, __pyx_t_5};
             __pyx_t_1 = __Pyx_PyObject_FastCall(__pyx_t_3, __pyx_callargs+1-__pyx_t_7, 1+__pyx_t_7);
             __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
             __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-            if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1102, __pyx_L7_error)
+            if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1109, __pyx_L7_error)
             __Pyx_GOTREF(__pyx_t_1);
             __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
           }
           __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-          /* "sat_toolkit/formula.pyx":1103
+          /* "sat_toolkit/formula.pyx":1110
  *         with sp.Popen(args, stdin=sp.PIPE, text=True) as minimizer:
  *             minimizer.stdin.write(self.to_dimacs())
  *             minimizer.stdin.close()             # <<<<<<<<<<<<<<
  * 
  *             ret_code = minimizer.wait()
  */
-          __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_v_minimizer, __pyx_n_s_stdin); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1103, __pyx_L7_error)
+          __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_v_minimizer, __pyx_n_s_stdin); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1110, __pyx_L7_error)
           __Pyx_GOTREF(__pyx_t_3);
-          __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_close); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1103, __pyx_L7_error)
+          __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_close); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1110, __pyx_L7_error)
           __Pyx_GOTREF(__pyx_t_5);
           __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
           __pyx_t_3 = NULL;
           __pyx_t_7 = 0;
           #if CYTHON_UNPACK_METHODS
           if (likely(PyMethod_Check(__pyx_t_5))) {
             __pyx_t_3 = PyMethod_GET_SELF(__pyx_t_5);
@@ -39298,28 +39435,28 @@
             }
           }
           #endif
           {
             PyObject *__pyx_callargs[2] = {__pyx_t_3, NULL};
             __pyx_t_1 = __Pyx_PyObject_FastCall(__pyx_t_5, __pyx_callargs+1-__pyx_t_7, 0+__pyx_t_7);
             __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
-            if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1103, __pyx_L7_error)
+            if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1110, __pyx_L7_error)
             __Pyx_GOTREF(__pyx_t_1);
             __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
           }
           __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-          /* "sat_toolkit/formula.pyx":1105
+          /* "sat_toolkit/formula.pyx":1112
  *             minimizer.stdin.close()
  * 
  *             ret_code = minimizer.wait()             # <<<<<<<<<<<<<<
  *             if ret_code not in [10, 20]:
  *                 # for SAT solvers ret_code == 10 corresponds to SATISFIABLE and
  */
-          __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_v_minimizer, __pyx_n_s_wait); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1105, __pyx_L7_error)
+          __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_v_minimizer, __pyx_n_s_wait); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1112, __pyx_L7_error)
           __Pyx_GOTREF(__pyx_t_5);
           __pyx_t_3 = NULL;
           __pyx_t_7 = 0;
           #if CYTHON_UNPACK_METHODS
           if (likely(PyMethod_Check(__pyx_t_5))) {
             __pyx_t_3 = PyMethod_GET_SELF(__pyx_t_5);
             if (likely(__pyx_t_3)) {
@@ -39331,23 +39468,23 @@
             }
           }
           #endif
           {
             PyObject *__pyx_callargs[2] = {__pyx_t_3, NULL};
             __pyx_t_1 = __Pyx_PyObject_FastCall(__pyx_t_5, __pyx_callargs+1-__pyx_t_7, 0+__pyx_t_7);
             __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
-            if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1105, __pyx_L7_error)
+            if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1112, __pyx_L7_error)
             __Pyx_GOTREF(__pyx_t_1);
             __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
           }
-          __pyx_t_7 = __Pyx_PyInt_As_int(__pyx_t_1); if (unlikely((__pyx_t_7 == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 1105, __pyx_L7_error)
+          __pyx_t_7 = __Pyx_PyInt_As_int(__pyx_t_1); if (unlikely((__pyx_t_7 == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 1112, __pyx_L7_error)
           __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
           __pyx_v_ret_code = __pyx_t_7;
 
-          /* "sat_toolkit/formula.pyx":1106
+          /* "sat_toolkit/formula.pyx":1113
  * 
  *             ret_code = minimizer.wait()
  *             if ret_code not in [10, 20]:             # <<<<<<<<<<<<<<
  *                 # for SAT solvers ret_code == 10 corresponds to SATISFIABLE and
  *                 # ret == 20 to UNSATISFIABLE (see for example
  */
           switch (__pyx_v_ret_code) {
@@ -39358,31 +39495,31 @@
             default:
             __pyx_t_11 = 1;
             break;
           }
           __pyx_t_12 = __pyx_t_11;
           if (unlikely(__pyx_t_12)) {
 
-            /* "sat_toolkit/formula.pyx":1110
+            /* "sat_toolkit/formula.pyx":1117
  *                 # ret == 20 to UNSATISFIABLE (see for example
  *                 # http://www.satcompetition.org/2004/format-solvers2004.html)
  *                 raise sp.CalledProcessError(ret_code, ' '.join(minimizer.args))             # <<<<<<<<<<<<<<
  * 
  *         with open(outfile, 'r') as f:
  */
-            __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_sp); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1110, __pyx_L7_error)
+            __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_sp); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1117, __pyx_L7_error)
             __Pyx_GOTREF(__pyx_t_5);
-            __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_CalledProcessError); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1110, __pyx_L7_error)
+            __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_CalledProcessError); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1117, __pyx_L7_error)
             __Pyx_GOTREF(__pyx_t_3);
             __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-            __pyx_t_5 = __Pyx_PyInt_From_int(__pyx_v_ret_code); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1110, __pyx_L7_error)
+            __pyx_t_5 = __Pyx_PyInt_From_int(__pyx_v_ret_code); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1117, __pyx_L7_error)
             __Pyx_GOTREF(__pyx_t_5);
-            __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_minimizer, __pyx_n_s_args); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1110, __pyx_L7_error)
+            __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_minimizer, __pyx_n_s_args); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1117, __pyx_L7_error)
             __Pyx_GOTREF(__pyx_t_2);
-            __pyx_t_4 = PyUnicode_Join(__pyx_kp_u__32, __pyx_t_2); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1110, __pyx_L7_error)
+            __pyx_t_4 = PyUnicode_Join(__pyx_kp_u__32, __pyx_t_2); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1117, __pyx_L7_error)
             __Pyx_GOTREF(__pyx_t_4);
             __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
             __pyx_t_2 = NULL;
             __pyx_t_7 = 0;
             #if CYTHON_UNPACK_METHODS
             if (unlikely(PyMethod_Check(__pyx_t_3))) {
               __pyx_t_2 = PyMethod_GET_SELF(__pyx_t_3);
@@ -39397,32 +39534,32 @@
             #endif
             {
               PyObject *__pyx_callargs[3] = {__pyx_t_2, __pyx_t_5, __pyx_t_4};
               __pyx_t_1 = __Pyx_PyObject_FastCall(__pyx_t_3, __pyx_callargs+1-__pyx_t_7, 2+__pyx_t_7);
               __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
               __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
               __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-              if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1110, __pyx_L7_error)
+              if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1117, __pyx_L7_error)
               __Pyx_GOTREF(__pyx_t_1);
               __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
             }
             __Pyx_Raise(__pyx_t_1, 0, 0, 0);
             __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-            __PYX_ERR(0, 1110, __pyx_L7_error)
+            __PYX_ERR(0, 1117, __pyx_L7_error)
 
-            /* "sat_toolkit/formula.pyx":1106
+            /* "sat_toolkit/formula.pyx":1113
  * 
  *             ret_code = minimizer.wait()
  *             if ret_code not in [10, 20]:             # <<<<<<<<<<<<<<
  *                 # for SAT solvers ret_code == 10 corresponds to SATISFIABLE and
  *                 # ret == 20 to UNSATISFIABLE (see for example
  */
           }
 
-          /* "sat_toolkit/formula.pyx":1101
+          /* "sat_toolkit/formula.pyx":1108
  *         """
  *         cdef int ret_code = 0
  *         with sp.Popen(args, stdin=sp.PIPE, text=True) as minimizer:             # <<<<<<<<<<<<<<
  *             minimizer.stdin.write(self.to_dimacs())
  *             minimizer.stdin.close()
  */
         }
@@ -39434,36 +39571,36 @@
         __Pyx_XDECREF(__pyx_t_1); __pyx_t_1 = 0;
         __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
         __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
         __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
         __Pyx_XDECREF(__pyx_t_5); __pyx_t_5 = 0;
         /*except:*/ {
           __Pyx_AddTraceback("sat_toolkit.formula.CNF._minimize_dimacs", __pyx_clineno, __pyx_lineno, __pyx_filename);
-          if (__Pyx_GetException(&__pyx_t_1, &__pyx_t_3, &__pyx_t_4) < 0) __PYX_ERR(0, 1101, __pyx_L9_except_error)
+          if (__Pyx_GetException(&__pyx_t_1, &__pyx_t_3, &__pyx_t_4) < 0) __PYX_ERR(0, 1108, __pyx_L9_except_error)
           __Pyx_XGOTREF(__pyx_t_1);
           __Pyx_XGOTREF(__pyx_t_3);
           __Pyx_XGOTREF(__pyx_t_4);
-          __pyx_t_5 = PyTuple_Pack(3, __pyx_t_1, __pyx_t_3, __pyx_t_4); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1101, __pyx_L9_except_error)
+          __pyx_t_5 = PyTuple_Pack(3, __pyx_t_1, __pyx_t_3, __pyx_t_4); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1108, __pyx_L9_except_error)
           __Pyx_GOTREF(__pyx_t_5);
           __pyx_t_13 = __Pyx_PyObject_Call(__pyx_t_6, __pyx_t_5, NULL);
           __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
           __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-          if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 1101, __pyx_L9_except_error)
+          if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 1108, __pyx_L9_except_error)
           __Pyx_GOTREF(__pyx_t_13);
           __pyx_t_12 = __Pyx_PyObject_IsTrue(__pyx_t_13);
           __Pyx_DECREF(__pyx_t_13); __pyx_t_13 = 0;
-          if (__pyx_t_12 < 0) __PYX_ERR(0, 1101, __pyx_L9_except_error)
+          if (__pyx_t_12 < 0) __PYX_ERR(0, 1108, __pyx_L9_except_error)
           __pyx_t_11 = (!__pyx_t_12);
           if (unlikely(__pyx_t_11)) {
             __Pyx_GIVEREF(__pyx_t_1);
             __Pyx_GIVEREF(__pyx_t_3);
             __Pyx_XGIVEREF(__pyx_t_4);
             __Pyx_ErrRestoreWithState(__pyx_t_1, __pyx_t_3, __pyx_t_4);
             __pyx_t_1 = 0; __pyx_t_3 = 0; __pyx_t_4 = 0; 
-            __PYX_ERR(0, 1101, __pyx_L9_except_error)
+            __PYX_ERR(0, 1108, __pyx_L9_except_error)
           }
           __Pyx_XDECREF(__pyx_t_1); __pyx_t_1 = 0;
           __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
           __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
           goto __pyx_L8_exception_handled;
         }
         __pyx_L9_except_error:;
@@ -39481,51 +39618,51 @@
       }
     }
     /*finally:*/ {
       /*normal exit:*/{
         if (__pyx_t_6) {
           __pyx_t_10 = __Pyx_PyObject_Call(__pyx_t_6, __pyx_tuple__35, NULL);
           __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-          if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1101, __pyx_L1_error)
+          if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1108, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_10);
           __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
         }
         goto __pyx_L6;
       }
       __pyx_L6:;
     }
     goto __pyx_L17;
     __pyx_L3_error:;
     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
     goto __pyx_L1_error;
     __pyx_L17:;
   }
 
-  /* "sat_toolkit/formula.pyx":1112
+  /* "sat_toolkit/formula.pyx":1119
  *                 raise sp.CalledProcessError(ret_code, ' '.join(minimizer.args))
  * 
  *         with open(outfile, 'r') as f:             # <<<<<<<<<<<<<<
  *             return CNF.from_dimacs(f.read())
  * 
  */
   /*with:*/ {
-    __pyx_t_4 = PyTuple_New(2); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1112, __pyx_L1_error)
+    __pyx_t_4 = PyTuple_New(2); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1119, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
     __Pyx_INCREF(__pyx_v_outfile);
     __Pyx_GIVEREF(__pyx_v_outfile);
-    if (__Pyx_PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_v_outfile)) __PYX_ERR(0, 1112, __pyx_L1_error);
+    if (__Pyx_PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_v_outfile)) __PYX_ERR(0, 1119, __pyx_L1_error);
     __Pyx_INCREF(__pyx_n_u_r);
     __Pyx_GIVEREF(__pyx_n_u_r);
-    if (__Pyx_PyTuple_SET_ITEM(__pyx_t_4, 1, __pyx_n_u_r)) __PYX_ERR(0, 1112, __pyx_L1_error);
-    __pyx_t_3 = __Pyx_PyObject_Call(__pyx_builtin_open, __pyx_t_4, NULL); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1112, __pyx_L1_error)
+    if (__Pyx_PyTuple_SET_ITEM(__pyx_t_4, 1, __pyx_n_u_r)) __PYX_ERR(0, 1119, __pyx_L1_error);
+    __pyx_t_3 = __Pyx_PyObject_Call(__pyx_builtin_open, __pyx_t_4, NULL); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1119, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-    __pyx_t_6 = __Pyx_PyObject_LookupSpecial(__pyx_t_3, __pyx_n_s_exit); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1112, __pyx_L1_error)
+    __pyx_t_6 = __Pyx_PyObject_LookupSpecial(__pyx_t_3, __pyx_n_s_exit); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1119, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
-    __pyx_t_1 = __Pyx_PyObject_LookupSpecial(__pyx_t_3, __pyx_n_s_enter); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1112, __pyx_L18_error)
+    __pyx_t_1 = __Pyx_PyObject_LookupSpecial(__pyx_t_3, __pyx_n_s_enter); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1119, __pyx_L18_error)
     __Pyx_GOTREF(__pyx_t_1);
     __pyx_t_5 = NULL;
     __pyx_t_7 = 0;
     #if CYTHON_UNPACK_METHODS
     if (likely(PyMethod_Check(__pyx_t_1))) {
       __pyx_t_5 = PyMethod_GET_SELF(__pyx_t_1);
       if (likely(__pyx_t_5)) {
@@ -39537,15 +39674,15 @@
       }
     }
     #endif
     {
       PyObject *__pyx_callargs[2] = {__pyx_t_5, NULL};
       __pyx_t_4 = __Pyx_PyObject_FastCall(__pyx_t_1, __pyx_callargs+1-__pyx_t_7, 0+__pyx_t_7);
       __Pyx_XDECREF(__pyx_t_5); __pyx_t_5 = 0;
-      if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1112, __pyx_L18_error)
+      if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1119, __pyx_L18_error)
       __Pyx_GOTREF(__pyx_t_4);
       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
     }
     __pyx_t_1 = __pyx_t_4;
     __pyx_t_4 = 0;
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
     /*try:*/ {
@@ -39556,25 +39693,25 @@
         __Pyx_XGOTREF(__pyx_t_10);
         __Pyx_XGOTREF(__pyx_t_9);
         __Pyx_XGOTREF(__pyx_t_8);
         /*try:*/ {
           __pyx_v_f = __pyx_t_1;
           __pyx_t_1 = 0;
 
-          /* "sat_toolkit/formula.pyx":1113
+          /* "sat_toolkit/formula.pyx":1120
  * 
  *         with open(outfile, 'r') as f:
  *             return CNF.from_dimacs(f.read())             # <<<<<<<<<<<<<<
  * 
  *     def minimize_lingeling(self, optlevel=None, timeout=0, extra_args: List[str] = []) -> CNF:
  */
           __Pyx_XDECREF((PyObject *)__pyx_r);
-          __pyx_t_3 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_ptype_11sat_toolkit_7formula_CNF), __pyx_n_s_from_dimacs); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1113, __pyx_L22_error)
+          __pyx_t_3 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_ptype_11sat_toolkit_7formula_CNF), __pyx_n_s_from_dimacs); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1120, __pyx_L22_error)
           __Pyx_GOTREF(__pyx_t_3);
-          __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_v_f, __pyx_n_s_read); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1113, __pyx_L22_error)
+          __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_v_f, __pyx_n_s_read); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1120, __pyx_L22_error)
           __Pyx_GOTREF(__pyx_t_5);
           __pyx_t_2 = NULL;
           __pyx_t_7 = 0;
           #if CYTHON_UNPACK_METHODS
           if (likely(PyMethod_Check(__pyx_t_5))) {
             __pyx_t_2 = PyMethod_GET_SELF(__pyx_t_5);
             if (likely(__pyx_t_2)) {
@@ -39586,15 +39723,15 @@
             }
           }
           #endif
           {
             PyObject *__pyx_callargs[2] = {__pyx_t_2, NULL};
             __pyx_t_4 = __Pyx_PyObject_FastCall(__pyx_t_5, __pyx_callargs+1-__pyx_t_7, 0+__pyx_t_7);
             __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
-            if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1113, __pyx_L22_error)
+            if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1120, __pyx_L22_error)
             __Pyx_GOTREF(__pyx_t_4);
             __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
           }
           __pyx_t_5 = NULL;
           __pyx_t_7 = 0;
           #if CYTHON_UNPACK_METHODS
           if (likely(PyMethod_Check(__pyx_t_3))) {
@@ -39609,24 +39746,24 @@
           }
           #endif
           {
             PyObject *__pyx_callargs[2] = {__pyx_t_5, __pyx_t_4};
             __pyx_t_1 = __Pyx_PyObject_FastCall(__pyx_t_3, __pyx_callargs+1-__pyx_t_7, 1+__pyx_t_7);
             __Pyx_XDECREF(__pyx_t_5); __pyx_t_5 = 0;
             __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-            if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1113, __pyx_L22_error)
+            if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1120, __pyx_L22_error)
             __Pyx_GOTREF(__pyx_t_1);
             __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
           }
-          if (!(likely(((__pyx_t_1) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_1, __pyx_ptype_11sat_toolkit_7formula_CNF))))) __PYX_ERR(0, 1113, __pyx_L22_error)
+          if (!(likely(((__pyx_t_1) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_1, __pyx_ptype_11sat_toolkit_7formula_CNF))))) __PYX_ERR(0, 1120, __pyx_L22_error)
           __pyx_r = ((struct __pyx_obj_11sat_toolkit_7formula_CNF *)__pyx_t_1);
           __pyx_t_1 = 0;
           goto __pyx_L26_try_return;
 
-          /* "sat_toolkit/formula.pyx":1112
+          /* "sat_toolkit/formula.pyx":1119
  *                 raise sp.CalledProcessError(ret_code, ' '.join(minimizer.args))
  * 
  *         with open(outfile, 'r') as f:             # <<<<<<<<<<<<<<
  *             return CNF.from_dimacs(f.read())
  * 
  */
         }
@@ -39634,36 +39771,36 @@
         __Pyx_XDECREF(__pyx_t_1); __pyx_t_1 = 0;
         __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
         __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
         __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
         __Pyx_XDECREF(__pyx_t_5); __pyx_t_5 = 0;
         /*except:*/ {
           __Pyx_AddTraceback("sat_toolkit.formula.CNF._minimize_dimacs", __pyx_clineno, __pyx_lineno, __pyx_filename);
-          if (__Pyx_GetException(&__pyx_t_1, &__pyx_t_3, &__pyx_t_4) < 0) __PYX_ERR(0, 1112, __pyx_L24_except_error)
+          if (__Pyx_GetException(&__pyx_t_1, &__pyx_t_3, &__pyx_t_4) < 0) __PYX_ERR(0, 1119, __pyx_L24_except_error)
           __Pyx_XGOTREF(__pyx_t_1);
           __Pyx_XGOTREF(__pyx_t_3);
           __Pyx_XGOTREF(__pyx_t_4);
-          __pyx_t_5 = PyTuple_Pack(3, __pyx_t_1, __pyx_t_3, __pyx_t_4); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1112, __pyx_L24_except_error)
+          __pyx_t_5 = PyTuple_Pack(3, __pyx_t_1, __pyx_t_3, __pyx_t_4); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1119, __pyx_L24_except_error)
           __Pyx_GOTREF(__pyx_t_5);
           __pyx_t_13 = __Pyx_PyObject_Call(__pyx_t_6, __pyx_t_5, NULL);
           __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
           __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-          if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 1112, __pyx_L24_except_error)
+          if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 1119, __pyx_L24_except_error)
           __Pyx_GOTREF(__pyx_t_13);
           __pyx_t_11 = __Pyx_PyObject_IsTrue(__pyx_t_13);
           __Pyx_DECREF(__pyx_t_13); __pyx_t_13 = 0;
-          if (__pyx_t_11 < 0) __PYX_ERR(0, 1112, __pyx_L24_except_error)
+          if (__pyx_t_11 < 0) __PYX_ERR(0, 1119, __pyx_L24_except_error)
           __pyx_t_12 = (!__pyx_t_11);
           if (unlikely(__pyx_t_12)) {
             __Pyx_GIVEREF(__pyx_t_1);
             __Pyx_GIVEREF(__pyx_t_3);
             __Pyx_XGIVEREF(__pyx_t_4);
             __Pyx_ErrRestoreWithState(__pyx_t_1, __pyx_t_3, __pyx_t_4);
             __pyx_t_1 = 0; __pyx_t_3 = 0; __pyx_t_4 = 0; 
-            __PYX_ERR(0, 1112, __pyx_L24_except_error)
+            __PYX_ERR(0, 1119, __pyx_L24_except_error)
           }
           __Pyx_XDECREF(__pyx_t_1); __pyx_t_1 = 0;
           __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
           __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
           goto __pyx_L23_exception_handled;
         }
         __pyx_L24_except_error:;
@@ -39686,27 +39823,27 @@
       }
     }
     /*finally:*/ {
       /*normal exit:*/{
         if (__pyx_t_6) {
           __pyx_t_8 = __Pyx_PyObject_Call(__pyx_t_6, __pyx_tuple__35, NULL);
           __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-          if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1112, __pyx_L1_error)
+          if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1119, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_8);
           __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
         }
         goto __pyx_L21;
       }
       __pyx_L19_return: {
         __pyx_t_14 = __pyx_r;
         __pyx_r = 0;
         if (__pyx_t_6) {
           __pyx_t_8 = __Pyx_PyObject_Call(__pyx_t_6, __pyx_tuple__35, NULL);
           __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-          if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1112, __pyx_L1_error)
+          if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1119, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_8);
           __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
         }
         __pyx_r = __pyx_t_14;
         __pyx_t_14 = 0;
         goto __pyx_L0;
       }
@@ -39715,15 +39852,15 @@
     goto __pyx_L31;
     __pyx_L18_error:;
     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
     goto __pyx_L1_error;
     __pyx_L31:;
   }
 
-  /* "sat_toolkit/formula.pyx":1092
+  /* "sat_toolkit/formula.pyx":1099
  *             return cnf
  * 
  *     def _minimize_dimacs(self, args: List[str], outfile: str) -> CNF:             # <<<<<<<<<<<<<<
  *         """
  *         calls args with self.to_dimacs() as stdin, waits for the command to
  */
 
@@ -39742,15 +39879,15 @@
   __Pyx_XDECREF(__pyx_v_minimizer);
   __Pyx_XDECREF(__pyx_v_f);
   __Pyx_XGIVEREF((PyObject *)__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "sat_toolkit/formula.pyx":1115
+/* "sat_toolkit/formula.pyx":1122
  *             return CNF.from_dimacs(f.read())
  * 
  *     def minimize_lingeling(self, optlevel=None, timeout=0, extra_args: List[str] = []) -> CNF:             # <<<<<<<<<<<<<<
  *         """
  *         Uses Lingeling to minimize the given CNF.
  */
 
@@ -39812,34 +39949,34 @@
       }
       kw_args = __Pyx_NumKwargs_FASTCALL(__pyx_kwds);
       switch (__pyx_nargs) {
         case  0:
         if (kw_args > 0) {
           PyObject* value = __Pyx_GetKwValue_FASTCALL(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_optlevel);
           if (value) { values[0] = __Pyx_Arg_NewRef_FASTCALL(value); kw_args--; }
-          else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 1115, __pyx_L3_error)
+          else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 1122, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  1:
         if (kw_args > 0) {
           PyObject* value = __Pyx_GetKwValue_FASTCALL(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_timeout);
           if (value) { values[1] = __Pyx_Arg_NewRef_FASTCALL(value); kw_args--; }
-          else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 1115, __pyx_L3_error)
+          else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 1122, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  2:
         if (kw_args > 0) {
           PyObject* value = __Pyx_GetKwValue_FASTCALL(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_extra_args);
           if (value) { values[2] = __Pyx_Arg_NewRef_FASTCALL(value); kw_args--; }
-          else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 1115, __pyx_L3_error)
+          else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 1122, __pyx_L3_error)
         }
       }
       if (unlikely(kw_args > 0)) {
         const Py_ssize_t kwd_pos_args = __pyx_nargs;
-        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values + 0, kwd_pos_args, "minimize_lingeling") < 0)) __PYX_ERR(0, 1115, __pyx_L3_error)
+        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values + 0, kwd_pos_args, "minimize_lingeling") < 0)) __PYX_ERR(0, 1122, __pyx_L3_error)
       }
     } else {
       switch (__pyx_nargs) {
         case  3: values[2] = __Pyx_Arg_FASTCALL(__pyx_args, 2);
         CYTHON_FALLTHROUGH;
         case  2: values[1] = __Pyx_Arg_FASTCALL(__pyx_args, 1);
         CYTHON_FALLTHROUGH;
@@ -39851,15 +39988,15 @@
     }
     __pyx_v_optlevel = values[0];
     __pyx_v_timeout = values[1];
     __pyx_v_extra_args = values[2];
   }
   goto __pyx_L6_skip;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("minimize_lingeling", 0, 0, 3, __pyx_nargs); __PYX_ERR(0, 1115, __pyx_L3_error)
+  __Pyx_RaiseArgtupleInvalid("minimize_lingeling", 0, 0, 3, __pyx_nargs); __PYX_ERR(0, 1122, __pyx_L3_error)
   __pyx_L6_skip:;
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L3_error:;
   {
     Py_ssize_t __pyx_temp;
     for (__pyx_temp=0; __pyx_temp < (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
       __Pyx_Arg_XDECREF_FASTCALL(values[__pyx_temp]);
@@ -39902,146 +40039,146 @@
   int __pyx_t_12;
   struct __pyx_obj_11sat_toolkit_7formula_CNF *__pyx_t_13 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("minimize_lingeling", 1);
 
-  /* "sat_toolkit/formula.pyx":1126
+  /* "sat_toolkit/formula.pyx":1133
  *         :rtype: CNF
  *         """
  *         cdef int ret_code = 0             # <<<<<<<<<<<<<<
  * 
  *         args = ['lingeling', '-s']
  */
   __pyx_v_ret_code = 0;
 
-  /* "sat_toolkit/formula.pyx":1128
+  /* "sat_toolkit/formula.pyx":1135
  *         cdef int ret_code = 0
  * 
  *         args = ['lingeling', '-s']             # <<<<<<<<<<<<<<
  *         if optlevel is not None:
  *             args += [f'-O{optlevel}']
  */
-  __pyx_t_1 = PyList_New(2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1128, __pyx_L1_error)
+  __pyx_t_1 = PyList_New(2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1135, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_INCREF(__pyx_n_u_lingeling);
   __Pyx_GIVEREF(__pyx_n_u_lingeling);
-  if (__Pyx_PyList_SET_ITEM(__pyx_t_1, 0, __pyx_n_u_lingeling)) __PYX_ERR(0, 1128, __pyx_L1_error);
+  if (__Pyx_PyList_SET_ITEM(__pyx_t_1, 0, __pyx_n_u_lingeling)) __PYX_ERR(0, 1135, __pyx_L1_error);
   __Pyx_INCREF(__pyx_kp_u_s);
   __Pyx_GIVEREF(__pyx_kp_u_s);
-  if (__Pyx_PyList_SET_ITEM(__pyx_t_1, 1, __pyx_kp_u_s)) __PYX_ERR(0, 1128, __pyx_L1_error);
+  if (__Pyx_PyList_SET_ITEM(__pyx_t_1, 1, __pyx_kp_u_s)) __PYX_ERR(0, 1135, __pyx_L1_error);
   __pyx_v_args = __pyx_t_1;
   __pyx_t_1 = 0;
 
-  /* "sat_toolkit/formula.pyx":1129
+  /* "sat_toolkit/formula.pyx":1136
  * 
  *         args = ['lingeling', '-s']
  *         if optlevel is not None:             # <<<<<<<<<<<<<<
  *             args += [f'-O{optlevel}']
  *         if timeout is not None:
  */
   __pyx_t_2 = (__pyx_v_optlevel != Py_None);
   if (__pyx_t_2) {
 
-    /* "sat_toolkit/formula.pyx":1130
+    /* "sat_toolkit/formula.pyx":1137
  *         args = ['lingeling', '-s']
  *         if optlevel is not None:
  *             args += [f'-O{optlevel}']             # <<<<<<<<<<<<<<
  *         if timeout is not None:
  *             args += ['-T', f'{timeout}']
  */
-    __pyx_t_1 = __Pyx_PyObject_FormatSimple(__pyx_v_optlevel, __pyx_empty_unicode); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1130, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyObject_FormatSimple(__pyx_v_optlevel, __pyx_empty_unicode); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1137, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
-    __pyx_t_3 = __Pyx_PyUnicode_Concat(__pyx_kp_u_O_2, __pyx_t_1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1130, __pyx_L1_error)
+    __pyx_t_3 = __Pyx_PyUnicode_Concat(__pyx_kp_u_O_2, __pyx_t_1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1137, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-    __pyx_t_1 = PyList_New(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1130, __pyx_L1_error)
+    __pyx_t_1 = PyList_New(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1137, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_GIVEREF(__pyx_t_3);
-    if (__Pyx_PyList_SET_ITEM(__pyx_t_1, 0, __pyx_t_3)) __PYX_ERR(0, 1130, __pyx_L1_error);
+    if (__Pyx_PyList_SET_ITEM(__pyx_t_1, 0, __pyx_t_3)) __PYX_ERR(0, 1137, __pyx_L1_error);
     __pyx_t_3 = 0;
-    __pyx_t_3 = PyNumber_InPlaceAdd(__pyx_v_args, __pyx_t_1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1130, __pyx_L1_error)
+    __pyx_t_3 = PyNumber_InPlaceAdd(__pyx_v_args, __pyx_t_1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1137, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
     __Pyx_DECREF_SET(__pyx_v_args, __pyx_t_3);
     __pyx_t_3 = 0;
 
-    /* "sat_toolkit/formula.pyx":1129
+    /* "sat_toolkit/formula.pyx":1136
  * 
  *         args = ['lingeling', '-s']
  *         if optlevel is not None:             # <<<<<<<<<<<<<<
  *             args += [f'-O{optlevel}']
  *         if timeout is not None:
  */
   }
 
-  /* "sat_toolkit/formula.pyx":1131
+  /* "sat_toolkit/formula.pyx":1138
  *         if optlevel is not None:
  *             args += [f'-O{optlevel}']
  *         if timeout is not None:             # <<<<<<<<<<<<<<
  *             args += ['-T', f'{timeout}']
  * 
  */
   __pyx_t_2 = (__pyx_v_timeout != Py_None);
   if (__pyx_t_2) {
 
-    /* "sat_toolkit/formula.pyx":1132
+    /* "sat_toolkit/formula.pyx":1139
  *             args += [f'-O{optlevel}']
  *         if timeout is not None:
  *             args += ['-T', f'{timeout}']             # <<<<<<<<<<<<<<
  * 
  *         with NamedTemporaryFile(prefix='lingeling_', suffix='.cnf') as f:
  */
-    __pyx_t_3 = __Pyx_PyObject_FormatSimple(__pyx_v_timeout, __pyx_empty_unicode); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1132, __pyx_L1_error)
+    __pyx_t_3 = __Pyx_PyObject_FormatSimple(__pyx_v_timeout, __pyx_empty_unicode); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1139, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
-    __pyx_t_1 = PyList_New(2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1132, __pyx_L1_error)
+    __pyx_t_1 = PyList_New(2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1139, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_INCREF(__pyx_kp_u_T_2);
     __Pyx_GIVEREF(__pyx_kp_u_T_2);
-    if (__Pyx_PyList_SET_ITEM(__pyx_t_1, 0, __pyx_kp_u_T_2)) __PYX_ERR(0, 1132, __pyx_L1_error);
+    if (__Pyx_PyList_SET_ITEM(__pyx_t_1, 0, __pyx_kp_u_T_2)) __PYX_ERR(0, 1139, __pyx_L1_error);
     __Pyx_GIVEREF(__pyx_t_3);
-    if (__Pyx_PyList_SET_ITEM(__pyx_t_1, 1, __pyx_t_3)) __PYX_ERR(0, 1132, __pyx_L1_error);
+    if (__Pyx_PyList_SET_ITEM(__pyx_t_1, 1, __pyx_t_3)) __PYX_ERR(0, 1139, __pyx_L1_error);
     __pyx_t_3 = 0;
-    __pyx_t_3 = PyNumber_InPlaceAdd(__pyx_v_args, __pyx_t_1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1132, __pyx_L1_error)
+    __pyx_t_3 = PyNumber_InPlaceAdd(__pyx_v_args, __pyx_t_1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1139, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
     __Pyx_DECREF_SET(__pyx_v_args, __pyx_t_3);
     __pyx_t_3 = 0;
 
-    /* "sat_toolkit/formula.pyx":1131
+    /* "sat_toolkit/formula.pyx":1138
  *         if optlevel is not None:
  *             args += [f'-O{optlevel}']
  *         if timeout is not None:             # <<<<<<<<<<<<<<
  *             args += ['-T', f'{timeout}']
  * 
  */
   }
 
-  /* "sat_toolkit/formula.pyx":1134
+  /* "sat_toolkit/formula.pyx":1141
  *             args += ['-T', f'{timeout}']
  * 
  *         with NamedTemporaryFile(prefix='lingeling_', suffix='.cnf') as f:             # <<<<<<<<<<<<<<
  *             args += ['-o', f.name]
  *             args += extra_args
  */
   /*with:*/ {
-    __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_NamedTemporaryFile); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1134, __pyx_L1_error)
+    __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_NamedTemporaryFile); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1141, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
-    __pyx_t_1 = __Pyx_PyDict_NewPresized(2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1134, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyDict_NewPresized(2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1141, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
-    if (PyDict_SetItem(__pyx_t_1, __pyx_n_s_prefix, __pyx_n_u_lingeling_2) < 0) __PYX_ERR(0, 1134, __pyx_L1_error)
-    if (PyDict_SetItem(__pyx_t_1, __pyx_n_s_suffix, __pyx_kp_u_cnf) < 0) __PYX_ERR(0, 1134, __pyx_L1_error)
-    __pyx_t_4 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_empty_tuple, __pyx_t_1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1134, __pyx_L1_error)
+    if (PyDict_SetItem(__pyx_t_1, __pyx_n_s_prefix, __pyx_n_u_lingeling_2) < 0) __PYX_ERR(0, 1141, __pyx_L1_error)
+    if (PyDict_SetItem(__pyx_t_1, __pyx_n_s_suffix, __pyx_kp_u_cnf) < 0) __PYX_ERR(0, 1141, __pyx_L1_error)
+    __pyx_t_4 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_empty_tuple, __pyx_t_1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1141, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-    __pyx_t_5 = __Pyx_PyObject_LookupSpecial(__pyx_t_4, __pyx_n_s_exit); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1134, __pyx_L1_error)
+    __pyx_t_5 = __Pyx_PyObject_LookupSpecial(__pyx_t_4, __pyx_n_s_exit); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1141, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
-    __pyx_t_3 = __Pyx_PyObject_LookupSpecial(__pyx_t_4, __pyx_n_s_enter); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1134, __pyx_L5_error)
+    __pyx_t_3 = __Pyx_PyObject_LookupSpecial(__pyx_t_4, __pyx_n_s_enter); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1141, __pyx_L5_error)
     __Pyx_GOTREF(__pyx_t_3);
     __pyx_t_6 = NULL;
     __pyx_t_7 = 0;
     #if CYTHON_UNPACK_METHODS
     if (likely(PyMethod_Check(__pyx_t_3))) {
       __pyx_t_6 = PyMethod_GET_SELF(__pyx_t_3);
       if (likely(__pyx_t_6)) {
@@ -40053,15 +40190,15 @@
       }
     }
     #endif
     {
       PyObject *__pyx_callargs[2] = {__pyx_t_6, NULL};
       __pyx_t_1 = __Pyx_PyObject_FastCall(__pyx_t_3, __pyx_callargs+1-__pyx_t_7, 0+__pyx_t_7);
       __Pyx_XDECREF(__pyx_t_6); __pyx_t_6 = 0;
-      if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1134, __pyx_L5_error)
+      if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1141, __pyx_L5_error)
       __Pyx_GOTREF(__pyx_t_1);
       __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
     }
     __pyx_t_3 = __pyx_t_1;
     __pyx_t_1 = 0;
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
     /*try:*/ {
@@ -40072,60 +40209,60 @@
         __Pyx_XGOTREF(__pyx_t_8);
         __Pyx_XGOTREF(__pyx_t_9);
         __Pyx_XGOTREF(__pyx_t_10);
         /*try:*/ {
           __pyx_v_f = __pyx_t_3;
           __pyx_t_3 = 0;
 
-          /* "sat_toolkit/formula.pyx":1135
+          /* "sat_toolkit/formula.pyx":1142
  * 
  *         with NamedTemporaryFile(prefix='lingeling_', suffix='.cnf') as f:
  *             args += ['-o', f.name]             # <<<<<<<<<<<<<<
  *             args += extra_args
  *             return self._minimize_dimacs(args, f.name)
  */
-          __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_v_f, __pyx_n_s_name); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1135, __pyx_L9_error)
+          __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_v_f, __pyx_n_s_name); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1142, __pyx_L9_error)
           __Pyx_GOTREF(__pyx_t_3);
-          __pyx_t_4 = PyList_New(2); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1135, __pyx_L9_error)
+          __pyx_t_4 = PyList_New(2); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1142, __pyx_L9_error)
           __Pyx_GOTREF(__pyx_t_4);
           __Pyx_INCREF(__pyx_kp_u_o);
           __Pyx_GIVEREF(__pyx_kp_u_o);
-          if (__Pyx_PyList_SET_ITEM(__pyx_t_4, 0, __pyx_kp_u_o)) __PYX_ERR(0, 1135, __pyx_L9_error);
+          if (__Pyx_PyList_SET_ITEM(__pyx_t_4, 0, __pyx_kp_u_o)) __PYX_ERR(0, 1142, __pyx_L9_error);
           __Pyx_GIVEREF(__pyx_t_3);
-          if (__Pyx_PyList_SET_ITEM(__pyx_t_4, 1, __pyx_t_3)) __PYX_ERR(0, 1135, __pyx_L9_error);
+          if (__Pyx_PyList_SET_ITEM(__pyx_t_4, 1, __pyx_t_3)) __PYX_ERR(0, 1142, __pyx_L9_error);
           __pyx_t_3 = 0;
-          __pyx_t_3 = PyNumber_InPlaceAdd(__pyx_v_args, __pyx_t_4); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1135, __pyx_L9_error)
+          __pyx_t_3 = PyNumber_InPlaceAdd(__pyx_v_args, __pyx_t_4); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1142, __pyx_L9_error)
           __Pyx_GOTREF(__pyx_t_3);
           __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
           __Pyx_DECREF_SET(__pyx_v_args, __pyx_t_3);
           __pyx_t_3 = 0;
 
-          /* "sat_toolkit/formula.pyx":1136
+          /* "sat_toolkit/formula.pyx":1143
  *         with NamedTemporaryFile(prefix='lingeling_', suffix='.cnf') as f:
  *             args += ['-o', f.name]
  *             args += extra_args             # <<<<<<<<<<<<<<
  *             return self._minimize_dimacs(args, f.name)
  * 
  */
-          __pyx_t_3 = PyNumber_InPlaceAdd(__pyx_v_args, __pyx_v_extra_args); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1136, __pyx_L9_error)
+          __pyx_t_3 = PyNumber_InPlaceAdd(__pyx_v_args, __pyx_v_extra_args); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1143, __pyx_L9_error)
           __Pyx_GOTREF(__pyx_t_3);
           __Pyx_DECREF_SET(__pyx_v_args, __pyx_t_3);
           __pyx_t_3 = 0;
 
-          /* "sat_toolkit/formula.pyx":1137
+          /* "sat_toolkit/formula.pyx":1144
  *             args += ['-o', f.name]
  *             args += extra_args
  *             return self._minimize_dimacs(args, f.name)             # <<<<<<<<<<<<<<
  * 
  * 
  */
           __Pyx_XDECREF((PyObject *)__pyx_r);
-          __pyx_t_4 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_self), __pyx_n_s_minimize_dimacs); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1137, __pyx_L9_error)
+          __pyx_t_4 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_self), __pyx_n_s_minimize_dimacs); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1144, __pyx_L9_error)
           __Pyx_GOTREF(__pyx_t_4);
-          __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_f, __pyx_n_s_name); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1137, __pyx_L9_error)
+          __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_f, __pyx_n_s_name); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1144, __pyx_L9_error)
           __Pyx_GOTREF(__pyx_t_1);
           __pyx_t_6 = NULL;
           __pyx_t_7 = 0;
           #if CYTHON_UNPACK_METHODS
           if (likely(PyMethod_Check(__pyx_t_4))) {
             __pyx_t_6 = PyMethod_GET_SELF(__pyx_t_4);
             if (likely(__pyx_t_6)) {
@@ -40138,60 +40275,60 @@
           }
           #endif
           {
             PyObject *__pyx_callargs[3] = {__pyx_t_6, __pyx_v_args, __pyx_t_1};
             __pyx_t_3 = __Pyx_PyObject_FastCall(__pyx_t_4, __pyx_callargs+1-__pyx_t_7, 2+__pyx_t_7);
             __Pyx_XDECREF(__pyx_t_6); __pyx_t_6 = 0;
             __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-            if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1137, __pyx_L9_error)
+            if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1144, __pyx_L9_error)
             __Pyx_GOTREF(__pyx_t_3);
             __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
           }
-          if (!(likely(((__pyx_t_3) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_3, __pyx_ptype_11sat_toolkit_7formula_CNF))))) __PYX_ERR(0, 1137, __pyx_L9_error)
+          if (!(likely(((__pyx_t_3) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_3, __pyx_ptype_11sat_toolkit_7formula_CNF))))) __PYX_ERR(0, 1144, __pyx_L9_error)
           __pyx_r = ((struct __pyx_obj_11sat_toolkit_7formula_CNF *)__pyx_t_3);
           __pyx_t_3 = 0;
           goto __pyx_L13_try_return;
 
-          /* "sat_toolkit/formula.pyx":1134
+          /* "sat_toolkit/formula.pyx":1141
  *             args += ['-T', f'{timeout}']
  * 
  *         with NamedTemporaryFile(prefix='lingeling_', suffix='.cnf') as f:             # <<<<<<<<<<<<<<
  *             args += ['-o', f.name]
  *             args += extra_args
  */
         }
         __pyx_L9_error:;
         __Pyx_XDECREF(__pyx_t_1); __pyx_t_1 = 0;
         __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
         __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
         __Pyx_XDECREF(__pyx_t_6); __pyx_t_6 = 0;
         /*except:*/ {
           __Pyx_AddTraceback("sat_toolkit.formula.CNF.minimize_lingeling", __pyx_clineno, __pyx_lineno, __pyx_filename);
-          if (__Pyx_GetException(&__pyx_t_3, &__pyx_t_4, &__pyx_t_1) < 0) __PYX_ERR(0, 1134, __pyx_L11_except_error)
+          if (__Pyx_GetException(&__pyx_t_3, &__pyx_t_4, &__pyx_t_1) < 0) __PYX_ERR(0, 1141, __pyx_L11_except_error)
           __Pyx_XGOTREF(__pyx_t_3);
           __Pyx_XGOTREF(__pyx_t_4);
           __Pyx_XGOTREF(__pyx_t_1);
-          __pyx_t_6 = PyTuple_Pack(3, __pyx_t_3, __pyx_t_4, __pyx_t_1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1134, __pyx_L11_except_error)
+          __pyx_t_6 = PyTuple_Pack(3, __pyx_t_3, __pyx_t_4, __pyx_t_1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1141, __pyx_L11_except_error)
           __Pyx_GOTREF(__pyx_t_6);
           __pyx_t_11 = __Pyx_PyObject_Call(__pyx_t_5, __pyx_t_6, NULL);
           __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
           __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-          if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1134, __pyx_L11_except_error)
+          if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1141, __pyx_L11_except_error)
           __Pyx_GOTREF(__pyx_t_11);
           __pyx_t_2 = __Pyx_PyObject_IsTrue(__pyx_t_11);
           __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
-          if (__pyx_t_2 < 0) __PYX_ERR(0, 1134, __pyx_L11_except_error)
+          if (__pyx_t_2 < 0) __PYX_ERR(0, 1141, __pyx_L11_except_error)
           __pyx_t_12 = (!__pyx_t_2);
           if (unlikely(__pyx_t_12)) {
             __Pyx_GIVEREF(__pyx_t_3);
             __Pyx_GIVEREF(__pyx_t_4);
             __Pyx_XGIVEREF(__pyx_t_1);
             __Pyx_ErrRestoreWithState(__pyx_t_3, __pyx_t_4, __pyx_t_1);
             __pyx_t_3 = 0; __pyx_t_4 = 0; __pyx_t_1 = 0; 
-            __PYX_ERR(0, 1134, __pyx_L11_except_error)
+            __PYX_ERR(0, 1141, __pyx_L11_except_error)
           }
           __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
           __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
           __Pyx_XDECREF(__pyx_t_1); __pyx_t_1 = 0;
           goto __pyx_L10_exception_handled;
         }
         __pyx_L11_except_error:;
@@ -40214,27 +40351,27 @@
       }
     }
     /*finally:*/ {
       /*normal exit:*/{
         if (__pyx_t_5) {
           __pyx_t_10 = __Pyx_PyObject_Call(__pyx_t_5, __pyx_tuple__35, NULL);
           __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-          if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1134, __pyx_L1_error)
+          if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1141, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_10);
           __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
         }
         goto __pyx_L8;
       }
       __pyx_L6_return: {
         __pyx_t_13 = __pyx_r;
         __pyx_r = 0;
         if (__pyx_t_5) {
           __pyx_t_10 = __Pyx_PyObject_Call(__pyx_t_5, __pyx_tuple__35, NULL);
           __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-          if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1134, __pyx_L1_error)
+          if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1141, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_10);
           __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
         }
         __pyx_r = __pyx_t_13;
         __pyx_t_13 = 0;
         goto __pyx_L0;
       }
@@ -40243,15 +40380,15 @@
     goto __pyx_L18;
     __pyx_L5_error:;
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
     goto __pyx_L1_error;
     __pyx_L18:;
   }
 
-  /* "sat_toolkit/formula.pyx":1115
+  /* "sat_toolkit/formula.pyx":1122
  *             return CNF.from_dimacs(f.read())
  * 
  *     def minimize_lingeling(self, optlevel=None, timeout=0, extra_args: List[str] = []) -> CNF:             # <<<<<<<<<<<<<<
  *         """
  *         Uses Lingeling to minimize the given CNF.
  */
 
@@ -40269,15 +40406,15 @@
   __Pyx_XDECREF(__pyx_v_args);
   __Pyx_XDECREF(__pyx_v_f);
   __Pyx_XGIVEREF((PyObject *)__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "sat_toolkit/formula.pyx":1141
+/* "sat_toolkit/formula.pyx":1148
  * 
  * 
  *     def solve_dimacs(self, command: List[str], verbose=False) -> Tuple[bool, np.array|None]:             # <<<<<<<<<<<<<<
  *         """
  *         solves the SAT by calling a DIMACS the compliant sat solver given by command.
  */
 
@@ -40335,27 +40472,27 @@
       kw_args = __Pyx_NumKwargs_FASTCALL(__pyx_kwds);
       switch (__pyx_nargs) {
         case  0:
         if (likely((values[0] = __Pyx_GetKwValue_FASTCALL(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_command)) != 0)) {
           (void)__Pyx_Arg_NewRef_FASTCALL(values[0]);
           kw_args--;
         }
-        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 1141, __pyx_L3_error)
+        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 1148, __pyx_L3_error)
         else goto __pyx_L5_argtuple_error;
         CYTHON_FALLTHROUGH;
         case  1:
         if (kw_args > 0) {
           PyObject* value = __Pyx_GetKwValue_FASTCALL(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_verbose);
           if (value) { values[1] = __Pyx_Arg_NewRef_FASTCALL(value); kw_args--; }
-          else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 1141, __pyx_L3_error)
+          else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 1148, __pyx_L3_error)
         }
       }
       if (unlikely(kw_args > 0)) {
         const Py_ssize_t kwd_pos_args = __pyx_nargs;
-        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values + 0, kwd_pos_args, "solve_dimacs") < 0)) __PYX_ERR(0, 1141, __pyx_L3_error)
+        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values + 0, kwd_pos_args, "solve_dimacs") < 0)) __PYX_ERR(0, 1148, __pyx_L3_error)
       }
     } else {
       switch (__pyx_nargs) {
         case  2: values[1] = __Pyx_Arg_FASTCALL(__pyx_args, 1);
         CYTHON_FALLTHROUGH;
         case  1: values[0] = __Pyx_Arg_FASTCALL(__pyx_args, 0);
         break;
@@ -40363,15 +40500,15 @@
       }
     }
     __pyx_v_command = values[0];
     __pyx_v_verbose = values[1];
   }
   goto __pyx_L6_skip;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("solve_dimacs", 0, 1, 2, __pyx_nargs); __PYX_ERR(0, 1141, __pyx_L3_error)
+  __Pyx_RaiseArgtupleInvalid("solve_dimacs", 0, 1, 2, __pyx_nargs); __PYX_ERR(0, 1148, __pyx_L3_error)
   __pyx_L6_skip:;
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L3_error:;
   {
     Py_ssize_t __pyx_temp;
     for (__pyx_temp=0; __pyx_temp < (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
       __Pyx_Arg_XDECREF_FASTCALL(values[__pyx_temp]);
@@ -40436,126 +40573,126 @@
   int __pyx_t_25;
   PyObject *__pyx_t_26 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("solve_dimacs", 1);
 
-  /* "sat_toolkit/formula.pyx":1148
+  /* "sat_toolkit/formula.pyx":1155
  *         Returns (False, None) for UNSAT instances.
  *         """
  *         cdef int echo_comments, ret_code = 0             # <<<<<<<<<<<<<<
  *         cdef uint8_t[:] result_view
  * 
  */
   __pyx_v_ret_code = 0;
 
-  /* "sat_toolkit/formula.pyx":1151
+  /* "sat_toolkit/formula.pyx":1158
  *         cdef uint8_t[:] result_view
  * 
  *         result = np.full(self.nvars + 1, 255, dtype=np.uint8)             # <<<<<<<<<<<<<<
  *         result_view = result
  *         echo_comments = verbose
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1151, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1158, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_full); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1151, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_full); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1158, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  __pyx_t_1 = __Pyx_PyInt_From_long((__pyx_v_self->__pyx_base.nvars + 1)); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1151, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyInt_From_long((__pyx_v_self->__pyx_base.nvars + 1)); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1158, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_3 = PyTuple_New(2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1151, __pyx_L1_error)
+  __pyx_t_3 = PyTuple_New(2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1158, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_GIVEREF(__pyx_t_1);
-  if (__Pyx_PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_t_1)) __PYX_ERR(0, 1151, __pyx_L1_error);
+  if (__Pyx_PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_t_1)) __PYX_ERR(0, 1158, __pyx_L1_error);
   __Pyx_INCREF(__pyx_int_255);
   __Pyx_GIVEREF(__pyx_int_255);
-  if (__Pyx_PyTuple_SET_ITEM(__pyx_t_3, 1, __pyx_int_255)) __PYX_ERR(0, 1151, __pyx_L1_error);
+  if (__Pyx_PyTuple_SET_ITEM(__pyx_t_3, 1, __pyx_int_255)) __PYX_ERR(0, 1158, __pyx_L1_error);
   __pyx_t_1 = 0;
-  __pyx_t_1 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1151, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1158, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_np); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1151, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_np); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1158, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
-  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_uint8); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1151, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_uint8); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1158, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-  if (PyDict_SetItem(__pyx_t_1, __pyx_n_s_dtype, __pyx_t_5) < 0) __PYX_ERR(0, 1151, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_1, __pyx_n_s_dtype, __pyx_t_5) < 0) __PYX_ERR(0, 1158, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-  __pyx_t_5 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_t_3, __pyx_t_1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1151, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_t_3, __pyx_t_1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1158, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __pyx_v_result = __pyx_t_5;
   __pyx_t_5 = 0;
 
-  /* "sat_toolkit/formula.pyx":1152
+  /* "sat_toolkit/formula.pyx":1159
  * 
  *         result = np.full(self.nvars + 1, 255, dtype=np.uint8)
  *         result_view = result             # <<<<<<<<<<<<<<
  *         echo_comments = verbose
  * 
  */
-  __pyx_t_6 = __Pyx_PyObject_to_MemoryviewSlice_ds_nn___pyx_t_11sat_toolkit_5types_uint8_t(__pyx_v_result, PyBUF_WRITABLE); if (unlikely(!__pyx_t_6.memview)) __PYX_ERR(0, 1152, __pyx_L1_error)
+  __pyx_t_6 = __Pyx_PyObject_to_MemoryviewSlice_ds_nn___pyx_t_11sat_toolkit_5types_uint8_t(__pyx_v_result, PyBUF_WRITABLE); if (unlikely(!__pyx_t_6.memview)) __PYX_ERR(0, 1159, __pyx_L1_error)
   __pyx_v_result_view = __pyx_t_6;
   __pyx_t_6.memview = NULL;
   __pyx_t_6.data = NULL;
 
-  /* "sat_toolkit/formula.pyx":1153
+  /* "sat_toolkit/formula.pyx":1160
  *         result = np.full(self.nvars + 1, 255, dtype=np.uint8)
  *         result_view = result
  *         echo_comments = verbose             # <<<<<<<<<<<<<<
  * 
  *         cdef int32_t[::1] buf = None;
  */
-  __pyx_t_7 = __Pyx_PyInt_As_int(__pyx_v_verbose); if (unlikely((__pyx_t_7 == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 1153, __pyx_L1_error)
+  __pyx_t_7 = __Pyx_PyInt_As_int(__pyx_v_verbose); if (unlikely((__pyx_t_7 == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 1160, __pyx_L1_error)
   __pyx_v_echo_comments = __pyx_t_7;
 
-  /* "sat_toolkit/formula.pyx":1155
+  /* "sat_toolkit/formula.pyx":1162
  *         echo_comments = verbose
  * 
  *         cdef int32_t[::1] buf = None;             # <<<<<<<<<<<<<<
  *         cdef int32_t lit
  *         cdef ssize_t i
  */
-  __pyx_t_8 = __Pyx_PyObject_to_MemoryviewSlice_dc_nn___pyx_t_11sat_toolkit_5types_int32_t(Py_None, PyBUF_WRITABLE); if (unlikely(!__pyx_t_8.memview)) __PYX_ERR(0, 1155, __pyx_L1_error)
+  __pyx_t_8 = __Pyx_PyObject_to_MemoryviewSlice_dc_nn___pyx_t_11sat_toolkit_5types_int32_t(Py_None, PyBUF_WRITABLE); if (unlikely(!__pyx_t_8.memview)) __PYX_ERR(0, 1162, __pyx_L1_error)
   __pyx_v_buf = __pyx_t_8;
   __pyx_t_8.memview = NULL;
   __pyx_t_8.data = NULL;
 
-  /* "sat_toolkit/formula.pyx":1158
+  /* "sat_toolkit/formula.pyx":1165
  *         cdef int32_t lit
  *         cdef ssize_t i
  *         cdef bint is_sat = False             # <<<<<<<<<<<<<<
  * 
  * 
  */
   __pyx_v_is_sat = 0;
 
-  /* "sat_toolkit/formula.pyx":1161
+  /* "sat_toolkit/formula.pyx":1168
  * 
  * 
  *         with NamedTemporaryFile('w', prefix='sat_toolkit_', suffix='.cnf') as f:             # <<<<<<<<<<<<<<
  *             f.write(self.to_dimacs())
  *             f.flush()
  */
   /*with:*/ {
-    __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_NamedTemporaryFile); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1161, __pyx_L1_error)
+    __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_NamedTemporaryFile); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1168, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
-    __pyx_t_1 = __Pyx_PyDict_NewPresized(2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1161, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyDict_NewPresized(2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1168, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
-    if (PyDict_SetItem(__pyx_t_1, __pyx_n_s_prefix, __pyx_n_u_sat_toolkit) < 0) __PYX_ERR(0, 1161, __pyx_L1_error)
-    if (PyDict_SetItem(__pyx_t_1, __pyx_n_s_suffix, __pyx_kp_u_cnf) < 0) __PYX_ERR(0, 1161, __pyx_L1_error)
-    __pyx_t_3 = __Pyx_PyObject_Call(__pyx_t_5, __pyx_tuple__37, __pyx_t_1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1161, __pyx_L1_error)
+    if (PyDict_SetItem(__pyx_t_1, __pyx_n_s_prefix, __pyx_n_u_sat_toolkit) < 0) __PYX_ERR(0, 1168, __pyx_L1_error)
+    if (PyDict_SetItem(__pyx_t_1, __pyx_n_s_suffix, __pyx_kp_u_cnf) < 0) __PYX_ERR(0, 1168, __pyx_L1_error)
+    __pyx_t_3 = __Pyx_PyObject_Call(__pyx_t_5, __pyx_tuple__37, __pyx_t_1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1168, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-    __pyx_t_9 = __Pyx_PyObject_LookupSpecial(__pyx_t_3, __pyx_n_s_exit); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1161, __pyx_L1_error)
+    __pyx_t_9 = __Pyx_PyObject_LookupSpecial(__pyx_t_3, __pyx_n_s_exit); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1168, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_9);
-    __pyx_t_5 = __Pyx_PyObject_LookupSpecial(__pyx_t_3, __pyx_n_s_enter); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1161, __pyx_L3_error)
+    __pyx_t_5 = __Pyx_PyObject_LookupSpecial(__pyx_t_3, __pyx_n_s_enter); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1168, __pyx_L3_error)
     __Pyx_GOTREF(__pyx_t_5);
     __pyx_t_2 = NULL;
     __pyx_t_7 = 0;
     #if CYTHON_UNPACK_METHODS
     if (likely(PyMethod_Check(__pyx_t_5))) {
       __pyx_t_2 = PyMethod_GET_SELF(__pyx_t_5);
       if (likely(__pyx_t_2)) {
@@ -40567,15 +40704,15 @@
       }
     }
     #endif
     {
       PyObject *__pyx_callargs[2] = {__pyx_t_2, NULL};
       __pyx_t_1 = __Pyx_PyObject_FastCall(__pyx_t_5, __pyx_callargs+1-__pyx_t_7, 0+__pyx_t_7);
       __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
-      if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1161, __pyx_L3_error)
+      if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1168, __pyx_L3_error)
       __Pyx_GOTREF(__pyx_t_1);
       __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
     }
     __pyx_t_5 = __pyx_t_1;
     __pyx_t_1 = 0;
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
     /*try:*/ {
@@ -40586,24 +40723,24 @@
         __Pyx_XGOTREF(__pyx_t_10);
         __Pyx_XGOTREF(__pyx_t_11);
         __Pyx_XGOTREF(__pyx_t_12);
         /*try:*/ {
           __pyx_v_f = __pyx_t_5;
           __pyx_t_5 = 0;
 
-          /* "sat_toolkit/formula.pyx":1162
+          /* "sat_toolkit/formula.pyx":1169
  * 
  *         with NamedTemporaryFile('w', prefix='sat_toolkit_', suffix='.cnf') as f:
  *             f.write(self.to_dimacs())             # <<<<<<<<<<<<<<
  *             f.flush()
  * 
  */
-          __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_v_f, __pyx_n_s_write); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1162, __pyx_L7_error)
+          __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_v_f, __pyx_n_s_write); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1169, __pyx_L7_error)
           __Pyx_GOTREF(__pyx_t_3);
-          __pyx_t_2 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_self), __pyx_n_s_to_dimacs); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1162, __pyx_L7_error)
+          __pyx_t_2 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_self), __pyx_n_s_to_dimacs); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1169, __pyx_L7_error)
           __Pyx_GOTREF(__pyx_t_2);
           __pyx_t_4 = NULL;
           __pyx_t_7 = 0;
           #if CYTHON_UNPACK_METHODS
           if (likely(PyMethod_Check(__pyx_t_2))) {
             __pyx_t_4 = PyMethod_GET_SELF(__pyx_t_2);
             if (likely(__pyx_t_4)) {
@@ -40615,15 +40752,15 @@
             }
           }
           #endif
           {
             PyObject *__pyx_callargs[2] = {__pyx_t_4, NULL};
             __pyx_t_1 = __Pyx_PyObject_FastCall(__pyx_t_2, __pyx_callargs+1-__pyx_t_7, 0+__pyx_t_7);
             __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
-            if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1162, __pyx_L7_error)
+            if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1169, __pyx_L7_error)
             __Pyx_GOTREF(__pyx_t_1);
             __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
           }
           __pyx_t_2 = NULL;
           __pyx_t_7 = 0;
           #if CYTHON_UNPACK_METHODS
           if (likely(PyMethod_Check(__pyx_t_3))) {
@@ -40638,28 +40775,28 @@
           }
           #endif
           {
             PyObject *__pyx_callargs[2] = {__pyx_t_2, __pyx_t_1};
             __pyx_t_5 = __Pyx_PyObject_FastCall(__pyx_t_3, __pyx_callargs+1-__pyx_t_7, 1+__pyx_t_7);
             __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
             __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-            if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1162, __pyx_L7_error)
+            if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1169, __pyx_L7_error)
             __Pyx_GOTREF(__pyx_t_5);
             __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
           }
           __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
 
-          /* "sat_toolkit/formula.pyx":1163
+          /* "sat_toolkit/formula.pyx":1170
  *         with NamedTemporaryFile('w', prefix='sat_toolkit_', suffix='.cnf') as f:
  *             f.write(self.to_dimacs())
  *             f.flush()             # <<<<<<<<<<<<<<
  * 
  *             args = command + [f.name]
  */
-          __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_v_f, __pyx_n_s_flush); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1163, __pyx_L7_error)
+          __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_v_f, __pyx_n_s_flush); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1170, __pyx_L7_error)
           __Pyx_GOTREF(__pyx_t_3);
           __pyx_t_1 = NULL;
           __pyx_t_7 = 0;
           #if CYTHON_UNPACK_METHODS
           if (likely(PyMethod_Check(__pyx_t_3))) {
             __pyx_t_1 = PyMethod_GET_SELF(__pyx_t_3);
             if (likely(__pyx_t_1)) {
@@ -40671,83 +40808,83 @@
             }
           }
           #endif
           {
             PyObject *__pyx_callargs[2] = {__pyx_t_1, NULL};
             __pyx_t_5 = __Pyx_PyObject_FastCall(__pyx_t_3, __pyx_callargs+1-__pyx_t_7, 0+__pyx_t_7);
             __Pyx_XDECREF(__pyx_t_1); __pyx_t_1 = 0;
-            if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1163, __pyx_L7_error)
+            if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1170, __pyx_L7_error)
             __Pyx_GOTREF(__pyx_t_5);
             __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
           }
           __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
 
-          /* "sat_toolkit/formula.pyx":1165
+          /* "sat_toolkit/formula.pyx":1172
  *             f.flush()
  * 
  *             args = command + [f.name]             # <<<<<<<<<<<<<<
  *             with sp.Popen(args, stdin=sp.DEVNULL, stdout=sp.PIPE, text=True) as solver:
  * 
  */
-          __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_v_f, __pyx_n_s_name); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1165, __pyx_L7_error)
+          __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_v_f, __pyx_n_s_name); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1172, __pyx_L7_error)
           __Pyx_GOTREF(__pyx_t_5);
-          __pyx_t_3 = PyList_New(1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1165, __pyx_L7_error)
+          __pyx_t_3 = PyList_New(1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1172, __pyx_L7_error)
           __Pyx_GOTREF(__pyx_t_3);
           __Pyx_GIVEREF(__pyx_t_5);
-          if (__Pyx_PyList_SET_ITEM(__pyx_t_3, 0, __pyx_t_5)) __PYX_ERR(0, 1165, __pyx_L7_error);
+          if (__Pyx_PyList_SET_ITEM(__pyx_t_3, 0, __pyx_t_5)) __PYX_ERR(0, 1172, __pyx_L7_error);
           __pyx_t_5 = 0;
-          __pyx_t_5 = PyNumber_Add(__pyx_v_command, __pyx_t_3); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1165, __pyx_L7_error)
+          __pyx_t_5 = PyNumber_Add(__pyx_v_command, __pyx_t_3); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1172, __pyx_L7_error)
           __Pyx_GOTREF(__pyx_t_5);
           __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
           __pyx_v_args = __pyx_t_5;
           __pyx_t_5 = 0;
 
-          /* "sat_toolkit/formula.pyx":1166
+          /* "sat_toolkit/formula.pyx":1173
  * 
  *             args = command + [f.name]
  *             with sp.Popen(args, stdin=sp.DEVNULL, stdout=sp.PIPE, text=True) as solver:             # <<<<<<<<<<<<<<
  * 
  *                 for line in solver.stdout:
  */
           /*with:*/ {
-            __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_sp); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1166, __pyx_L7_error)
+            __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_sp); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1173, __pyx_L7_error)
             __Pyx_GOTREF(__pyx_t_5);
-            __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_Popen); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1166, __pyx_L7_error)
+            __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_Popen); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1173, __pyx_L7_error)
             __Pyx_GOTREF(__pyx_t_3);
             __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-            __pyx_t_5 = PyTuple_New(1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1166, __pyx_L7_error)
+            __pyx_t_5 = PyTuple_New(1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1173, __pyx_L7_error)
             __Pyx_GOTREF(__pyx_t_5);
             __Pyx_INCREF(__pyx_v_args);
             __Pyx_GIVEREF(__pyx_v_args);
-            if (__Pyx_PyTuple_SET_ITEM(__pyx_t_5, 0, __pyx_v_args)) __PYX_ERR(0, 1166, __pyx_L7_error);
-            __pyx_t_1 = __Pyx_PyDict_NewPresized(3); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1166, __pyx_L7_error)
+            if (__Pyx_PyTuple_SET_ITEM(__pyx_t_5, 0, __pyx_v_args)) __PYX_ERR(0, 1173, __pyx_L7_error);
+            __pyx_t_1 = __Pyx_PyDict_NewPresized(3); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1173, __pyx_L7_error)
             __Pyx_GOTREF(__pyx_t_1);
-            __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_sp); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1166, __pyx_L7_error)
+            __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_sp); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1173, __pyx_L7_error)
             __Pyx_GOTREF(__pyx_t_2);
-            __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_DEVNULL); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1166, __pyx_L7_error)
+            __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_DEVNULL); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1173, __pyx_L7_error)
             __Pyx_GOTREF(__pyx_t_4);
             __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-            if (PyDict_SetItem(__pyx_t_1, __pyx_n_s_stdin, __pyx_t_4) < 0) __PYX_ERR(0, 1166, __pyx_L7_error)
+            if (PyDict_SetItem(__pyx_t_1, __pyx_n_s_stdin, __pyx_t_4) < 0) __PYX_ERR(0, 1173, __pyx_L7_error)
             __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-            __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_sp); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1166, __pyx_L7_error)
+            __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_sp); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1173, __pyx_L7_error)
             __Pyx_GOTREF(__pyx_t_4);
-            __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_PIPE); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1166, __pyx_L7_error)
+            __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_PIPE); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1173, __pyx_L7_error)
             __Pyx_GOTREF(__pyx_t_2);
             __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-            if (PyDict_SetItem(__pyx_t_1, __pyx_n_s_stdout, __pyx_t_2) < 0) __PYX_ERR(0, 1166, __pyx_L7_error)
+            if (PyDict_SetItem(__pyx_t_1, __pyx_n_s_stdout, __pyx_t_2) < 0) __PYX_ERR(0, 1173, __pyx_L7_error)
             __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-            if (PyDict_SetItem(__pyx_t_1, __pyx_n_s_text, Py_True) < 0) __PYX_ERR(0, 1166, __pyx_L7_error)
-            __pyx_t_2 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_5, __pyx_t_1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1166, __pyx_L7_error)
+            if (PyDict_SetItem(__pyx_t_1, __pyx_n_s_text, Py_True) < 0) __PYX_ERR(0, 1173, __pyx_L7_error)
+            __pyx_t_2 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_5, __pyx_t_1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1173, __pyx_L7_error)
             __Pyx_GOTREF(__pyx_t_2);
             __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
             __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
             __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-            __pyx_t_13 = __Pyx_PyObject_LookupSpecial(__pyx_t_2, __pyx_n_s_exit); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 1166, __pyx_L7_error)
+            __pyx_t_13 = __Pyx_PyObject_LookupSpecial(__pyx_t_2, __pyx_n_s_exit); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 1173, __pyx_L7_error)
             __Pyx_GOTREF(__pyx_t_13);
-            __pyx_t_5 = __Pyx_PyObject_LookupSpecial(__pyx_t_2, __pyx_n_s_enter); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1166, __pyx_L13_error)
+            __pyx_t_5 = __Pyx_PyObject_LookupSpecial(__pyx_t_2, __pyx_n_s_enter); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1173, __pyx_L13_error)
             __Pyx_GOTREF(__pyx_t_5);
             __pyx_t_3 = NULL;
             __pyx_t_7 = 0;
             #if CYTHON_UNPACK_METHODS
             if (likely(PyMethod_Check(__pyx_t_5))) {
               __pyx_t_3 = PyMethod_GET_SELF(__pyx_t_5);
               if (likely(__pyx_t_3)) {
@@ -40759,15 +40896,15 @@
               }
             }
             #endif
             {
               PyObject *__pyx_callargs[2] = {__pyx_t_3, NULL};
               __pyx_t_1 = __Pyx_PyObject_FastCall(__pyx_t_5, __pyx_callargs+1-__pyx_t_7, 0+__pyx_t_7);
               __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
-              if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1166, __pyx_L13_error)
+              if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1173, __pyx_L13_error)
               __Pyx_GOTREF(__pyx_t_1);
               __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
             }
             __pyx_t_5 = __pyx_t_1;
             __pyx_t_1 = 0;
             __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
             /*try:*/ {
@@ -40778,127 +40915,127 @@
                 __Pyx_XGOTREF(__pyx_t_14);
                 __Pyx_XGOTREF(__pyx_t_15);
                 __Pyx_XGOTREF(__pyx_t_16);
                 /*try:*/ {
                   __pyx_v_solver = __pyx_t_5;
                   __pyx_t_5 = 0;
 
-                  /* "sat_toolkit/formula.pyx":1168
+                  /* "sat_toolkit/formula.pyx":1175
  *             with sp.Popen(args, stdin=sp.DEVNULL, stdout=sp.PIPE, text=True) as solver:
  * 
  *                 for line in solver.stdout:             # <<<<<<<<<<<<<<
  *                     if echo_comments:
  *                         print(line, end='')
  */
-                  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_v_solver, __pyx_n_s_stdout); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1168, __pyx_L17_error)
+                  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_v_solver, __pyx_n_s_stdout); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1175, __pyx_L17_error)
                   __Pyx_GOTREF(__pyx_t_5);
                   if (likely(PyList_CheckExact(__pyx_t_5)) || PyTuple_CheckExact(__pyx_t_5)) {
                     __pyx_t_2 = __pyx_t_5; __Pyx_INCREF(__pyx_t_2);
                     __pyx_t_17 = 0;
                     __pyx_t_18 = NULL;
                   } else {
-                    __pyx_t_17 = -1; __pyx_t_2 = PyObject_GetIter(__pyx_t_5); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1168, __pyx_L17_error)
+                    __pyx_t_17 = -1; __pyx_t_2 = PyObject_GetIter(__pyx_t_5); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1175, __pyx_L17_error)
                     __Pyx_GOTREF(__pyx_t_2);
-                    __pyx_t_18 = __Pyx_PyObject_GetIterNextFunc(__pyx_t_2); if (unlikely(!__pyx_t_18)) __PYX_ERR(0, 1168, __pyx_L17_error)
+                    __pyx_t_18 = __Pyx_PyObject_GetIterNextFunc(__pyx_t_2); if (unlikely(!__pyx_t_18)) __PYX_ERR(0, 1175, __pyx_L17_error)
                   }
                   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
                   for (;;) {
                     if (likely(!__pyx_t_18)) {
                       if (likely(PyList_CheckExact(__pyx_t_2))) {
                         {
                           Py_ssize_t __pyx_temp = __Pyx_PyList_GET_SIZE(__pyx_t_2);
                           #if !CYTHON_ASSUME_SAFE_MACROS
-                          if (unlikely((__pyx_temp < 0))) __PYX_ERR(0, 1168, __pyx_L17_error)
+                          if (unlikely((__pyx_temp < 0))) __PYX_ERR(0, 1175, __pyx_L17_error)
                           #endif
                           if (__pyx_t_17 >= __pyx_temp) break;
                         }
                         #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-                        __pyx_t_5 = PyList_GET_ITEM(__pyx_t_2, __pyx_t_17); __Pyx_INCREF(__pyx_t_5); __pyx_t_17++; if (unlikely((0 < 0))) __PYX_ERR(0, 1168, __pyx_L17_error)
+                        __pyx_t_5 = PyList_GET_ITEM(__pyx_t_2, __pyx_t_17); __Pyx_INCREF(__pyx_t_5); __pyx_t_17++; if (unlikely((0 < 0))) __PYX_ERR(0, 1175, __pyx_L17_error)
                         #else
-                        __pyx_t_5 = __Pyx_PySequence_ITEM(__pyx_t_2, __pyx_t_17); __pyx_t_17++; if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1168, __pyx_L17_error)
+                        __pyx_t_5 = __Pyx_PySequence_ITEM(__pyx_t_2, __pyx_t_17); __pyx_t_17++; if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1175, __pyx_L17_error)
                         __Pyx_GOTREF(__pyx_t_5);
                         #endif
                       } else {
                         {
                           Py_ssize_t __pyx_temp = __Pyx_PyTuple_GET_SIZE(__pyx_t_2);
                           #if !CYTHON_ASSUME_SAFE_MACROS
-                          if (unlikely((__pyx_temp < 0))) __PYX_ERR(0, 1168, __pyx_L17_error)
+                          if (unlikely((__pyx_temp < 0))) __PYX_ERR(0, 1175, __pyx_L17_error)
                           #endif
                           if (__pyx_t_17 >= __pyx_temp) break;
                         }
                         #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-                        __pyx_t_5 = PyTuple_GET_ITEM(__pyx_t_2, __pyx_t_17); __Pyx_INCREF(__pyx_t_5); __pyx_t_17++; if (unlikely((0 < 0))) __PYX_ERR(0, 1168, __pyx_L17_error)
+                        __pyx_t_5 = PyTuple_GET_ITEM(__pyx_t_2, __pyx_t_17); __Pyx_INCREF(__pyx_t_5); __pyx_t_17++; if (unlikely((0 < 0))) __PYX_ERR(0, 1175, __pyx_L17_error)
                         #else
-                        __pyx_t_5 = __Pyx_PySequence_ITEM(__pyx_t_2, __pyx_t_17); __pyx_t_17++; if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1168, __pyx_L17_error)
+                        __pyx_t_5 = __Pyx_PySequence_ITEM(__pyx_t_2, __pyx_t_17); __pyx_t_17++; if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1175, __pyx_L17_error)
                         __Pyx_GOTREF(__pyx_t_5);
                         #endif
                       }
                     } else {
                       __pyx_t_5 = __pyx_t_18(__pyx_t_2);
                       if (unlikely(!__pyx_t_5)) {
                         PyObject* exc_type = PyErr_Occurred();
                         if (exc_type) {
                           if (likely(__Pyx_PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
-                          else __PYX_ERR(0, 1168, __pyx_L17_error)
+                          else __PYX_ERR(0, 1175, __pyx_L17_error)
                         }
                         break;
                       }
                       __Pyx_GOTREF(__pyx_t_5);
                     }
                     __Pyx_XDECREF_SET(__pyx_v_line, __pyx_t_5);
                     __pyx_t_5 = 0;
 
-                    /* "sat_toolkit/formula.pyx":1169
+                    /* "sat_toolkit/formula.pyx":1176
  * 
  *                 for line in solver.stdout:
  *                     if echo_comments:             # <<<<<<<<<<<<<<
  *                         print(line, end='')
  * 
  */
                     __pyx_t_19 = (__pyx_v_echo_comments != 0);
                     if (__pyx_t_19) {
 
-                      /* "sat_toolkit/formula.pyx":1170
+                      /* "sat_toolkit/formula.pyx":1177
  *                 for line in solver.stdout:
  *                     if echo_comments:
  *                         print(line, end='')             # <<<<<<<<<<<<<<
  * 
  *                     if line.startswith('c '):
  */
-                      __pyx_t_5 = PyTuple_New(1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1170, __pyx_L17_error)
+                      __pyx_t_5 = PyTuple_New(1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1177, __pyx_L17_error)
                       __Pyx_GOTREF(__pyx_t_5);
                       __Pyx_INCREF(__pyx_v_line);
                       __Pyx_GIVEREF(__pyx_v_line);
-                      if (__Pyx_PyTuple_SET_ITEM(__pyx_t_5, 0, __pyx_v_line)) __PYX_ERR(0, 1170, __pyx_L17_error);
-                      __pyx_t_1 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1170, __pyx_L17_error)
+                      if (__Pyx_PyTuple_SET_ITEM(__pyx_t_5, 0, __pyx_v_line)) __PYX_ERR(0, 1177, __pyx_L17_error);
+                      __pyx_t_1 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1177, __pyx_L17_error)
                       __Pyx_GOTREF(__pyx_t_1);
-                      if (PyDict_SetItem(__pyx_t_1, __pyx_n_s_end, __pyx_kp_u__10) < 0) __PYX_ERR(0, 1170, __pyx_L17_error)
-                      __pyx_t_3 = __Pyx_PyObject_Call(__pyx_builtin_print, __pyx_t_5, __pyx_t_1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1170, __pyx_L17_error)
+                      if (PyDict_SetItem(__pyx_t_1, __pyx_n_s_end, __pyx_kp_u__10) < 0) __PYX_ERR(0, 1177, __pyx_L17_error)
+                      __pyx_t_3 = __Pyx_PyObject_Call(__pyx_builtin_print, __pyx_t_5, __pyx_t_1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1177, __pyx_L17_error)
                       __Pyx_GOTREF(__pyx_t_3);
                       __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
                       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
                       __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
 
-                      /* "sat_toolkit/formula.pyx":1169
+                      /* "sat_toolkit/formula.pyx":1176
  * 
  *                 for line in solver.stdout:
  *                     if echo_comments:             # <<<<<<<<<<<<<<
  *                         print(line, end='')
  * 
  */
                     }
 
-                    /* "sat_toolkit/formula.pyx":1172
+                    /* "sat_toolkit/formula.pyx":1179
  *                         print(line, end='')
  * 
  *                     if line.startswith('c '):             # <<<<<<<<<<<<<<
  *                         continue
  * 
  */
-                    __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_line, __pyx_n_s_startswith); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1172, __pyx_L17_error)
+                    __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_line, __pyx_n_s_startswith); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1179, __pyx_L17_error)
                     __Pyx_GOTREF(__pyx_t_1);
                     __pyx_t_5 = NULL;
                     __pyx_t_7 = 0;
                     #if CYTHON_UNPACK_METHODS
                     if (likely(PyMethod_Check(__pyx_t_1))) {
                       __pyx_t_5 = PyMethod_GET_SELF(__pyx_t_1);
                       if (likely(__pyx_t_5)) {
@@ -40910,48 +41047,48 @@
                       }
                     }
                     #endif
                     {
                       PyObject *__pyx_callargs[2] = {__pyx_t_5, __pyx_kp_u_c_2};
                       __pyx_t_3 = __Pyx_PyObject_FastCall(__pyx_t_1, __pyx_callargs+1-__pyx_t_7, 1+__pyx_t_7);
                       __Pyx_XDECREF(__pyx_t_5); __pyx_t_5 = 0;
-                      if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1172, __pyx_L17_error)
+                      if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1179, __pyx_L17_error)
                       __Pyx_GOTREF(__pyx_t_3);
                       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
                     }
-                    __pyx_t_19 = __Pyx_PyObject_IsTrue(__pyx_t_3); if (unlikely((__pyx_t_19 < 0))) __PYX_ERR(0, 1172, __pyx_L17_error)
+                    __pyx_t_19 = __Pyx_PyObject_IsTrue(__pyx_t_3); if (unlikely((__pyx_t_19 < 0))) __PYX_ERR(0, 1179, __pyx_L17_error)
                     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
                     if (__pyx_t_19) {
 
-                      /* "sat_toolkit/formula.pyx":1173
+                      /* "sat_toolkit/formula.pyx":1180
  * 
  *                     if line.startswith('c '):
  *                         continue             # <<<<<<<<<<<<<<
  * 
  *                     if line.startswith('s '):
  */
                       goto __pyx_L23_continue;
 
-                      /* "sat_toolkit/formula.pyx":1172
+                      /* "sat_toolkit/formula.pyx":1179
  *                         print(line, end='')
  * 
  *                     if line.startswith('c '):             # <<<<<<<<<<<<<<
  *                         continue
  * 
  */
                     }
 
-                    /* "sat_toolkit/formula.pyx":1175
+                    /* "sat_toolkit/formula.pyx":1182
  *                         continue
  * 
  *                     if line.startswith('s '):             # <<<<<<<<<<<<<<
  *                         line = line[2:].strip()
  *                         if line == 'SATISFIABLE':
  */
-                    __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_line, __pyx_n_s_startswith); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1175, __pyx_L17_error)
+                    __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_line, __pyx_n_s_startswith); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1182, __pyx_L17_error)
                     __Pyx_GOTREF(__pyx_t_1);
                     __pyx_t_5 = NULL;
                     __pyx_t_7 = 0;
                     #if CYTHON_UNPACK_METHODS
                     if (likely(PyMethod_Check(__pyx_t_1))) {
                       __pyx_t_5 = PyMethod_GET_SELF(__pyx_t_1);
                       if (likely(__pyx_t_5)) {
@@ -40963,32 +41100,32 @@
                       }
                     }
                     #endif
                     {
                       PyObject *__pyx_callargs[2] = {__pyx_t_5, __pyx_kp_u_s_2};
                       __pyx_t_3 = __Pyx_PyObject_FastCall(__pyx_t_1, __pyx_callargs+1-__pyx_t_7, 1+__pyx_t_7);
                       __Pyx_XDECREF(__pyx_t_5); __pyx_t_5 = 0;
-                      if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1175, __pyx_L17_error)
+                      if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1182, __pyx_L17_error)
                       __Pyx_GOTREF(__pyx_t_3);
                       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
                     }
-                    __pyx_t_19 = __Pyx_PyObject_IsTrue(__pyx_t_3); if (unlikely((__pyx_t_19 < 0))) __PYX_ERR(0, 1175, __pyx_L17_error)
+                    __pyx_t_19 = __Pyx_PyObject_IsTrue(__pyx_t_3); if (unlikely((__pyx_t_19 < 0))) __PYX_ERR(0, 1182, __pyx_L17_error)
                     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
                     if (__pyx_t_19) {
 
-                      /* "sat_toolkit/formula.pyx":1176
+                      /* "sat_toolkit/formula.pyx":1183
  * 
  *                     if line.startswith('s '):
  *                         line = line[2:].strip()             # <<<<<<<<<<<<<<
  *                         if line == 'SATISFIABLE':
  *                             is_sat = True
  */
-                      __pyx_t_1 = __Pyx_PyObject_GetSlice(__pyx_v_line, 2, 0, NULL, NULL, &__pyx_slice__38, 1, 0, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1176, __pyx_L17_error)
+                      __pyx_t_1 = __Pyx_PyObject_GetSlice(__pyx_v_line, 2, 0, NULL, NULL, &__pyx_slice__38, 1, 0, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1183, __pyx_L17_error)
                       __Pyx_GOTREF(__pyx_t_1);
-                      __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_strip); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1176, __pyx_L17_error)
+                      __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_strip); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1183, __pyx_L17_error)
                       __Pyx_GOTREF(__pyx_t_5);
                       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
                       __pyx_t_1 = NULL;
                       __pyx_t_7 = 0;
                       #if CYTHON_UNPACK_METHODS
                       if (likely(PyMethod_Check(__pyx_t_5))) {
                         __pyx_t_1 = PyMethod_GET_SELF(__pyx_t_5);
@@ -41001,118 +41138,118 @@
                         }
                       }
                       #endif
                       {
                         PyObject *__pyx_callargs[2] = {__pyx_t_1, NULL};
                         __pyx_t_3 = __Pyx_PyObject_FastCall(__pyx_t_5, __pyx_callargs+1-__pyx_t_7, 0+__pyx_t_7);
                         __Pyx_XDECREF(__pyx_t_1); __pyx_t_1 = 0;
-                        if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1176, __pyx_L17_error)
+                        if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1183, __pyx_L17_error)
                         __Pyx_GOTREF(__pyx_t_3);
                         __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
                       }
                       __Pyx_DECREF_SET(__pyx_v_line, __pyx_t_3);
                       __pyx_t_3 = 0;
 
-                      /* "sat_toolkit/formula.pyx":1177
+                      /* "sat_toolkit/formula.pyx":1184
  *                     if line.startswith('s '):
  *                         line = line[2:].strip()
  *                         if line == 'SATISFIABLE':             # <<<<<<<<<<<<<<
  *                             is_sat = True
  *                         elif line == 'UNSATISFIABLE':
  */
-                      __pyx_t_19 = (__Pyx_PyUnicode_Equals(__pyx_v_line, __pyx_n_u_SATISFIABLE, Py_EQ)); if (unlikely((__pyx_t_19 < 0))) __PYX_ERR(0, 1177, __pyx_L17_error)
+                      __pyx_t_19 = (__Pyx_PyUnicode_Equals(__pyx_v_line, __pyx_n_u_SATISFIABLE, Py_EQ)); if (unlikely((__pyx_t_19 < 0))) __PYX_ERR(0, 1184, __pyx_L17_error)
                       if (__pyx_t_19) {
 
-                        /* "sat_toolkit/formula.pyx":1178
+                        /* "sat_toolkit/formula.pyx":1185
  *                         line = line[2:].strip()
  *                         if line == 'SATISFIABLE':
  *                             is_sat = True             # <<<<<<<<<<<<<<
  *                         elif line == 'UNSATISFIABLE':
  *                             is_sat = False
  */
                         __pyx_v_is_sat = 1;
 
-                        /* "sat_toolkit/formula.pyx":1177
+                        /* "sat_toolkit/formula.pyx":1184
  *                     if line.startswith('s '):
  *                         line = line[2:].strip()
  *                         if line == 'SATISFIABLE':             # <<<<<<<<<<<<<<
  *                             is_sat = True
  *                         elif line == 'UNSATISFIABLE':
  */
                         goto __pyx_L28;
                       }
 
-                      /* "sat_toolkit/formula.pyx":1179
+                      /* "sat_toolkit/formula.pyx":1186
  *                         if line == 'SATISFIABLE':
  *                             is_sat = True
  *                         elif line == 'UNSATISFIABLE':             # <<<<<<<<<<<<<<
  *                             is_sat = False
  *                         else:
  */
-                      __pyx_t_19 = (__Pyx_PyUnicode_Equals(__pyx_v_line, __pyx_n_u_UNSATISFIABLE, Py_EQ)); if (unlikely((__pyx_t_19 < 0))) __PYX_ERR(0, 1179, __pyx_L17_error)
+                      __pyx_t_19 = (__Pyx_PyUnicode_Equals(__pyx_v_line, __pyx_n_u_UNSATISFIABLE, Py_EQ)); if (unlikely((__pyx_t_19 < 0))) __PYX_ERR(0, 1186, __pyx_L17_error)
                       if (likely(__pyx_t_19)) {
 
-                        /* "sat_toolkit/formula.pyx":1180
+                        /* "sat_toolkit/formula.pyx":1187
  *                             is_sat = True
  *                         elif line == 'UNSATISFIABLE':
  *                             is_sat = False             # <<<<<<<<<<<<<<
  *                         else:
  *                             raise ValueError(f'unknown status: {line}')
  */
                         __pyx_v_is_sat = 0;
 
-                        /* "sat_toolkit/formula.pyx":1179
+                        /* "sat_toolkit/formula.pyx":1186
  *                         if line == 'SATISFIABLE':
  *                             is_sat = True
  *                         elif line == 'UNSATISFIABLE':             # <<<<<<<<<<<<<<
  *                             is_sat = False
  *                         else:
  */
                         goto __pyx_L28;
                       }
 
-                      /* "sat_toolkit/formula.pyx":1182
+                      /* "sat_toolkit/formula.pyx":1189
  *                             is_sat = False
  *                         else:
  *                             raise ValueError(f'unknown status: {line}')             # <<<<<<<<<<<<<<
  * 
  *                     if line.startswith('v '):
  */
                       /*else*/ {
-                        __pyx_t_3 = __Pyx_PyObject_FormatSimple(__pyx_v_line, __pyx_empty_unicode); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1182, __pyx_L17_error)
+                        __pyx_t_3 = __Pyx_PyObject_FormatSimple(__pyx_v_line, __pyx_empty_unicode); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1189, __pyx_L17_error)
                         __Pyx_GOTREF(__pyx_t_3);
-                        __pyx_t_5 = __Pyx_PyUnicode_Concat(__pyx_kp_u_unknown_status, __pyx_t_3); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1182, __pyx_L17_error)
+                        __pyx_t_5 = __Pyx_PyUnicode_Concat(__pyx_kp_u_unknown_status, __pyx_t_3); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1189, __pyx_L17_error)
                         __Pyx_GOTREF(__pyx_t_5);
                         __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-                        __pyx_t_3 = __Pyx_PyObject_CallOneArg(__pyx_builtin_ValueError, __pyx_t_5); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1182, __pyx_L17_error)
+                        __pyx_t_3 = __Pyx_PyObject_CallOneArg(__pyx_builtin_ValueError, __pyx_t_5); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1189, __pyx_L17_error)
                         __Pyx_GOTREF(__pyx_t_3);
                         __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
                         __Pyx_Raise(__pyx_t_3, 0, 0, 0);
                         __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-                        __PYX_ERR(0, 1182, __pyx_L17_error)
+                        __PYX_ERR(0, 1189, __pyx_L17_error)
                       }
                       __pyx_L28:;
 
-                      /* "sat_toolkit/formula.pyx":1175
+                      /* "sat_toolkit/formula.pyx":1182
  *                         continue
  * 
  *                     if line.startswith('s '):             # <<<<<<<<<<<<<<
  *                         line = line[2:].strip()
  *                         if line == 'SATISFIABLE':
  */
                     }
 
-                    /* "sat_toolkit/formula.pyx":1184
+                    /* "sat_toolkit/formula.pyx":1191
  *                             raise ValueError(f'unknown status: {line}')
  * 
  *                     if line.startswith('v '):             # <<<<<<<<<<<<<<
  *                         buf = np.fromstring(line[2:], dtype=np.int32, sep=' ')
  *                         for i in range(buf.shape[0]):
  */
-                    __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_v_line, __pyx_n_s_startswith); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1184, __pyx_L17_error)
+                    __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_v_line, __pyx_n_s_startswith); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1191, __pyx_L17_error)
                     __Pyx_GOTREF(__pyx_t_5);
                     __pyx_t_1 = NULL;
                     __pyx_t_7 = 0;
                     #if CYTHON_UNPACK_METHODS
                     if (likely(PyMethod_Check(__pyx_t_5))) {
                       __pyx_t_1 = PyMethod_GET_SELF(__pyx_t_5);
                       if (likely(__pyx_t_1)) {
@@ -41124,156 +41261,156 @@
                       }
                     }
                     #endif
                     {
                       PyObject *__pyx_callargs[2] = {__pyx_t_1, __pyx_kp_u_v};
                       __pyx_t_3 = __Pyx_PyObject_FastCall(__pyx_t_5, __pyx_callargs+1-__pyx_t_7, 1+__pyx_t_7);
                       __Pyx_XDECREF(__pyx_t_1); __pyx_t_1 = 0;
-                      if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1184, __pyx_L17_error)
+                      if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1191, __pyx_L17_error)
                       __Pyx_GOTREF(__pyx_t_3);
                       __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
                     }
-                    __pyx_t_19 = __Pyx_PyObject_IsTrue(__pyx_t_3); if (unlikely((__pyx_t_19 < 0))) __PYX_ERR(0, 1184, __pyx_L17_error)
+                    __pyx_t_19 = __Pyx_PyObject_IsTrue(__pyx_t_3); if (unlikely((__pyx_t_19 < 0))) __PYX_ERR(0, 1191, __pyx_L17_error)
                     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
                     if (__pyx_t_19) {
 
-                      /* "sat_toolkit/formula.pyx":1185
+                      /* "sat_toolkit/formula.pyx":1192
  * 
  *                     if line.startswith('v '):
  *                         buf = np.fromstring(line[2:], dtype=np.int32, sep=' ')             # <<<<<<<<<<<<<<
  *                         for i in range(buf.shape[0]):
  *                             lit = buf[i]
  */
-                      __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_np); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1185, __pyx_L17_error)
+                      __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_np); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1192, __pyx_L17_error)
                       __Pyx_GOTREF(__pyx_t_3);
-                      __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_fromstring); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1185, __pyx_L17_error)
+                      __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_fromstring); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1192, __pyx_L17_error)
                       __Pyx_GOTREF(__pyx_t_5);
                       __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-                      __pyx_t_3 = __Pyx_PyObject_GetSlice(__pyx_v_line, 2, 0, NULL, NULL, &__pyx_slice__38, 1, 0, 0); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1185, __pyx_L17_error)
+                      __pyx_t_3 = __Pyx_PyObject_GetSlice(__pyx_v_line, 2, 0, NULL, NULL, &__pyx_slice__38, 1, 0, 0); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1192, __pyx_L17_error)
                       __Pyx_GOTREF(__pyx_t_3);
-                      __pyx_t_1 = PyTuple_New(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1185, __pyx_L17_error)
+                      __pyx_t_1 = PyTuple_New(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1192, __pyx_L17_error)
                       __Pyx_GOTREF(__pyx_t_1);
                       __Pyx_GIVEREF(__pyx_t_3);
-                      if (__Pyx_PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_t_3)) __PYX_ERR(0, 1185, __pyx_L17_error);
+                      if (__Pyx_PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_t_3)) __PYX_ERR(0, 1192, __pyx_L17_error);
                       __pyx_t_3 = 0;
-                      __pyx_t_3 = __Pyx_PyDict_NewPresized(2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1185, __pyx_L17_error)
+                      __pyx_t_3 = __Pyx_PyDict_NewPresized(2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1192, __pyx_L17_error)
                       __Pyx_GOTREF(__pyx_t_3);
-                      __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_np); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1185, __pyx_L17_error)
+                      __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_np); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1192, __pyx_L17_error)
                       __Pyx_GOTREF(__pyx_t_4);
-                      __pyx_t_20 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_int32); if (unlikely(!__pyx_t_20)) __PYX_ERR(0, 1185, __pyx_L17_error)
+                      __pyx_t_20 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_int32); if (unlikely(!__pyx_t_20)) __PYX_ERR(0, 1192, __pyx_L17_error)
                       __Pyx_GOTREF(__pyx_t_20);
                       __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-                      if (PyDict_SetItem(__pyx_t_3, __pyx_n_s_dtype, __pyx_t_20) < 0) __PYX_ERR(0, 1185, __pyx_L17_error)
+                      if (PyDict_SetItem(__pyx_t_3, __pyx_n_s_dtype, __pyx_t_20) < 0) __PYX_ERR(0, 1192, __pyx_L17_error)
                       __Pyx_DECREF(__pyx_t_20); __pyx_t_20 = 0;
-                      if (PyDict_SetItem(__pyx_t_3, __pyx_n_s_sep, __pyx_kp_u__32) < 0) __PYX_ERR(0, 1185, __pyx_L17_error)
-                      __pyx_t_20 = __Pyx_PyObject_Call(__pyx_t_5, __pyx_t_1, __pyx_t_3); if (unlikely(!__pyx_t_20)) __PYX_ERR(0, 1185, __pyx_L17_error)
+                      if (PyDict_SetItem(__pyx_t_3, __pyx_n_s_sep, __pyx_kp_u__32) < 0) __PYX_ERR(0, 1192, __pyx_L17_error)
+                      __pyx_t_20 = __Pyx_PyObject_Call(__pyx_t_5, __pyx_t_1, __pyx_t_3); if (unlikely(!__pyx_t_20)) __PYX_ERR(0, 1192, __pyx_L17_error)
                       __Pyx_GOTREF(__pyx_t_20);
                       __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
                       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
                       __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-                      __pyx_t_8 = __Pyx_PyObject_to_MemoryviewSlice_dc_nn___pyx_t_11sat_toolkit_5types_int32_t(__pyx_t_20, PyBUF_WRITABLE); if (unlikely(!__pyx_t_8.memview)) __PYX_ERR(0, 1185, __pyx_L17_error)
+                      __pyx_t_8 = __Pyx_PyObject_to_MemoryviewSlice_dc_nn___pyx_t_11sat_toolkit_5types_int32_t(__pyx_t_20, PyBUF_WRITABLE); if (unlikely(!__pyx_t_8.memview)) __PYX_ERR(0, 1192, __pyx_L17_error)
                       __Pyx_DECREF(__pyx_t_20); __pyx_t_20 = 0;
                       __PYX_XCLEAR_MEMVIEW(&__pyx_v_buf, 1);
                       __pyx_v_buf = __pyx_t_8;
                       __pyx_t_8.memview = NULL;
                       __pyx_t_8.data = NULL;
 
-                      /* "sat_toolkit/formula.pyx":1186
+                      /* "sat_toolkit/formula.pyx":1193
  *                     if line.startswith('v '):
  *                         buf = np.fromstring(line[2:], dtype=np.int32, sep=' ')
  *                         for i in range(buf.shape[0]):             # <<<<<<<<<<<<<<
  *                             lit = buf[i]
  *                             if abs(lit) >= result_view.shape[0]:
  */
                       __pyx_t_21 = (__pyx_v_buf.shape[0]);
                       __pyx_t_22 = __pyx_t_21;
                       for (__pyx_t_23 = 0; __pyx_t_23 < __pyx_t_22; __pyx_t_23+=1) {
                         __pyx_v_i = __pyx_t_23;
 
-                        /* "sat_toolkit/formula.pyx":1187
+                        /* "sat_toolkit/formula.pyx":1194
  *                         buf = np.fromstring(line[2:], dtype=np.int32, sep=' ')
  *                         for i in range(buf.shape[0]):
  *                             lit = buf[i]             # <<<<<<<<<<<<<<
  *                             if abs(lit) >= result_view.shape[0]:
  *                                 raise IndexError('solver returned model index that is out of bounds')
  */
                         __pyx_t_24 = __pyx_v_i;
                         __pyx_v_lit = (*((__pyx_t_11sat_toolkit_5types_int32_t *) ( /* dim=0 */ ((char *) (((__pyx_t_11sat_toolkit_5types_int32_t *) __pyx_v_buf.data) + __pyx_t_24)) )));
 
-                        /* "sat_toolkit/formula.pyx":1188
+                        /* "sat_toolkit/formula.pyx":1195
  *                         for i in range(buf.shape[0]):
  *                             lit = buf[i]
  *                             if abs(lit) >= result_view.shape[0]:             # <<<<<<<<<<<<<<
  *                                 raise IndexError('solver returned model index that is out of bounds')
  *                             result_view[abs(lit)] = lit > 0
  */
                         __pyx_t_19 = (__pyx_f_11sat_toolkit_7formula_abs(__pyx_v_lit) >= (__pyx_v_result_view.shape[0]));
                         if (unlikely(__pyx_t_19)) {
 
-                          /* "sat_toolkit/formula.pyx":1189
+                          /* "sat_toolkit/formula.pyx":1196
  *                             lit = buf[i]
  *                             if abs(lit) >= result_view.shape[0]:
  *                                 raise IndexError('solver returned model index that is out of bounds')             # <<<<<<<<<<<<<<
  *                             result_view[abs(lit)] = lit > 0
  * 
  */
-                          __pyx_t_20 = __Pyx_PyObject_Call(__pyx_builtin_IndexError, __pyx_tuple__39, NULL); if (unlikely(!__pyx_t_20)) __PYX_ERR(0, 1189, __pyx_L17_error)
+                          __pyx_t_20 = __Pyx_PyObject_Call(__pyx_builtin_IndexError, __pyx_tuple__39, NULL); if (unlikely(!__pyx_t_20)) __PYX_ERR(0, 1196, __pyx_L17_error)
                           __Pyx_GOTREF(__pyx_t_20);
                           __Pyx_Raise(__pyx_t_20, 0, 0, 0);
                           __Pyx_DECREF(__pyx_t_20); __pyx_t_20 = 0;
-                          __PYX_ERR(0, 1189, __pyx_L17_error)
+                          __PYX_ERR(0, 1196, __pyx_L17_error)
 
-                          /* "sat_toolkit/formula.pyx":1188
+                          /* "sat_toolkit/formula.pyx":1195
  *                         for i in range(buf.shape[0]):
  *                             lit = buf[i]
  *                             if abs(lit) >= result_view.shape[0]:             # <<<<<<<<<<<<<<
  *                                 raise IndexError('solver returned model index that is out of bounds')
  *                             result_view[abs(lit)] = lit > 0
  */
                         }
 
-                        /* "sat_toolkit/formula.pyx":1190
+                        /* "sat_toolkit/formula.pyx":1197
  *                             if abs(lit) >= result_view.shape[0]:
  *                                 raise IndexError('solver returned model index that is out of bounds')
  *                             result_view[abs(lit)] = lit > 0             # <<<<<<<<<<<<<<
  * 
  * 
  */
                         __pyx_t_24 = __pyx_f_11sat_toolkit_7formula_abs(__pyx_v_lit);
                         *((__pyx_t_11sat_toolkit_5types_uint8_t *) ( /* dim=0 */ (__pyx_v_result_view.data + __pyx_t_24 * __pyx_v_result_view.strides[0]) )) = (__pyx_v_lit > 0);
                       }
 
-                      /* "sat_toolkit/formula.pyx":1184
+                      /* "sat_toolkit/formula.pyx":1191
  *                             raise ValueError(f'unknown status: {line}')
  * 
  *                     if line.startswith('v '):             # <<<<<<<<<<<<<<
  *                         buf = np.fromstring(line[2:], dtype=np.int32, sep=' ')
  *                         for i in range(buf.shape[0]):
  */
                     }
 
-                    /* "sat_toolkit/formula.pyx":1168
+                    /* "sat_toolkit/formula.pyx":1175
  *             with sp.Popen(args, stdin=sp.DEVNULL, stdout=sp.PIPE, text=True) as solver:
  * 
  *                 for line in solver.stdout:             # <<<<<<<<<<<<<<
  *                     if echo_comments:
  *                         print(line, end='')
  */
                     __pyx_L23_continue:;
                   }
                   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
 
-                  /* "sat_toolkit/formula.pyx":1193
+                  /* "sat_toolkit/formula.pyx":1200
  * 
  * 
  *                 ret_code = solver.wait()             # <<<<<<<<<<<<<<
  *                 if ret_code not in [10, 20]:
  *                     # for SAT solvers ret_code == 10 corresponds to SATISFIABLE and
  */
-                  __pyx_t_20 = __Pyx_PyObject_GetAttrStr(__pyx_v_solver, __pyx_n_s_wait); if (unlikely(!__pyx_t_20)) __PYX_ERR(0, 1193, __pyx_L17_error)
+                  __pyx_t_20 = __Pyx_PyObject_GetAttrStr(__pyx_v_solver, __pyx_n_s_wait); if (unlikely(!__pyx_t_20)) __PYX_ERR(0, 1200, __pyx_L17_error)
                   __Pyx_GOTREF(__pyx_t_20);
                   __pyx_t_3 = NULL;
                   __pyx_t_7 = 0;
                   #if CYTHON_UNPACK_METHODS
                   if (likely(PyMethod_Check(__pyx_t_20))) {
                     __pyx_t_3 = PyMethod_GET_SELF(__pyx_t_20);
                     if (likely(__pyx_t_3)) {
@@ -41285,23 +41422,23 @@
                     }
                   }
                   #endif
                   {
                     PyObject *__pyx_callargs[2] = {__pyx_t_3, NULL};
                     __pyx_t_2 = __Pyx_PyObject_FastCall(__pyx_t_20, __pyx_callargs+1-__pyx_t_7, 0+__pyx_t_7);
                     __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
-                    if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1193, __pyx_L17_error)
+                    if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1200, __pyx_L17_error)
                     __Pyx_GOTREF(__pyx_t_2);
                     __Pyx_DECREF(__pyx_t_20); __pyx_t_20 = 0;
                   }
-                  __pyx_t_7 = __Pyx_PyInt_As_int(__pyx_t_2); if (unlikely((__pyx_t_7 == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 1193, __pyx_L17_error)
+                  __pyx_t_7 = __Pyx_PyInt_As_int(__pyx_t_2); if (unlikely((__pyx_t_7 == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 1200, __pyx_L17_error)
                   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
                   __pyx_v_ret_code = __pyx_t_7;
 
-                  /* "sat_toolkit/formula.pyx":1194
+                  /* "sat_toolkit/formula.pyx":1201
  * 
  *                 ret_code = solver.wait()
  *                 if ret_code not in [10, 20]:             # <<<<<<<<<<<<<<
  *                     # for SAT solvers ret_code == 10 corresponds to SATISFIABLE and
  *                     # ret == 20 to UNSATISFIABLE (see for example
  */
                   switch (__pyx_v_ret_code) {
@@ -41312,31 +41449,31 @@
                     default:
                     __pyx_t_19 = 1;
                     break;
                   }
                   __pyx_t_25 = __pyx_t_19;
                   if (unlikely(__pyx_t_25)) {
 
-                    /* "sat_toolkit/formula.pyx":1198
+                    /* "sat_toolkit/formula.pyx":1205
  *                     # ret == 20 to UNSATISFIABLE (see for example
  *                     # http://www.satcompetition.org/2004/format-solvers2004.html)
  *                     raise sp.CalledProcessError(ret_code, ' '.join(solver.args))             # <<<<<<<<<<<<<<
  * 
  *                 is_sat = ret_code == 10
  */
-                    __Pyx_GetModuleGlobalName(__pyx_t_20, __pyx_n_s_sp); if (unlikely(!__pyx_t_20)) __PYX_ERR(0, 1198, __pyx_L17_error)
+                    __Pyx_GetModuleGlobalName(__pyx_t_20, __pyx_n_s_sp); if (unlikely(!__pyx_t_20)) __PYX_ERR(0, 1205, __pyx_L17_error)
                     __Pyx_GOTREF(__pyx_t_20);
-                    __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_20, __pyx_n_s_CalledProcessError); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1198, __pyx_L17_error)
+                    __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_20, __pyx_n_s_CalledProcessError); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1205, __pyx_L17_error)
                     __Pyx_GOTREF(__pyx_t_3);
                     __Pyx_DECREF(__pyx_t_20); __pyx_t_20 = 0;
-                    __pyx_t_20 = __Pyx_PyInt_From_int(__pyx_v_ret_code); if (unlikely(!__pyx_t_20)) __PYX_ERR(0, 1198, __pyx_L17_error)
+                    __pyx_t_20 = __Pyx_PyInt_From_int(__pyx_v_ret_code); if (unlikely(!__pyx_t_20)) __PYX_ERR(0, 1205, __pyx_L17_error)
                     __Pyx_GOTREF(__pyx_t_20);
-                    __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_solver, __pyx_n_s_args); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1198, __pyx_L17_error)
+                    __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_solver, __pyx_n_s_args); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1205, __pyx_L17_error)
                     __Pyx_GOTREF(__pyx_t_1);
-                    __pyx_t_5 = PyUnicode_Join(__pyx_kp_u__32, __pyx_t_1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1198, __pyx_L17_error)
+                    __pyx_t_5 = PyUnicode_Join(__pyx_kp_u__32, __pyx_t_1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1205, __pyx_L17_error)
                     __Pyx_GOTREF(__pyx_t_5);
                     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
                     __pyx_t_1 = NULL;
                     __pyx_t_7 = 0;
                     #if CYTHON_UNPACK_METHODS
                     if (unlikely(PyMethod_Check(__pyx_t_3))) {
                       __pyx_t_1 = PyMethod_GET_SELF(__pyx_t_3);
@@ -41351,41 +41488,41 @@
                     #endif
                     {
                       PyObject *__pyx_callargs[3] = {__pyx_t_1, __pyx_t_20, __pyx_t_5};
                       __pyx_t_2 = __Pyx_PyObject_FastCall(__pyx_t_3, __pyx_callargs+1-__pyx_t_7, 2+__pyx_t_7);
                       __Pyx_XDECREF(__pyx_t_1); __pyx_t_1 = 0;
                       __Pyx_DECREF(__pyx_t_20); __pyx_t_20 = 0;
                       __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-                      if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1198, __pyx_L17_error)
+                      if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1205, __pyx_L17_error)
                       __Pyx_GOTREF(__pyx_t_2);
                       __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
                     }
                     __Pyx_Raise(__pyx_t_2, 0, 0, 0);
                     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-                    __PYX_ERR(0, 1198, __pyx_L17_error)
+                    __PYX_ERR(0, 1205, __pyx_L17_error)
 
-                    /* "sat_toolkit/formula.pyx":1194
+                    /* "sat_toolkit/formula.pyx":1201
  * 
  *                 ret_code = solver.wait()
  *                 if ret_code not in [10, 20]:             # <<<<<<<<<<<<<<
  *                     # for SAT solvers ret_code == 10 corresponds to SATISFIABLE and
  *                     # ret == 20 to UNSATISFIABLE (see for example
  */
                   }
 
-                  /* "sat_toolkit/formula.pyx":1200
+                  /* "sat_toolkit/formula.pyx":1207
  *                     raise sp.CalledProcessError(ret_code, ' '.join(solver.args))
  * 
  *                 is_sat = ret_code == 10             # <<<<<<<<<<<<<<
  * 
  *             if is_sat:
  */
                   __pyx_v_is_sat = (__pyx_v_ret_code == 10);
 
-                  /* "sat_toolkit/formula.pyx":1166
+                  /* "sat_toolkit/formula.pyx":1173
  * 
  *             args = command + [f.name]
  *             with sp.Popen(args, stdin=sp.DEVNULL, stdout=sp.PIPE, text=True) as solver:             # <<<<<<<<<<<<<<
  * 
  *                 for line in solver.stdout:
  */
                 }
@@ -41402,36 +41539,36 @@
                 __Pyx_XDECREF(__pyx_t_5); __pyx_t_5 = 0;
                 __PYX_XCLEAR_MEMVIEW(&__pyx_t_6, 1);
                 __pyx_t_6.memview = NULL; __pyx_t_6.data = NULL;
                 __PYX_XCLEAR_MEMVIEW(&__pyx_t_8, 1);
                 __pyx_t_8.memview = NULL; __pyx_t_8.data = NULL;
                 /*except:*/ {
                   __Pyx_AddTraceback("sat_toolkit.formula.CNF.solve_dimacs", __pyx_clineno, __pyx_lineno, __pyx_filename);
-                  if (__Pyx_GetException(&__pyx_t_2, &__pyx_t_3, &__pyx_t_5) < 0) __PYX_ERR(0, 1166, __pyx_L19_except_error)
+                  if (__Pyx_GetException(&__pyx_t_2, &__pyx_t_3, &__pyx_t_5) < 0) __PYX_ERR(0, 1173, __pyx_L19_except_error)
                   __Pyx_XGOTREF(__pyx_t_2);
                   __Pyx_XGOTREF(__pyx_t_3);
                   __Pyx_XGOTREF(__pyx_t_5);
-                  __pyx_t_20 = PyTuple_Pack(3, __pyx_t_2, __pyx_t_3, __pyx_t_5); if (unlikely(!__pyx_t_20)) __PYX_ERR(0, 1166, __pyx_L19_except_error)
+                  __pyx_t_20 = PyTuple_Pack(3, __pyx_t_2, __pyx_t_3, __pyx_t_5); if (unlikely(!__pyx_t_20)) __PYX_ERR(0, 1173, __pyx_L19_except_error)
                   __Pyx_GOTREF(__pyx_t_20);
                   __pyx_t_26 = __Pyx_PyObject_Call(__pyx_t_13, __pyx_t_20, NULL);
                   __Pyx_DECREF(__pyx_t_13); __pyx_t_13 = 0;
                   __Pyx_DECREF(__pyx_t_20); __pyx_t_20 = 0;
-                  if (unlikely(!__pyx_t_26)) __PYX_ERR(0, 1166, __pyx_L19_except_error)
+                  if (unlikely(!__pyx_t_26)) __PYX_ERR(0, 1173, __pyx_L19_except_error)
                   __Pyx_GOTREF(__pyx_t_26);
                   __pyx_t_25 = __Pyx_PyObject_IsTrue(__pyx_t_26);
                   __Pyx_DECREF(__pyx_t_26); __pyx_t_26 = 0;
-                  if (__pyx_t_25 < 0) __PYX_ERR(0, 1166, __pyx_L19_except_error)
+                  if (__pyx_t_25 < 0) __PYX_ERR(0, 1173, __pyx_L19_except_error)
                   __pyx_t_19 = (!__pyx_t_25);
                   if (unlikely(__pyx_t_19)) {
                     __Pyx_GIVEREF(__pyx_t_2);
                     __Pyx_GIVEREF(__pyx_t_3);
                     __Pyx_XGIVEREF(__pyx_t_5);
                     __Pyx_ErrRestoreWithState(__pyx_t_2, __pyx_t_3, __pyx_t_5);
                     __pyx_t_2 = 0; __pyx_t_3 = 0; __pyx_t_5 = 0; 
-                    __PYX_ERR(0, 1166, __pyx_L19_except_error)
+                    __PYX_ERR(0, 1173, __pyx_L19_except_error)
                   }
                   __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
                   __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
                   __Pyx_XDECREF(__pyx_t_5); __pyx_t_5 = 0;
                   goto __pyx_L18_exception_handled;
                 }
                 __pyx_L19_except_error:;
@@ -41449,82 +41586,82 @@
               }
             }
             /*finally:*/ {
               /*normal exit:*/{
                 if (__pyx_t_13) {
                   __pyx_t_16 = __Pyx_PyObject_Call(__pyx_t_13, __pyx_tuple__35, NULL);
                   __Pyx_DECREF(__pyx_t_13); __pyx_t_13 = 0;
-                  if (unlikely(!__pyx_t_16)) __PYX_ERR(0, 1166, __pyx_L7_error)
+                  if (unlikely(!__pyx_t_16)) __PYX_ERR(0, 1173, __pyx_L7_error)
                   __Pyx_GOTREF(__pyx_t_16);
                   __Pyx_DECREF(__pyx_t_16); __pyx_t_16 = 0;
                 }
                 goto __pyx_L16;
               }
               __pyx_L16:;
             }
             goto __pyx_L38;
             __pyx_L13_error:;
             __Pyx_DECREF(__pyx_t_13); __pyx_t_13 = 0;
             goto __pyx_L7_error;
             __pyx_L38:;
           }
 
-          /* "sat_toolkit/formula.pyx":1202
+          /* "sat_toolkit/formula.pyx":1209
  *                 is_sat = ret_code == 10
  * 
  *             if is_sat:             # <<<<<<<<<<<<<<
  *                 return True, result
  *             else:
  */
           if (__pyx_v_is_sat) {
 
-            /* "sat_toolkit/formula.pyx":1203
+            /* "sat_toolkit/formula.pyx":1210
  * 
  *             if is_sat:
  *                 return True, result             # <<<<<<<<<<<<<<
  *             else:
  *                 return False, None
  */
             __Pyx_XDECREF(__pyx_r);
-            __pyx_t_5 = PyTuple_New(2); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1203, __pyx_L7_error)
+            __pyx_t_5 = PyTuple_New(2); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1210, __pyx_L7_error)
             __Pyx_GOTREF(__pyx_t_5);
             __Pyx_INCREF(Py_True);
             __Pyx_GIVEREF(Py_True);
-            if (__Pyx_PyTuple_SET_ITEM(__pyx_t_5, 0, Py_True)) __PYX_ERR(0, 1203, __pyx_L7_error);
+            if (__Pyx_PyTuple_SET_ITEM(__pyx_t_5, 0, Py_True)) __PYX_ERR(0, 1210, __pyx_L7_error);
             __Pyx_INCREF(__pyx_v_result);
             __Pyx_GIVEREF(__pyx_v_result);
-            if (__Pyx_PyTuple_SET_ITEM(__pyx_t_5, 1, __pyx_v_result)) __PYX_ERR(0, 1203, __pyx_L7_error);
+            if (__Pyx_PyTuple_SET_ITEM(__pyx_t_5, 1, __pyx_v_result)) __PYX_ERR(0, 1210, __pyx_L7_error);
             __pyx_r = __pyx_t_5;
             __pyx_t_5 = 0;
             goto __pyx_L11_try_return;
 
-            /* "sat_toolkit/formula.pyx":1202
+            /* "sat_toolkit/formula.pyx":1209
  *                 is_sat = ret_code == 10
  * 
  *             if is_sat:             # <<<<<<<<<<<<<<
  *                 return True, result
  *             else:
  */
           }
 
-          /* "sat_toolkit/formula.pyx":1205
+          /* "sat_toolkit/formula.pyx":1212
  *                 return True, result
  *             else:
  *                 return False, None             # <<<<<<<<<<<<<<
  * 
  * 
  */
           /*else*/ {
             __Pyx_XDECREF(__pyx_r);
             __Pyx_INCREF(__pyx_tuple__40);
             __pyx_r = __pyx_tuple__40;
             goto __pyx_L11_try_return;
           }
 
-          /* "sat_toolkit/formula.pyx":1161
+          /* "sat_toolkit/formula.pyx":1168
  * 
  * 
  *         with NamedTemporaryFile('w', prefix='sat_toolkit_', suffix='.cnf') as f:             # <<<<<<<<<<<<<<
  *             f.write(self.to_dimacs())
  *             f.flush()
  */
         }
@@ -41537,36 +41674,36 @@
         __Pyx_XDECREF(__pyx_t_5); __pyx_t_5 = 0;
         __PYX_XCLEAR_MEMVIEW(&__pyx_t_6, 1);
         __pyx_t_6.memview = NULL; __pyx_t_6.data = NULL;
         __PYX_XCLEAR_MEMVIEW(&__pyx_t_8, 1);
         __pyx_t_8.memview = NULL; __pyx_t_8.data = NULL;
         /*except:*/ {
           __Pyx_AddTraceback("sat_toolkit.formula.CNF.solve_dimacs", __pyx_clineno, __pyx_lineno, __pyx_filename);
-          if (__Pyx_GetException(&__pyx_t_5, &__pyx_t_3, &__pyx_t_2) < 0) __PYX_ERR(0, 1161, __pyx_L9_except_error)
+          if (__Pyx_GetException(&__pyx_t_5, &__pyx_t_3, &__pyx_t_2) < 0) __PYX_ERR(0, 1168, __pyx_L9_except_error)
           __Pyx_XGOTREF(__pyx_t_5);
           __Pyx_XGOTREF(__pyx_t_3);
           __Pyx_XGOTREF(__pyx_t_2);
-          __pyx_t_20 = PyTuple_Pack(3, __pyx_t_5, __pyx_t_3, __pyx_t_2); if (unlikely(!__pyx_t_20)) __PYX_ERR(0, 1161, __pyx_L9_except_error)
+          __pyx_t_20 = PyTuple_Pack(3, __pyx_t_5, __pyx_t_3, __pyx_t_2); if (unlikely(!__pyx_t_20)) __PYX_ERR(0, 1168, __pyx_L9_except_error)
           __Pyx_GOTREF(__pyx_t_20);
           __pyx_t_13 = __Pyx_PyObject_Call(__pyx_t_9, __pyx_t_20, NULL);
           __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
           __Pyx_DECREF(__pyx_t_20); __pyx_t_20 = 0;
-          if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 1161, __pyx_L9_except_error)
+          if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 1168, __pyx_L9_except_error)
           __Pyx_GOTREF(__pyx_t_13);
           __pyx_t_19 = __Pyx_PyObject_IsTrue(__pyx_t_13);
           __Pyx_DECREF(__pyx_t_13); __pyx_t_13 = 0;
-          if (__pyx_t_19 < 0) __PYX_ERR(0, 1161, __pyx_L9_except_error)
+          if (__pyx_t_19 < 0) __PYX_ERR(0, 1168, __pyx_L9_except_error)
           __pyx_t_25 = (!__pyx_t_19);
           if (unlikely(__pyx_t_25)) {
             __Pyx_GIVEREF(__pyx_t_5);
             __Pyx_GIVEREF(__pyx_t_3);
             __Pyx_XGIVEREF(__pyx_t_2);
             __Pyx_ErrRestoreWithState(__pyx_t_5, __pyx_t_3, __pyx_t_2);
             __pyx_t_5 = 0; __pyx_t_3 = 0; __pyx_t_2 = 0; 
-            __PYX_ERR(0, 1161, __pyx_L9_except_error)
+            __PYX_ERR(0, 1168, __pyx_L9_except_error)
           }
           __Pyx_XDECREF(__pyx_t_5); __pyx_t_5 = 0;
           __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
           __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
           goto __pyx_L8_exception_handled;
         }
         __pyx_L9_except_error:;
@@ -41589,27 +41726,27 @@
       }
     }
     /*finally:*/ {
       /*normal exit:*/{
         if (__pyx_t_9) {
           __pyx_t_12 = __Pyx_PyObject_Call(__pyx_t_9, __pyx_tuple__35, NULL);
           __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
-          if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 1161, __pyx_L1_error)
+          if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 1168, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_12);
           __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;
         }
         goto __pyx_L6;
       }
       __pyx_L4_return: {
         __pyx_t_12 = __pyx_r;
         __pyx_r = 0;
         if (__pyx_t_9) {
           __pyx_t_11 = __Pyx_PyObject_Call(__pyx_t_9, __pyx_tuple__35, NULL);
           __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
-          if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1161, __pyx_L1_error)
+          if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1168, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_11);
           __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
         }
         __pyx_r = __pyx_t_12;
         __pyx_t_12 = 0;
         goto __pyx_L0;
       }
@@ -41618,15 +41755,15 @@
     goto __pyx_L43;
     __pyx_L3_error:;
     __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
     goto __pyx_L1_error;
     __pyx_L43:;
   }
 
-  /* "sat_toolkit/formula.pyx":1141
+  /* "sat_toolkit/formula.pyx":1148
  * 
  * 
  *     def solve_dimacs(self, command: List[str], verbose=False) -> Tuple[bool, np.array|None]:             # <<<<<<<<<<<<<<
  *         """
  *         solves the SAT by calling a DIMACS the compliant sat solver given by command.
  */
 
@@ -41653,15 +41790,15 @@
   __Pyx_XDECREF(__pyx_v_solver);
   __Pyx_XDECREF(__pyx_v_line);
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "sat_toolkit/formula.pyx":1209
+/* "sat_toolkit/formula.pyx":1216
  * 
  * 
  *     def check_solution(self, uint8_t[:] solution) -> bool:             # <<<<<<<<<<<<<<
  *         cdef size_t i
  *         for i in range(solution.shape[0]):
  */
 
@@ -41715,31 +41852,31 @@
       kw_args = __Pyx_NumKwargs_FASTCALL(__pyx_kwds);
       switch (__pyx_nargs) {
         case  0:
         if (likely((values[0] = __Pyx_GetKwValue_FASTCALL(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_solution)) != 0)) {
           (void)__Pyx_Arg_NewRef_FASTCALL(values[0]);
           kw_args--;
         }
-        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 1209, __pyx_L3_error)
+        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 1216, __pyx_L3_error)
         else goto __pyx_L5_argtuple_error;
       }
       if (unlikely(kw_args > 0)) {
         const Py_ssize_t kwd_pos_args = __pyx_nargs;
-        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values + 0, kwd_pos_args, "check_solution") < 0)) __PYX_ERR(0, 1209, __pyx_L3_error)
+        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values + 0, kwd_pos_args, "check_solution") < 0)) __PYX_ERR(0, 1216, __pyx_L3_error)
       }
     } else if (unlikely(__pyx_nargs != 1)) {
       goto __pyx_L5_argtuple_error;
     } else {
       values[0] = __Pyx_Arg_FASTCALL(__pyx_args, 0);
     }
-    __pyx_v_solution = __Pyx_PyObject_to_MemoryviewSlice_ds_nn___pyx_t_11sat_toolkit_5types_uint8_t(values[0], PyBUF_WRITABLE); if (unlikely(!__pyx_v_solution.memview)) __PYX_ERR(0, 1209, __pyx_L3_error)
+    __pyx_v_solution = __Pyx_PyObject_to_MemoryviewSlice_ds_nn___pyx_t_11sat_toolkit_5types_uint8_t(values[0], PyBUF_WRITABLE); if (unlikely(!__pyx_v_solution.memview)) __PYX_ERR(0, 1216, __pyx_L3_error)
   }
   goto __pyx_L6_skip;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("check_solution", 1, 1, 1, __pyx_nargs); __PYX_ERR(0, 1209, __pyx_L3_error)
+  __Pyx_RaiseArgtupleInvalid("check_solution", 1, 1, 1, __pyx_nargs); __PYX_ERR(0, 1216, __pyx_L3_error)
   __pyx_L6_skip:;
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L3_error:;
   {
     Py_ssize_t __pyx_temp;
     for (__pyx_temp=0; __pyx_temp < (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
       __Pyx_Arg_XDECREF_FASTCALL(values[__pyx_temp]);
@@ -41778,27 +41915,27 @@
   PyObject *__pyx_t_8 = NULL;
   int __pyx_t_9;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("check_solution", 1);
 
-  /* "sat_toolkit/formula.pyx":1211
+  /* "sat_toolkit/formula.pyx":1218
  *     def check_solution(self, uint8_t[:] solution) -> bool:
  *         cdef size_t i
  *         for i in range(solution.shape[0]):             # <<<<<<<<<<<<<<
  *            if solution[i] not in [0, 1]:
  *                raise ValueError(f'all elements in solution must be in [0, 1]')
  */
   __pyx_t_1 = (__pyx_v_solution.shape[0]);
   __pyx_t_2 = __pyx_t_1;
   for (__pyx_t_3 = 0; __pyx_t_3 < __pyx_t_2; __pyx_t_3+=1) {
     __pyx_v_i = __pyx_t_3;
 
-    /* "sat_toolkit/formula.pyx":1212
+    /* "sat_toolkit/formula.pyx":1219
  *         cdef size_t i
  *         for i in range(solution.shape[0]):
  *            if solution[i] not in [0, 1]:             # <<<<<<<<<<<<<<
  *                raise ValueError(f'all elements in solution must be in [0, 1]')
  * 
  */
     __pyx_t_4 = __pyx_v_i;
@@ -41811,53 +41948,53 @@
     }
     __pyx_t_7 = (__pyx_t_5 != 1);
     __pyx_t_6 = __pyx_t_7;
     __pyx_L6_bool_binop_done:;
     __pyx_t_7 = __pyx_t_6;
     if (unlikely(__pyx_t_7)) {
 
-      /* "sat_toolkit/formula.pyx":1213
+      /* "sat_toolkit/formula.pyx":1220
  *         for i in range(solution.shape[0]):
  *            if solution[i] not in [0, 1]:
  *                raise ValueError(f'all elements in solution must be in [0, 1]')             # <<<<<<<<<<<<<<
  * 
  *         return self._check_solution(solution)
  */
-      __pyx_t_8 = __Pyx_PyObject_Call(__pyx_builtin_ValueError, __pyx_tuple__41, NULL); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1213, __pyx_L1_error)
+      __pyx_t_8 = __Pyx_PyObject_Call(__pyx_builtin_ValueError, __pyx_tuple__41, NULL); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1220, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_8);
       __Pyx_Raise(__pyx_t_8, 0, 0, 0);
       __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
-      __PYX_ERR(0, 1213, __pyx_L1_error)
+      __PYX_ERR(0, 1220, __pyx_L1_error)
 
-      /* "sat_toolkit/formula.pyx":1212
+      /* "sat_toolkit/formula.pyx":1219
  *         cdef size_t i
  *         for i in range(solution.shape[0]):
  *            if solution[i] not in [0, 1]:             # <<<<<<<<<<<<<<
  *                raise ValueError(f'all elements in solution must be in [0, 1]')
  * 
  */
     }
   }
 
-  /* "sat_toolkit/formula.pyx":1215
+  /* "sat_toolkit/formula.pyx":1222
  *                raise ValueError(f'all elements in solution must be in [0, 1]')
  * 
  *         return self._check_solution(solution)             # <<<<<<<<<<<<<<
  * 
  *     cdef int _check_solution(self, uint8_t[:] solution) except -1 nogil:
  */
   __Pyx_XDECREF(__pyx_r);
-  __pyx_t_9 = ((struct __pyx_vtabstruct_11sat_toolkit_7formula_CNF *)__pyx_v_self->__pyx_base.__pyx_vtab)->_check_solution(__pyx_v_self, __pyx_v_solution); if (unlikely(__pyx_t_9 == ((int)-1))) __PYX_ERR(0, 1215, __pyx_L1_error)
-  __pyx_t_8 = __Pyx_PyInt_From_int(__pyx_t_9); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1215, __pyx_L1_error)
+  __pyx_t_9 = ((struct __pyx_vtabstruct_11sat_toolkit_7formula_CNF *)__pyx_v_self->__pyx_base.__pyx_vtab)->_check_solution(__pyx_v_self, __pyx_v_solution); if (unlikely(__pyx_t_9 == ((int)-1))) __PYX_ERR(0, 1222, __pyx_L1_error)
+  __pyx_t_8 = __Pyx_PyInt_From_int(__pyx_t_9); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1222, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_8);
   __pyx_r = __pyx_t_8;
   __pyx_t_8 = 0;
   goto __pyx_L0;
 
-  /* "sat_toolkit/formula.pyx":1209
+  /* "sat_toolkit/formula.pyx":1216
  * 
  * 
  *     def check_solution(self, uint8_t[:] solution) -> bool:             # <<<<<<<<<<<<<<
  *         cdef size_t i
  *         for i in range(solution.shape[0]):
  */
 
@@ -41868,15 +42005,15 @@
   __pyx_r = NULL;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "sat_toolkit/formula.pyx":1217
+/* "sat_toolkit/formula.pyx":1224
  *         return self._check_solution(solution)
  * 
  *     cdef int _check_solution(self, uint8_t[:] solution) except -1 nogil:             # <<<<<<<<<<<<<<
  *         cdef size_t i, clause_pos, clause_elem
  *         cdef uint8_t expected
  */
 
@@ -41896,146 +42033,146 @@
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   #ifdef WITH_THREAD
   PyGILState_STATE __pyx_gilstate_save;
   #endif
   __Pyx_RefNannySetupContext("_check_solution", 1);
 
-  /* "sat_toolkit/formula.pyx":1221
+  /* "sat_toolkit/formula.pyx":1228
  *         cdef uint8_t expected
  * 
  *         if self.nvars >= solution.shape[0]:             # <<<<<<<<<<<<<<
  *             raise IndexError(f'solution of length {solution.shape[0]} too short for CNF with {self.nvars} variables')
  * 
  */
   __pyx_t_1 = (__pyx_v_self->__pyx_base.nvars >= (__pyx_v_solution.shape[0]));
   if (unlikely(__pyx_t_1)) {
 
-    /* "sat_toolkit/formula.pyx":1222
+    /* "sat_toolkit/formula.pyx":1229
  * 
  *         if self.nvars >= solution.shape[0]:
  *             raise IndexError(f'solution of length {solution.shape[0]} too short for CNF with {self.nvars} variables')             # <<<<<<<<<<<<<<
  * 
  *         for i in range(self._start_indices.size()):
  */
     {
         #ifdef WITH_THREAD
         PyGILState_STATE __pyx_gilstate_save = __Pyx_PyGILState_Ensure();
         #endif
         /*try:*/ {
-          __pyx_t_2 = PyTuple_New(5); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1222, __pyx_L5_error)
+          __pyx_t_2 = PyTuple_New(5); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1229, __pyx_L5_error)
           __Pyx_GOTREF(__pyx_t_2);
           __pyx_t_3 = 0;
           __pyx_t_4 = 127;
           __Pyx_INCREF(__pyx_kp_u_solution_of_length);
           __pyx_t_3 += 19;
           __Pyx_GIVEREF(__pyx_kp_u_solution_of_length);
           PyTuple_SET_ITEM(__pyx_t_2, 0, __pyx_kp_u_solution_of_length);
-          __pyx_t_5 = __Pyx_PyUnicode_From_Py_ssize_t((__pyx_v_solution.shape[0]), 0, ' ', 'd'); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1222, __pyx_L5_error)
+          __pyx_t_5 = __Pyx_PyUnicode_From_Py_ssize_t((__pyx_v_solution.shape[0]), 0, ' ', 'd'); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1229, __pyx_L5_error)
           __Pyx_GOTREF(__pyx_t_5);
           __pyx_t_3 += __Pyx_PyUnicode_GET_LENGTH(__pyx_t_5);
           __Pyx_GIVEREF(__pyx_t_5);
           PyTuple_SET_ITEM(__pyx_t_2, 1, __pyx_t_5);
           __pyx_t_5 = 0;
           __Pyx_INCREF(__pyx_kp_u_too_short_for_CNF_with);
           __pyx_t_3 += 24;
           __Pyx_GIVEREF(__pyx_kp_u_too_short_for_CNF_with);
           PyTuple_SET_ITEM(__pyx_t_2, 2, __pyx_kp_u_too_short_for_CNF_with);
-          __pyx_t_5 = __Pyx_PyUnicode_From_int(__pyx_v_self->__pyx_base.nvars, 0, ' ', 'd'); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1222, __pyx_L5_error)
+          __pyx_t_5 = __Pyx_PyUnicode_From_int(__pyx_v_self->__pyx_base.nvars, 0, ' ', 'd'); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1229, __pyx_L5_error)
           __Pyx_GOTREF(__pyx_t_5);
           __pyx_t_3 += __Pyx_PyUnicode_GET_LENGTH(__pyx_t_5);
           __Pyx_GIVEREF(__pyx_t_5);
           PyTuple_SET_ITEM(__pyx_t_2, 3, __pyx_t_5);
           __pyx_t_5 = 0;
           __Pyx_INCREF(__pyx_kp_u_variables_2);
           __pyx_t_3 += 10;
           __Pyx_GIVEREF(__pyx_kp_u_variables_2);
           PyTuple_SET_ITEM(__pyx_t_2, 4, __pyx_kp_u_variables_2);
-          __pyx_t_5 = __Pyx_PyUnicode_Join(__pyx_t_2, 5, __pyx_t_3, __pyx_t_4); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1222, __pyx_L5_error)
+          __pyx_t_5 = __Pyx_PyUnicode_Join(__pyx_t_2, 5, __pyx_t_3, __pyx_t_4); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1229, __pyx_L5_error)
           __Pyx_GOTREF(__pyx_t_5);
           __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-          __pyx_t_2 = __Pyx_PyObject_CallOneArg(__pyx_builtin_IndexError, __pyx_t_5); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1222, __pyx_L5_error)
+          __pyx_t_2 = __Pyx_PyObject_CallOneArg(__pyx_builtin_IndexError, __pyx_t_5); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1229, __pyx_L5_error)
           __Pyx_GOTREF(__pyx_t_2);
           __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
           __Pyx_Raise(__pyx_t_2, 0, 0, 0);
           __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-          __PYX_ERR(0, 1222, __pyx_L5_error)
+          __PYX_ERR(0, 1229, __pyx_L5_error)
         }
         /*finally:*/ {
           __pyx_L5_error: {
             #ifdef WITH_THREAD
             __Pyx_PyGILState_Release(__pyx_gilstate_save);
             #endif
             goto __pyx_L1_error;
           }
         }
     }
 
-    /* "sat_toolkit/formula.pyx":1221
+    /* "sat_toolkit/formula.pyx":1228
  *         cdef uint8_t expected
  * 
  *         if self.nvars >= solution.shape[0]:             # <<<<<<<<<<<<<<
  *             raise IndexError(f'solution of length {solution.shape[0]} too short for CNF with {self.nvars} variables')
  * 
  */
   }
 
-  /* "sat_toolkit/formula.pyx":1224
+  /* "sat_toolkit/formula.pyx":1231
  *             raise IndexError(f'solution of length {solution.shape[0]} too short for CNF with {self.nvars} variables')
  * 
  *         for i in range(self._start_indices.size()):             # <<<<<<<<<<<<<<
  *             if not self._check_solution_for_single_clause(i, solution):
  *                 return 0
  */
   __pyx_t_6 = __pyx_v_self->__pyx_base._start_indices.size();
   __pyx_t_7 = __pyx_t_6;
   for (__pyx_t_8 = 0; __pyx_t_8 < __pyx_t_7; __pyx_t_8+=1) {
     __pyx_v_i = __pyx_t_8;
 
-    /* "sat_toolkit/formula.pyx":1225
+    /* "sat_toolkit/formula.pyx":1232
  * 
  *         for i in range(self._start_indices.size()):
  *             if not self._check_solution_for_single_clause(i, solution):             # <<<<<<<<<<<<<<
  *                 return 0
  * 
  */
     __pyx_t_1 = (!(((struct __pyx_vtabstruct_11sat_toolkit_7formula_CNF *)__pyx_v_self->__pyx_base.__pyx_vtab)->_check_solution_for_single_clause(__pyx_v_self, __pyx_v_i, __pyx_v_solution) != 0));
     if (__pyx_t_1) {
 
-      /* "sat_toolkit/formula.pyx":1226
+      /* "sat_toolkit/formula.pyx":1233
  *         for i in range(self._start_indices.size()):
  *             if not self._check_solution_for_single_clause(i, solution):
  *                 return 0             # <<<<<<<<<<<<<<
  * 
  *         return 1
  */
       __pyx_r = 0;
       goto __pyx_L0;
 
-      /* "sat_toolkit/formula.pyx":1225
+      /* "sat_toolkit/formula.pyx":1232
  * 
  *         for i in range(self._start_indices.size()):
  *             if not self._check_solution_for_single_clause(i, solution):             # <<<<<<<<<<<<<<
  *                 return 0
  * 
  */
     }
   }
 
-  /* "sat_toolkit/formula.pyx":1228
+  /* "sat_toolkit/formula.pyx":1235
  *                 return 0
  * 
  *         return 1             # <<<<<<<<<<<<<<
  * 
  *     cdef int _check_solution_for_single_clause(self, size_t clause_idx, uint8_t[:] solution) noexcept nogil:
  */
   __pyx_r = 1;
   goto __pyx_L0;
 
-  /* "sat_toolkit/formula.pyx":1217
+  /* "sat_toolkit/formula.pyx":1224
  *         return self._check_solution(solution)
  * 
  *     cdef int _check_solution(self, uint8_t[:] solution) except -1 nogil:             # <<<<<<<<<<<<<<
  *         cdef size_t i, clause_pos, clause_elem
  *         cdef uint8_t expected
  */
 
@@ -42052,15 +42189,15 @@
   __Pyx_PyGILState_Release(__pyx_gilstate_save);
   #endif
   __pyx_L0:;
   __Pyx_RefNannyFinishContextNogil()
   return __pyx_r;
 }
 
-/* "sat_toolkit/formula.pyx":1230
+/* "sat_toolkit/formula.pyx":1237
  *         return 1
  * 
  *     cdef int _check_solution_for_single_clause(self, size_t clause_idx, uint8_t[:] solution) noexcept nogil:             # <<<<<<<<<<<<<<
  *         cdef size_t clause_pos
  *         cdef uint8_t expected
  */
 
@@ -42068,144 +42205,144 @@
   size_t __pyx_v_clause_pos;
   __pyx_t_11sat_toolkit_5types_uint8_t __pyx_v_expected;
   int __pyx_v_clause_elem;
   int __pyx_r;
   int __pyx_t_1;
   Py_ssize_t __pyx_t_2;
 
-  /* "sat_toolkit/formula.pyx":1235
+  /* "sat_toolkit/formula.pyx":1242
  *         cdef int clause_elem
  * 
  *         clause_pos = self._start_indices[clause_idx]             # <<<<<<<<<<<<<<
  * 
  *         while self._clauses[clause_pos] != 0:
  */
   __pyx_v_clause_pos = (__pyx_v_self->__pyx_base._start_indices[__pyx_v_clause_idx]);
 
-  /* "sat_toolkit/formula.pyx":1237
+  /* "sat_toolkit/formula.pyx":1244
  *         clause_pos = self._start_indices[clause_idx]
  * 
  *         while self._clauses[clause_pos] != 0:             # <<<<<<<<<<<<<<
  *             clause_elem = self._clauses[clause_pos]
  *             expected = clause_elem > 0
  */
   while (1) {
     __pyx_t_1 = ((__pyx_v_self->__pyx_base._clauses[__pyx_v_clause_pos]) != 0);
     if (!__pyx_t_1) break;
 
-    /* "sat_toolkit/formula.pyx":1238
+    /* "sat_toolkit/formula.pyx":1245
  * 
  *         while self._clauses[clause_pos] != 0:
  *             clause_elem = self._clauses[clause_pos]             # <<<<<<<<<<<<<<
  *             expected = clause_elem > 0
  *             if clause_elem < 0:
  */
     __pyx_v_clause_elem = (__pyx_v_self->__pyx_base._clauses[__pyx_v_clause_pos]);
 
-    /* "sat_toolkit/formula.pyx":1239
+    /* "sat_toolkit/formula.pyx":1246
  *         while self._clauses[clause_pos] != 0:
  *             clause_elem = self._clauses[clause_pos]
  *             expected = clause_elem > 0             # <<<<<<<<<<<<<<
  *             if clause_elem < 0:
  *                 clause_elem = -clause_elem
  */
     __pyx_v_expected = (__pyx_v_clause_elem > 0);
 
-    /* "sat_toolkit/formula.pyx":1240
+    /* "sat_toolkit/formula.pyx":1247
  *             clause_elem = self._clauses[clause_pos]
  *             expected = clause_elem > 0
  *             if clause_elem < 0:             # <<<<<<<<<<<<<<
  *                 clause_elem = -clause_elem
  * 
  */
     __pyx_t_1 = (__pyx_v_clause_elem < 0);
     if (__pyx_t_1) {
 
-      /* "sat_toolkit/formula.pyx":1241
+      /* "sat_toolkit/formula.pyx":1248
  *             expected = clause_elem > 0
  *             if clause_elem < 0:
  *                 clause_elem = -clause_elem             # <<<<<<<<<<<<<<
  * 
  *             if expected == solution[clause_elem]:
  */
       __pyx_v_clause_elem = (-__pyx_v_clause_elem);
 
-      /* "sat_toolkit/formula.pyx":1240
+      /* "sat_toolkit/formula.pyx":1247
  *             clause_elem = self._clauses[clause_pos]
  *             expected = clause_elem > 0
  *             if clause_elem < 0:             # <<<<<<<<<<<<<<
  *                 clause_elem = -clause_elem
  * 
  */
     }
 
-    /* "sat_toolkit/formula.pyx":1243
+    /* "sat_toolkit/formula.pyx":1250
  *                 clause_elem = -clause_elem
  * 
  *             if expected == solution[clause_elem]:             # <<<<<<<<<<<<<<
  *                 return True
  * 
  */
     __pyx_t_2 = __pyx_v_clause_elem;
     __pyx_t_1 = (__pyx_v_expected == (*((__pyx_t_11sat_toolkit_5types_uint8_t *) ( /* dim=0 */ (__pyx_v_solution.data + __pyx_t_2 * __pyx_v_solution.strides[0]) ))));
     if (__pyx_t_1) {
 
-      /* "sat_toolkit/formula.pyx":1244
+      /* "sat_toolkit/formula.pyx":1251
  * 
  *             if expected == solution[clause_elem]:
  *                 return True             # <<<<<<<<<<<<<<
  * 
  *             clause_pos += 1
  */
       __pyx_r = 1;
       goto __pyx_L0;
 
-      /* "sat_toolkit/formula.pyx":1243
+      /* "sat_toolkit/formula.pyx":1250
  *                 clause_elem = -clause_elem
  * 
  *             if expected == solution[clause_elem]:             # <<<<<<<<<<<<<<
  *                 return True
  * 
  */
     }
 
-    /* "sat_toolkit/formula.pyx":1246
+    /* "sat_toolkit/formula.pyx":1253
  *                 return True
  * 
  *             clause_pos += 1             # <<<<<<<<<<<<<<
  * 
  *         return False
  */
     __pyx_v_clause_pos = (__pyx_v_clause_pos + 1);
   }
 
-  /* "sat_toolkit/formula.pyx":1248
+  /* "sat_toolkit/formula.pyx":1255
  *             clause_pos += 1
  * 
  *         return False             # <<<<<<<<<<<<<<
  * 
  *     def to_truthtable(self) -> Truthtable:
  */
   __pyx_r = 0;
   goto __pyx_L0;
 
-  /* "sat_toolkit/formula.pyx":1230
+  /* "sat_toolkit/formula.pyx":1237
  *         return 1
  * 
  *     cdef int _check_solution_for_single_clause(self, size_t clause_idx, uint8_t[:] solution) noexcept nogil:             # <<<<<<<<<<<<<<
  *         cdef size_t clause_pos
  *         cdef uint8_t expected
  */
 
   /* function exit code */
   __pyx_L0:;
   return __pyx_r;
 }
 
-/* "sat_toolkit/formula.pyx":1250
+/* "sat_toolkit/formula.pyx":1257
  *         return False
  * 
  *     def to_truthtable(self) -> Truthtable:             # <<<<<<<<<<<<<<
  *         """
  *         Return the current CNF as a Truthtable by iterating over all possible
  */
 
@@ -42277,63 +42414,63 @@
   size_t __pyx_t_15;
   size_t __pyx_t_16;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("to_truthtable", 1);
 
-  /* "sat_toolkit/formula.pyx":1259
+  /* "sat_toolkit/formula.pyx":1266
  *         cdef uint8_t[:] current_sol_view
  * 
  *         if self.nvars > 32:             # <<<<<<<<<<<<<<
  *             raise ValueError('cannot find all solutions for CNF with more than 32 variables')
  * 
  */
   __pyx_t_1 = (__pyx_v_self->__pyx_base.nvars > 32);
   if (unlikely(__pyx_t_1)) {
 
-    /* "sat_toolkit/formula.pyx":1260
+    /* "sat_toolkit/formula.pyx":1267
  * 
  *         if self.nvars > 32:
  *             raise ValueError('cannot find all solutions for CNF with more than 32 variables')             # <<<<<<<<<<<<<<
  * 
  *         truthtable = np.empty((<uint64_t> 1) << self.nvars, np.uint8)
  */
-    __pyx_t_2 = __Pyx_PyObject_Call(__pyx_builtin_ValueError, __pyx_tuple__42, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1260, __pyx_L1_error)
+    __pyx_t_2 = __Pyx_PyObject_Call(__pyx_builtin_ValueError, __pyx_tuple__42, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1267, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
     __Pyx_Raise(__pyx_t_2, 0, 0, 0);
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-    __PYX_ERR(0, 1260, __pyx_L1_error)
+    __PYX_ERR(0, 1267, __pyx_L1_error)
 
-    /* "sat_toolkit/formula.pyx":1259
+    /* "sat_toolkit/formula.pyx":1266
  *         cdef uint8_t[:] current_sol_view
  * 
  *         if self.nvars > 32:             # <<<<<<<<<<<<<<
  *             raise ValueError('cannot find all solutions for CNF with more than 32 variables')
  * 
  */
   }
 
-  /* "sat_toolkit/formula.pyx":1262
+  /* "sat_toolkit/formula.pyx":1269
  *             raise ValueError('cannot find all solutions for CNF with more than 32 variables')
  * 
  *         truthtable = np.empty((<uint64_t> 1) << self.nvars, np.uint8)             # <<<<<<<<<<<<<<
  *         current_sol = np.empty(1 + self.nvars, np.uint8)
  * 
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_np); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1262, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_np); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1269, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_empty); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1262, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_empty); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1269, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  __pyx_t_3 = __Pyx_PyInt_From_unsigned_long((((__pyx_t_11sat_toolkit_5types_uint64_t)1) << __pyx_v_self->__pyx_base.nvars)); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1262, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyInt_From_unsigned_long((((__pyx_t_11sat_toolkit_5types_uint64_t)1) << __pyx_v_self->__pyx_base.nvars)); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1269, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_np); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1262, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_np); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1269, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
-  __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_uint8); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1262, __pyx_L1_error)
+  __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_uint8); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1269, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_6);
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
   __pyx_t_5 = NULL;
   __pyx_t_7 = 0;
   #if CYTHON_UNPACK_METHODS
   if (unlikely(PyMethod_Check(__pyx_t_4))) {
     __pyx_t_5 = PyMethod_GET_SELF(__pyx_t_4);
@@ -42348,38 +42485,38 @@
   #endif
   {
     PyObject *__pyx_callargs[3] = {__pyx_t_5, __pyx_t_3, __pyx_t_6};
     __pyx_t_2 = __Pyx_PyObject_FastCall(__pyx_t_4, __pyx_callargs+1-__pyx_t_7, 2+__pyx_t_7);
     __Pyx_XDECREF(__pyx_t_5); __pyx_t_5 = 0;
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-    if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1262, __pyx_L1_error)
+    if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1269, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
   }
   __pyx_v_truthtable = __pyx_t_2;
   __pyx_t_2 = 0;
 
-  /* "sat_toolkit/formula.pyx":1263
+  /* "sat_toolkit/formula.pyx":1270
  * 
  *         truthtable = np.empty((<uint64_t> 1) << self.nvars, np.uint8)
  *         current_sol = np.empty(1 + self.nvars, np.uint8)             # <<<<<<<<<<<<<<
  * 
  *         truthtable_view = truthtable
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_np); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1263, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_np); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1270, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
-  __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_empty); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1263, __pyx_L1_error)
+  __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_empty); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1270, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_6);
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-  __pyx_t_4 = __Pyx_PyInt_From_long((1 + __pyx_v_self->__pyx_base.nvars)); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1263, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyInt_From_long((1 + __pyx_v_self->__pyx_base.nvars)); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1270, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
-  __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_np); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1263, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_np); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1270, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_uint8); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1263, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_uint8); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1270, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   __pyx_t_3 = NULL;
   __pyx_t_7 = 0;
   #if CYTHON_UNPACK_METHODS
   if (unlikely(PyMethod_Check(__pyx_t_6))) {
     __pyx_t_3 = PyMethod_GET_SELF(__pyx_t_6);
@@ -42394,120 +42531,120 @@
   #endif
   {
     PyObject *__pyx_callargs[3] = {__pyx_t_3, __pyx_t_4, __pyx_t_5};
     __pyx_t_2 = __Pyx_PyObject_FastCall(__pyx_t_6, __pyx_callargs+1-__pyx_t_7, 2+__pyx_t_7);
     __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-    if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1263, __pyx_L1_error)
+    if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1270, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
   }
   __pyx_v_current_sol = __pyx_t_2;
   __pyx_t_2 = 0;
 
-  /* "sat_toolkit/formula.pyx":1265
+  /* "sat_toolkit/formula.pyx":1272
  *         current_sol = np.empty(1 + self.nvars, np.uint8)
  * 
  *         truthtable_view = truthtable             # <<<<<<<<<<<<<<
  *         current_sol_view = current_sol
  *         current_sol_view[0] = 0
  */
-  __pyx_t_8 = __Pyx_PyObject_to_MemoryviewSlice_ds_nn___pyx_t_11sat_toolkit_5types_uint8_t(__pyx_v_truthtable, PyBUF_WRITABLE); if (unlikely(!__pyx_t_8.memview)) __PYX_ERR(0, 1265, __pyx_L1_error)
+  __pyx_t_8 = __Pyx_PyObject_to_MemoryviewSlice_ds_nn___pyx_t_11sat_toolkit_5types_uint8_t(__pyx_v_truthtable, PyBUF_WRITABLE); if (unlikely(!__pyx_t_8.memview)) __PYX_ERR(0, 1272, __pyx_L1_error)
   __pyx_v_truthtable_view = __pyx_t_8;
   __pyx_t_8.memview = NULL;
   __pyx_t_8.data = NULL;
 
-  /* "sat_toolkit/formula.pyx":1266
+  /* "sat_toolkit/formula.pyx":1273
  * 
  *         truthtable_view = truthtable
  *         current_sol_view = current_sol             # <<<<<<<<<<<<<<
  *         current_sol_view[0] = 0
  * 
  */
-  __pyx_t_8 = __Pyx_PyObject_to_MemoryviewSlice_ds_nn___pyx_t_11sat_toolkit_5types_uint8_t(__pyx_v_current_sol, PyBUF_WRITABLE); if (unlikely(!__pyx_t_8.memview)) __PYX_ERR(0, 1266, __pyx_L1_error)
+  __pyx_t_8 = __Pyx_PyObject_to_MemoryviewSlice_ds_nn___pyx_t_11sat_toolkit_5types_uint8_t(__pyx_v_current_sol, PyBUF_WRITABLE); if (unlikely(!__pyx_t_8.memview)) __PYX_ERR(0, 1273, __pyx_L1_error)
   __pyx_v_current_sol_view = __pyx_t_8;
   __pyx_t_8.memview = NULL;
   __pyx_t_8.data = NULL;
 
-  /* "sat_toolkit/formula.pyx":1267
+  /* "sat_toolkit/formula.pyx":1274
  *         truthtable_view = truthtable
  *         current_sol_view = current_sol
  *         current_sol_view[0] = 0             # <<<<<<<<<<<<<<
  * 
  *         for i in range((<uint64_t> 1) << self.nvars):
  */
   __pyx_t_9 = 0;
   *((__pyx_t_11sat_toolkit_5types_uint8_t *) ( /* dim=0 */ (__pyx_v_current_sol_view.data + __pyx_t_9 * __pyx_v_current_sol_view.strides[0]) )) = 0;
 
-  /* "sat_toolkit/formula.pyx":1269
+  /* "sat_toolkit/formula.pyx":1276
  *         current_sol_view[0] = 0
  * 
  *         for i in range((<uint64_t> 1) << self.nvars):             # <<<<<<<<<<<<<<
  *             for j in range(1, self.nvars + 1):
  *                 current_sol_view[j] = (i >> (j - 1)) & 1
  */
   __pyx_t_10 = (((__pyx_t_11sat_toolkit_5types_uint64_t)1) << __pyx_v_self->__pyx_base.nvars);
   __pyx_t_11 = __pyx_t_10;
   for (__pyx_t_12 = 0; __pyx_t_12 < __pyx_t_11; __pyx_t_12+=1) {
     __pyx_v_i = __pyx_t_12;
 
-    /* "sat_toolkit/formula.pyx":1270
+    /* "sat_toolkit/formula.pyx":1277
  * 
  *         for i in range((<uint64_t> 1) << self.nvars):
  *             for j in range(1, self.nvars + 1):             # <<<<<<<<<<<<<<
  *                 current_sol_view[j] = (i >> (j - 1)) & 1
  *             truthtable_view[i] = self._check_solution(current_sol_view)
  */
     __pyx_t_13 = (__pyx_v_self->__pyx_base.nvars + 1);
     __pyx_t_14 = __pyx_t_13;
     for (__pyx_t_15 = 1; __pyx_t_15 < __pyx_t_14; __pyx_t_15+=1) {
       __pyx_v_j = __pyx_t_15;
 
-      /* "sat_toolkit/formula.pyx":1271
+      /* "sat_toolkit/formula.pyx":1278
  *         for i in range((<uint64_t> 1) << self.nvars):
  *             for j in range(1, self.nvars + 1):
  *                 current_sol_view[j] = (i >> (j - 1)) & 1             # <<<<<<<<<<<<<<
  *             truthtable_view[i] = self._check_solution(current_sol_view)
  *             PyErr_CheckSignals()
  */
       __pyx_t_16 = __pyx_v_j;
       *((__pyx_t_11sat_toolkit_5types_uint8_t *) ( /* dim=0 */ (__pyx_v_current_sol_view.data + __pyx_t_16 * __pyx_v_current_sol_view.strides[0]) )) = ((__pyx_v_i >> (__pyx_v_j - 1)) & 1);
     }
 
-    /* "sat_toolkit/formula.pyx":1272
+    /* "sat_toolkit/formula.pyx":1279
  *             for j in range(1, self.nvars + 1):
  *                 current_sol_view[j] = (i >> (j - 1)) & 1
  *             truthtable_view[i] = self._check_solution(current_sol_view)             # <<<<<<<<<<<<<<
  *             PyErr_CheckSignals()
  * 
  */
-    __pyx_t_7 = ((struct __pyx_vtabstruct_11sat_toolkit_7formula_CNF *)__pyx_v_self->__pyx_base.__pyx_vtab)->_check_solution(__pyx_v_self, __pyx_v_current_sol_view); if (unlikely(__pyx_t_7 == ((int)-1))) __PYX_ERR(0, 1272, __pyx_L1_error)
+    __pyx_t_7 = ((struct __pyx_vtabstruct_11sat_toolkit_7formula_CNF *)__pyx_v_self->__pyx_base.__pyx_vtab)->_check_solution(__pyx_v_self, __pyx_v_current_sol_view); if (unlikely(__pyx_t_7 == ((int)-1))) __PYX_ERR(0, 1279, __pyx_L1_error)
     __pyx_t_15 = __pyx_v_i;
     *((__pyx_t_11sat_toolkit_5types_uint8_t *) ( /* dim=0 */ (__pyx_v_truthtable_view.data + __pyx_t_15 * __pyx_v_truthtable_view.strides[0]) )) = __pyx_t_7;
 
-    /* "sat_toolkit/formula.pyx":1273
+    /* "sat_toolkit/formula.pyx":1280
  *                 current_sol_view[j] = (i >> (j - 1)) & 1
  *             truthtable_view[i] = self._check_solution(current_sol_view)
  *             PyErr_CheckSignals()             # <<<<<<<<<<<<<<
  * 
  *         return Truthtable.from_lut(truthtable)
  */
-    __pyx_t_7 = PyErr_CheckSignals(); if (unlikely(__pyx_t_7 == ((int)-1))) __PYX_ERR(0, 1273, __pyx_L1_error)
+    __pyx_t_7 = PyErr_CheckSignals(); if (unlikely(__pyx_t_7 == ((int)-1))) __PYX_ERR(0, 1280, __pyx_L1_error)
   }
 
-  /* "sat_toolkit/formula.pyx":1275
+  /* "sat_toolkit/formula.pyx":1282
  *             PyErr_CheckSignals()
  * 
  *         return Truthtable.from_lut(truthtable)             # <<<<<<<<<<<<<<
  * 
  *     cdef Clause get_clause(self, ssize_t idx):
  */
   __Pyx_XDECREF((PyObject *)__pyx_r);
-  __pyx_t_6 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_ptype_11sat_toolkit_7formula_Truthtable), __pyx_n_s_from_lut); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1275, __pyx_L1_error)
+  __pyx_t_6 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_ptype_11sat_toolkit_7formula_Truthtable), __pyx_n_s_from_lut); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1282, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_6);
   __pyx_t_5 = NULL;
   __pyx_t_7 = 0;
   #if CYTHON_UNPACK_METHODS
   if (likely(PyMethod_Check(__pyx_t_6))) {
     __pyx_t_5 = PyMethod_GET_SELF(__pyx_t_6);
     if (likely(__pyx_t_5)) {
@@ -42519,24 +42656,24 @@
     }
   }
   #endif
   {
     PyObject *__pyx_callargs[2] = {__pyx_t_5, __pyx_v_truthtable};
     __pyx_t_2 = __Pyx_PyObject_FastCall(__pyx_t_6, __pyx_callargs+1-__pyx_t_7, 1+__pyx_t_7);
     __Pyx_XDECREF(__pyx_t_5); __pyx_t_5 = 0;
-    if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1275, __pyx_L1_error)
+    if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1282, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
   }
-  if (!(likely(((__pyx_t_2) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_2, __pyx_ptype_11sat_toolkit_7formula_Truthtable))))) __PYX_ERR(0, 1275, __pyx_L1_error)
+  if (!(likely(((__pyx_t_2) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_2, __pyx_ptype_11sat_toolkit_7formula_Truthtable))))) __PYX_ERR(0, 1282, __pyx_L1_error)
   __pyx_r = ((struct __pyx_obj_11sat_toolkit_7formula_Truthtable *)__pyx_t_2);
   __pyx_t_2 = 0;
   goto __pyx_L0;
 
-  /* "sat_toolkit/formula.pyx":1250
+  /* "sat_toolkit/formula.pyx":1257
  *         return False
  * 
  *     def to_truthtable(self) -> Truthtable:             # <<<<<<<<<<<<<<
  *         """
  *         Return the current CNF as a Truthtable by iterating over all possible
  */
 
@@ -42556,15 +42693,15 @@
   __Pyx_XDECREF(__pyx_v_truthtable);
   __Pyx_XDECREF(__pyx_v_current_sol);
   __Pyx_XGIVEREF((PyObject *)__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "sat_toolkit/formula.pyx":1277
+/* "sat_toolkit/formula.pyx":1284
  *         return Truthtable.from_lut(truthtable)
  * 
  *     cdef Clause get_clause(self, ssize_t idx):             # <<<<<<<<<<<<<<
  *         cdef Clause result
  *         result = Clause.from_memview(self._get_clause(idx))
  */
 
@@ -42575,42 +42712,42 @@
   __Pyx_memviewslice __pyx_t_1 = { 0, 0, { 0 }, { 0 }, { 0 } };
   PyObject *__pyx_t_2 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("get_clause", 1);
 
-  /* "sat_toolkit/formula.pyx":1279
+  /* "sat_toolkit/formula.pyx":1286
  *     cdef Clause get_clause(self, ssize_t idx):
  *         cdef Clause result
  *         result = Clause.from_memview(self._get_clause(idx))             # <<<<<<<<<<<<<<
  * 
  *         return result
  */
-  __pyx_t_1 = ((struct __pyx_vtabstruct_11sat_toolkit_7formula_CNF *)__pyx_v_self->__pyx_base.__pyx_vtab)->__pyx_base._get_clause(((struct __pyx_obj_11sat_toolkit_7formula__ClauseList *)__pyx_v_self), __pyx_v_idx); if (unlikely(!__pyx_t_1.memview)) __PYX_ERR(0, 1279, __pyx_L1_error)
-  __pyx_t_2 = ((PyObject *)__pyx_f_11sat_toolkit_7formula_6Clause_from_memview(__pyx_t_1)); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1279, __pyx_L1_error)
+  __pyx_t_1 = ((struct __pyx_vtabstruct_11sat_toolkit_7formula_CNF *)__pyx_v_self->__pyx_base.__pyx_vtab)->__pyx_base._get_clause(((struct __pyx_obj_11sat_toolkit_7formula__ClauseList *)__pyx_v_self), __pyx_v_idx); if (unlikely(!__pyx_t_1.memview)) __PYX_ERR(0, 1286, __pyx_L1_error)
+  __pyx_t_2 = ((PyObject *)__pyx_f_11sat_toolkit_7formula_6Clause_from_memview(__pyx_t_1)); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1286, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __PYX_XCLEAR_MEMVIEW(&__pyx_t_1, 1);
   __pyx_t_1.memview = NULL; __pyx_t_1.data = NULL;
   __pyx_v_result = ((struct __pyx_obj_11sat_toolkit_7formula_Clause *)__pyx_t_2);
   __pyx_t_2 = 0;
 
-  /* "sat_toolkit/formula.pyx":1281
+  /* "sat_toolkit/formula.pyx":1288
  *         result = Clause.from_memview(self._get_clause(idx))
  * 
  *         return result             # <<<<<<<<<<<<<<
  * 
  *     cdef int _check_clause_type(self, _BaseClause clause) noexcept:
  */
   __Pyx_XDECREF((PyObject *)__pyx_r);
   __Pyx_INCREF((PyObject *)__pyx_v_result);
   __pyx_r = __pyx_v_result;
   goto __pyx_L0;
 
-  /* "sat_toolkit/formula.pyx":1277
+  /* "sat_toolkit/formula.pyx":1284
  *         return Truthtable.from_lut(truthtable)
  * 
  *     cdef Clause get_clause(self, ssize_t idx):             # <<<<<<<<<<<<<<
  *         cdef Clause result
  *         result = Clause.from_memview(self._get_clause(idx))
  */
 
@@ -42627,51 +42764,51 @@
   return __pyx_r;
 }
 
 struct __pyx_obj_11sat_toolkit_7formula_Clause *__pyx_f_11sat_toolkit_7formula_3CNF_get_clause__pyx_wrap_1(struct __pyx_obj_11sat_toolkit_7formula_CNF *__pyx_v_self, Py_ssize_t __pyx_v_idx) {
   return __pyx_f_11sat_toolkit_7formula_3CNF_get_clause(__pyx_v_self, __pyx_v_idx);
 }
 
-/* "sat_toolkit/formula.pyx":1283
+/* "sat_toolkit/formula.pyx":1290
  *         return result
  * 
  *     cdef int _check_clause_type(self, _BaseClause clause) noexcept:             # <<<<<<<<<<<<<<
  *         return isinstance(clause, Clause)
  * 
  */
 
 static int __pyx_f_11sat_toolkit_7formula_3CNF__check_clause_type(CYTHON_UNUSED struct __pyx_obj_11sat_toolkit_7formula_CNF *__pyx_v_self, struct __pyx_obj_11sat_toolkit_7formula__BaseClause *__pyx_v_clause) {
   int __pyx_r;
   int __pyx_t_1;
 
-  /* "sat_toolkit/formula.pyx":1284
+  /* "sat_toolkit/formula.pyx":1291
  * 
  *     cdef int _check_clause_type(self, _BaseClause clause) noexcept:
  *         return isinstance(clause, Clause)             # <<<<<<<<<<<<<<
  * 
  *     def __repr__(self) -> str:
  */
   __pyx_t_1 = __Pyx_TypeCheck(((PyObject *)__pyx_v_clause), __pyx_ptype_11sat_toolkit_7formula_Clause); 
   __pyx_r = __pyx_t_1;
   goto __pyx_L0;
 
-  /* "sat_toolkit/formula.pyx":1283
+  /* "sat_toolkit/formula.pyx":1290
  *         return result
  * 
  *     cdef int _check_clause_type(self, _BaseClause clause) noexcept:             # <<<<<<<<<<<<<<
  *         return isinstance(clause, Clause)
  * 
  */
 
   /* function exit code */
   __pyx_L0:;
   return __pyx_r;
 }
 
-/* "sat_toolkit/formula.pyx":1286
+/* "sat_toolkit/formula.pyx":1293
  *         return isinstance(clause, Clause)
  * 
  *     def __repr__(self) -> str:             # <<<<<<<<<<<<<<
  *         return f'CNF over {self.nvars} variables with {self._start_indices.size()} clauses'
  * 
  */
 
@@ -42699,62 +42836,62 @@
   PyObject *__pyx_t_4 = NULL;
   PyObject *__pyx_t_5 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("__repr__", 1);
 
-  /* "sat_toolkit/formula.pyx":1287
+  /* "sat_toolkit/formula.pyx":1294
  * 
  *     def __repr__(self) -> str:
  *         return f'CNF over {self.nvars} variables with {self._start_indices.size()} clauses'             # <<<<<<<<<<<<<<
  * 
  *     def __str__(self) -> str:
  */
   __Pyx_XDECREF(__pyx_r);
-  __pyx_t_1 = PyTuple_New(5); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1287, __pyx_L1_error)
+  __pyx_t_1 = PyTuple_New(5); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1294, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_t_2 = 0;
   __pyx_t_3 = 127;
   __Pyx_INCREF(__pyx_kp_u_CNF_over);
   __pyx_t_2 += 9;
   __Pyx_GIVEREF(__pyx_kp_u_CNF_over);
   PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_kp_u_CNF_over);
-  __pyx_t_4 = __Pyx_PyUnicode_From_int(__pyx_v_self->__pyx_base.nvars, 0, ' ', 'd'); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1287, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyUnicode_From_int(__pyx_v_self->__pyx_base.nvars, 0, ' ', 'd'); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1294, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __pyx_t_2 += __Pyx_PyUnicode_GET_LENGTH(__pyx_t_4);
   __Pyx_GIVEREF(__pyx_t_4);
   PyTuple_SET_ITEM(__pyx_t_1, 1, __pyx_t_4);
   __pyx_t_4 = 0;
   __Pyx_INCREF(__pyx_kp_u_variables_with);
   __pyx_t_2 += 16;
   __Pyx_GIVEREF(__pyx_kp_u_variables_with);
   PyTuple_SET_ITEM(__pyx_t_1, 2, __pyx_kp_u_variables_with);
-  __pyx_t_4 = __Pyx_PyInt_FromSize_t(__pyx_v_self->__pyx_base._start_indices.size()); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1287, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyInt_FromSize_t(__pyx_v_self->__pyx_base._start_indices.size()); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1294, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
-  __pyx_t_5 = __Pyx_PyObject_FormatSimple(__pyx_t_4, __pyx_empty_unicode); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1287, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyObject_FormatSimple(__pyx_t_4, __pyx_empty_unicode); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1294, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
   __pyx_t_3 = (__Pyx_PyUnicode_MAX_CHAR_VALUE(__pyx_t_5) > __pyx_t_3) ? __Pyx_PyUnicode_MAX_CHAR_VALUE(__pyx_t_5) : __pyx_t_3;
   __pyx_t_2 += __Pyx_PyUnicode_GET_LENGTH(__pyx_t_5);
   __Pyx_GIVEREF(__pyx_t_5);
   PyTuple_SET_ITEM(__pyx_t_1, 3, __pyx_t_5);
   __pyx_t_5 = 0;
   __Pyx_INCREF(__pyx_kp_u_clauses_2);
   __pyx_t_2 += 8;
   __Pyx_GIVEREF(__pyx_kp_u_clauses_2);
   PyTuple_SET_ITEM(__pyx_t_1, 4, __pyx_kp_u_clauses_2);
-  __pyx_t_5 = __Pyx_PyUnicode_Join(__pyx_t_1, 5, __pyx_t_2, __pyx_t_3); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1287, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyUnicode_Join(__pyx_t_1, 5, __pyx_t_2, __pyx_t_3); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1294, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __pyx_r = __pyx_t_5;
   __pyx_t_5 = 0;
   goto __pyx_L0;
 
-  /* "sat_toolkit/formula.pyx":1286
+  /* "sat_toolkit/formula.pyx":1293
  *         return isinstance(clause, Clause)
  * 
  *     def __repr__(self) -> str:             # <<<<<<<<<<<<<<
  *         return f'CNF over {self.nvars} variables with {self._start_indices.size()} clauses'
  * 
  */
 
@@ -42767,15 +42904,15 @@
   __pyx_r = NULL;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "sat_toolkit/formula.pyx":1289
+/* "sat_toolkit/formula.pyx":1296
  *         return f'CNF over {self.nvars} variables with {self._start_indices.size()} clauses'
  * 
  *     def __str__(self) -> str:             # <<<<<<<<<<<<<<
  *         return self.to_dimacs().rstrip()
  * 
  */
 
@@ -42803,23 +42940,23 @@
   PyObject *__pyx_t_4 = NULL;
   int __pyx_t_5;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("__str__", 1);
 
-  /* "sat_toolkit/formula.pyx":1290
+  /* "sat_toolkit/formula.pyx":1297
  * 
  *     def __str__(self) -> str:
  *         return self.to_dimacs().rstrip()             # <<<<<<<<<<<<<<
  * 
  *     def equiv(self, CNF other) -> bool:
  */
   __Pyx_XDECREF(__pyx_r);
-  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_self), __pyx_n_s_to_dimacs); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1290, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_self), __pyx_n_s_to_dimacs); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1297, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __pyx_t_4 = NULL;
   __pyx_t_5 = 0;
   #if CYTHON_UNPACK_METHODS
   if (likely(PyMethod_Check(__pyx_t_3))) {
     __pyx_t_4 = PyMethod_GET_SELF(__pyx_t_3);
     if (likely(__pyx_t_4)) {
@@ -42831,19 +42968,19 @@
     }
   }
   #endif
   {
     PyObject *__pyx_callargs[2] = {__pyx_t_4, NULL};
     __pyx_t_2 = __Pyx_PyObject_FastCall(__pyx_t_3, __pyx_callargs+1-__pyx_t_5, 0+__pyx_t_5);
     __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
-    if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1290, __pyx_L1_error)
+    if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1297, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   }
-  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_rstrip); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1290, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_rstrip); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1297, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   __pyx_t_2 = NULL;
   __pyx_t_5 = 0;
   #if CYTHON_UNPACK_METHODS
   if (likely(PyMethod_Check(__pyx_t_3))) {
     __pyx_t_2 = PyMethod_GET_SELF(__pyx_t_3);
@@ -42856,23 +42993,23 @@
     }
   }
   #endif
   {
     PyObject *__pyx_callargs[2] = {__pyx_t_2, NULL};
     __pyx_t_1 = __Pyx_PyObject_FastCall(__pyx_t_3, __pyx_callargs+1-__pyx_t_5, 0+__pyx_t_5);
     __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
-    if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1290, __pyx_L1_error)
+    if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1297, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   }
   __pyx_r = __pyx_t_1;
   __pyx_t_1 = 0;
   goto __pyx_L0;
 
-  /* "sat_toolkit/formula.pyx":1289
+  /* "sat_toolkit/formula.pyx":1296
  *         return f'CNF over {self.nvars} variables with {self._start_indices.size()} clauses'
  * 
  *     def __str__(self) -> str:             # <<<<<<<<<<<<<<
  *         return self.to_dimacs().rstrip()
  * 
  */
 
@@ -42886,15 +43023,15 @@
   __pyx_r = NULL;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "sat_toolkit/formula.pyx":1292
+/* "sat_toolkit/formula.pyx":1299
  *         return self.to_dimacs().rstrip()
  * 
  *     def equiv(self, CNF other) -> bool:             # <<<<<<<<<<<<<<
  *         """
  *         Check for logical eqivalence between self and other.
  */
 
@@ -42948,45 +43085,45 @@
       kw_args = __Pyx_NumKwargs_FASTCALL(__pyx_kwds);
       switch (__pyx_nargs) {
         case  0:
         if (likely((values[0] = __Pyx_GetKwValue_FASTCALL(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_other)) != 0)) {
           (void)__Pyx_Arg_NewRef_FASTCALL(values[0]);
           kw_args--;
         }
-        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 1292, __pyx_L3_error)
+        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 1299, __pyx_L3_error)
         else goto __pyx_L5_argtuple_error;
       }
       if (unlikely(kw_args > 0)) {
         const Py_ssize_t kwd_pos_args = __pyx_nargs;
-        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values + 0, kwd_pos_args, "equiv") < 0)) __PYX_ERR(0, 1292, __pyx_L3_error)
+        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values + 0, kwd_pos_args, "equiv") < 0)) __PYX_ERR(0, 1299, __pyx_L3_error)
       }
     } else if (unlikely(__pyx_nargs != 1)) {
       goto __pyx_L5_argtuple_error;
     } else {
       values[0] = __Pyx_Arg_FASTCALL(__pyx_args, 0);
     }
     __pyx_v_other = ((struct __pyx_obj_11sat_toolkit_7formula_CNF *)values[0]);
   }
   goto __pyx_L6_skip;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("equiv", 1, 1, 1, __pyx_nargs); __PYX_ERR(0, 1292, __pyx_L3_error)
+  __Pyx_RaiseArgtupleInvalid("equiv", 1, 1, 1, __pyx_nargs); __PYX_ERR(0, 1299, __pyx_L3_error)
   __pyx_L6_skip:;
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L3_error:;
   {
     Py_ssize_t __pyx_temp;
     for (__pyx_temp=0; __pyx_temp < (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
       __Pyx_Arg_XDECREF_FASTCALL(values[__pyx_temp]);
     }
   }
   __Pyx_AddTraceback("sat_toolkit.formula.CNF.equiv", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __Pyx_RefNannyFinishContext();
   return NULL;
   __pyx_L4_argument_unpacking_done:;
-  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_other), __pyx_ptype_11sat_toolkit_7formula_CNF, 1, "other", 0))) __PYX_ERR(0, 1292, __pyx_L1_error)
+  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_other), __pyx_ptype_11sat_toolkit_7formula_CNF, 1, "other", 0))) __PYX_ERR(0, 1299, __pyx_L1_error)
   __pyx_r = __pyx_pf_11sat_toolkit_7formula_3CNF_40equiv(((struct __pyx_obj_11sat_toolkit_7formula_CNF *)__pyx_v_self), __pyx_v_other);
 
   /* function exit code */
   goto __pyx_L0;
   __pyx_L1_error:;
   __pyx_r = NULL;
   __pyx_L0:;
@@ -43019,105 +43156,105 @@
   int __pyx_t_12;
   PyObject *__pyx_t_13 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("equiv", 1);
 
-  /* "sat_toolkit/formula.pyx":1297
+  /* "sat_toolkit/formula.pyx":1304
  *         Calls `espresso -Dverify` to perform the comparison.
  *         """
  *         cdef int ret_code = 0             # <<<<<<<<<<<<<<
  * 
  *         if self.nvars != other.nvars:
  */
   __pyx_v_ret_code = 0;
 
-  /* "sat_toolkit/formula.pyx":1299
+  /* "sat_toolkit/formula.pyx":1306
  *         cdef int ret_code = 0
  * 
  *         if self.nvars != other.nvars:             # <<<<<<<<<<<<<<
  *             return False
  * 
  */
   __pyx_t_1 = (__pyx_v_self->__pyx_base.nvars != __pyx_v_other->__pyx_base.nvars);
   if (__pyx_t_1) {
 
-    /* "sat_toolkit/formula.pyx":1300
+    /* "sat_toolkit/formula.pyx":1307
  * 
  *         if self.nvars != other.nvars:
  *             return False             # <<<<<<<<<<<<<<
  * 
  *         with sp.Popen(['espresso', '-Dverify'], stdin=sp.PIPE, stdout=sp.PIPE, text=True) as espresso:
  */
     __Pyx_XDECREF(__pyx_r);
     __Pyx_INCREF(Py_False);
     __pyx_r = Py_False;
     goto __pyx_L0;
 
-    /* "sat_toolkit/formula.pyx":1299
+    /* "sat_toolkit/formula.pyx":1306
  *         cdef int ret_code = 0
  * 
  *         if self.nvars != other.nvars:             # <<<<<<<<<<<<<<
  *             return False
  * 
  */
   }
 
-  /* "sat_toolkit/formula.pyx":1302
+  /* "sat_toolkit/formula.pyx":1309
  *             return False
  * 
  *         with sp.Popen(['espresso', '-Dverify'], stdin=sp.PIPE, stdout=sp.PIPE, text=True) as espresso:             # <<<<<<<<<<<<<<
  *             espresso.stdin.write(self.to_espresso())
  *             espresso.stdin.write(other.to_espresso(print_numvars = False))
  */
   /*with:*/ {
-    __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_sp); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1302, __pyx_L1_error)
+    __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_sp); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1309, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
-    __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_Popen); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1302, __pyx_L1_error)
+    __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_Popen); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1309, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-    __pyx_t_2 = PyList_New(2); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1302, __pyx_L1_error)
+    __pyx_t_2 = PyList_New(2); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1309, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
     __Pyx_INCREF(__pyx_n_u_espresso);
     __Pyx_GIVEREF(__pyx_n_u_espresso);
-    if (__Pyx_PyList_SET_ITEM(__pyx_t_2, 0, __pyx_n_u_espresso)) __PYX_ERR(0, 1302, __pyx_L1_error);
+    if (__Pyx_PyList_SET_ITEM(__pyx_t_2, 0, __pyx_n_u_espresso)) __PYX_ERR(0, 1309, __pyx_L1_error);
     __Pyx_INCREF(__pyx_kp_u_Dverify);
     __Pyx_GIVEREF(__pyx_kp_u_Dverify);
-    if (__Pyx_PyList_SET_ITEM(__pyx_t_2, 1, __pyx_kp_u_Dverify)) __PYX_ERR(0, 1302, __pyx_L1_error);
-    __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1302, __pyx_L1_error)
+    if (__Pyx_PyList_SET_ITEM(__pyx_t_2, 1, __pyx_kp_u_Dverify)) __PYX_ERR(0, 1309, __pyx_L1_error);
+    __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1309, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
     __Pyx_GIVEREF(__pyx_t_2);
-    if (__Pyx_PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_2)) __PYX_ERR(0, 1302, __pyx_L1_error);
+    if (__Pyx_PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_2)) __PYX_ERR(0, 1309, __pyx_L1_error);
     __pyx_t_2 = 0;
-    __pyx_t_2 = __Pyx_PyDict_NewPresized(3); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1302, __pyx_L1_error)
+    __pyx_t_2 = __Pyx_PyDict_NewPresized(3); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1309, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
-    __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_sp); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1302, __pyx_L1_error)
+    __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_sp); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1309, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
-    __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_PIPE); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1302, __pyx_L1_error)
+    __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_PIPE); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1309, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-    if (PyDict_SetItem(__pyx_t_2, __pyx_n_s_stdin, __pyx_t_6) < 0) __PYX_ERR(0, 1302, __pyx_L1_error)
+    if (PyDict_SetItem(__pyx_t_2, __pyx_n_s_stdin, __pyx_t_6) < 0) __PYX_ERR(0, 1309, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-    __Pyx_GetModuleGlobalName(__pyx_t_6, __pyx_n_s_sp); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1302, __pyx_L1_error)
+    __Pyx_GetModuleGlobalName(__pyx_t_6, __pyx_n_s_sp); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1309, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
-    __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_6, __pyx_n_s_PIPE); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1302, __pyx_L1_error)
+    __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_6, __pyx_n_s_PIPE); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1309, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-    if (PyDict_SetItem(__pyx_t_2, __pyx_n_s_stdout, __pyx_t_5) < 0) __PYX_ERR(0, 1302, __pyx_L1_error)
+    if (PyDict_SetItem(__pyx_t_2, __pyx_n_s_stdout, __pyx_t_5) < 0) __PYX_ERR(0, 1309, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-    if (PyDict_SetItem(__pyx_t_2, __pyx_n_s_text, Py_True) < 0) __PYX_ERR(0, 1302, __pyx_L1_error)
-    __pyx_t_5 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_4, __pyx_t_2); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1302, __pyx_L1_error)
+    if (PyDict_SetItem(__pyx_t_2, __pyx_n_s_text, Py_True) < 0) __PYX_ERR(0, 1309, __pyx_L1_error)
+    __pyx_t_5 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_4, __pyx_t_2); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1309, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-    __pyx_t_7 = __Pyx_PyObject_LookupSpecial(__pyx_t_5, __pyx_n_s_exit); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1302, __pyx_L1_error)
+    __pyx_t_7 = __Pyx_PyObject_LookupSpecial(__pyx_t_5, __pyx_n_s_exit); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1309, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_7);
-    __pyx_t_4 = __Pyx_PyObject_LookupSpecial(__pyx_t_5, __pyx_n_s_enter); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1302, __pyx_L4_error)
+    __pyx_t_4 = __Pyx_PyObject_LookupSpecial(__pyx_t_5, __pyx_n_s_enter); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1309, __pyx_L4_error)
     __Pyx_GOTREF(__pyx_t_4);
     __pyx_t_3 = NULL;
     __pyx_t_8 = 0;
     #if CYTHON_UNPACK_METHODS
     if (likely(PyMethod_Check(__pyx_t_4))) {
       __pyx_t_3 = PyMethod_GET_SELF(__pyx_t_4);
       if (likely(__pyx_t_3)) {
@@ -43129,15 +43266,15 @@
       }
     }
     #endif
     {
       PyObject *__pyx_callargs[2] = {__pyx_t_3, NULL};
       __pyx_t_2 = __Pyx_PyObject_FastCall(__pyx_t_4, __pyx_callargs+1-__pyx_t_8, 0+__pyx_t_8);
       __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
-      if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1302, __pyx_L4_error)
+      if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1309, __pyx_L4_error)
       __Pyx_GOTREF(__pyx_t_2);
       __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
     }
     __pyx_t_4 = __pyx_t_2;
     __pyx_t_2 = 0;
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
     /*try:*/ {
@@ -43148,27 +43285,27 @@
         __Pyx_XGOTREF(__pyx_t_9);
         __Pyx_XGOTREF(__pyx_t_10);
         __Pyx_XGOTREF(__pyx_t_11);
         /*try:*/ {
           __pyx_v_espresso = __pyx_t_4;
           __pyx_t_4 = 0;
 
-          /* "sat_toolkit/formula.pyx":1303
+          /* "sat_toolkit/formula.pyx":1310
  * 
  *         with sp.Popen(['espresso', '-Dverify'], stdin=sp.PIPE, stdout=sp.PIPE, text=True) as espresso:
  *             espresso.stdin.write(self.to_espresso())             # <<<<<<<<<<<<<<
  *             espresso.stdin.write(other.to_espresso(print_numvars = False))
  *             espresso.stdin.close()
  */
-          __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_v_espresso, __pyx_n_s_stdin); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1303, __pyx_L8_error)
+          __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_v_espresso, __pyx_n_s_stdin); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1310, __pyx_L8_error)
           __Pyx_GOTREF(__pyx_t_5);
-          __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_write); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1303, __pyx_L8_error)
+          __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_write); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1310, __pyx_L8_error)
           __Pyx_GOTREF(__pyx_t_2);
           __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-          __pyx_t_3 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_self), __pyx_n_s_to_espresso); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1303, __pyx_L8_error)
+          __pyx_t_3 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_self), __pyx_n_s_to_espresso); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1310, __pyx_L8_error)
           __Pyx_GOTREF(__pyx_t_3);
           __pyx_t_6 = NULL;
           __pyx_t_8 = 0;
           #if CYTHON_UNPACK_METHODS
           if (likely(PyMethod_Check(__pyx_t_3))) {
             __pyx_t_6 = PyMethod_GET_SELF(__pyx_t_3);
             if (likely(__pyx_t_6)) {
@@ -43180,15 +43317,15 @@
             }
           }
           #endif
           {
             PyObject *__pyx_callargs[2] = {__pyx_t_6, NULL};
             __pyx_t_5 = __Pyx_PyObject_FastCall(__pyx_t_3, __pyx_callargs+1-__pyx_t_8, 0+__pyx_t_8);
             __Pyx_XDECREF(__pyx_t_6); __pyx_t_6 = 0;
-            if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1303, __pyx_L8_error)
+            if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1310, __pyx_L8_error)
             __Pyx_GOTREF(__pyx_t_5);
             __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
           }
           __pyx_t_3 = NULL;
           __pyx_t_8 = 0;
           #if CYTHON_UNPACK_METHODS
           if (likely(PyMethod_Check(__pyx_t_2))) {
@@ -43203,38 +43340,38 @@
           }
           #endif
           {
             PyObject *__pyx_callargs[2] = {__pyx_t_3, __pyx_t_5};
             __pyx_t_4 = __Pyx_PyObject_FastCall(__pyx_t_2, __pyx_callargs+1-__pyx_t_8, 1+__pyx_t_8);
             __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
             __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-            if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1303, __pyx_L8_error)
+            if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1310, __pyx_L8_error)
             __Pyx_GOTREF(__pyx_t_4);
             __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
           }
           __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
 
-          /* "sat_toolkit/formula.pyx":1304
+          /* "sat_toolkit/formula.pyx":1311
  *         with sp.Popen(['espresso', '-Dverify'], stdin=sp.PIPE, stdout=sp.PIPE, text=True) as espresso:
  *             espresso.stdin.write(self.to_espresso())
  *             espresso.stdin.write(other.to_espresso(print_numvars = False))             # <<<<<<<<<<<<<<
  *             espresso.stdin.close()
  * 
  */
-          __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_espresso, __pyx_n_s_stdin); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1304, __pyx_L8_error)
+          __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_espresso, __pyx_n_s_stdin); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1311, __pyx_L8_error)
           __Pyx_GOTREF(__pyx_t_2);
-          __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_write); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1304, __pyx_L8_error)
+          __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_write); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1311, __pyx_L8_error)
           __Pyx_GOTREF(__pyx_t_5);
           __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-          __pyx_t_2 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_other), __pyx_n_s_to_espresso); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1304, __pyx_L8_error)
+          __pyx_t_2 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_other), __pyx_n_s_to_espresso); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1311, __pyx_L8_error)
           __Pyx_GOTREF(__pyx_t_2);
-          __pyx_t_3 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1304, __pyx_L8_error)
+          __pyx_t_3 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1311, __pyx_L8_error)
           __Pyx_GOTREF(__pyx_t_3);
-          if (PyDict_SetItem(__pyx_t_3, __pyx_n_s_print_numvars, Py_False) < 0) __PYX_ERR(0, 1304, __pyx_L8_error)
-          __pyx_t_6 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_empty_tuple, __pyx_t_3); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1304, __pyx_L8_error)
+          if (PyDict_SetItem(__pyx_t_3, __pyx_n_s_print_numvars, Py_False) < 0) __PYX_ERR(0, 1311, __pyx_L8_error)
+          __pyx_t_6 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_empty_tuple, __pyx_t_3); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1311, __pyx_L8_error)
           __Pyx_GOTREF(__pyx_t_6);
           __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
           __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
           __pyx_t_3 = NULL;
           __pyx_t_8 = 0;
           #if CYTHON_UNPACK_METHODS
           if (likely(PyMethod_Check(__pyx_t_5))) {
@@ -43249,30 +43386,30 @@
           }
           #endif
           {
             PyObject *__pyx_callargs[2] = {__pyx_t_3, __pyx_t_6};
             __pyx_t_4 = __Pyx_PyObject_FastCall(__pyx_t_5, __pyx_callargs+1-__pyx_t_8, 1+__pyx_t_8);
             __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
             __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-            if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1304, __pyx_L8_error)
+            if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1311, __pyx_L8_error)
             __Pyx_GOTREF(__pyx_t_4);
             __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
           }
           __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
 
-          /* "sat_toolkit/formula.pyx":1305
+          /* "sat_toolkit/formula.pyx":1312
  *             espresso.stdin.write(self.to_espresso())
  *             espresso.stdin.write(other.to_espresso(print_numvars = False))
  *             espresso.stdin.close()             # <<<<<<<<<<<<<<
  * 
  *             ret_code = espresso.wait()
  */
-          __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_v_espresso, __pyx_n_s_stdin); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1305, __pyx_L8_error)
+          __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_v_espresso, __pyx_n_s_stdin); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1312, __pyx_L8_error)
           __Pyx_GOTREF(__pyx_t_5);
-          __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_close); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1305, __pyx_L8_error)
+          __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_close); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1312, __pyx_L8_error)
           __Pyx_GOTREF(__pyx_t_6);
           __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
           __pyx_t_5 = NULL;
           __pyx_t_8 = 0;
           #if CYTHON_UNPACK_METHODS
           if (likely(PyMethod_Check(__pyx_t_6))) {
             __pyx_t_5 = PyMethod_GET_SELF(__pyx_t_6);
@@ -43285,28 +43422,28 @@
             }
           }
           #endif
           {
             PyObject *__pyx_callargs[2] = {__pyx_t_5, NULL};
             __pyx_t_4 = __Pyx_PyObject_FastCall(__pyx_t_6, __pyx_callargs+1-__pyx_t_8, 0+__pyx_t_8);
             __Pyx_XDECREF(__pyx_t_5); __pyx_t_5 = 0;
-            if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1305, __pyx_L8_error)
+            if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1312, __pyx_L8_error)
             __Pyx_GOTREF(__pyx_t_4);
             __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
           }
           __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
 
-          /* "sat_toolkit/formula.pyx":1307
+          /* "sat_toolkit/formula.pyx":1314
  *             espresso.stdin.close()
  * 
  *             ret_code = espresso.wait()             # <<<<<<<<<<<<<<
  *             if ret_code not in [0, 1]:
  *                 raise sp.CalledProcessError(ret_code, ' '.join(espresso.args))
  */
-          __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_v_espresso, __pyx_n_s_wait); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1307, __pyx_L8_error)
+          __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_v_espresso, __pyx_n_s_wait); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1314, __pyx_L8_error)
           __Pyx_GOTREF(__pyx_t_6);
           __pyx_t_5 = NULL;
           __pyx_t_8 = 0;
           #if CYTHON_UNPACK_METHODS
           if (likely(PyMethod_Check(__pyx_t_6))) {
             __pyx_t_5 = PyMethod_GET_SELF(__pyx_t_6);
             if (likely(__pyx_t_5)) {
@@ -43318,23 +43455,23 @@
             }
           }
           #endif
           {
             PyObject *__pyx_callargs[2] = {__pyx_t_5, NULL};
             __pyx_t_4 = __Pyx_PyObject_FastCall(__pyx_t_6, __pyx_callargs+1-__pyx_t_8, 0+__pyx_t_8);
             __Pyx_XDECREF(__pyx_t_5); __pyx_t_5 = 0;
-            if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1307, __pyx_L8_error)
+            if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1314, __pyx_L8_error)
             __Pyx_GOTREF(__pyx_t_4);
             __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
           }
-          __pyx_t_8 = __Pyx_PyInt_As_int(__pyx_t_4); if (unlikely((__pyx_t_8 == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 1307, __pyx_L8_error)
+          __pyx_t_8 = __Pyx_PyInt_As_int(__pyx_t_4); if (unlikely((__pyx_t_8 == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 1314, __pyx_L8_error)
           __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
           __pyx_v_ret_code = __pyx_t_8;
 
-          /* "sat_toolkit/formula.pyx":1308
+          /* "sat_toolkit/formula.pyx":1315
  * 
  *             ret_code = espresso.wait()
  *             if ret_code not in [0, 1]:             # <<<<<<<<<<<<<<
  *                 raise sp.CalledProcessError(ret_code, ' '.join(espresso.args))
  * 
  */
           switch (__pyx_v_ret_code) {
@@ -43345,31 +43482,31 @@
             default:
             __pyx_t_1 = 1;
             break;
           }
           __pyx_t_12 = __pyx_t_1;
           if (unlikely(__pyx_t_12)) {
 
-            /* "sat_toolkit/formula.pyx":1309
+            /* "sat_toolkit/formula.pyx":1316
  *             ret_code = espresso.wait()
  *             if ret_code not in [0, 1]:
  *                 raise sp.CalledProcessError(ret_code, ' '.join(espresso.args))             # <<<<<<<<<<<<<<
  * 
  *             return ret_code == 0
  */
-            __Pyx_GetModuleGlobalName(__pyx_t_6, __pyx_n_s_sp); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1309, __pyx_L8_error)
+            __Pyx_GetModuleGlobalName(__pyx_t_6, __pyx_n_s_sp); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1316, __pyx_L8_error)
             __Pyx_GOTREF(__pyx_t_6);
-            __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_6, __pyx_n_s_CalledProcessError); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1309, __pyx_L8_error)
+            __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_6, __pyx_n_s_CalledProcessError); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1316, __pyx_L8_error)
             __Pyx_GOTREF(__pyx_t_5);
             __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-            __pyx_t_6 = __Pyx_PyInt_From_int(__pyx_v_ret_code); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1309, __pyx_L8_error)
+            __pyx_t_6 = __Pyx_PyInt_From_int(__pyx_v_ret_code); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1316, __pyx_L8_error)
             __Pyx_GOTREF(__pyx_t_6);
-            __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_v_espresso, __pyx_n_s_args); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1309, __pyx_L8_error)
+            __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_v_espresso, __pyx_n_s_args); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1316, __pyx_L8_error)
             __Pyx_GOTREF(__pyx_t_3);
-            __pyx_t_2 = PyUnicode_Join(__pyx_kp_u__32, __pyx_t_3); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1309, __pyx_L8_error)
+            __pyx_t_2 = PyUnicode_Join(__pyx_kp_u__32, __pyx_t_3); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1316, __pyx_L8_error)
             __Pyx_GOTREF(__pyx_t_2);
             __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
             __pyx_t_3 = NULL;
             __pyx_t_8 = 0;
             #if CYTHON_UNPACK_METHODS
             if (unlikely(PyMethod_Check(__pyx_t_5))) {
               __pyx_t_3 = PyMethod_GET_SELF(__pyx_t_5);
@@ -43384,46 +43521,46 @@
             #endif
             {
               PyObject *__pyx_callargs[3] = {__pyx_t_3, __pyx_t_6, __pyx_t_2};
               __pyx_t_4 = __Pyx_PyObject_FastCall(__pyx_t_5, __pyx_callargs+1-__pyx_t_8, 2+__pyx_t_8);
               __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
               __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
               __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-              if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1309, __pyx_L8_error)
+              if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1316, __pyx_L8_error)
               __Pyx_GOTREF(__pyx_t_4);
               __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
             }
             __Pyx_Raise(__pyx_t_4, 0, 0, 0);
             __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-            __PYX_ERR(0, 1309, __pyx_L8_error)
+            __PYX_ERR(0, 1316, __pyx_L8_error)
 
-            /* "sat_toolkit/formula.pyx":1308
+            /* "sat_toolkit/formula.pyx":1315
  * 
  *             ret_code = espresso.wait()
  *             if ret_code not in [0, 1]:             # <<<<<<<<<<<<<<
  *                 raise sp.CalledProcessError(ret_code, ' '.join(espresso.args))
  * 
  */
           }
 
-          /* "sat_toolkit/formula.pyx":1311
+          /* "sat_toolkit/formula.pyx":1318
  *                 raise sp.CalledProcessError(ret_code, ' '.join(espresso.args))
  * 
  *             return ret_code == 0             # <<<<<<<<<<<<<<
  * 
  *     def translate(self, mapping) -> CNF:
  */
           __Pyx_XDECREF(__pyx_r);
-          __pyx_t_4 = __Pyx_PyBool_FromLong((__pyx_v_ret_code == 0)); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1311, __pyx_L8_error)
+          __pyx_t_4 = __Pyx_PyBool_FromLong((__pyx_v_ret_code == 0)); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1318, __pyx_L8_error)
           __Pyx_GOTREF(__pyx_t_4);
           __pyx_r = __pyx_t_4;
           __pyx_t_4 = 0;
           goto __pyx_L12_try_return;
 
-          /* "sat_toolkit/formula.pyx":1302
+          /* "sat_toolkit/formula.pyx":1309
  *             return False
  * 
  *         with sp.Popen(['espresso', '-Dverify'], stdin=sp.PIPE, stdout=sp.PIPE, text=True) as espresso:             # <<<<<<<<<<<<<<
  *             espresso.stdin.write(self.to_espresso())
  *             espresso.stdin.write(other.to_espresso(print_numvars = False))
  */
         }
@@ -43431,36 +43568,36 @@
         __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
         __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
         __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
         __Pyx_XDECREF(__pyx_t_5); __pyx_t_5 = 0;
         __Pyx_XDECREF(__pyx_t_6); __pyx_t_6 = 0;
         /*except:*/ {
           __Pyx_AddTraceback("sat_toolkit.formula.CNF.equiv", __pyx_clineno, __pyx_lineno, __pyx_filename);
-          if (__Pyx_GetException(&__pyx_t_4, &__pyx_t_5, &__pyx_t_2) < 0) __PYX_ERR(0, 1302, __pyx_L10_except_error)
+          if (__Pyx_GetException(&__pyx_t_4, &__pyx_t_5, &__pyx_t_2) < 0) __PYX_ERR(0, 1309, __pyx_L10_except_error)
           __Pyx_XGOTREF(__pyx_t_4);
           __Pyx_XGOTREF(__pyx_t_5);
           __Pyx_XGOTREF(__pyx_t_2);
-          __pyx_t_6 = PyTuple_Pack(3, __pyx_t_4, __pyx_t_5, __pyx_t_2); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1302, __pyx_L10_except_error)
+          __pyx_t_6 = PyTuple_Pack(3, __pyx_t_4, __pyx_t_5, __pyx_t_2); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1309, __pyx_L10_except_error)
           __Pyx_GOTREF(__pyx_t_6);
           __pyx_t_13 = __Pyx_PyObject_Call(__pyx_t_7, __pyx_t_6, NULL);
           __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
           __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-          if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 1302, __pyx_L10_except_error)
+          if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 1309, __pyx_L10_except_error)
           __Pyx_GOTREF(__pyx_t_13);
           __pyx_t_12 = __Pyx_PyObject_IsTrue(__pyx_t_13);
           __Pyx_DECREF(__pyx_t_13); __pyx_t_13 = 0;
-          if (__pyx_t_12 < 0) __PYX_ERR(0, 1302, __pyx_L10_except_error)
+          if (__pyx_t_12 < 0) __PYX_ERR(0, 1309, __pyx_L10_except_error)
           __pyx_t_1 = (!__pyx_t_12);
           if (unlikely(__pyx_t_1)) {
             __Pyx_GIVEREF(__pyx_t_4);
             __Pyx_GIVEREF(__pyx_t_5);
             __Pyx_XGIVEREF(__pyx_t_2);
             __Pyx_ErrRestoreWithState(__pyx_t_4, __pyx_t_5, __pyx_t_2);
             __pyx_t_4 = 0; __pyx_t_5 = 0; __pyx_t_2 = 0; 
-            __PYX_ERR(0, 1302, __pyx_L10_except_error)
+            __PYX_ERR(0, 1309, __pyx_L10_except_error)
           }
           __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
           __Pyx_XDECREF(__pyx_t_5); __pyx_t_5 = 0;
           __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
           goto __pyx_L9_exception_handled;
         }
         __pyx_L10_except_error:;
@@ -43483,27 +43620,27 @@
       }
     }
     /*finally:*/ {
       /*normal exit:*/{
         if (__pyx_t_7) {
           __pyx_t_11 = __Pyx_PyObject_Call(__pyx_t_7, __pyx_tuple__35, NULL);
           __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-          if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1302, __pyx_L1_error)
+          if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1309, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_11);
           __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
         }
         goto __pyx_L7;
       }
       __pyx_L5_return: {
         __pyx_t_11 = __pyx_r;
         __pyx_r = 0;
         if (__pyx_t_7) {
           __pyx_t_10 = __Pyx_PyObject_Call(__pyx_t_7, __pyx_tuple__35, NULL);
           __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-          if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1302, __pyx_L1_error)
+          if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1309, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_10);
           __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
         }
         __pyx_r = __pyx_t_11;
         __pyx_t_11 = 0;
         goto __pyx_L0;
       }
@@ -43512,15 +43649,15 @@
     goto __pyx_L18;
     __pyx_L4_error:;
     __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
     goto __pyx_L1_error;
     __pyx_L18:;
   }
 
-  /* "sat_toolkit/formula.pyx":1292
+  /* "sat_toolkit/formula.pyx":1299
  *         return self.to_dimacs().rstrip()
  * 
  *     def equiv(self, CNF other) -> bool:             # <<<<<<<<<<<<<<
  *         """
  *         Check for logical eqivalence between self and other.
  */
 
@@ -43538,15 +43675,15 @@
   __pyx_L0:;
   __Pyx_XDECREF(__pyx_v_espresso);
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "sat_toolkit/formula.pyx":1313
+/* "sat_toolkit/formula.pyx":1320
  *             return ret_code == 0
  * 
  *     def translate(self, mapping) -> CNF:             # <<<<<<<<<<<<<<
  *         """
  *         Translate all variables in the CNF to a new index.
  */
 
@@ -43600,31 +43737,31 @@
       kw_args = __Pyx_NumKwargs_FASTCALL(__pyx_kwds);
       switch (__pyx_nargs) {
         case  0:
         if (likely((values[0] = __Pyx_GetKwValue_FASTCALL(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_mapping)) != 0)) {
           (void)__Pyx_Arg_NewRef_FASTCALL(values[0]);
           kw_args--;
         }
-        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 1313, __pyx_L3_error)
+        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 1320, __pyx_L3_error)
         else goto __pyx_L5_argtuple_error;
       }
       if (unlikely(kw_args > 0)) {
         const Py_ssize_t kwd_pos_args = __pyx_nargs;
-        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values + 0, kwd_pos_args, "translate") < 0)) __PYX_ERR(0, 1313, __pyx_L3_error)
+        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values + 0, kwd_pos_args, "translate") < 0)) __PYX_ERR(0, 1320, __pyx_L3_error)
       }
     } else if (unlikely(__pyx_nargs != 1)) {
       goto __pyx_L5_argtuple_error;
     } else {
       values[0] = __Pyx_Arg_FASTCALL(__pyx_args, 0);
     }
     __pyx_v_mapping = values[0];
   }
   goto __pyx_L6_skip;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("translate", 1, 1, 1, __pyx_nargs); __PYX_ERR(0, 1313, __pyx_L3_error)
+  __Pyx_RaiseArgtupleInvalid("translate", 1, 1, 1, __pyx_nargs); __PYX_ERR(0, 1320, __pyx_L3_error)
   __pyx_L6_skip:;
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L3_error:;
   {
     Py_ssize_t __pyx_temp;
     for (__pyx_temp=0; __pyx_temp < (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
       __Pyx_Arg_XDECREF_FASTCALL(values[__pyx_temp]);
@@ -43678,230 +43815,230 @@
   __Pyx_memviewslice __pyx_t_20 = { 0, 0, { 0 }, { 0 }, { 0 } };
   int __pyx_t_21;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("translate", 1);
 
-  /* "sat_toolkit/formula.pyx":1322
+  /* "sat_toolkit/formula.pyx":1329
  *         :return: a new CNF with variables changed according to mapping parameter
  *         """
  *         cdef np_vars = np.array(mapping, copy=False, dtype=np.int32)             # <<<<<<<<<<<<<<
  *         cdef int [::1] var_view = np_vars
  *         cdef size_t i
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1322, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1329, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_array); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1322, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_array); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1329, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  __pyx_t_1 = PyTuple_New(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1322, __pyx_L1_error)
+  __pyx_t_1 = PyTuple_New(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1329, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_INCREF(__pyx_v_mapping);
   __Pyx_GIVEREF(__pyx_v_mapping);
-  if (__Pyx_PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_v_mapping)) __PYX_ERR(0, 1322, __pyx_L1_error);
-  __pyx_t_3 = __Pyx_PyDict_NewPresized(2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1322, __pyx_L1_error)
+  if (__Pyx_PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_v_mapping)) __PYX_ERR(0, 1329, __pyx_L1_error);
+  __pyx_t_3 = __Pyx_PyDict_NewPresized(2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1329, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  if (PyDict_SetItem(__pyx_t_3, __pyx_n_s_copy, Py_False) < 0) __PYX_ERR(0, 1322, __pyx_L1_error)
-  __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_np); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1322, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_3, __pyx_n_s_copy, Py_False) < 0) __PYX_ERR(0, 1329, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_np); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1329, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
-  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_int32); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1322, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_int32); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1329, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-  if (PyDict_SetItem(__pyx_t_3, __pyx_n_s_dtype, __pyx_t_5) < 0) __PYX_ERR(0, 1322, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_3, __pyx_n_s_dtype, __pyx_t_5) < 0) __PYX_ERR(0, 1329, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-  __pyx_t_5 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_t_1, __pyx_t_3); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1322, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_t_1, __pyx_t_3); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1329, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   __pyx_v_np_vars = __pyx_t_5;
   __pyx_t_5 = 0;
 
-  /* "sat_toolkit/formula.pyx":1323
+  /* "sat_toolkit/formula.pyx":1330
  *         """
  *         cdef np_vars = np.array(mapping, copy=False, dtype=np.int32)
  *         cdef int [::1] var_view = np_vars             # <<<<<<<<<<<<<<
  *         cdef size_t i
  * 
  */
-  __pyx_t_6 = __Pyx_PyObject_to_MemoryviewSlice_dc_int(__pyx_v_np_vars, PyBUF_WRITABLE); if (unlikely(!__pyx_t_6.memview)) __PYX_ERR(0, 1323, __pyx_L1_error)
+  __pyx_t_6 = __Pyx_PyObject_to_MemoryviewSlice_dc_int(__pyx_v_np_vars, PyBUF_WRITABLE); if (unlikely(!__pyx_t_6.memview)) __PYX_ERR(0, 1330, __pyx_L1_error)
   __pyx_v_var_view = __pyx_t_6;
   __pyx_t_6.memview = NULL;
   __pyx_t_6.data = NULL;
 
-  /* "sat_toolkit/formula.pyx":1326
+  /* "sat_toolkit/formula.pyx":1333
  *         cdef size_t i
  * 
  *         if var_view.shape[0] != self.nvars + 1:             # <<<<<<<<<<<<<<
  *             raise ValueError(f'need to provide translation for all 1+{self.nvars} variables')
  *         if var_view[0] != 0:
  */
   __pyx_t_7 = ((__pyx_v_var_view.shape[0]) != (__pyx_v_self->__pyx_base.nvars + 1));
   if (unlikely(__pyx_t_7)) {
 
-    /* "sat_toolkit/formula.pyx":1327
+    /* "sat_toolkit/formula.pyx":1334
  * 
  *         if var_view.shape[0] != self.nvars + 1:
  *             raise ValueError(f'need to provide translation for all 1+{self.nvars} variables')             # <<<<<<<<<<<<<<
  *         if var_view[0] != 0:
  *             raise ValueError('variable 0 must map to 0 again')
  */
-    __pyx_t_5 = PyTuple_New(3); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1327, __pyx_L1_error)
+    __pyx_t_5 = PyTuple_New(3); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1334, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
     __pyx_t_8 = 0;
     __pyx_t_9 = 127;
     __Pyx_INCREF(__pyx_kp_u_need_to_provide_translation_for);
     __pyx_t_8 += 38;
     __Pyx_GIVEREF(__pyx_kp_u_need_to_provide_translation_for);
     PyTuple_SET_ITEM(__pyx_t_5, 0, __pyx_kp_u_need_to_provide_translation_for);
-    __pyx_t_3 = __Pyx_PyUnicode_From_int(__pyx_v_self->__pyx_base.nvars, 0, ' ', 'd'); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1327, __pyx_L1_error)
+    __pyx_t_3 = __Pyx_PyUnicode_From_int(__pyx_v_self->__pyx_base.nvars, 0, ' ', 'd'); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1334, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
     __pyx_t_8 += __Pyx_PyUnicode_GET_LENGTH(__pyx_t_3);
     __Pyx_GIVEREF(__pyx_t_3);
     PyTuple_SET_ITEM(__pyx_t_5, 1, __pyx_t_3);
     __pyx_t_3 = 0;
     __Pyx_INCREF(__pyx_kp_u_variables_2);
     __pyx_t_8 += 10;
     __Pyx_GIVEREF(__pyx_kp_u_variables_2);
     PyTuple_SET_ITEM(__pyx_t_5, 2, __pyx_kp_u_variables_2);
-    __pyx_t_3 = __Pyx_PyUnicode_Join(__pyx_t_5, 3, __pyx_t_8, __pyx_t_9); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1327, __pyx_L1_error)
+    __pyx_t_3 = __Pyx_PyUnicode_Join(__pyx_t_5, 3, __pyx_t_8, __pyx_t_9); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1334, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-    __pyx_t_5 = __Pyx_PyObject_CallOneArg(__pyx_builtin_ValueError, __pyx_t_3); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1327, __pyx_L1_error)
+    __pyx_t_5 = __Pyx_PyObject_CallOneArg(__pyx_builtin_ValueError, __pyx_t_3); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1334, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
     __Pyx_Raise(__pyx_t_5, 0, 0, 0);
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-    __PYX_ERR(0, 1327, __pyx_L1_error)
+    __PYX_ERR(0, 1334, __pyx_L1_error)
 
-    /* "sat_toolkit/formula.pyx":1326
+    /* "sat_toolkit/formula.pyx":1333
  *         cdef size_t i
  * 
  *         if var_view.shape[0] != self.nvars + 1:             # <<<<<<<<<<<<<<
  *             raise ValueError(f'need to provide translation for all 1+{self.nvars} variables')
  *         if var_view[0] != 0:
  */
   }
 
-  /* "sat_toolkit/formula.pyx":1328
+  /* "sat_toolkit/formula.pyx":1335
  *         if var_view.shape[0] != self.nvars + 1:
  *             raise ValueError(f'need to provide translation for all 1+{self.nvars} variables')
  *         if var_view[0] != 0:             # <<<<<<<<<<<<<<
  *             raise ValueError('variable 0 must map to 0 again')
  * 
  */
   __pyx_t_10 = 0;
   __pyx_t_7 = ((*((int *) ( /* dim=0 */ ((char *) (((int *) __pyx_v_var_view.data) + __pyx_t_10)) ))) != 0);
   if (unlikely(__pyx_t_7)) {
 
-    /* "sat_toolkit/formula.pyx":1329
+    /* "sat_toolkit/formula.pyx":1336
  *             raise ValueError(f'need to provide translation for all 1+{self.nvars} variables')
  *         if var_view[0] != 0:
  *             raise ValueError('variable 0 must map to 0 again')             # <<<<<<<<<<<<<<
  * 
  *         for i in range(1, <size_t> var_view.shape[0]):
  */
-    __pyx_t_5 = __Pyx_PyObject_Call(__pyx_builtin_ValueError, __pyx_tuple__43, NULL); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1329, __pyx_L1_error)
+    __pyx_t_5 = __Pyx_PyObject_Call(__pyx_builtin_ValueError, __pyx_tuple__43, NULL); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1336, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
     __Pyx_Raise(__pyx_t_5, 0, 0, 0);
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-    __PYX_ERR(0, 1329, __pyx_L1_error)
+    __PYX_ERR(0, 1336, __pyx_L1_error)
 
-    /* "sat_toolkit/formula.pyx":1328
+    /* "sat_toolkit/formula.pyx":1335
  *         if var_view.shape[0] != self.nvars + 1:
  *             raise ValueError(f'need to provide translation for all 1+{self.nvars} variables')
  *         if var_view[0] != 0:             # <<<<<<<<<<<<<<
  *             raise ValueError('variable 0 must map to 0 again')
  * 
  */
   }
 
-  /* "sat_toolkit/formula.pyx":1331
+  /* "sat_toolkit/formula.pyx":1338
  *             raise ValueError('variable 0 must map to 0 again')
  * 
  *         for i in range(1, <size_t> var_view.shape[0]):             # <<<<<<<<<<<<<<
  *             if var_view[i] == 0:
  *                 raise ValueError('variable must not be mapped to 0')
  */
   __pyx_t_11 = ((size_t)(__pyx_v_var_view.shape[0]));
   __pyx_t_12 = __pyx_t_11;
   for (__pyx_t_13 = 1; __pyx_t_13 < __pyx_t_12; __pyx_t_13+=1) {
     __pyx_v_i = __pyx_t_13;
 
-    /* "sat_toolkit/formula.pyx":1332
+    /* "sat_toolkit/formula.pyx":1339
  * 
  *         for i in range(1, <size_t> var_view.shape[0]):
  *             if var_view[i] == 0:             # <<<<<<<<<<<<<<
  *                 raise ValueError('variable must not be mapped to 0')
  * 
  */
     __pyx_t_14 = __pyx_v_i;
     __pyx_t_7 = ((*((int *) ( /* dim=0 */ ((char *) (((int *) __pyx_v_var_view.data) + __pyx_t_14)) ))) == 0);
     if (unlikely(__pyx_t_7)) {
 
-      /* "sat_toolkit/formula.pyx":1333
+      /* "sat_toolkit/formula.pyx":1340
  *         for i in range(1, <size_t> var_view.shape[0]):
  *             if var_view[i] == 0:
  *                 raise ValueError('variable must not be mapped to 0')             # <<<<<<<<<<<<<<
  * 
  *         cdef vector[int] new_clauses
  */
-      __pyx_t_5 = __Pyx_PyObject_Call(__pyx_builtin_ValueError, __pyx_tuple__44, NULL); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1333, __pyx_L1_error)
+      __pyx_t_5 = __Pyx_PyObject_Call(__pyx_builtin_ValueError, __pyx_tuple__44, NULL); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1340, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_5);
       __Pyx_Raise(__pyx_t_5, 0, 0, 0);
       __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-      __PYX_ERR(0, 1333, __pyx_L1_error)
+      __PYX_ERR(0, 1340, __pyx_L1_error)
 
-      /* "sat_toolkit/formula.pyx":1332
+      /* "sat_toolkit/formula.pyx":1339
  * 
  *         for i in range(1, <size_t> var_view.shape[0]):
  *             if var_view[i] == 0:             # <<<<<<<<<<<<<<
  *                 raise ValueError('variable must not be mapped to 0')
  * 
  */
     }
   }
 
-  /* "sat_toolkit/formula.pyx":1336
+  /* "sat_toolkit/formula.pyx":1343
  * 
  *         cdef vector[int] new_clauses
  *         new_clauses.resize(self._clauses.size())             # <<<<<<<<<<<<<<
  * 
  *         cdef int var
  */
   try {
     __pyx_v_new_clauses.resize(__pyx_v_self->__pyx_base._clauses.size());
   } catch(...) {
     __Pyx_CppExn2PyErr();
-    __PYX_ERR(0, 1336, __pyx_L1_error)
+    __PYX_ERR(0, 1343, __pyx_L1_error)
   }
 
-  /* "sat_toolkit/formula.pyx":1339
+  /* "sat_toolkit/formula.pyx":1346
  * 
  *         cdef int var
  *         for i in range(self._clauses.size()):             # <<<<<<<<<<<<<<
  *             var = self._clauses[i]
  *             new_clauses[i] = var_view[abs(var)] * (1 if var > 0 else -1)
  */
   __pyx_t_15 = __pyx_v_self->__pyx_base._clauses.size();
   __pyx_t_16 = __pyx_t_15;
   for (__pyx_t_11 = 0; __pyx_t_11 < __pyx_t_16; __pyx_t_11+=1) {
     __pyx_v_i = __pyx_t_11;
 
-    /* "sat_toolkit/formula.pyx":1340
+    /* "sat_toolkit/formula.pyx":1347
  *         cdef int var
  *         for i in range(self._clauses.size()):
  *             var = self._clauses[i]             # <<<<<<<<<<<<<<
  *             new_clauses[i] = var_view[abs(var)] * (1 if var > 0 else -1)
  * 
  */
     __pyx_v_var = (__pyx_v_self->__pyx_base._clauses[__pyx_v_i]);
 
-    /* "sat_toolkit/formula.pyx":1341
+    /* "sat_toolkit/formula.pyx":1348
  *         for i in range(self._clauses.size()):
  *             var = self._clauses[i]
  *             new_clauses[i] = var_view[abs(var)] * (1 if var > 0 else -1)             # <<<<<<<<<<<<<<
  * 
  *         cdef CNF res = CNF.__new__(CNF)
  */
     __pyx_t_10 = __pyx_f_11sat_toolkit_7formula_abs(__pyx_v_var);
@@ -43910,65 +44047,65 @@
       __pyx_t_17 = 1;
     } else {
       __pyx_t_17 = -1L;
     }
     (__pyx_v_new_clauses[__pyx_v_i]) = ((*((int *) ( /* dim=0 */ ((char *) (((int *) __pyx_v_var_view.data) + __pyx_t_10)) ))) * __pyx_t_17);
   }
 
-  /* "sat_toolkit/formula.pyx":1343
+  /* "sat_toolkit/formula.pyx":1350
  *             new_clauses[i] = var_view[abs(var)] * (1 if var > 0 else -1)
  * 
  *         cdef CNF res = CNF.__new__(CNF)             # <<<<<<<<<<<<<<
  *         res._add_clauses(<int[:new_clauses.size()]> new_clauses.data())
  *         return res
  */
-  __pyx_t_5 = ((PyObject *)__pyx_tp_new_11sat_toolkit_7formula_CNF(((PyTypeObject *)__pyx_ptype_11sat_toolkit_7formula_CNF), __pyx_empty_tuple, NULL)); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1343, __pyx_L1_error)
+  __pyx_t_5 = ((PyObject *)__pyx_tp_new_11sat_toolkit_7formula_CNF(((PyTypeObject *)__pyx_ptype_11sat_toolkit_7formula_CNF), __pyx_empty_tuple, NULL)); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1350, __pyx_L1_error)
   __Pyx_GOTREF((PyObject *)__pyx_t_5);
   __pyx_v_res = ((struct __pyx_obj_11sat_toolkit_7formula_CNF *)__pyx_t_5);
   __pyx_t_5 = 0;
 
-  /* "sat_toolkit/formula.pyx":1344
+  /* "sat_toolkit/formula.pyx":1351
  * 
  *         cdef CNF res = CNF.__new__(CNF)
  *         res._add_clauses(<int[:new_clauses.size()]> new_clauses.data())             # <<<<<<<<<<<<<<
  *         return res
  * 
  */
   __pyx_t_18 = __pyx_v_new_clauses.data();
   if (!__pyx_t_18) {
     PyErr_SetString(PyExc_ValueError,"Cannot create cython.array from NULL pointer");
-    __PYX_ERR(0, 1344, __pyx_L1_error)
+    __PYX_ERR(0, 1351, __pyx_L1_error)
   }
-  __pyx_t_3 = __pyx_format_from_typeinfo(&__Pyx_TypeInfo_int); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1344, __pyx_L1_error)
+  __pyx_t_3 = __pyx_format_from_typeinfo(&__Pyx_TypeInfo_int); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1351, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  __pyx_t_5 = Py_BuildValue((char*) "("  __PYX_BUILD_PY_SSIZE_T  ")", ((Py_ssize_t)__pyx_v_new_clauses.size())); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1344, __pyx_L1_error)
+  __pyx_t_5 = Py_BuildValue((char*) "("  __PYX_BUILD_PY_SSIZE_T  ")", ((Py_ssize_t)__pyx_v_new_clauses.size())); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1351, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
-  __pyx_t_19 = __pyx_array_new(__pyx_t_5, sizeof(int), PyBytes_AS_STRING(__pyx_t_3), (char *) "c", (char *) __pyx_t_18); if (unlikely(!__pyx_t_19)) __PYX_ERR(0, 1344, __pyx_L1_error)
+  __pyx_t_19 = __pyx_array_new(__pyx_t_5, sizeof(int), PyBytes_AS_STRING(__pyx_t_3), (char *) "c", (char *) __pyx_t_18); if (unlikely(!__pyx_t_19)) __PYX_ERR(0, 1351, __pyx_L1_error)
   __Pyx_GOTREF((PyObject *)__pyx_t_19);
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  __pyx_t_20 = __Pyx_PyObject_to_MemoryviewSlice_ds_int__const__(((PyObject *)__pyx_t_19), 0); if (unlikely(!__pyx_t_20.memview)) __PYX_ERR(0, 1344, __pyx_L1_error)
+  __pyx_t_20 = __Pyx_PyObject_to_MemoryviewSlice_ds_int__const__(((PyObject *)__pyx_t_19), 0); if (unlikely(!__pyx_t_20.memview)) __PYX_ERR(0, 1351, __pyx_L1_error)
   __Pyx_DECREF((PyObject *)__pyx_t_19); __pyx_t_19 = 0;
-  __pyx_t_21 = ((struct __pyx_vtabstruct_11sat_toolkit_7formula_CNF *)__pyx_v_res->__pyx_base.__pyx_vtab)->__pyx_base._add_clauses(((struct __pyx_obj_11sat_toolkit_7formula__ClauseList *)__pyx_v_res), __pyx_t_20); if (unlikely(__pyx_t_21 == ((int)-1))) __PYX_ERR(0, 1344, __pyx_L1_error)
+  __pyx_t_21 = ((struct __pyx_vtabstruct_11sat_toolkit_7formula_CNF *)__pyx_v_res->__pyx_base.__pyx_vtab)->__pyx_base._add_clauses(((struct __pyx_obj_11sat_toolkit_7formula__ClauseList *)__pyx_v_res), __pyx_t_20); if (unlikely(__pyx_t_21 == ((int)-1))) __PYX_ERR(0, 1351, __pyx_L1_error)
   __PYX_XCLEAR_MEMVIEW(&__pyx_t_20, 1);
   __pyx_t_20.memview = NULL; __pyx_t_20.data = NULL;
 
-  /* "sat_toolkit/formula.pyx":1345
+  /* "sat_toolkit/formula.pyx":1352
  *         cdef CNF res = CNF.__new__(CNF)
  *         res._add_clauses(<int[:new_clauses.size()]> new_clauses.data())
  *         return res             # <<<<<<<<<<<<<<
  * 
  * collections.abc.Sequence.register(_ClauseList)
  */
   __Pyx_XDECREF((PyObject *)__pyx_r);
   __Pyx_INCREF((PyObject *)__pyx_v_res);
   __pyx_r = __pyx_v_res;
   goto __pyx_L0;
 
-  /* "sat_toolkit/formula.pyx":1313
+  /* "sat_toolkit/formula.pyx":1320
  *             return ret_code == 0
  * 
  *     def translate(self, mapping) -> CNF:             # <<<<<<<<<<<<<<
  *         """
  *         Translate all variables in the CNF to a new index.
  */
 
@@ -43989,51 +44126,51 @@
   __PYX_XCLEAR_MEMVIEW(&__pyx_v_var_view, 1);
   __Pyx_XDECREF((PyObject *)__pyx_v_res);
   __Pyx_XGIVEREF((PyObject *)__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "sat_toolkit/formula.pyx":1354
+/* "sat_toolkit/formula.pyx":1361
  *     Class for storing and manipulating a list of xor clauses.
  *     """
  *     cdef int _check_clause_type(self, _BaseClause clause) noexcept:             # <<<<<<<<<<<<<<
  *         return isinstance(clause, XorClause)
  * 
  */
 
 static int __pyx_f_11sat_toolkit_7formula_13XorClauseList__check_clause_type(CYTHON_UNUSED struct __pyx_obj_11sat_toolkit_7formula_XorClauseList *__pyx_v_self, struct __pyx_obj_11sat_toolkit_7formula__BaseClause *__pyx_v_clause) {
   int __pyx_r;
   int __pyx_t_1;
 
-  /* "sat_toolkit/formula.pyx":1355
+  /* "sat_toolkit/formula.pyx":1362
  *     """
  *     cdef int _check_clause_type(self, _BaseClause clause) noexcept:
  *         return isinstance(clause, XorClause)             # <<<<<<<<<<<<<<
  * 
  *     cdef XorClause get_clause(self, ssize_t idx):
  */
   __pyx_t_1 = __Pyx_TypeCheck(((PyObject *)__pyx_v_clause), __pyx_ptype_11sat_toolkit_7formula_XorClause); 
   __pyx_r = __pyx_t_1;
   goto __pyx_L0;
 
-  /* "sat_toolkit/formula.pyx":1354
+  /* "sat_toolkit/formula.pyx":1361
  *     Class for storing and manipulating a list of xor clauses.
  *     """
  *     cdef int _check_clause_type(self, _BaseClause clause) noexcept:             # <<<<<<<<<<<<<<
  *         return isinstance(clause, XorClause)
  * 
  */
 
   /* function exit code */
   __pyx_L0:;
   return __pyx_r;
 }
 
-/* "sat_toolkit/formula.pyx":1357
+/* "sat_toolkit/formula.pyx":1364
  *         return isinstance(clause, XorClause)
  * 
  *     cdef XorClause get_clause(self, ssize_t idx):             # <<<<<<<<<<<<<<
  *         cdef XorClause result
  *         result = XorClause.from_memview(self._get_clause(idx))
  */
 
@@ -44044,42 +44181,42 @@
   __Pyx_memviewslice __pyx_t_1 = { 0, 0, { 0 }, { 0 }, { 0 } };
   PyObject *__pyx_t_2 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("get_clause", 1);
 
-  /* "sat_toolkit/formula.pyx":1359
+  /* "sat_toolkit/formula.pyx":1366
  *     cdef XorClause get_clause(self, ssize_t idx):
  *         cdef XorClause result
  *         result = XorClause.from_memview(self._get_clause(idx))             # <<<<<<<<<<<<<<
  * 
  *         return result
  */
-  __pyx_t_1 = ((struct __pyx_vtabstruct_11sat_toolkit_7formula_XorClauseList *)__pyx_v_self->__pyx_base.__pyx_vtab)->__pyx_base._get_clause(((struct __pyx_obj_11sat_toolkit_7formula__ClauseList *)__pyx_v_self), __pyx_v_idx); if (unlikely(!__pyx_t_1.memview)) __PYX_ERR(0, 1359, __pyx_L1_error)
-  __pyx_t_2 = ((PyObject *)__pyx_f_11sat_toolkit_7formula_9XorClause_from_memview(__pyx_t_1)); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1359, __pyx_L1_error)
+  __pyx_t_1 = ((struct __pyx_vtabstruct_11sat_toolkit_7formula_XorClauseList *)__pyx_v_self->__pyx_base.__pyx_vtab)->__pyx_base._get_clause(((struct __pyx_obj_11sat_toolkit_7formula__ClauseList *)__pyx_v_self), __pyx_v_idx); if (unlikely(!__pyx_t_1.memview)) __PYX_ERR(0, 1366, __pyx_L1_error)
+  __pyx_t_2 = ((PyObject *)__pyx_f_11sat_toolkit_7formula_9XorClause_from_memview(__pyx_t_1)); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1366, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __PYX_XCLEAR_MEMVIEW(&__pyx_t_1, 1);
   __pyx_t_1.memview = NULL; __pyx_t_1.data = NULL;
   __pyx_v_result = ((struct __pyx_obj_11sat_toolkit_7formula_XorClause *)__pyx_t_2);
   __pyx_t_2 = 0;
 
-  /* "sat_toolkit/formula.pyx":1361
+  /* "sat_toolkit/formula.pyx":1368
  *         result = XorClause.from_memview(self._get_clause(idx))
  * 
  *         return result             # <<<<<<<<<<<<<<
  * 
  * 
  */
   __Pyx_XDECREF((PyObject *)__pyx_r);
   __Pyx_INCREF((PyObject *)__pyx_v_result);
   __pyx_r = __pyx_v_result;
   goto __pyx_L0;
 
-  /* "sat_toolkit/formula.pyx":1357
+  /* "sat_toolkit/formula.pyx":1364
  *         return isinstance(clause, XorClause)
  * 
  *     cdef XorClause get_clause(self, ssize_t idx):             # <<<<<<<<<<<<<<
  *         cdef XorClause result
  *         result = XorClause.from_memview(self._get_clause(idx))
  */
 
@@ -44096,15 +44233,15 @@
   return __pyx_r;
 }
 
 struct __pyx_obj_11sat_toolkit_7formula_XorClause *__pyx_f_11sat_toolkit_7formula_13XorClauseList_get_clause__pyx_wrap_1(struct __pyx_obj_11sat_toolkit_7formula_XorClauseList *__pyx_v_self, Py_ssize_t __pyx_v_idx) {
   return __pyx_f_11sat_toolkit_7formula_13XorClauseList_get_clause(__pyx_v_self, __pyx_v_idx);
 }
 
-/* "sat_toolkit/formula.pyx":1368
+/* "sat_toolkit/formula.pyx":1375
  *     cdef readonly XorClauseList _xor_clauses
  * 
  *     def __cinit__(self):             # <<<<<<<<<<<<<<
  *         self._clauses = CNF.__new__(CNF)
  *         self._xor_clauses = XorClauseList.__new__(XorClauseList)
  */
 
@@ -44137,45 +44274,45 @@
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("__cinit__", 1);
 
-  /* "sat_toolkit/formula.pyx":1369
+  /* "sat_toolkit/formula.pyx":1376
  * 
  *     def __cinit__(self):
  *         self._clauses = CNF.__new__(CNF)             # <<<<<<<<<<<<<<
  *         self._xor_clauses = XorClauseList.__new__(XorClauseList)
  * 
  */
-  __pyx_t_1 = ((PyObject *)__pyx_tp_new_11sat_toolkit_7formula_CNF(((PyTypeObject *)__pyx_ptype_11sat_toolkit_7formula_CNF), __pyx_empty_tuple, NULL)); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1369, __pyx_L1_error)
+  __pyx_t_1 = ((PyObject *)__pyx_tp_new_11sat_toolkit_7formula_CNF(((PyTypeObject *)__pyx_ptype_11sat_toolkit_7formula_CNF), __pyx_empty_tuple, NULL)); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1376, __pyx_L1_error)
   __Pyx_GOTREF((PyObject *)__pyx_t_1);
   __Pyx_GIVEREF((PyObject *)__pyx_t_1);
   __Pyx_GOTREF((PyObject *)__pyx_v_self->_clauses);
   __Pyx_DECREF((PyObject *)__pyx_v_self->_clauses);
   __pyx_v_self->_clauses = ((struct __pyx_obj_11sat_toolkit_7formula_CNF *)__pyx_t_1);
   __pyx_t_1 = 0;
 
-  /* "sat_toolkit/formula.pyx":1370
+  /* "sat_toolkit/formula.pyx":1377
  *     def __cinit__(self):
  *         self._clauses = CNF.__new__(CNF)
  *         self._xor_clauses = XorClauseList.__new__(XorClauseList)             # <<<<<<<<<<<<<<
  * 
  *     def __init__(self, clauses: CNF|None=None, xor_clauses: XorClauseList|None=None):
  */
-  __pyx_t_1 = ((PyObject *)__pyx_tp_new_11sat_toolkit_7formula_XorClauseList(((PyTypeObject *)__pyx_ptype_11sat_toolkit_7formula_XorClauseList), __pyx_empty_tuple, NULL)); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1370, __pyx_L1_error)
+  __pyx_t_1 = ((PyObject *)__pyx_tp_new_11sat_toolkit_7formula_XorClauseList(((PyTypeObject *)__pyx_ptype_11sat_toolkit_7formula_XorClauseList), __pyx_empty_tuple, NULL)); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1377, __pyx_L1_error)
   __Pyx_GOTREF((PyObject *)__pyx_t_1);
   __Pyx_GIVEREF((PyObject *)__pyx_t_1);
   __Pyx_GOTREF((PyObject *)__pyx_v_self->_xor_clauses);
   __Pyx_DECREF((PyObject *)__pyx_v_self->_xor_clauses);
   __pyx_v_self->_xor_clauses = ((struct __pyx_obj_11sat_toolkit_7formula_XorClauseList *)__pyx_t_1);
   __pyx_t_1 = 0;
 
-  /* "sat_toolkit/formula.pyx":1368
+  /* "sat_toolkit/formula.pyx":1375
  *     cdef readonly XorClauseList _xor_clauses
  * 
  *     def __cinit__(self):             # <<<<<<<<<<<<<<
  *         self._clauses = CNF.__new__(CNF)
  *         self._xor_clauses = XorClauseList.__new__(XorClauseList)
  */
 
@@ -44187,15 +44324,15 @@
   __Pyx_AddTraceback("sat_toolkit.formula.XorCNF.__cinit__", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __pyx_r = -1;
   __pyx_L0:;
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "sat_toolkit/formula.pyx":1372
+/* "sat_toolkit/formula.pyx":1379
  *         self._xor_clauses = XorClauseList.__new__(XorClauseList)
  * 
  *     def __init__(self, clauses: CNF|None=None, xor_clauses: XorClauseList|None=None):             # <<<<<<<<<<<<<<
  *         if clauses is not None:
  *             self._clauses.add_clauses(clauses)
  */
 
@@ -44235,27 +44372,27 @@
       }
       kw_args = __Pyx_NumKwargs_VARARGS(__pyx_kwds);
       switch (__pyx_nargs) {
         case  0:
         if (kw_args > 0) {
           PyObject* value = __Pyx_GetKwValue_VARARGS(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_clauses);
           if (value) { values[0] = __Pyx_Arg_NewRef_VARARGS(value); kw_args--; }
-          else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 1372, __pyx_L3_error)
+          else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 1379, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  1:
         if (kw_args > 0) {
           PyObject* value = __Pyx_GetKwValue_VARARGS(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_xor_clauses);
           if (value) { values[1] = __Pyx_Arg_NewRef_VARARGS(value); kw_args--; }
-          else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 1372, __pyx_L3_error)
+          else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 1379, __pyx_L3_error)
         }
       }
       if (unlikely(kw_args > 0)) {
         const Py_ssize_t kwd_pos_args = __pyx_nargs;
-        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values + 0, kwd_pos_args, "__init__") < 0)) __PYX_ERR(0, 1372, __pyx_L3_error)
+        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values + 0, kwd_pos_args, "__init__") < 0)) __PYX_ERR(0, 1379, __pyx_L3_error)
       }
     } else {
       switch (__pyx_nargs) {
         case  2: values[1] = __Pyx_Arg_VARARGS(__pyx_args, 1);
         CYTHON_FALLTHROUGH;
         case  1: values[0] = __Pyx_Arg_VARARGS(__pyx_args, 0);
         CYTHON_FALLTHROUGH;
@@ -44264,15 +44401,15 @@
       }
     }
     __pyx_v_clauses = values[0];
     __pyx_v_xor_clauses = values[1];
   }
   goto __pyx_L6_skip;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("__init__", 0, 0, 2, __pyx_nargs); __PYX_ERR(0, 1372, __pyx_L3_error)
+  __Pyx_RaiseArgtupleInvalid("__init__", 0, 0, 2, __pyx_nargs); __PYX_ERR(0, 1379, __pyx_L3_error)
   __pyx_L6_skip:;
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L3_error:;
   {
     Py_ssize_t __pyx_temp;
     for (__pyx_temp=0; __pyx_temp < (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
       __Pyx_Arg_XDECREF_VARARGS(values[__pyx_temp]);
@@ -44304,32 +44441,32 @@
   PyObject *__pyx_t_4 = NULL;
   int __pyx_t_5;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("__init__", 1);
 
-  /* "sat_toolkit/formula.pyx":1373
+  /* "sat_toolkit/formula.pyx":1380
  * 
  *     def __init__(self, clauses: CNF|None=None, xor_clauses: XorClauseList|None=None):
  *         if clauses is not None:             # <<<<<<<<<<<<<<
  *             self._clauses.add_clauses(clauses)
  *         if xor_clauses is not None:
  */
   __pyx_t_1 = (__pyx_v_clauses != Py_None);
   if (__pyx_t_1) {
 
-    /* "sat_toolkit/formula.pyx":1374
+    /* "sat_toolkit/formula.pyx":1381
  *     def __init__(self, clauses: CNF|None=None, xor_clauses: XorClauseList|None=None):
  *         if clauses is not None:
  *             self._clauses.add_clauses(clauses)             # <<<<<<<<<<<<<<
  *         if xor_clauses is not None:
  *             self._xor_clauses.add_clauses(xor_clauses)
  */
-    __pyx_t_3 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_self->_clauses), __pyx_n_s_add_clauses); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1374, __pyx_L1_error)
+    __pyx_t_3 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_self->_clauses), __pyx_n_s_add_clauses); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1381, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
     __pyx_t_4 = NULL;
     __pyx_t_5 = 0;
     #if CYTHON_UNPACK_METHODS
     if (likely(PyMethod_Check(__pyx_t_3))) {
       __pyx_t_4 = PyMethod_GET_SELF(__pyx_t_3);
       if (likely(__pyx_t_4)) {
@@ -44341,47 +44478,47 @@
       }
     }
     #endif
     {
       PyObject *__pyx_callargs[2] = {__pyx_t_4, __pyx_v_clauses};
       __pyx_t_2 = __Pyx_PyObject_FastCall(__pyx_t_3, __pyx_callargs+1-__pyx_t_5, 1+__pyx_t_5);
       __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
-      if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1374, __pyx_L1_error)
+      if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1381, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_2);
       __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
     }
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
 
-    /* "sat_toolkit/formula.pyx":1373
+    /* "sat_toolkit/formula.pyx":1380
  * 
  *     def __init__(self, clauses: CNF|None=None, xor_clauses: XorClauseList|None=None):
  *         if clauses is not None:             # <<<<<<<<<<<<<<
  *             self._clauses.add_clauses(clauses)
  *         if xor_clauses is not None:
  */
   }
 
-  /* "sat_toolkit/formula.pyx":1375
+  /* "sat_toolkit/formula.pyx":1382
  *         if clauses is not None:
  *             self._clauses.add_clauses(clauses)
  *         if xor_clauses is not None:             # <<<<<<<<<<<<<<
  *             self._xor_clauses.add_clauses(xor_clauses)
  * 
  */
   __pyx_t_1 = (__pyx_v_xor_clauses != Py_None);
   if (__pyx_t_1) {
 
-    /* "sat_toolkit/formula.pyx":1376
+    /* "sat_toolkit/formula.pyx":1383
  *             self._clauses.add_clauses(clauses)
  *         if xor_clauses is not None:
  *             self._xor_clauses.add_clauses(xor_clauses)             # <<<<<<<<<<<<<<
  * 
  * 
  */
-    __pyx_t_3 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_self->_xor_clauses), __pyx_n_s_add_clauses); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1376, __pyx_L1_error)
+    __pyx_t_3 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_self->_xor_clauses), __pyx_n_s_add_clauses); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1383, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
     __pyx_t_4 = NULL;
     __pyx_t_5 = 0;
     #if CYTHON_UNPACK_METHODS
     if (likely(PyMethod_Check(__pyx_t_3))) {
       __pyx_t_4 = PyMethod_GET_SELF(__pyx_t_3);
       if (likely(__pyx_t_4)) {
@@ -44393,30 +44530,30 @@
       }
     }
     #endif
     {
       PyObject *__pyx_callargs[2] = {__pyx_t_4, __pyx_v_xor_clauses};
       __pyx_t_2 = __Pyx_PyObject_FastCall(__pyx_t_3, __pyx_callargs+1-__pyx_t_5, 1+__pyx_t_5);
       __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
-      if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1376, __pyx_L1_error)
+      if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1383, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_2);
       __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
     }
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
 
-    /* "sat_toolkit/formula.pyx":1375
+    /* "sat_toolkit/formula.pyx":1382
  *         if clauses is not None:
  *             self._clauses.add_clauses(clauses)
  *         if xor_clauses is not None:             # <<<<<<<<<<<<<<
  *             self._xor_clauses.add_clauses(xor_clauses)
  * 
  */
   }
 
-  /* "sat_toolkit/formula.pyx":1372
+  /* "sat_toolkit/formula.pyx":1379
  *         self._xor_clauses = XorClauseList.__new__(XorClauseList)
  * 
  *     def __init__(self, clauses: CNF|None=None, xor_clauses: XorClauseList|None=None):             # <<<<<<<<<<<<<<
  *         if clauses is not None:
  *             self._clauses.add_clauses(clauses)
  */
 
@@ -44430,15 +44567,15 @@
   __Pyx_AddTraceback("sat_toolkit.formula.XorCNF.__init__", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __pyx_r = -1;
   __pyx_L0:;
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "sat_toolkit/formula.pyx":1379
+/* "sat_toolkit/formula.pyx":1386
  * 
  * 
  *     @staticmethod             # <<<<<<<<<<<<<<
  *     def from_dimacs(dimacs: str) -> XorCNF:
  *         cdef CNF clauses = CNF.__new__(CNF)
  */
 
@@ -44492,45 +44629,45 @@
       kw_args = __Pyx_NumKwargs_FASTCALL(__pyx_kwds);
       switch (__pyx_nargs) {
         case  0:
         if (likely((values[0] = __Pyx_GetKwValue_FASTCALL(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_dimacs)) != 0)) {
           (void)__Pyx_Arg_NewRef_FASTCALL(values[0]);
           kw_args--;
         }
-        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 1379, __pyx_L3_error)
+        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 1386, __pyx_L3_error)
         else goto __pyx_L5_argtuple_error;
       }
       if (unlikely(kw_args > 0)) {
         const Py_ssize_t kwd_pos_args = __pyx_nargs;
-        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values + 0, kwd_pos_args, "from_dimacs") < 0)) __PYX_ERR(0, 1379, __pyx_L3_error)
+        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values + 0, kwd_pos_args, "from_dimacs") < 0)) __PYX_ERR(0, 1386, __pyx_L3_error)
       }
     } else if (unlikely(__pyx_nargs != 1)) {
       goto __pyx_L5_argtuple_error;
     } else {
       values[0] = __Pyx_Arg_FASTCALL(__pyx_args, 0);
     }
     __pyx_v_dimacs = ((PyObject*)values[0]);
   }
   goto __pyx_L6_skip;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("from_dimacs", 1, 1, 1, __pyx_nargs); __PYX_ERR(0, 1379, __pyx_L3_error)
+  __Pyx_RaiseArgtupleInvalid("from_dimacs", 1, 1, 1, __pyx_nargs); __PYX_ERR(0, 1386, __pyx_L3_error)
   __pyx_L6_skip:;
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L3_error:;
   {
     Py_ssize_t __pyx_temp;
     for (__pyx_temp=0; __pyx_temp < (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
       __Pyx_Arg_XDECREF_FASTCALL(values[__pyx_temp]);
     }
   }
   __Pyx_AddTraceback("sat_toolkit.formula.XorCNF.from_dimacs", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __Pyx_RefNannyFinishContext();
   return NULL;
   __pyx_L4_argument_unpacking_done:;
-  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_dimacs), (&PyUnicode_Type), 0, "dimacs", 1))) __PYX_ERR(0, 1380, __pyx_L1_error)
+  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_dimacs), (&PyUnicode_Type), 0, "dimacs", 1))) __PYX_ERR(0, 1387, __pyx_L1_error)
   __pyx_r = __pyx_pf_11sat_toolkit_7formula_6XorCNF_4from_dimacs(__pyx_v_dimacs);
 
   /* function exit code */
   goto __pyx_L0;
   __pyx_L1_error:;
   __pyx_r = NULL;
   __pyx_L0:;
@@ -44575,66 +44712,66 @@
   int __pyx_t_15;
   int __pyx_t_16;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("from_dimacs", 1);
 
-  /* "sat_toolkit/formula.pyx":1381
+  /* "sat_toolkit/formula.pyx":1388
  *     @staticmethod
  *     def from_dimacs(dimacs: str) -> XorCNF:
  *         cdef CNF clauses = CNF.__new__(CNF)             # <<<<<<<<<<<<<<
  *         cdef XorClauseList xors = XorClauseList.__new__(XorClauseList)
  *         cdef int nvars = -1
  */
-  __pyx_t_1 = ((PyObject *)__pyx_tp_new_11sat_toolkit_7formula_CNF(((PyTypeObject *)__pyx_ptype_11sat_toolkit_7formula_CNF), __pyx_empty_tuple, NULL)); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1381, __pyx_L1_error)
+  __pyx_t_1 = ((PyObject *)__pyx_tp_new_11sat_toolkit_7formula_CNF(((PyTypeObject *)__pyx_ptype_11sat_toolkit_7formula_CNF), __pyx_empty_tuple, NULL)); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1388, __pyx_L1_error)
   __Pyx_GOTREF((PyObject *)__pyx_t_1);
   __pyx_v_clauses = ((struct __pyx_obj_11sat_toolkit_7formula_CNF *)__pyx_t_1);
   __pyx_t_1 = 0;
 
-  /* "sat_toolkit/formula.pyx":1382
+  /* "sat_toolkit/formula.pyx":1389
  *     def from_dimacs(dimacs: str) -> XorCNF:
  *         cdef CNF clauses = CNF.__new__(CNF)
  *         cdef XorClauseList xors = XorClauseList.__new__(XorClauseList)             # <<<<<<<<<<<<<<
  *         cdef int nvars = -1
  *         cdef int nclauses = -1
  */
-  __pyx_t_1 = ((PyObject *)__pyx_tp_new_11sat_toolkit_7formula_XorClauseList(((PyTypeObject *)__pyx_ptype_11sat_toolkit_7formula_XorClauseList), __pyx_empty_tuple, NULL)); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1382, __pyx_L1_error)
+  __pyx_t_1 = ((PyObject *)__pyx_tp_new_11sat_toolkit_7formula_XorClauseList(((PyTypeObject *)__pyx_ptype_11sat_toolkit_7formula_XorClauseList), __pyx_empty_tuple, NULL)); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1389, __pyx_L1_error)
   __Pyx_GOTREF((PyObject *)__pyx_t_1);
   __pyx_v_xors = ((struct __pyx_obj_11sat_toolkit_7formula_XorClauseList *)__pyx_t_1);
   __pyx_t_1 = 0;
 
-  /* "sat_toolkit/formula.pyx":1383
+  /* "sat_toolkit/formula.pyx":1390
  *         cdef CNF clauses = CNF.__new__(CNF)
  *         cdef XorClauseList xors = XorClauseList.__new__(XorClauseList)
  *         cdef int nvars = -1             # <<<<<<<<<<<<<<
  *         cdef int nclauses = -1
  * 
  */
   __pyx_v_nvars = -1;
 
-  /* "sat_toolkit/formula.pyx":1384
+  /* "sat_toolkit/formula.pyx":1391
  *         cdef XorClauseList xors = XorClauseList.__new__(XorClauseList)
  *         cdef int nvars = -1
  *         cdef int nclauses = -1             # <<<<<<<<<<<<<<
  * 
  *         lines = io.StringIO(dimacs)
  */
   __pyx_v_nclauses = -1;
 
-  /* "sat_toolkit/formula.pyx":1386
+  /* "sat_toolkit/formula.pyx":1393
  *         cdef int nclauses = -1
  * 
  *         lines = io.StringIO(dimacs)             # <<<<<<<<<<<<<<
  * 
  *         for line in lines:
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_io); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1386, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_io); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1393, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_StringIO); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1386, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_StringIO); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1393, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   __pyx_t_2 = NULL;
   __pyx_t_4 = 0;
   #if CYTHON_UNPACK_METHODS
   if (unlikely(PyMethod_Check(__pyx_t_3))) {
     __pyx_t_2 = PyMethod_GET_SELF(__pyx_t_3);
@@ -44647,91 +44784,91 @@
     }
   }
   #endif
   {
     PyObject *__pyx_callargs[2] = {__pyx_t_2, __pyx_v_dimacs};
     __pyx_t_1 = __Pyx_PyObject_FastCall(__pyx_t_3, __pyx_callargs+1-__pyx_t_4, 1+__pyx_t_4);
     __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
-    if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1386, __pyx_L1_error)
+    if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1393, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   }
   __pyx_v_lines = __pyx_t_1;
   __pyx_t_1 = 0;
 
-  /* "sat_toolkit/formula.pyx":1388
+  /* "sat_toolkit/formula.pyx":1395
  *         lines = io.StringIO(dimacs)
  * 
  *         for line in lines:             # <<<<<<<<<<<<<<
  *             if line.startswith('c'):
  *                 continue
  */
   if (likely(PyList_CheckExact(__pyx_v_lines)) || PyTuple_CheckExact(__pyx_v_lines)) {
     __pyx_t_1 = __pyx_v_lines; __Pyx_INCREF(__pyx_t_1);
     __pyx_t_5 = 0;
     __pyx_t_6 = NULL;
   } else {
-    __pyx_t_5 = -1; __pyx_t_1 = PyObject_GetIter(__pyx_v_lines); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1388, __pyx_L1_error)
+    __pyx_t_5 = -1; __pyx_t_1 = PyObject_GetIter(__pyx_v_lines); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1395, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
-    __pyx_t_6 = __Pyx_PyObject_GetIterNextFunc(__pyx_t_1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1388, __pyx_L1_error)
+    __pyx_t_6 = __Pyx_PyObject_GetIterNextFunc(__pyx_t_1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1395, __pyx_L1_error)
   }
   for (;;) {
     if (likely(!__pyx_t_6)) {
       if (likely(PyList_CheckExact(__pyx_t_1))) {
         {
           Py_ssize_t __pyx_temp = __Pyx_PyList_GET_SIZE(__pyx_t_1);
           #if !CYTHON_ASSUME_SAFE_MACROS
-          if (unlikely((__pyx_temp < 0))) __PYX_ERR(0, 1388, __pyx_L1_error)
+          if (unlikely((__pyx_temp < 0))) __PYX_ERR(0, 1395, __pyx_L1_error)
           #endif
           if (__pyx_t_5 >= __pyx_temp) break;
         }
         #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-        __pyx_t_3 = PyList_GET_ITEM(__pyx_t_1, __pyx_t_5); __Pyx_INCREF(__pyx_t_3); __pyx_t_5++; if (unlikely((0 < 0))) __PYX_ERR(0, 1388, __pyx_L1_error)
+        __pyx_t_3 = PyList_GET_ITEM(__pyx_t_1, __pyx_t_5); __Pyx_INCREF(__pyx_t_3); __pyx_t_5++; if (unlikely((0 < 0))) __PYX_ERR(0, 1395, __pyx_L1_error)
         #else
-        __pyx_t_3 = __Pyx_PySequence_ITEM(__pyx_t_1, __pyx_t_5); __pyx_t_5++; if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1388, __pyx_L1_error)
+        __pyx_t_3 = __Pyx_PySequence_ITEM(__pyx_t_1, __pyx_t_5); __pyx_t_5++; if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1395, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_3);
         #endif
       } else {
         {
           Py_ssize_t __pyx_temp = __Pyx_PyTuple_GET_SIZE(__pyx_t_1);
           #if !CYTHON_ASSUME_SAFE_MACROS
-          if (unlikely((__pyx_temp < 0))) __PYX_ERR(0, 1388, __pyx_L1_error)
+          if (unlikely((__pyx_temp < 0))) __PYX_ERR(0, 1395, __pyx_L1_error)
           #endif
           if (__pyx_t_5 >= __pyx_temp) break;
         }
         #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-        __pyx_t_3 = PyTuple_GET_ITEM(__pyx_t_1, __pyx_t_5); __Pyx_INCREF(__pyx_t_3); __pyx_t_5++; if (unlikely((0 < 0))) __PYX_ERR(0, 1388, __pyx_L1_error)
+        __pyx_t_3 = PyTuple_GET_ITEM(__pyx_t_1, __pyx_t_5); __Pyx_INCREF(__pyx_t_3); __pyx_t_5++; if (unlikely((0 < 0))) __PYX_ERR(0, 1395, __pyx_L1_error)
         #else
-        __pyx_t_3 = __Pyx_PySequence_ITEM(__pyx_t_1, __pyx_t_5); __pyx_t_5++; if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1388, __pyx_L1_error)
+        __pyx_t_3 = __Pyx_PySequence_ITEM(__pyx_t_1, __pyx_t_5); __pyx_t_5++; if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1395, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_3);
         #endif
       }
     } else {
       __pyx_t_3 = __pyx_t_6(__pyx_t_1);
       if (unlikely(!__pyx_t_3)) {
         PyObject* exc_type = PyErr_Occurred();
         if (exc_type) {
           if (likely(__Pyx_PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
-          else __PYX_ERR(0, 1388, __pyx_L1_error)
+          else __PYX_ERR(0, 1395, __pyx_L1_error)
         }
         break;
       }
       __Pyx_GOTREF(__pyx_t_3);
     }
     __Pyx_XDECREF_SET(__pyx_v_line, __pyx_t_3);
     __pyx_t_3 = 0;
 
-    /* "sat_toolkit/formula.pyx":1389
+    /* "sat_toolkit/formula.pyx":1396
  * 
  *         for line in lines:
  *             if line.startswith('c'):             # <<<<<<<<<<<<<<
  *                 continue
  * 
  */
-    __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_line, __pyx_n_s_startswith); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1389, __pyx_L1_error)
+    __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_line, __pyx_n_s_startswith); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1396, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
     __pyx_t_7 = NULL;
     __pyx_t_4 = 0;
     #if CYTHON_UNPACK_METHODS
     if (likely(PyMethod_Check(__pyx_t_2))) {
       __pyx_t_7 = PyMethod_GET_SELF(__pyx_t_2);
       if (likely(__pyx_t_7)) {
@@ -44743,48 +44880,48 @@
       }
     }
     #endif
     {
       PyObject *__pyx_callargs[2] = {__pyx_t_7, __pyx_n_u_c};
       __pyx_t_3 = __Pyx_PyObject_FastCall(__pyx_t_2, __pyx_callargs+1-__pyx_t_4, 1+__pyx_t_4);
       __Pyx_XDECREF(__pyx_t_7); __pyx_t_7 = 0;
-      if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1389, __pyx_L1_error)
+      if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1396, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_3);
       __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
     }
-    __pyx_t_8 = __Pyx_PyObject_IsTrue(__pyx_t_3); if (unlikely((__pyx_t_8 < 0))) __PYX_ERR(0, 1389, __pyx_L1_error)
+    __pyx_t_8 = __Pyx_PyObject_IsTrue(__pyx_t_3); if (unlikely((__pyx_t_8 < 0))) __PYX_ERR(0, 1396, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
     if (__pyx_t_8) {
 
-      /* "sat_toolkit/formula.pyx":1390
+      /* "sat_toolkit/formula.pyx":1397
  *         for line in lines:
  *             if line.startswith('c'):
  *                 continue             # <<<<<<<<<<<<<<
  * 
  *             if line.startswith('p cnf '):
  */
       goto __pyx_L3_continue;
 
-      /* "sat_toolkit/formula.pyx":1389
+      /* "sat_toolkit/formula.pyx":1396
  * 
  *         for line in lines:
  *             if line.startswith('c'):             # <<<<<<<<<<<<<<
  *                 continue
  * 
  */
     }
 
-    /* "sat_toolkit/formula.pyx":1392
+    /* "sat_toolkit/formula.pyx":1399
  *                 continue
  * 
  *             if line.startswith('p cnf '):             # <<<<<<<<<<<<<<
  *                 if nvars != -1:
  *                     raise ValueError('multiple p cnf lines in dimacs')
  */
-    __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_line, __pyx_n_s_startswith); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1392, __pyx_L1_error)
+    __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_line, __pyx_n_s_startswith); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1399, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
     __pyx_t_7 = NULL;
     __pyx_t_4 = 0;
     #if CYTHON_UNPACK_METHODS
     if (likely(PyMethod_Check(__pyx_t_2))) {
       __pyx_t_7 = PyMethod_GET_SELF(__pyx_t_2);
       if (likely(__pyx_t_7)) {
@@ -44796,65 +44933,65 @@
       }
     }
     #endif
     {
       PyObject *__pyx_callargs[2] = {__pyx_t_7, __pyx_kp_u_p_cnf};
       __pyx_t_3 = __Pyx_PyObject_FastCall(__pyx_t_2, __pyx_callargs+1-__pyx_t_4, 1+__pyx_t_4);
       __Pyx_XDECREF(__pyx_t_7); __pyx_t_7 = 0;
-      if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1392, __pyx_L1_error)
+      if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1399, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_3);
       __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
     }
-    __pyx_t_8 = __Pyx_PyObject_IsTrue(__pyx_t_3); if (unlikely((__pyx_t_8 < 0))) __PYX_ERR(0, 1392, __pyx_L1_error)
+    __pyx_t_8 = __Pyx_PyObject_IsTrue(__pyx_t_3); if (unlikely((__pyx_t_8 < 0))) __PYX_ERR(0, 1399, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
     if (__pyx_t_8) {
 
-      /* "sat_toolkit/formula.pyx":1393
+      /* "sat_toolkit/formula.pyx":1400
  * 
  *             if line.startswith('p cnf '):
  *                 if nvars != -1:             # <<<<<<<<<<<<<<
  *                     raise ValueError('multiple p cnf lines in dimacs')
  * 
  */
       __pyx_t_8 = (__pyx_v_nvars != -1L);
       if (unlikely(__pyx_t_8)) {
 
-        /* "sat_toolkit/formula.pyx":1394
+        /* "sat_toolkit/formula.pyx":1401
  *             if line.startswith('p cnf '):
  *                 if nvars != -1:
  *                     raise ValueError('multiple p cnf lines in dimacs')             # <<<<<<<<<<<<<<
  * 
  *                 tmp_nvars, tmp_nclauses = line[len('p cnf '):].split()
  */
-        __pyx_t_3 = __Pyx_PyObject_Call(__pyx_builtin_ValueError, __pyx_tuple__45, NULL); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1394, __pyx_L1_error)
+        __pyx_t_3 = __Pyx_PyObject_Call(__pyx_builtin_ValueError, __pyx_tuple__45, NULL); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1401, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_3);
         __Pyx_Raise(__pyx_t_3, 0, 0, 0);
         __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-        __PYX_ERR(0, 1394, __pyx_L1_error)
+        __PYX_ERR(0, 1401, __pyx_L1_error)
 
-        /* "sat_toolkit/formula.pyx":1393
+        /* "sat_toolkit/formula.pyx":1400
  * 
  *             if line.startswith('p cnf '):
  *                 if nvars != -1:             # <<<<<<<<<<<<<<
  *                     raise ValueError('multiple p cnf lines in dimacs')
  * 
  */
       }
 
-      /* "sat_toolkit/formula.pyx":1396
+      /* "sat_toolkit/formula.pyx":1403
  *                     raise ValueError('multiple p cnf lines in dimacs')
  * 
  *                 tmp_nvars, tmp_nclauses = line[len('p cnf '):].split()             # <<<<<<<<<<<<<<
  *                 nvars = int(tmp_nvars)
  *                 nclaues = int(tmp_nclauses)
  */
-      __pyx_t_9 = __Pyx_PyUnicode_GET_LENGTH(__pyx_kp_u_p_cnf); if (unlikely(__pyx_t_9 == ((Py_ssize_t)-1))) __PYX_ERR(0, 1396, __pyx_L1_error)
-      __pyx_t_2 = __Pyx_PyObject_GetSlice(__pyx_v_line, __pyx_t_9, 0, NULL, NULL, NULL, 1, 0, 0); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1396, __pyx_L1_error)
+      __pyx_t_9 = __Pyx_PyUnicode_GET_LENGTH(__pyx_kp_u_p_cnf); if (unlikely(__pyx_t_9 == ((Py_ssize_t)-1))) __PYX_ERR(0, 1403, __pyx_L1_error)
+      __pyx_t_2 = __Pyx_PyObject_GetSlice(__pyx_v_line, __pyx_t_9, 0, NULL, NULL, NULL, 1, 0, 0); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1403, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_2);
-      __pyx_t_7 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_split); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1396, __pyx_L1_error)
+      __pyx_t_7 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_split); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1403, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_7);
       __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
       __pyx_t_2 = NULL;
       __pyx_t_4 = 0;
       #if CYTHON_UNPACK_METHODS
       if (likely(PyMethod_Check(__pyx_t_7))) {
         __pyx_t_2 = PyMethod_GET_SELF(__pyx_t_7);
@@ -44867,112 +45004,112 @@
         }
       }
       #endif
       {
         PyObject *__pyx_callargs[2] = {__pyx_t_2, NULL};
         __pyx_t_3 = __Pyx_PyObject_FastCall(__pyx_t_7, __pyx_callargs+1-__pyx_t_4, 0+__pyx_t_4);
         __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
-        if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1396, __pyx_L1_error)
+        if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1403, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_3);
         __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
       }
       if ((likely(PyTuple_CheckExact(__pyx_t_3))) || (PyList_CheckExact(__pyx_t_3))) {
         PyObject* sequence = __pyx_t_3;
         Py_ssize_t size = __Pyx_PySequence_SIZE(sequence);
         if (unlikely(size != 2)) {
           if (size > 2) __Pyx_RaiseTooManyValuesError(2);
           else if (size >= 0) __Pyx_RaiseNeedMoreValuesError(size);
-          __PYX_ERR(0, 1396, __pyx_L1_error)
+          __PYX_ERR(0, 1403, __pyx_L1_error)
         }
         #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
         if (likely(PyTuple_CheckExact(sequence))) {
           __pyx_t_7 = PyTuple_GET_ITEM(sequence, 0); 
           __pyx_t_2 = PyTuple_GET_ITEM(sequence, 1); 
         } else {
           __pyx_t_7 = PyList_GET_ITEM(sequence, 0); 
           __pyx_t_2 = PyList_GET_ITEM(sequence, 1); 
         }
         __Pyx_INCREF(__pyx_t_7);
         __Pyx_INCREF(__pyx_t_2);
         #else
-        __pyx_t_7 = PySequence_ITEM(sequence, 0); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1396, __pyx_L1_error)
+        __pyx_t_7 = PySequence_ITEM(sequence, 0); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1403, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_7);
-        __pyx_t_2 = PySequence_ITEM(sequence, 1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1396, __pyx_L1_error)
+        __pyx_t_2 = PySequence_ITEM(sequence, 1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1403, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_2);
         #endif
         __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
       } else {
         Py_ssize_t index = -1;
-        __pyx_t_10 = PyObject_GetIter(__pyx_t_3); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1396, __pyx_L1_error)
+        __pyx_t_10 = PyObject_GetIter(__pyx_t_3); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1403, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_10);
         __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
         __pyx_t_11 = __Pyx_PyObject_GetIterNextFunc(__pyx_t_10);
         index = 0; __pyx_t_7 = __pyx_t_11(__pyx_t_10); if (unlikely(!__pyx_t_7)) goto __pyx_L8_unpacking_failed;
         __Pyx_GOTREF(__pyx_t_7);
         index = 1; __pyx_t_2 = __pyx_t_11(__pyx_t_10); if (unlikely(!__pyx_t_2)) goto __pyx_L8_unpacking_failed;
         __Pyx_GOTREF(__pyx_t_2);
-        if (__Pyx_IternextUnpackEndCheck(__pyx_t_11(__pyx_t_10), 2) < 0) __PYX_ERR(0, 1396, __pyx_L1_error)
+        if (__Pyx_IternextUnpackEndCheck(__pyx_t_11(__pyx_t_10), 2) < 0) __PYX_ERR(0, 1403, __pyx_L1_error)
         __pyx_t_11 = NULL;
         __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
         goto __pyx_L9_unpacking_done;
         __pyx_L8_unpacking_failed:;
         __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
         __pyx_t_11 = NULL;
         if (__Pyx_IterFinish() == 0) __Pyx_RaiseNeedMoreValuesError(index);
-        __PYX_ERR(0, 1396, __pyx_L1_error)
+        __PYX_ERR(0, 1403, __pyx_L1_error)
         __pyx_L9_unpacking_done:;
       }
       __Pyx_XDECREF_SET(__pyx_v_tmp_nvars, __pyx_t_7);
       __pyx_t_7 = 0;
       __Pyx_XDECREF_SET(__pyx_v_tmp_nclauses, __pyx_t_2);
       __pyx_t_2 = 0;
 
-      /* "sat_toolkit/formula.pyx":1397
+      /* "sat_toolkit/formula.pyx":1404
  * 
  *                 tmp_nvars, tmp_nclauses = line[len('p cnf '):].split()
  *                 nvars = int(tmp_nvars)             # <<<<<<<<<<<<<<
  *                 nclaues = int(tmp_nclauses)
  * 
  */
-      __pyx_t_3 = __Pyx_PyNumber_Int(__pyx_v_tmp_nvars); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1397, __pyx_L1_error)
+      __pyx_t_3 = __Pyx_PyNumber_Int(__pyx_v_tmp_nvars); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1404, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_3);
-      __pyx_t_4 = __Pyx_PyInt_As_int(__pyx_t_3); if (unlikely((__pyx_t_4 == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 1397, __pyx_L1_error)
+      __pyx_t_4 = __Pyx_PyInt_As_int(__pyx_t_3); if (unlikely((__pyx_t_4 == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 1404, __pyx_L1_error)
       __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
       __pyx_v_nvars = __pyx_t_4;
 
-      /* "sat_toolkit/formula.pyx":1398
+      /* "sat_toolkit/formula.pyx":1405
  *                 tmp_nvars, tmp_nclauses = line[len('p cnf '):].split()
  *                 nvars = int(tmp_nvars)
  *                 nclaues = int(tmp_nclauses)             # <<<<<<<<<<<<<<
  * 
  *             elif line.startswith('x'):
  */
-      __pyx_t_3 = __Pyx_PyNumber_Int(__pyx_v_tmp_nclauses); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1398, __pyx_L1_error)
+      __pyx_t_3 = __Pyx_PyNumber_Int(__pyx_v_tmp_nclauses); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1405, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_3);
       __Pyx_XDECREF_SET(__pyx_v_nclaues, __pyx_t_3);
       __pyx_t_3 = 0;
 
-      /* "sat_toolkit/formula.pyx":1392
+      /* "sat_toolkit/formula.pyx":1399
  *                 continue
  * 
  *             if line.startswith('p cnf '):             # <<<<<<<<<<<<<<
  *                 if nvars != -1:
  *                     raise ValueError('multiple p cnf lines in dimacs')
  */
       goto __pyx_L6;
     }
 
-    /* "sat_toolkit/formula.pyx":1400
+    /* "sat_toolkit/formula.pyx":1407
  *                 nclaues = int(tmp_nclauses)
  * 
  *             elif line.startswith('x'):             # <<<<<<<<<<<<<<
  *                 xors.add_clauses([int(x) for x in line[1:].split()])
  *             else:
  */
-    __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_line, __pyx_n_s_startswith); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1400, __pyx_L1_error)
+    __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_line, __pyx_n_s_startswith); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1407, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
     __pyx_t_7 = NULL;
     __pyx_t_4 = 0;
     #if CYTHON_UNPACK_METHODS
     if (likely(PyMethod_Check(__pyx_t_2))) {
       __pyx_t_7 = PyMethod_GET_SELF(__pyx_t_2);
       if (likely(__pyx_t_7)) {
@@ -44984,37 +45121,37 @@
       }
     }
     #endif
     {
       PyObject *__pyx_callargs[2] = {__pyx_t_7, __pyx_n_u_x};
       __pyx_t_3 = __Pyx_PyObject_FastCall(__pyx_t_2, __pyx_callargs+1-__pyx_t_4, 1+__pyx_t_4);
       __Pyx_XDECREF(__pyx_t_7); __pyx_t_7 = 0;
-      if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1400, __pyx_L1_error)
+      if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1407, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_3);
       __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
     }
-    __pyx_t_8 = __Pyx_PyObject_IsTrue(__pyx_t_3); if (unlikely((__pyx_t_8 < 0))) __PYX_ERR(0, 1400, __pyx_L1_error)
+    __pyx_t_8 = __Pyx_PyObject_IsTrue(__pyx_t_3); if (unlikely((__pyx_t_8 < 0))) __PYX_ERR(0, 1407, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
     if (__pyx_t_8) {
 
-      /* "sat_toolkit/formula.pyx":1401
+      /* "sat_toolkit/formula.pyx":1408
  * 
  *             elif line.startswith('x'):
  *                 xors.add_clauses([int(x) for x in line[1:].split()])             # <<<<<<<<<<<<<<
  *             else:
  *                 clauses.add_clauses([int(x) for x in line.split()])
  */
-      __pyx_t_2 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_xors), __pyx_n_s_add_clauses); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1401, __pyx_L1_error)
+      __pyx_t_2 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_xors), __pyx_n_s_add_clauses); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1408, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_2);
       { /* enter inner scope */
-        __pyx_t_7 = PyList_New(0); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1401, __pyx_L12_error)
+        __pyx_t_7 = PyList_New(0); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1408, __pyx_L12_error)
         __Pyx_GOTREF(__pyx_t_7);
-        __pyx_t_12 = __Pyx_PyObject_GetSlice(__pyx_v_line, 1, 0, NULL, NULL, &__pyx_slice__46, 1, 0, 0); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 1401, __pyx_L12_error)
+        __pyx_t_12 = __Pyx_PyObject_GetSlice(__pyx_v_line, 1, 0, NULL, NULL, &__pyx_slice__46, 1, 0, 0); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 1408, __pyx_L12_error)
         __Pyx_GOTREF(__pyx_t_12);
-        __pyx_t_13 = __Pyx_PyObject_GetAttrStr(__pyx_t_12, __pyx_n_s_split); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 1401, __pyx_L12_error)
+        __pyx_t_13 = __Pyx_PyObject_GetAttrStr(__pyx_t_12, __pyx_n_s_split); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 1408, __pyx_L12_error)
         __Pyx_GOTREF(__pyx_t_13);
         __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;
         __pyx_t_12 = NULL;
         __pyx_t_4 = 0;
         #if CYTHON_UNPACK_METHODS
         if (likely(PyMethod_Check(__pyx_t_13))) {
           __pyx_t_12 = PyMethod_GET_SELF(__pyx_t_13);
@@ -45027,76 +45164,76 @@
           }
         }
         #endif
         {
           PyObject *__pyx_callargs[2] = {__pyx_t_12, NULL};
           __pyx_t_10 = __Pyx_PyObject_FastCall(__pyx_t_13, __pyx_callargs+1-__pyx_t_4, 0+__pyx_t_4);
           __Pyx_XDECREF(__pyx_t_12); __pyx_t_12 = 0;
-          if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1401, __pyx_L12_error)
+          if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1408, __pyx_L12_error)
           __Pyx_GOTREF(__pyx_t_10);
           __Pyx_DECREF(__pyx_t_13); __pyx_t_13 = 0;
         }
         if (likely(PyList_CheckExact(__pyx_t_10)) || PyTuple_CheckExact(__pyx_t_10)) {
           __pyx_t_13 = __pyx_t_10; __Pyx_INCREF(__pyx_t_13);
           __pyx_t_9 = 0;
           __pyx_t_14 = NULL;
         } else {
-          __pyx_t_9 = -1; __pyx_t_13 = PyObject_GetIter(__pyx_t_10); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 1401, __pyx_L12_error)
+          __pyx_t_9 = -1; __pyx_t_13 = PyObject_GetIter(__pyx_t_10); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 1408, __pyx_L12_error)
           __Pyx_GOTREF(__pyx_t_13);
-          __pyx_t_14 = __Pyx_PyObject_GetIterNextFunc(__pyx_t_13); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 1401, __pyx_L12_error)
+          __pyx_t_14 = __Pyx_PyObject_GetIterNextFunc(__pyx_t_13); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 1408, __pyx_L12_error)
         }
         __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
         for (;;) {
           if (likely(!__pyx_t_14)) {
             if (likely(PyList_CheckExact(__pyx_t_13))) {
               {
                 Py_ssize_t __pyx_temp = __Pyx_PyList_GET_SIZE(__pyx_t_13);
                 #if !CYTHON_ASSUME_SAFE_MACROS
-                if (unlikely((__pyx_temp < 0))) __PYX_ERR(0, 1401, __pyx_L12_error)
+                if (unlikely((__pyx_temp < 0))) __PYX_ERR(0, 1408, __pyx_L12_error)
                 #endif
                 if (__pyx_t_9 >= __pyx_temp) break;
               }
               #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-              __pyx_t_10 = PyList_GET_ITEM(__pyx_t_13, __pyx_t_9); __Pyx_INCREF(__pyx_t_10); __pyx_t_9++; if (unlikely((0 < 0))) __PYX_ERR(0, 1401, __pyx_L12_error)
+              __pyx_t_10 = PyList_GET_ITEM(__pyx_t_13, __pyx_t_9); __Pyx_INCREF(__pyx_t_10); __pyx_t_9++; if (unlikely((0 < 0))) __PYX_ERR(0, 1408, __pyx_L12_error)
               #else
-              __pyx_t_10 = __Pyx_PySequence_ITEM(__pyx_t_13, __pyx_t_9); __pyx_t_9++; if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1401, __pyx_L12_error)
+              __pyx_t_10 = __Pyx_PySequence_ITEM(__pyx_t_13, __pyx_t_9); __pyx_t_9++; if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1408, __pyx_L12_error)
               __Pyx_GOTREF(__pyx_t_10);
               #endif
             } else {
               {
                 Py_ssize_t __pyx_temp = __Pyx_PyTuple_GET_SIZE(__pyx_t_13);
                 #if !CYTHON_ASSUME_SAFE_MACROS
-                if (unlikely((__pyx_temp < 0))) __PYX_ERR(0, 1401, __pyx_L12_error)
+                if (unlikely((__pyx_temp < 0))) __PYX_ERR(0, 1408, __pyx_L12_error)
                 #endif
                 if (__pyx_t_9 >= __pyx_temp) break;
               }
               #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-              __pyx_t_10 = PyTuple_GET_ITEM(__pyx_t_13, __pyx_t_9); __Pyx_INCREF(__pyx_t_10); __pyx_t_9++; if (unlikely((0 < 0))) __PYX_ERR(0, 1401, __pyx_L12_error)
+              __pyx_t_10 = PyTuple_GET_ITEM(__pyx_t_13, __pyx_t_9); __Pyx_INCREF(__pyx_t_10); __pyx_t_9++; if (unlikely((0 < 0))) __PYX_ERR(0, 1408, __pyx_L12_error)
               #else
-              __pyx_t_10 = __Pyx_PySequence_ITEM(__pyx_t_13, __pyx_t_9); __pyx_t_9++; if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1401, __pyx_L12_error)
+              __pyx_t_10 = __Pyx_PySequence_ITEM(__pyx_t_13, __pyx_t_9); __pyx_t_9++; if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1408, __pyx_L12_error)
               __Pyx_GOTREF(__pyx_t_10);
               #endif
             }
           } else {
             __pyx_t_10 = __pyx_t_14(__pyx_t_13);
             if (unlikely(!__pyx_t_10)) {
               PyObject* exc_type = PyErr_Occurred();
               if (exc_type) {
                 if (likely(__Pyx_PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
-                else __PYX_ERR(0, 1401, __pyx_L12_error)
+                else __PYX_ERR(0, 1408, __pyx_L12_error)
               }
               break;
             }
             __Pyx_GOTREF(__pyx_t_10);
           }
           __Pyx_XDECREF_SET(__pyx_7genexpr__pyx_v_x, __pyx_t_10);
           __pyx_t_10 = 0;
-          __pyx_t_10 = __Pyx_PyNumber_Int(__pyx_7genexpr__pyx_v_x); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1401, __pyx_L12_error)
+          __pyx_t_10 = __Pyx_PyNumber_Int(__pyx_7genexpr__pyx_v_x); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1408, __pyx_L12_error)
           __Pyx_GOTREF(__pyx_t_10);
-          if (unlikely(__Pyx_ListComp_Append(__pyx_t_7, (PyObject*)__pyx_t_10))) __PYX_ERR(0, 1401, __pyx_L12_error)
+          if (unlikely(__Pyx_ListComp_Append(__pyx_t_7, (PyObject*)__pyx_t_10))) __PYX_ERR(0, 1408, __pyx_L12_error)
           __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
         }
         __Pyx_DECREF(__pyx_t_13); __pyx_t_13 = 0;
         __Pyx_XDECREF(__pyx_7genexpr__pyx_v_x); __pyx_7genexpr__pyx_v_x = 0;
         goto __pyx_L16_exit_scope;
         __pyx_L12_error:;
         __Pyx_XDECREF(__pyx_7genexpr__pyx_v_x); __pyx_7genexpr__pyx_v_x = 0;
@@ -45118,44 +45255,44 @@
       }
       #endif
       {
         PyObject *__pyx_callargs[2] = {__pyx_t_13, __pyx_t_7};
         __pyx_t_3 = __Pyx_PyObject_FastCall(__pyx_t_2, __pyx_callargs+1-__pyx_t_4, 1+__pyx_t_4);
         __Pyx_XDECREF(__pyx_t_13); __pyx_t_13 = 0;
         __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-        if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1401, __pyx_L1_error)
+        if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1408, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_3);
         __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
       }
       __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
 
-      /* "sat_toolkit/formula.pyx":1400
+      /* "sat_toolkit/formula.pyx":1407
  *                 nclaues = int(tmp_nclauses)
  * 
  *             elif line.startswith('x'):             # <<<<<<<<<<<<<<
  *                 xors.add_clauses([int(x) for x in line[1:].split()])
  *             else:
  */
       goto __pyx_L6;
     }
 
-    /* "sat_toolkit/formula.pyx":1403
+    /* "sat_toolkit/formula.pyx":1410
  *                 xors.add_clauses([int(x) for x in line[1:].split()])
  *             else:
  *                 clauses.add_clauses([int(x) for x in line.split()])             # <<<<<<<<<<<<<<
  * 
  *         if nvars == -1:
  */
     /*else*/ {
-      __pyx_t_2 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_clauses), __pyx_n_s_add_clauses); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1403, __pyx_L1_error)
+      __pyx_t_2 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_clauses), __pyx_n_s_add_clauses); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1410, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_2);
       { /* enter inner scope */
-        __pyx_t_7 = PyList_New(0); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1403, __pyx_L19_error)
+        __pyx_t_7 = PyList_New(0); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1410, __pyx_L19_error)
         __Pyx_GOTREF(__pyx_t_7);
-        __pyx_t_10 = __Pyx_PyObject_GetAttrStr(__pyx_v_line, __pyx_n_s_split); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1403, __pyx_L19_error)
+        __pyx_t_10 = __Pyx_PyObject_GetAttrStr(__pyx_v_line, __pyx_n_s_split); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1410, __pyx_L19_error)
         __Pyx_GOTREF(__pyx_t_10);
         __pyx_t_12 = NULL;
         __pyx_t_4 = 0;
         #if CYTHON_UNPACK_METHODS
         if (likely(PyMethod_Check(__pyx_t_10))) {
           __pyx_t_12 = PyMethod_GET_SELF(__pyx_t_10);
           if (likely(__pyx_t_12)) {
@@ -45167,76 +45304,76 @@
           }
         }
         #endif
         {
           PyObject *__pyx_callargs[2] = {__pyx_t_12, NULL};
           __pyx_t_13 = __Pyx_PyObject_FastCall(__pyx_t_10, __pyx_callargs+1-__pyx_t_4, 0+__pyx_t_4);
           __Pyx_XDECREF(__pyx_t_12); __pyx_t_12 = 0;
-          if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 1403, __pyx_L19_error)
+          if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 1410, __pyx_L19_error)
           __Pyx_GOTREF(__pyx_t_13);
           __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
         }
         if (likely(PyList_CheckExact(__pyx_t_13)) || PyTuple_CheckExact(__pyx_t_13)) {
           __pyx_t_10 = __pyx_t_13; __Pyx_INCREF(__pyx_t_10);
           __pyx_t_9 = 0;
           __pyx_t_14 = NULL;
         } else {
-          __pyx_t_9 = -1; __pyx_t_10 = PyObject_GetIter(__pyx_t_13); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1403, __pyx_L19_error)
+          __pyx_t_9 = -1; __pyx_t_10 = PyObject_GetIter(__pyx_t_13); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1410, __pyx_L19_error)
           __Pyx_GOTREF(__pyx_t_10);
-          __pyx_t_14 = __Pyx_PyObject_GetIterNextFunc(__pyx_t_10); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 1403, __pyx_L19_error)
+          __pyx_t_14 = __Pyx_PyObject_GetIterNextFunc(__pyx_t_10); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 1410, __pyx_L19_error)
         }
         __Pyx_DECREF(__pyx_t_13); __pyx_t_13 = 0;
         for (;;) {
           if (likely(!__pyx_t_14)) {
             if (likely(PyList_CheckExact(__pyx_t_10))) {
               {
                 Py_ssize_t __pyx_temp = __Pyx_PyList_GET_SIZE(__pyx_t_10);
                 #if !CYTHON_ASSUME_SAFE_MACROS
-                if (unlikely((__pyx_temp < 0))) __PYX_ERR(0, 1403, __pyx_L19_error)
+                if (unlikely((__pyx_temp < 0))) __PYX_ERR(0, 1410, __pyx_L19_error)
                 #endif
                 if (__pyx_t_9 >= __pyx_temp) break;
               }
               #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-              __pyx_t_13 = PyList_GET_ITEM(__pyx_t_10, __pyx_t_9); __Pyx_INCREF(__pyx_t_13); __pyx_t_9++; if (unlikely((0 < 0))) __PYX_ERR(0, 1403, __pyx_L19_error)
+              __pyx_t_13 = PyList_GET_ITEM(__pyx_t_10, __pyx_t_9); __Pyx_INCREF(__pyx_t_13); __pyx_t_9++; if (unlikely((0 < 0))) __PYX_ERR(0, 1410, __pyx_L19_error)
               #else
-              __pyx_t_13 = __Pyx_PySequence_ITEM(__pyx_t_10, __pyx_t_9); __pyx_t_9++; if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 1403, __pyx_L19_error)
+              __pyx_t_13 = __Pyx_PySequence_ITEM(__pyx_t_10, __pyx_t_9); __pyx_t_9++; if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 1410, __pyx_L19_error)
               __Pyx_GOTREF(__pyx_t_13);
               #endif
             } else {
               {
                 Py_ssize_t __pyx_temp = __Pyx_PyTuple_GET_SIZE(__pyx_t_10);
                 #if !CYTHON_ASSUME_SAFE_MACROS
-                if (unlikely((__pyx_temp < 0))) __PYX_ERR(0, 1403, __pyx_L19_error)
+                if (unlikely((__pyx_temp < 0))) __PYX_ERR(0, 1410, __pyx_L19_error)
                 #endif
                 if (__pyx_t_9 >= __pyx_temp) break;
               }
               #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-              __pyx_t_13 = PyTuple_GET_ITEM(__pyx_t_10, __pyx_t_9); __Pyx_INCREF(__pyx_t_13); __pyx_t_9++; if (unlikely((0 < 0))) __PYX_ERR(0, 1403, __pyx_L19_error)
+              __pyx_t_13 = PyTuple_GET_ITEM(__pyx_t_10, __pyx_t_9); __Pyx_INCREF(__pyx_t_13); __pyx_t_9++; if (unlikely((0 < 0))) __PYX_ERR(0, 1410, __pyx_L19_error)
               #else
-              __pyx_t_13 = __Pyx_PySequence_ITEM(__pyx_t_10, __pyx_t_9); __pyx_t_9++; if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 1403, __pyx_L19_error)
+              __pyx_t_13 = __Pyx_PySequence_ITEM(__pyx_t_10, __pyx_t_9); __pyx_t_9++; if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 1410, __pyx_L19_error)
               __Pyx_GOTREF(__pyx_t_13);
               #endif
             }
           } else {
             __pyx_t_13 = __pyx_t_14(__pyx_t_10);
             if (unlikely(!__pyx_t_13)) {
               PyObject* exc_type = PyErr_Occurred();
               if (exc_type) {
                 if (likely(__Pyx_PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
-                else __PYX_ERR(0, 1403, __pyx_L19_error)
+                else __PYX_ERR(0, 1410, __pyx_L19_error)
               }
               break;
             }
             __Pyx_GOTREF(__pyx_t_13);
           }
           __Pyx_XDECREF_SET(__pyx_8genexpr1__pyx_v_x, __pyx_t_13);
           __pyx_t_13 = 0;
-          __pyx_t_13 = __Pyx_PyNumber_Int(__pyx_8genexpr1__pyx_v_x); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 1403, __pyx_L19_error)
+          __pyx_t_13 = __Pyx_PyNumber_Int(__pyx_8genexpr1__pyx_v_x); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 1410, __pyx_L19_error)
           __Pyx_GOTREF(__pyx_t_13);
-          if (unlikely(__Pyx_ListComp_Append(__pyx_t_7, (PyObject*)__pyx_t_13))) __PYX_ERR(0, 1403, __pyx_L19_error)
+          if (unlikely(__Pyx_ListComp_Append(__pyx_t_7, (PyObject*)__pyx_t_13))) __PYX_ERR(0, 1410, __pyx_L19_error)
           __Pyx_DECREF(__pyx_t_13); __pyx_t_13 = 0;
         }
         __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
         __Pyx_XDECREF(__pyx_8genexpr1__pyx_v_x); __pyx_8genexpr1__pyx_v_x = 0;
         goto __pyx_L23_exit_scope;
         __pyx_L19_error:;
         __Pyx_XDECREF(__pyx_8genexpr1__pyx_v_x); __pyx_8genexpr1__pyx_v_x = 0;
@@ -45258,66 +45395,66 @@
       }
       #endif
       {
         PyObject *__pyx_callargs[2] = {__pyx_t_10, __pyx_t_7};
         __pyx_t_3 = __Pyx_PyObject_FastCall(__pyx_t_2, __pyx_callargs+1-__pyx_t_4, 1+__pyx_t_4);
         __Pyx_XDECREF(__pyx_t_10); __pyx_t_10 = 0;
         __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-        if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1403, __pyx_L1_error)
+        if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1410, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_3);
         __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
       }
       __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
     }
     __pyx_L6:;
 
-    /* "sat_toolkit/formula.pyx":1388
+    /* "sat_toolkit/formula.pyx":1395
  *         lines = io.StringIO(dimacs)
  * 
  *         for line in lines:             # <<<<<<<<<<<<<<
  *             if line.startswith('c'):
  *                 continue
  */
     __pyx_L3_continue:;
   }
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-  /* "sat_toolkit/formula.pyx":1405
+  /* "sat_toolkit/formula.pyx":1412
  *                 clauses.add_clauses([int(x) for x in line.split()])
  * 
  *         if nvars == -1:             # <<<<<<<<<<<<<<
  *             raise ValueError('no \'p cnf ...\' line in dimacs')
  * 
  */
   __pyx_t_8 = (__pyx_v_nvars == -1L);
   if (unlikely(__pyx_t_8)) {
 
-    /* "sat_toolkit/formula.pyx":1406
+    /* "sat_toolkit/formula.pyx":1413
  * 
  *         if nvars == -1:
  *             raise ValueError('no \'p cnf ...\' line in dimacs')             # <<<<<<<<<<<<<<
  * 
  *         if nvars < max(clauses.nvars, xors.nvars):
  */
-    __pyx_t_1 = __Pyx_PyObject_Call(__pyx_builtin_ValueError, __pyx_tuple__47, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1406, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyObject_Call(__pyx_builtin_ValueError, __pyx_tuple__47, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1413, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_Raise(__pyx_t_1, 0, 0, 0);
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-    __PYX_ERR(0, 1406, __pyx_L1_error)
+    __PYX_ERR(0, 1413, __pyx_L1_error)
 
-    /* "sat_toolkit/formula.pyx":1405
+    /* "sat_toolkit/formula.pyx":1412
  *                 clauses.add_clauses([int(x) for x in line.split()])
  * 
  *         if nvars == -1:             # <<<<<<<<<<<<<<
  *             raise ValueError('no \'p cnf ...\' line in dimacs')
  * 
  */
   }
 
-  /* "sat_toolkit/formula.pyx":1408
+  /* "sat_toolkit/formula.pyx":1415
  *             raise ValueError('no \'p cnf ...\' line in dimacs')
  * 
  *         if nvars < max(clauses.nvars, xors.nvars):             # <<<<<<<<<<<<<<
  *             raise ValueError('nvars in p cnf line is smaller than the biggest encountered variable')
  * 
  */
   __pyx_t_4 = __pyx_v_xors->__pyx_base.nvars;
@@ -45327,74 +45464,74 @@
     __pyx_t_16 = __pyx_t_4;
   } else {
     __pyx_t_16 = __pyx_t_15;
   }
   __pyx_t_8 = (__pyx_v_nvars < __pyx_t_16);
   if (unlikely(__pyx_t_8)) {
 
-    /* "sat_toolkit/formula.pyx":1409
+    /* "sat_toolkit/formula.pyx":1416
  * 
  *         if nvars < max(clauses.nvars, xors.nvars):
  *             raise ValueError('nvars in p cnf line is smaller than the biggest encountered variable')             # <<<<<<<<<<<<<<
  * 
  *         clauses.nvars = nvars
  */
-    __pyx_t_1 = __Pyx_PyObject_Call(__pyx_builtin_ValueError, __pyx_tuple__48, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1409, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyObject_Call(__pyx_builtin_ValueError, __pyx_tuple__48, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1416, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_Raise(__pyx_t_1, 0, 0, 0);
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-    __PYX_ERR(0, 1409, __pyx_L1_error)
+    __PYX_ERR(0, 1416, __pyx_L1_error)
 
-    /* "sat_toolkit/formula.pyx":1408
+    /* "sat_toolkit/formula.pyx":1415
  *             raise ValueError('no \'p cnf ...\' line in dimacs')
  * 
  *         if nvars < max(clauses.nvars, xors.nvars):             # <<<<<<<<<<<<<<
  *             raise ValueError('nvars in p cnf line is smaller than the biggest encountered variable')
  * 
  */
   }
 
-  /* "sat_toolkit/formula.pyx":1411
+  /* "sat_toolkit/formula.pyx":1418
  *             raise ValueError('nvars in p cnf line is smaller than the biggest encountered variable')
  * 
  *         clauses.nvars = nvars             # <<<<<<<<<<<<<<
  *         xors.nvars = nvars
  * 
  */
   __pyx_v_clauses->__pyx_base.nvars = __pyx_v_nvars;
 
-  /* "sat_toolkit/formula.pyx":1412
+  /* "sat_toolkit/formula.pyx":1419
  * 
  *         clauses.nvars = nvars
  *         xors.nvars = nvars             # <<<<<<<<<<<<<<
  * 
  *         return XorCNF(clauses=clauses, xor_clauses=xors)
  */
   __pyx_v_xors->__pyx_base.nvars = __pyx_v_nvars;
 
-  /* "sat_toolkit/formula.pyx":1414
+  /* "sat_toolkit/formula.pyx":1421
  *         xors.nvars = nvars
  * 
  *         return XorCNF(clauses=clauses, xor_clauses=xors)             # <<<<<<<<<<<<<<
  * 
  *     @staticmethod
  */
   __Pyx_XDECREF((PyObject *)__pyx_r);
-  __pyx_t_1 = __Pyx_PyDict_NewPresized(2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1414, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyDict_NewPresized(2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1421, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  if (PyDict_SetItem(__pyx_t_1, __pyx_n_s_clauses, ((PyObject *)__pyx_v_clauses)) < 0) __PYX_ERR(0, 1414, __pyx_L1_error)
-  if (PyDict_SetItem(__pyx_t_1, __pyx_n_s_xor_clauses, ((PyObject *)__pyx_v_xors)) < 0) __PYX_ERR(0, 1414, __pyx_L1_error)
-  __pyx_t_3 = __Pyx_PyObject_Call(((PyObject *)__pyx_ptype_11sat_toolkit_7formula_XorCNF), __pyx_empty_tuple, __pyx_t_1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1414, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_1, __pyx_n_s_clauses, ((PyObject *)__pyx_v_clauses)) < 0) __PYX_ERR(0, 1421, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_1, __pyx_n_s_xor_clauses, ((PyObject *)__pyx_v_xors)) < 0) __PYX_ERR(0, 1421, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_Call(((PyObject *)__pyx_ptype_11sat_toolkit_7formula_XorCNF), __pyx_empty_tuple, __pyx_t_1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1421, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __pyx_r = ((struct __pyx_obj_11sat_toolkit_7formula_XorCNF *)__pyx_t_3);
   __pyx_t_3 = 0;
   goto __pyx_L0;
 
-  /* "sat_toolkit/formula.pyx":1379
+  /* "sat_toolkit/formula.pyx":1386
  * 
  * 
  *     @staticmethod             # <<<<<<<<<<<<<<
  *     def from_dimacs(dimacs: str) -> XorCNF:
  *         cdef CNF clauses = CNF.__new__(CNF)
  */
 
@@ -45420,15 +45557,15 @@
   __Pyx_XDECREF(__pyx_7genexpr__pyx_v_x);
   __Pyx_XDECREF(__pyx_8genexpr1__pyx_v_x);
   __Pyx_XGIVEREF((PyObject *)__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "sat_toolkit/formula.pyx":1416
+/* "sat_toolkit/formula.pyx":1423
  *         return XorCNF(clauses=clauses, xor_clauses=xors)
  * 
  *     @staticmethod             # <<<<<<<<<<<<<<
  *     def create_xor(*args, rhs=None) -> XorCNF:
  *         """
  */
 
@@ -45455,15 +45592,15 @@
   #endif
   __pyx_kwvalues = __Pyx_KwValues_VARARGS(__pyx_args, __pyx_nargs);
   __Pyx_INCREF(__pyx_args);
   __pyx_v_args = __pyx_args;
   {
     PyObject **__pyx_pyargnames[] = {&__pyx_n_s_rhs,0};
 
-    /* "sat_toolkit/formula.pyx":1417
+    /* "sat_toolkit/formula.pyx":1424
  * 
  *     @staticmethod
  *     def create_xor(*args, rhs=None) -> XorCNF:             # <<<<<<<<<<<<<<
  *         """
  *         creates an XorCNF specifying the xor of the arguments is equal to the right
  */
     values[0] = __Pyx_Arg_NewRef_VARARGS(((PyObject *)Py_None));
@@ -45474,28 +45611,28 @@
         case  0: break;
       }
       kw_args = __Pyx_NumKwargs_VARARGS(__pyx_kwds);
       if (kw_args == 1) {
         const Py_ssize_t index = 0;
         PyObject* value = __Pyx_GetKwValue_VARARGS(__pyx_kwds, __pyx_kwvalues, *__pyx_pyargnames[index]);
         if (value) { values[index] = __Pyx_Arg_NewRef_VARARGS(value); kw_args--; }
-        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 1416, __pyx_L3_error)
+        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 1423, __pyx_L3_error)
       }
       if (unlikely(kw_args > 0)) {
-        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values + 0, 0, "create_xor") < 0)) __PYX_ERR(0, 1416, __pyx_L3_error)
+        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values + 0, 0, "create_xor") < 0)) __PYX_ERR(0, 1423, __pyx_L3_error)
       }
     } else if (unlikely(__pyx_nargs < 0)) {
       goto __pyx_L5_argtuple_error;
     } else {
     }
     __pyx_v_rhs = values[0];
   }
   goto __pyx_L6_skip;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("create_xor", 0, 0, 0, __pyx_nargs); __PYX_ERR(0, 1416, __pyx_L3_error)
+  __Pyx_RaiseArgtupleInvalid("create_xor", 0, 0, 0, __pyx_nargs); __PYX_ERR(0, 1423, __pyx_L3_error)
   __pyx_L6_skip:;
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L3_error:;
   {
     Py_ssize_t __pyx_temp;
     for (__pyx_temp=0; __pyx_temp < (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
       __Pyx_Arg_XDECREF_VARARGS(values[__pyx_temp]);
@@ -45504,15 +45641,15 @@
   __Pyx_DECREF(__pyx_v_args); __pyx_v_args = 0;
   __Pyx_AddTraceback("sat_toolkit.formula.XorCNF.create_xor", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __Pyx_RefNannyFinishContext();
   return NULL;
   __pyx_L4_argument_unpacking_done:;
   __pyx_r = __pyx_pf_11sat_toolkit_7formula_6XorCNF_6create_xor(__pyx_v_rhs, __pyx_v_args);
 
-  /* "sat_toolkit/formula.pyx":1416
+  /* "sat_toolkit/formula.pyx":1423
  *         return XorCNF(clauses=clauses, xor_clauses=xors)
  * 
  *     @staticmethod             # <<<<<<<<<<<<<<
  *     def create_xor(*args, rhs=None) -> XorCNF:
  *         """
  */
 
@@ -45569,34 +45706,34 @@
   size_t __pyx_t_27;
   __Pyx_memviewslice __pyx_t_28 = { 0, 0, { 0 }, { 0 }, { 0 } };
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("create_xor", 1);
 
-  /* "sat_toolkit/formula.pyx":1427
+  /* "sat_toolkit/formula.pyx":1434
  *         Each argument is a 1-D array. The xors are computed elementwise.
  *         """
  *         cdef size_t num_args = len(args)             # <<<<<<<<<<<<<<
  *         cdef size_t num_xors = -1
  *         cdef size_t i, j
  */
-  __pyx_t_1 = __Pyx_PyTuple_GET_SIZE(__pyx_v_args); if (unlikely(__pyx_t_1 == ((Py_ssize_t)-1))) __PYX_ERR(0, 1427, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyTuple_GET_SIZE(__pyx_v_args); if (unlikely(__pyx_t_1 == ((Py_ssize_t)-1))) __PYX_ERR(0, 1434, __pyx_L1_error)
   __pyx_v_num_args = __pyx_t_1;
 
-  /* "sat_toolkit/formula.pyx":1428
+  /* "sat_toolkit/formula.pyx":1435
  *         """
  *         cdef size_t num_args = len(args)
  *         cdef size_t num_xors = -1             # <<<<<<<<<<<<<<
  *         cdef size_t i, j
  * 
  */
   __pyx_v_num_xors = -1L;
 
-  /* "sat_toolkit/formula.pyx":1433
+  /* "sat_toolkit/formula.pyx":1440
  *         cdef int[::1] rhs_view
  * 
  *         try:             # <<<<<<<<<<<<<<
  *             rhs_view = rhs
  *         except (TypeError, ValueError):
  */
   {
@@ -45604,27 +45741,27 @@
     __Pyx_PyThreadState_assign
     __Pyx_ExceptionSave(&__pyx_t_2, &__pyx_t_3, &__pyx_t_4);
     __Pyx_XGOTREF(__pyx_t_2);
     __Pyx_XGOTREF(__pyx_t_3);
     __Pyx_XGOTREF(__pyx_t_4);
     /*try:*/ {
 
-      /* "sat_toolkit/formula.pyx":1434
+      /* "sat_toolkit/formula.pyx":1441
  * 
  *         try:
  *             rhs_view = rhs             # <<<<<<<<<<<<<<
  *         except (TypeError, ValueError):
  *             rhs_view = np.array(rhs, dtype=np.int32)
  */
-      __pyx_t_5 = __Pyx_PyObject_to_MemoryviewSlice_dc_int(__pyx_v_rhs, PyBUF_WRITABLE); if (unlikely(!__pyx_t_5.memview)) __PYX_ERR(0, 1434, __pyx_L3_error)
+      __pyx_t_5 = __Pyx_PyObject_to_MemoryviewSlice_dc_int(__pyx_v_rhs, PyBUF_WRITABLE); if (unlikely(!__pyx_t_5.memview)) __PYX_ERR(0, 1441, __pyx_L3_error)
       __pyx_v_rhs_view = __pyx_t_5;
       __pyx_t_5.memview = NULL;
       __pyx_t_5.data = NULL;
 
-      /* "sat_toolkit/formula.pyx":1433
+      /* "sat_toolkit/formula.pyx":1440
  *         cdef int[::1] rhs_view
  * 
  *         try:             # <<<<<<<<<<<<<<
  *             rhs_view = rhs
  *         except (TypeError, ValueError):
  */
     }
@@ -45632,74 +45769,74 @@
     __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
     __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
     goto __pyx_L8_try_end;
     __pyx_L3_error:;
     __PYX_XCLEAR_MEMVIEW(&__pyx_t_5, 1);
     __pyx_t_5.memview = NULL; __pyx_t_5.data = NULL;
 
-    /* "sat_toolkit/formula.pyx":1435
+    /* "sat_toolkit/formula.pyx":1442
  *         try:
  *             rhs_view = rhs
  *         except (TypeError, ValueError):             # <<<<<<<<<<<<<<
  *             rhs_view = np.array(rhs, dtype=np.int32)
  * 
  */
     __pyx_t_6 = __Pyx_PyErr_ExceptionMatches2(__pyx_builtin_TypeError, __pyx_builtin_ValueError);
     if (__pyx_t_6) {
       __Pyx_AddTraceback("sat_toolkit.formula.XorCNF.create_xor", __pyx_clineno, __pyx_lineno, __pyx_filename);
-      if (__Pyx_GetException(&__pyx_t_7, &__pyx_t_8, &__pyx_t_9) < 0) __PYX_ERR(0, 1435, __pyx_L5_except_error)
+      if (__Pyx_GetException(&__pyx_t_7, &__pyx_t_8, &__pyx_t_9) < 0) __PYX_ERR(0, 1442, __pyx_L5_except_error)
       __Pyx_XGOTREF(__pyx_t_7);
       __Pyx_XGOTREF(__pyx_t_8);
       __Pyx_XGOTREF(__pyx_t_9);
 
-      /* "sat_toolkit/formula.pyx":1436
+      /* "sat_toolkit/formula.pyx":1443
  *             rhs_view = rhs
  *         except (TypeError, ValueError):
  *             rhs_view = np.array(rhs, dtype=np.int32)             # <<<<<<<<<<<<<<
  * 
  *         if num_args < 1:
  */
-      __Pyx_GetModuleGlobalName(__pyx_t_10, __pyx_n_s_np); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1436, __pyx_L5_except_error)
+      __Pyx_GetModuleGlobalName(__pyx_t_10, __pyx_n_s_np); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1443, __pyx_L5_except_error)
       __Pyx_GOTREF(__pyx_t_10);
-      __pyx_t_11 = __Pyx_PyObject_GetAttrStr(__pyx_t_10, __pyx_n_s_array); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1436, __pyx_L5_except_error)
+      __pyx_t_11 = __Pyx_PyObject_GetAttrStr(__pyx_t_10, __pyx_n_s_array); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1443, __pyx_L5_except_error)
       __Pyx_GOTREF(__pyx_t_11);
       __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
-      __pyx_t_10 = PyTuple_New(1); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1436, __pyx_L5_except_error)
+      __pyx_t_10 = PyTuple_New(1); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1443, __pyx_L5_except_error)
       __Pyx_GOTREF(__pyx_t_10);
       __Pyx_INCREF(__pyx_v_rhs);
       __Pyx_GIVEREF(__pyx_v_rhs);
-      if (__Pyx_PyTuple_SET_ITEM(__pyx_t_10, 0, __pyx_v_rhs)) __PYX_ERR(0, 1436, __pyx_L5_except_error);
-      __pyx_t_12 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 1436, __pyx_L5_except_error)
+      if (__Pyx_PyTuple_SET_ITEM(__pyx_t_10, 0, __pyx_v_rhs)) __PYX_ERR(0, 1443, __pyx_L5_except_error);
+      __pyx_t_12 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 1443, __pyx_L5_except_error)
       __Pyx_GOTREF(__pyx_t_12);
-      __Pyx_GetModuleGlobalName(__pyx_t_13, __pyx_n_s_np); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 1436, __pyx_L5_except_error)
+      __Pyx_GetModuleGlobalName(__pyx_t_13, __pyx_n_s_np); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 1443, __pyx_L5_except_error)
       __Pyx_GOTREF(__pyx_t_13);
-      __pyx_t_14 = __Pyx_PyObject_GetAttrStr(__pyx_t_13, __pyx_n_s_int32); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 1436, __pyx_L5_except_error)
+      __pyx_t_14 = __Pyx_PyObject_GetAttrStr(__pyx_t_13, __pyx_n_s_int32); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 1443, __pyx_L5_except_error)
       __Pyx_GOTREF(__pyx_t_14);
       __Pyx_DECREF(__pyx_t_13); __pyx_t_13 = 0;
-      if (PyDict_SetItem(__pyx_t_12, __pyx_n_s_dtype, __pyx_t_14) < 0) __PYX_ERR(0, 1436, __pyx_L5_except_error)
+      if (PyDict_SetItem(__pyx_t_12, __pyx_n_s_dtype, __pyx_t_14) < 0) __PYX_ERR(0, 1443, __pyx_L5_except_error)
       __Pyx_DECREF(__pyx_t_14); __pyx_t_14 = 0;
-      __pyx_t_14 = __Pyx_PyObject_Call(__pyx_t_11, __pyx_t_10, __pyx_t_12); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 1436, __pyx_L5_except_error)
+      __pyx_t_14 = __Pyx_PyObject_Call(__pyx_t_11, __pyx_t_10, __pyx_t_12); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 1443, __pyx_L5_except_error)
       __Pyx_GOTREF(__pyx_t_14);
       __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
       __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
       __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;
-      __pyx_t_5 = __Pyx_PyObject_to_MemoryviewSlice_dc_int(__pyx_t_14, PyBUF_WRITABLE); if (unlikely(!__pyx_t_5.memview)) __PYX_ERR(0, 1436, __pyx_L5_except_error)
+      __pyx_t_5 = __Pyx_PyObject_to_MemoryviewSlice_dc_int(__pyx_t_14, PyBUF_WRITABLE); if (unlikely(!__pyx_t_5.memview)) __PYX_ERR(0, 1443, __pyx_L5_except_error)
       __Pyx_DECREF(__pyx_t_14); __pyx_t_14 = 0;
       __PYX_XCLEAR_MEMVIEW(&__pyx_v_rhs_view, 1);
       __pyx_v_rhs_view = __pyx_t_5;
       __pyx_t_5.memview = NULL;
       __pyx_t_5.data = NULL;
       __Pyx_XDECREF(__pyx_t_7); __pyx_t_7 = 0;
       __Pyx_XDECREF(__pyx_t_8); __pyx_t_8 = 0;
       __Pyx_XDECREF(__pyx_t_9); __pyx_t_9 = 0;
       goto __pyx_L4_exception_handled;
     }
     goto __pyx_L5_except_error;
 
-    /* "sat_toolkit/formula.pyx":1433
+    /* "sat_toolkit/formula.pyx":1440
  *         cdef int[::1] rhs_view
  * 
  *         try:             # <<<<<<<<<<<<<<
  *             rhs_view = rhs
  *         except (TypeError, ValueError):
  */
     __pyx_L5_except_error:;
@@ -45712,60 +45849,60 @@
     __Pyx_XGIVEREF(__pyx_t_2);
     __Pyx_XGIVEREF(__pyx_t_3);
     __Pyx_XGIVEREF(__pyx_t_4);
     __Pyx_ExceptionReset(__pyx_t_2, __pyx_t_3, __pyx_t_4);
     __pyx_L8_try_end:;
   }
 
-  /* "sat_toolkit/formula.pyx":1438
+  /* "sat_toolkit/formula.pyx":1445
  *             rhs_view = np.array(rhs, dtype=np.int32)
  * 
  *         if num_args < 1:             # <<<<<<<<<<<<<<
  *             raise ValueError('must provide at least one argument')
  * 
  */
   __pyx_t_15 = (__pyx_v_num_args < 1);
   if (unlikely(__pyx_t_15)) {
 
-    /* "sat_toolkit/formula.pyx":1439
+    /* "sat_toolkit/formula.pyx":1446
  * 
  *         if num_args < 1:
  *             raise ValueError('must provide at least one argument')             # <<<<<<<<<<<<<<
  * 
  *         num_xors = len(args[0])
  */
-    __pyx_t_9 = __Pyx_PyObject_Call(__pyx_builtin_ValueError, __pyx_tuple__30, NULL); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1439, __pyx_L1_error)
+    __pyx_t_9 = __Pyx_PyObject_Call(__pyx_builtin_ValueError, __pyx_tuple__30, NULL); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1446, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_9);
     __Pyx_Raise(__pyx_t_9, 0, 0, 0);
     __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
-    __PYX_ERR(0, 1439, __pyx_L1_error)
+    __PYX_ERR(0, 1446, __pyx_L1_error)
 
-    /* "sat_toolkit/formula.pyx":1438
+    /* "sat_toolkit/formula.pyx":1445
  *             rhs_view = np.array(rhs, dtype=np.int32)
  * 
  *         if num_args < 1:             # <<<<<<<<<<<<<<
  *             raise ValueError('must provide at least one argument')
  * 
  */
   }
 
-  /* "sat_toolkit/formula.pyx":1441
+  /* "sat_toolkit/formula.pyx":1448
  *             raise ValueError('must provide at least one argument')
  * 
  *         num_xors = len(args[0])             # <<<<<<<<<<<<<<
  * 
  *         if rhs_view is not None and len(rhs_view) != num_xors:
  */
   __pyx_t_9 = PyTuple_GET_ITEM(__pyx_v_args, 0);
   __Pyx_INCREF(__pyx_t_9);
-  __pyx_t_1 = PyObject_Length(__pyx_t_9); if (unlikely(__pyx_t_1 == ((Py_ssize_t)-1))) __PYX_ERR(0, 1441, __pyx_L1_error)
+  __pyx_t_1 = PyObject_Length(__pyx_t_9); if (unlikely(__pyx_t_1 == ((Py_ssize_t)-1))) __PYX_ERR(0, 1448, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
   __pyx_v_num_xors = __pyx_t_1;
 
-  /* "sat_toolkit/formula.pyx":1443
+  /* "sat_toolkit/formula.pyx":1450
  *         num_xors = len(args[0])
  * 
  *         if rhs_view is not None and len(rhs_view) != num_xors:             # <<<<<<<<<<<<<<
  *             raise ValueError('rhs must have the same length as the arguments')
  * 
  */
   __pyx_t_16 = (((PyObject *) __pyx_v_rhs_view.memview) != Py_None);
@@ -45776,63 +45913,63 @@
   }
   __pyx_t_1 = __Pyx_MemoryView_Len(__pyx_v_rhs_view); 
   __pyx_t_16 = (__pyx_t_1 != __pyx_v_num_xors);
   __pyx_t_15 = __pyx_t_16;
   __pyx_L13_bool_binop_done:;
   if (unlikely(__pyx_t_15)) {
 
-    /* "sat_toolkit/formula.pyx":1444
+    /* "sat_toolkit/formula.pyx":1451
  * 
  *         if rhs_view is not None and len(rhs_view) != num_xors:
  *             raise ValueError('rhs must have the same length as the arguments')             # <<<<<<<<<<<<<<
  * 
  *         packed_args = np.zeros((num_xors, num_args + 1), np.int32)
  */
-    __pyx_t_9 = __Pyx_PyObject_Call(__pyx_builtin_ValueError, __pyx_tuple__49, NULL); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1444, __pyx_L1_error)
+    __pyx_t_9 = __Pyx_PyObject_Call(__pyx_builtin_ValueError, __pyx_tuple__49, NULL); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1451, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_9);
     __Pyx_Raise(__pyx_t_9, 0, 0, 0);
     __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
-    __PYX_ERR(0, 1444, __pyx_L1_error)
+    __PYX_ERR(0, 1451, __pyx_L1_error)
 
-    /* "sat_toolkit/formula.pyx":1443
+    /* "sat_toolkit/formula.pyx":1450
  *         num_xors = len(args[0])
  * 
  *         if rhs_view is not None and len(rhs_view) != num_xors:             # <<<<<<<<<<<<<<
  *             raise ValueError('rhs must have the same length as the arguments')
  * 
  */
   }
 
-  /* "sat_toolkit/formula.pyx":1446
+  /* "sat_toolkit/formula.pyx":1453
  *             raise ValueError('rhs must have the same length as the arguments')
  * 
  *         packed_args = np.zeros((num_xors, num_args + 1), np.int32)             # <<<<<<<<<<<<<<
  * 
  *         for i, arg in enumerate(args):
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_8, __pyx_n_s_np); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1446, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_8, __pyx_n_s_np); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1453, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_8);
-  __pyx_t_7 = __Pyx_PyObject_GetAttrStr(__pyx_t_8, __pyx_n_s_zeros); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1446, __pyx_L1_error)
+  __pyx_t_7 = __Pyx_PyObject_GetAttrStr(__pyx_t_8, __pyx_n_s_zeros); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1453, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_7);
   __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
-  __pyx_t_8 = __Pyx_PyInt_FromSize_t(__pyx_v_num_xors); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1446, __pyx_L1_error)
+  __pyx_t_8 = __Pyx_PyInt_FromSize_t(__pyx_v_num_xors); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1453, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_8);
-  __pyx_t_14 = __Pyx_PyInt_FromSize_t((__pyx_v_num_args + 1)); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 1446, __pyx_L1_error)
+  __pyx_t_14 = __Pyx_PyInt_FromSize_t((__pyx_v_num_args + 1)); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 1453, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_14);
-  __pyx_t_12 = PyTuple_New(2); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 1446, __pyx_L1_error)
+  __pyx_t_12 = PyTuple_New(2); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 1453, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_12);
   __Pyx_GIVEREF(__pyx_t_8);
-  if (__Pyx_PyTuple_SET_ITEM(__pyx_t_12, 0, __pyx_t_8)) __PYX_ERR(0, 1446, __pyx_L1_error);
+  if (__Pyx_PyTuple_SET_ITEM(__pyx_t_12, 0, __pyx_t_8)) __PYX_ERR(0, 1453, __pyx_L1_error);
   __Pyx_GIVEREF(__pyx_t_14);
-  if (__Pyx_PyTuple_SET_ITEM(__pyx_t_12, 1, __pyx_t_14)) __PYX_ERR(0, 1446, __pyx_L1_error);
+  if (__Pyx_PyTuple_SET_ITEM(__pyx_t_12, 1, __pyx_t_14)) __PYX_ERR(0, 1453, __pyx_L1_error);
   __pyx_t_8 = 0;
   __pyx_t_14 = 0;
-  __Pyx_GetModuleGlobalName(__pyx_t_14, __pyx_n_s_np); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 1446, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_14, __pyx_n_s_np); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 1453, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_14);
-  __pyx_t_8 = __Pyx_PyObject_GetAttrStr(__pyx_t_14, __pyx_n_s_int32); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1446, __pyx_L1_error)
+  __pyx_t_8 = __Pyx_PyObject_GetAttrStr(__pyx_t_14, __pyx_n_s_int32); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1453, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_8);
   __Pyx_DECREF(__pyx_t_14); __pyx_t_14 = 0;
   __pyx_t_14 = NULL;
   __pyx_t_6 = 0;
   #if CYTHON_UNPACK_METHODS
   if (unlikely(PyMethod_Check(__pyx_t_7))) {
     __pyx_t_14 = PyMethod_GET_SELF(__pyx_t_7);
@@ -45847,105 +45984,105 @@
   #endif
   {
     PyObject *__pyx_callargs[3] = {__pyx_t_14, __pyx_t_12, __pyx_t_8};
     __pyx_t_9 = __Pyx_PyObject_FastCall(__pyx_t_7, __pyx_callargs+1-__pyx_t_6, 2+__pyx_t_6);
     __Pyx_XDECREF(__pyx_t_14); __pyx_t_14 = 0;
     __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;
     __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
-    if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1446, __pyx_L1_error)
+    if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1453, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_9);
     __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
   }
   __pyx_v_packed_args = __pyx_t_9;
   __pyx_t_9 = 0;
 
-  /* "sat_toolkit/formula.pyx":1448
+  /* "sat_toolkit/formula.pyx":1455
  *         packed_args = np.zeros((num_xors, num_args + 1), np.int32)
  * 
  *         for i, arg in enumerate(args):             # <<<<<<<<<<<<<<
  *             packed_args[:, i] = arg
  * 
  */
   __pyx_t_17 = 0;
   __pyx_t_9 = __pyx_v_args; __Pyx_INCREF(__pyx_t_9);
   __pyx_t_1 = 0;
   for (;;) {
     {
       Py_ssize_t __pyx_temp = __Pyx_PyTuple_GET_SIZE(__pyx_t_9);
       #if !CYTHON_ASSUME_SAFE_MACROS
-      if (unlikely((__pyx_temp < 0))) __PYX_ERR(0, 1448, __pyx_L1_error)
+      if (unlikely((__pyx_temp < 0))) __PYX_ERR(0, 1455, __pyx_L1_error)
       #endif
       if (__pyx_t_1 >= __pyx_temp) break;
     }
     #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-    __pyx_t_7 = PyTuple_GET_ITEM(__pyx_t_9, __pyx_t_1); __Pyx_INCREF(__pyx_t_7); __pyx_t_1++; if (unlikely((0 < 0))) __PYX_ERR(0, 1448, __pyx_L1_error)
+    __pyx_t_7 = PyTuple_GET_ITEM(__pyx_t_9, __pyx_t_1); __Pyx_INCREF(__pyx_t_7); __pyx_t_1++; if (unlikely((0 < 0))) __PYX_ERR(0, 1455, __pyx_L1_error)
     #else
-    __pyx_t_7 = __Pyx_PySequence_ITEM(__pyx_t_9, __pyx_t_1); __pyx_t_1++; if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1448, __pyx_L1_error)
+    __pyx_t_7 = __Pyx_PySequence_ITEM(__pyx_t_9, __pyx_t_1); __pyx_t_1++; if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1455, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_7);
     #endif
     __Pyx_XDECREF_SET(__pyx_v_arg, __pyx_t_7);
     __pyx_t_7 = 0;
     __pyx_v_i = __pyx_t_17;
     __pyx_t_17 = (__pyx_t_17 + 1);
 
-    /* "sat_toolkit/formula.pyx":1449
+    /* "sat_toolkit/formula.pyx":1456
  * 
  *         for i, arg in enumerate(args):
  *             packed_args[:, i] = arg             # <<<<<<<<<<<<<<
  * 
  * 
  */
-    __pyx_t_7 = __Pyx_PyInt_FromSize_t(__pyx_v_i); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1449, __pyx_L1_error)
+    __pyx_t_7 = __Pyx_PyInt_FromSize_t(__pyx_v_i); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1456, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_7);
-    __pyx_t_8 = PyTuple_New(2); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1449, __pyx_L1_error)
+    __pyx_t_8 = PyTuple_New(2); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1456, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_8);
     __Pyx_INCREF(__pyx_slice__5);
     __Pyx_GIVEREF(__pyx_slice__5);
-    if (__Pyx_PyTuple_SET_ITEM(__pyx_t_8, 0, __pyx_slice__5)) __PYX_ERR(0, 1449, __pyx_L1_error);
+    if (__Pyx_PyTuple_SET_ITEM(__pyx_t_8, 0, __pyx_slice__5)) __PYX_ERR(0, 1456, __pyx_L1_error);
     __Pyx_GIVEREF(__pyx_t_7);
-    if (__Pyx_PyTuple_SET_ITEM(__pyx_t_8, 1, __pyx_t_7)) __PYX_ERR(0, 1449, __pyx_L1_error);
+    if (__Pyx_PyTuple_SET_ITEM(__pyx_t_8, 1, __pyx_t_7)) __PYX_ERR(0, 1456, __pyx_L1_error);
     __pyx_t_7 = 0;
-    if (unlikely((PyObject_SetItem(__pyx_v_packed_args, __pyx_t_8, __pyx_v_arg) < 0))) __PYX_ERR(0, 1449, __pyx_L1_error)
+    if (unlikely((PyObject_SetItem(__pyx_v_packed_args, __pyx_t_8, __pyx_v_arg) < 0))) __PYX_ERR(0, 1456, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
 
-    /* "sat_toolkit/formula.pyx":1448
+    /* "sat_toolkit/formula.pyx":1455
  *         packed_args = np.zeros((num_xors, num_args + 1), np.int32)
  * 
  *         for i, arg in enumerate(args):             # <<<<<<<<<<<<<<
  *             packed_args[:, i] = arg
  * 
  */
   }
   __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
 
-  /* "sat_toolkit/formula.pyx":1452
+  /* "sat_toolkit/formula.pyx":1459
  * 
  * 
  *         cdef int[:, ::1] packed_args_view = packed_args             # <<<<<<<<<<<<<<
  * 
  *         for i in range(num_xors):
  */
-  __pyx_t_18 = __Pyx_PyObject_to_MemoryviewSlice_d_dc_int(__pyx_v_packed_args, PyBUF_WRITABLE); if (unlikely(!__pyx_t_18.memview)) __PYX_ERR(0, 1452, __pyx_L1_error)
+  __pyx_t_18 = __Pyx_PyObject_to_MemoryviewSlice_d_dc_int(__pyx_v_packed_args, PyBUF_WRITABLE); if (unlikely(!__pyx_t_18.memview)) __PYX_ERR(0, 1459, __pyx_L1_error)
   __pyx_v_packed_args_view = __pyx_t_18;
   __pyx_t_18.memview = NULL;
   __pyx_t_18.data = NULL;
 
-  /* "sat_toolkit/formula.pyx":1454
+  /* "sat_toolkit/formula.pyx":1461
  *         cdef int[:, ::1] packed_args_view = packed_args
  * 
  *         for i in range(num_xors):             # <<<<<<<<<<<<<<
  *             if rhs_view is not None and rhs_view[i] not in [0, 1]:
  *                 raise ValueError(f"right hand side must be 0 or 1, not {rhs_view[i]}")
  */
   __pyx_t_17 = __pyx_v_num_xors;
   __pyx_t_19 = __pyx_t_17;
   for (__pyx_t_20 = 0; __pyx_t_20 < __pyx_t_19; __pyx_t_20+=1) {
     __pyx_v_i = __pyx_t_20;
 
-    /* "sat_toolkit/formula.pyx":1455
+    /* "sat_toolkit/formula.pyx":1462
  * 
  *         for i in range(num_xors):
  *             if rhs_view is not None and rhs_view[i] not in [0, 1]:             # <<<<<<<<<<<<<<
  *                 raise ValueError(f"right hand side must be 0 or 1, not {rhs_view[i]}")
  * 
  */
     __pyx_t_16 = (((PyObject *) __pyx_v_rhs_view.memview) != Py_None);
@@ -45966,44 +46103,44 @@
     __pyx_t_16 = __pyx_t_22;
     __pyx_L23_bool_binop_done:;
     __pyx_t_22 = __pyx_t_16;
     __pyx_t_15 = __pyx_t_22;
     __pyx_L21_bool_binop_done:;
     if (unlikely(__pyx_t_15)) {
 
-      /* "sat_toolkit/formula.pyx":1456
+      /* "sat_toolkit/formula.pyx":1463
  *         for i in range(num_xors):
  *             if rhs_view is not None and rhs_view[i] not in [0, 1]:
  *                 raise ValueError(f"right hand side must be 0 or 1, not {rhs_view[i]}")             # <<<<<<<<<<<<<<
  * 
  *             # the default rhs value in cryptominisat is 1 while our default is 0
  */
       __pyx_t_21 = __pyx_v_i;
-      __pyx_t_9 = __Pyx_PyUnicode_From_int((*((int *) ( /* dim=0 */ ((char *) (((int *) __pyx_v_rhs_view.data) + __pyx_t_21)) ))), 0, ' ', 'd'); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1456, __pyx_L1_error)
+      __pyx_t_9 = __Pyx_PyUnicode_From_int((*((int *) ( /* dim=0 */ ((char *) (((int *) __pyx_v_rhs_view.data) + __pyx_t_21)) ))), 0, ' ', 'd'); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1463, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_9);
-      __pyx_t_8 = __Pyx_PyUnicode_Concat(__pyx_kp_u_right_hand_side_must_be_0_or_1_n, __pyx_t_9); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1456, __pyx_L1_error)
+      __pyx_t_8 = __Pyx_PyUnicode_Concat(__pyx_kp_u_right_hand_side_must_be_0_or_1_n, __pyx_t_9); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1463, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_8);
       __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
-      __pyx_t_9 = __Pyx_PyObject_CallOneArg(__pyx_builtin_ValueError, __pyx_t_8); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1456, __pyx_L1_error)
+      __pyx_t_9 = __Pyx_PyObject_CallOneArg(__pyx_builtin_ValueError, __pyx_t_8); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1463, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_9);
       __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
       __Pyx_Raise(__pyx_t_9, 0, 0, 0);
       __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
-      __PYX_ERR(0, 1456, __pyx_L1_error)
+      __PYX_ERR(0, 1463, __pyx_L1_error)
 
-      /* "sat_toolkit/formula.pyx":1455
+      /* "sat_toolkit/formula.pyx":1462
  * 
  *         for i in range(num_xors):
  *             if rhs_view is not None and rhs_view[i] not in [0, 1]:             # <<<<<<<<<<<<<<
  *                 raise ValueError(f"right hand side must be 0 or 1, not {rhs_view[i]}")
  * 
  */
     }
 
-    /* "sat_toolkit/formula.pyx":1461
+    /* "sat_toolkit/formula.pyx":1468
  *             # so we need to flip the first sign if rhs is 0
  *             # (see https://www.msoos.org/xor-clauses/)
  *             if rhs_view is None or rhs_view[i] == 0:             # <<<<<<<<<<<<<<
  *                 packed_args_view[i, 0] *= -1
  * 
  */
     __pyx_t_22 = (((PyObject *) __pyx_v_rhs_view.memview) == Py_None);
@@ -46014,102 +46151,102 @@
     }
     __pyx_t_21 = __pyx_v_i;
     __pyx_t_22 = ((*((int *) ( /* dim=0 */ ((char *) (((int *) __pyx_v_rhs_view.data) + __pyx_t_21)) ))) == 0);
     __pyx_t_15 = __pyx_t_22;
     __pyx_L26_bool_binop_done:;
     if (__pyx_t_15) {
 
-      /* "sat_toolkit/formula.pyx":1462
+      /* "sat_toolkit/formula.pyx":1469
  *             # (see https://www.msoos.org/xor-clauses/)
  *             if rhs_view is None or rhs_view[i] == 0:
  *                 packed_args_view[i, 0] *= -1             # <<<<<<<<<<<<<<
  * 
  *             for j in range(num_args):
  */
       __pyx_t_21 = __pyx_v_i;
       __pyx_t_23 = 0;
       *((int *) ( /* dim=1 */ ((char *) (((int *) ( /* dim=0 */ (__pyx_v_packed_args_view.data + __pyx_t_21 * __pyx_v_packed_args_view.strides[0]) )) + __pyx_t_23)) )) *= -1;
 
-      /* "sat_toolkit/formula.pyx":1461
+      /* "sat_toolkit/formula.pyx":1468
  *             # so we need to flip the first sign if rhs is 0
  *             # (see https://www.msoos.org/xor-clauses/)
  *             if rhs_view is None or rhs_view[i] == 0:             # <<<<<<<<<<<<<<
  *                 packed_args_view[i, 0] *= -1
  * 
  */
     }
 
-    /* "sat_toolkit/formula.pyx":1464
+    /* "sat_toolkit/formula.pyx":1471
  *                 packed_args_view[i, 0] *= -1
  * 
  *             for j in range(num_args):             # <<<<<<<<<<<<<<
  *                 if packed_args_view[i, j] == 0:
  *                     raise ValueError('all indices must be nonzero')
  */
     __pyx_t_21 = __pyx_v_num_args;
     __pyx_t_24 = __pyx_t_21;
     for (__pyx_t_25 = 0; __pyx_t_25 < __pyx_t_24; __pyx_t_25+=1) {
       __pyx_v_j = __pyx_t_25;
 
-      /* "sat_toolkit/formula.pyx":1465
+      /* "sat_toolkit/formula.pyx":1472
  * 
  *             for j in range(num_args):
  *                 if packed_args_view[i, j] == 0:             # <<<<<<<<<<<<<<
  *                     raise ValueError('all indices must be nonzero')
  * 
  */
       __pyx_t_26 = __pyx_v_i;
       __pyx_t_27 = __pyx_v_j;
       __pyx_t_15 = ((*((int *) ( /* dim=1 */ ((char *) (((int *) ( /* dim=0 */ (__pyx_v_packed_args_view.data + __pyx_t_26 * __pyx_v_packed_args_view.strides[0]) )) + __pyx_t_27)) ))) == 0);
       if (unlikely(__pyx_t_15)) {
 
-        /* "sat_toolkit/formula.pyx":1466
+        /* "sat_toolkit/formula.pyx":1473
  *             for j in range(num_args):
  *                 if packed_args_view[i, j] == 0:
  *                     raise ValueError('all indices must be nonzero')             # <<<<<<<<<<<<<<
  * 
  *         cdef XorCNF res = XorCNF.__new__(XorCNF)
  */
-        __pyx_t_9 = __Pyx_PyObject_Call(__pyx_builtin_ValueError, __pyx_tuple__28, NULL); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1466, __pyx_L1_error)
+        __pyx_t_9 = __Pyx_PyObject_Call(__pyx_builtin_ValueError, __pyx_tuple__28, NULL); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1473, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_9);
         __Pyx_Raise(__pyx_t_9, 0, 0, 0);
         __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
-        __PYX_ERR(0, 1466, __pyx_L1_error)
+        __PYX_ERR(0, 1473, __pyx_L1_error)
 
-        /* "sat_toolkit/formula.pyx":1465
+        /* "sat_toolkit/formula.pyx":1472
  * 
  *             for j in range(num_args):
  *                 if packed_args_view[i, j] == 0:             # <<<<<<<<<<<<<<
  *                     raise ValueError('all indices must be nonzero')
  * 
  */
       }
     }
   }
 
-  /* "sat_toolkit/formula.pyx":1468
+  /* "sat_toolkit/formula.pyx":1475
  *                     raise ValueError('all indices must be nonzero')
  * 
  *         cdef XorCNF res = XorCNF.__new__(XorCNF)             # <<<<<<<<<<<<<<
  *         res._xor_clauses._add_clauses(packed_args.reshape(-1))
  *         return res
  */
-  __pyx_t_9 = ((PyObject *)__pyx_tp_new_11sat_toolkit_7formula_XorCNF(((PyTypeObject *)__pyx_ptype_11sat_toolkit_7formula_XorCNF), __pyx_empty_tuple, NULL)); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1468, __pyx_L1_error)
+  __pyx_t_9 = ((PyObject *)__pyx_tp_new_11sat_toolkit_7formula_XorCNF(((PyTypeObject *)__pyx_ptype_11sat_toolkit_7formula_XorCNF), __pyx_empty_tuple, NULL)); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1475, __pyx_L1_error)
   __Pyx_GOTREF((PyObject *)__pyx_t_9);
   __pyx_v_res = ((struct __pyx_obj_11sat_toolkit_7formula_XorCNF *)__pyx_t_9);
   __pyx_t_9 = 0;
 
-  /* "sat_toolkit/formula.pyx":1469
+  /* "sat_toolkit/formula.pyx":1476
  * 
  *         cdef XorCNF res = XorCNF.__new__(XorCNF)
  *         res._xor_clauses._add_clauses(packed_args.reshape(-1))             # <<<<<<<<<<<<<<
  *         return res
  * 
  */
-  __pyx_t_8 = __Pyx_PyObject_GetAttrStr(__pyx_v_packed_args, __pyx_n_s_reshape); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1469, __pyx_L1_error)
+  __pyx_t_8 = __Pyx_PyObject_GetAttrStr(__pyx_v_packed_args, __pyx_n_s_reshape); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1476, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_8);
   __pyx_t_7 = NULL;
   __pyx_t_6 = 0;
   #if CYTHON_UNPACK_METHODS
   if (likely(PyMethod_Check(__pyx_t_8))) {
     __pyx_t_7 = PyMethod_GET_SELF(__pyx_t_8);
     if (likely(__pyx_t_7)) {
@@ -46121,37 +46258,37 @@
     }
   }
   #endif
   {
     PyObject *__pyx_callargs[2] = {__pyx_t_7, __pyx_int_neg_1};
     __pyx_t_9 = __Pyx_PyObject_FastCall(__pyx_t_8, __pyx_callargs+1-__pyx_t_6, 1+__pyx_t_6);
     __Pyx_XDECREF(__pyx_t_7); __pyx_t_7 = 0;
-    if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1469, __pyx_L1_error)
+    if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1476, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_9);
     __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
   }
-  __pyx_t_28 = __Pyx_PyObject_to_MemoryviewSlice_ds_int__const__(__pyx_t_9, 0); if (unlikely(!__pyx_t_28.memview)) __PYX_ERR(0, 1469, __pyx_L1_error)
+  __pyx_t_28 = __Pyx_PyObject_to_MemoryviewSlice_ds_int__const__(__pyx_t_9, 0); if (unlikely(!__pyx_t_28.memview)) __PYX_ERR(0, 1476, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
-  __pyx_t_6 = ((struct __pyx_vtabstruct_11sat_toolkit_7formula_XorClauseList *)__pyx_v_res->_xor_clauses->__pyx_base.__pyx_vtab)->__pyx_base._add_clauses(((struct __pyx_obj_11sat_toolkit_7formula__ClauseList *)__pyx_v_res->_xor_clauses), __pyx_t_28); if (unlikely(__pyx_t_6 == ((int)-1))) __PYX_ERR(0, 1469, __pyx_L1_error)
+  __pyx_t_6 = ((struct __pyx_vtabstruct_11sat_toolkit_7formula_XorClauseList *)__pyx_v_res->_xor_clauses->__pyx_base.__pyx_vtab)->__pyx_base._add_clauses(((struct __pyx_obj_11sat_toolkit_7formula__ClauseList *)__pyx_v_res->_xor_clauses), __pyx_t_28); if (unlikely(__pyx_t_6 == ((int)-1))) __PYX_ERR(0, 1476, __pyx_L1_error)
   __PYX_XCLEAR_MEMVIEW(&__pyx_t_28, 1);
   __pyx_t_28.memview = NULL; __pyx_t_28.data = NULL;
 
-  /* "sat_toolkit/formula.pyx":1470
+  /* "sat_toolkit/formula.pyx":1477
  *         cdef XorCNF res = XorCNF.__new__(XorCNF)
  *         res._xor_clauses._add_clauses(packed_args.reshape(-1))
  *         return res             # <<<<<<<<<<<<<<
  * 
  *     def partition(self) -> tuple[list[CNF], list[XorClauseList]]:
  */
   __Pyx_XDECREF((PyObject *)__pyx_r);
   __Pyx_INCREF((PyObject *)__pyx_v_res);
   __pyx_r = __pyx_v_res;
   goto __pyx_L0;
 
-  /* "sat_toolkit/formula.pyx":1416
+  /* "sat_toolkit/formula.pyx":1423
  *         return XorCNF(clauses=clauses, xor_clauses=xors)
  * 
  *     @staticmethod             # <<<<<<<<<<<<<<
  *     def create_xor(*args, rhs=None) -> XorCNF:
  *         """
  */
 
@@ -46177,15 +46314,15 @@
   __PYX_XCLEAR_MEMVIEW(&__pyx_v_packed_args_view, 1);
   __Pyx_XDECREF((PyObject *)__pyx_v_res);
   __Pyx_XGIVEREF((PyObject *)__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "sat_toolkit/formula.pyx":1472
+/* "sat_toolkit/formula.pyx":1479
  *         return res
  * 
  *     def partition(self) -> tuple[list[CNF], list[XorClauseList]]:             # <<<<<<<<<<<<<<
  *         """
  *         Separately partition the CNF and XorClauseList into a lists of CNFs and
  */
 
@@ -46240,23 +46377,23 @@
   int __pyx_t_4;
   PyObject *__pyx_t_5 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("partition", 1);
 
-  /* "sat_toolkit/formula.pyx":1480
+  /* "sat_toolkit/formula.pyx":1487
  *         containing XorClauseLists.
  *         """
  *         return (self._clauses.partition(), self._xor_clauses.partition())             # <<<<<<<<<<<<<<
  * 
  *     def to_cnf(self) -> CNF:
  */
   __Pyx_XDECREF(__pyx_r);
-  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_self->_clauses), __pyx_n_s_partition); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1480, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_self->_clauses), __pyx_n_s_partition); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1487, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __pyx_t_3 = NULL;
   __pyx_t_4 = 0;
   #if CYTHON_UNPACK_METHODS
   if (likely(PyMethod_Check(__pyx_t_2))) {
     __pyx_t_3 = PyMethod_GET_SELF(__pyx_t_2);
     if (likely(__pyx_t_3)) {
@@ -46268,19 +46405,19 @@
     }
   }
   #endif
   {
     PyObject *__pyx_callargs[2] = {__pyx_t_3, NULL};
     __pyx_t_1 = __Pyx_PyObject_FastCall(__pyx_t_2, __pyx_callargs+1-__pyx_t_4, 0+__pyx_t_4);
     __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
-    if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1480, __pyx_L1_error)
+    if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1487, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   }
-  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_self->_xor_clauses), __pyx_n_s_partition); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1480, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_self->_xor_clauses), __pyx_n_s_partition); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1487, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __pyx_t_5 = NULL;
   __pyx_t_4 = 0;
   #if CYTHON_UNPACK_METHODS
   if (likely(PyMethod_Check(__pyx_t_3))) {
     __pyx_t_5 = PyMethod_GET_SELF(__pyx_t_3);
     if (likely(__pyx_t_5)) {
@@ -46292,31 +46429,31 @@
     }
   }
   #endif
   {
     PyObject *__pyx_callargs[2] = {__pyx_t_5, NULL};
     __pyx_t_2 = __Pyx_PyObject_FastCall(__pyx_t_3, __pyx_callargs+1-__pyx_t_4, 0+__pyx_t_4);
     __Pyx_XDECREF(__pyx_t_5); __pyx_t_5 = 0;
-    if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1480, __pyx_L1_error)
+    if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1487, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   }
-  __pyx_t_3 = PyTuple_New(2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1480, __pyx_L1_error)
+  __pyx_t_3 = PyTuple_New(2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1487, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_GIVEREF(__pyx_t_1);
-  if (__Pyx_PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_t_1)) __PYX_ERR(0, 1480, __pyx_L1_error);
+  if (__Pyx_PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_t_1)) __PYX_ERR(0, 1487, __pyx_L1_error);
   __Pyx_GIVEREF(__pyx_t_2);
-  if (__Pyx_PyTuple_SET_ITEM(__pyx_t_3, 1, __pyx_t_2)) __PYX_ERR(0, 1480, __pyx_L1_error);
+  if (__Pyx_PyTuple_SET_ITEM(__pyx_t_3, 1, __pyx_t_2)) __PYX_ERR(0, 1487, __pyx_L1_error);
   __pyx_t_1 = 0;
   __pyx_t_2 = 0;
   __pyx_r = ((PyObject*)__pyx_t_3);
   __pyx_t_3 = 0;
   goto __pyx_L0;
 
-  /* "sat_toolkit/formula.pyx":1472
+  /* "sat_toolkit/formula.pyx":1479
  *         return res
  * 
  *     def partition(self) -> tuple[list[CNF], list[XorClauseList]]:             # <<<<<<<<<<<<<<
  *         """
  *         Separately partition the CNF and XorClauseList into a lists of CNFs and
  */
 
@@ -46330,15 +46467,15 @@
   __pyx_r = NULL;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "sat_toolkit/formula.pyx":1482
+/* "sat_toolkit/formula.pyx":1489
  *         return (self._clauses.partition(), self._xor_clauses.partition())
  * 
  *     def to_cnf(self) -> CNF:             # <<<<<<<<<<<<<<
  *         cdef CNF res = CNF.__new__(CNF)
  *         cdef size_t idx
  */
 
@@ -46398,87 +46535,87 @@
   __Pyx_memviewslice __pyx_t_7 = { 0, 0, { 0 }, { 0 }, { 0 } };
   struct __pyx_opt_args_11sat_toolkit_7formula_3CNF__add_xor_clause __pyx_t_8;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("to_cnf", 1);
 
-  /* "sat_toolkit/formula.pyx":1483
+  /* "sat_toolkit/formula.pyx":1490
  * 
  *     def to_cnf(self) -> CNF:
  *         cdef CNF res = CNF.__new__(CNF)             # <<<<<<<<<<<<<<
  *         cdef size_t idx
  * 
  */
-  __pyx_t_1 = ((PyObject *)__pyx_tp_new_11sat_toolkit_7formula_CNF(((PyTypeObject *)__pyx_ptype_11sat_toolkit_7formula_CNF), __pyx_empty_tuple, NULL)); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1483, __pyx_L1_error)
+  __pyx_t_1 = ((PyObject *)__pyx_tp_new_11sat_toolkit_7formula_CNF(((PyTypeObject *)__pyx_ptype_11sat_toolkit_7formula_CNF), __pyx_empty_tuple, NULL)); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1490, __pyx_L1_error)
   __Pyx_GOTREF((PyObject *)__pyx_t_1);
   __pyx_v_res = ((struct __pyx_obj_11sat_toolkit_7formula_CNF *)__pyx_t_1);
   __pyx_t_1 = 0;
 
-  /* "sat_toolkit/formula.pyx":1486
+  /* "sat_toolkit/formula.pyx":1493
  *         cdef size_t idx
  * 
  *         res._add_clauses(self._clauses)             # <<<<<<<<<<<<<<
  *         res.nvars = self._nvars()
  * 
  */
-  __pyx_t_2 = __Pyx_PyObject_to_MemoryviewSlice_ds_int__const__(((PyObject *)__pyx_v_self->_clauses), 0); if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 1486, __pyx_L1_error)
-  __pyx_t_3 = ((struct __pyx_vtabstruct_11sat_toolkit_7formula_CNF *)__pyx_v_res->__pyx_base.__pyx_vtab)->__pyx_base._add_clauses(((struct __pyx_obj_11sat_toolkit_7formula__ClauseList *)__pyx_v_res), __pyx_t_2); if (unlikely(__pyx_t_3 == ((int)-1))) __PYX_ERR(0, 1486, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_to_MemoryviewSlice_ds_int__const__(((PyObject *)__pyx_v_self->_clauses), 0); if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 1493, __pyx_L1_error)
+  __pyx_t_3 = ((struct __pyx_vtabstruct_11sat_toolkit_7formula_CNF *)__pyx_v_res->__pyx_base.__pyx_vtab)->__pyx_base._add_clauses(((struct __pyx_obj_11sat_toolkit_7formula__ClauseList *)__pyx_v_res), __pyx_t_2); if (unlikely(__pyx_t_3 == ((int)-1))) __PYX_ERR(0, 1493, __pyx_L1_error)
   __PYX_XCLEAR_MEMVIEW(&__pyx_t_2, 1);
   __pyx_t_2.memview = NULL; __pyx_t_2.data = NULL;
 
-  /* "sat_toolkit/formula.pyx":1487
+  /* "sat_toolkit/formula.pyx":1494
  * 
  *         res._add_clauses(self._clauses)
  *         res.nvars = self._nvars()             # <<<<<<<<<<<<<<
  * 
  *         for idx in range(self._xor_clauses._start_indices.size()):
  */
   __pyx_v_res->__pyx_base.nvars = ((struct __pyx_vtabstruct_11sat_toolkit_7formula_XorCNF *)__pyx_v_self->__pyx_vtab)->_nvars(__pyx_v_self);
 
-  /* "sat_toolkit/formula.pyx":1489
+  /* "sat_toolkit/formula.pyx":1496
  *         res.nvars = self._nvars()
  * 
  *         for idx in range(self._xor_clauses._start_indices.size()):             # <<<<<<<<<<<<<<
  *             res._add_xor_clause(self._xor_clauses._get_clause(idx), rhs=1)
  * 
  */
   __pyx_t_4 = __pyx_v_self->_xor_clauses->__pyx_base._start_indices.size();
   __pyx_t_5 = __pyx_t_4;
   for (__pyx_t_6 = 0; __pyx_t_6 < __pyx_t_5; __pyx_t_6+=1) {
     __pyx_v_idx = __pyx_t_6;
 
-    /* "sat_toolkit/formula.pyx":1490
+    /* "sat_toolkit/formula.pyx":1497
  * 
  *         for idx in range(self._xor_clauses._start_indices.size()):
  *             res._add_xor_clause(self._xor_clauses._get_clause(idx), rhs=1)             # <<<<<<<<<<<<<<
  * 
  *         return res
  */
-    __pyx_t_7 = ((struct __pyx_vtabstruct_11sat_toolkit_7formula_XorClauseList *)__pyx_v_self->_xor_clauses->__pyx_base.__pyx_vtab)->__pyx_base._get_clause(((struct __pyx_obj_11sat_toolkit_7formula__ClauseList *)__pyx_v_self->_xor_clauses), __pyx_v_idx); if (unlikely(!__pyx_t_7.memview)) __PYX_ERR(0, 1490, __pyx_L1_error)
+    __pyx_t_7 = ((struct __pyx_vtabstruct_11sat_toolkit_7formula_XorClauseList *)__pyx_v_self->_xor_clauses->__pyx_base.__pyx_vtab)->__pyx_base._get_clause(((struct __pyx_obj_11sat_toolkit_7formula__ClauseList *)__pyx_v_self->_xor_clauses), __pyx_v_idx); if (unlikely(!__pyx_t_7.memview)) __PYX_ERR(0, 1497, __pyx_L1_error)
     __pyx_t_8.__pyx_n = 1;
     __pyx_t_8.rhs = 1;
-    __pyx_t_3 = ((struct __pyx_vtabstruct_11sat_toolkit_7formula_CNF *)__pyx_v_res->__pyx_base.__pyx_vtab)->_add_xor_clause(__pyx_v_res, __pyx_t_7, &__pyx_t_8); if (unlikely(__pyx_t_3 == ((int)-1))) __PYX_ERR(0, 1490, __pyx_L1_error)
+    __pyx_t_3 = ((struct __pyx_vtabstruct_11sat_toolkit_7formula_CNF *)__pyx_v_res->__pyx_base.__pyx_vtab)->_add_xor_clause(__pyx_v_res, __pyx_t_7, &__pyx_t_8); if (unlikely(__pyx_t_3 == ((int)-1))) __PYX_ERR(0, 1497, __pyx_L1_error)
     __PYX_XCLEAR_MEMVIEW(&__pyx_t_7, 1);
     __pyx_t_7.memview = NULL; __pyx_t_7.data = NULL;
   }
 
-  /* "sat_toolkit/formula.pyx":1492
+  /* "sat_toolkit/formula.pyx":1499
  *             res._add_xor_clause(self._xor_clauses._get_clause(idx), rhs=1)
  * 
  *         return res             # <<<<<<<<<<<<<<
  * 
  *     def add_clauses(self, clauses):
  */
   __Pyx_XDECREF((PyObject *)__pyx_r);
   __Pyx_INCREF((PyObject *)__pyx_v_res);
   __pyx_r = __pyx_v_res;
   goto __pyx_L0;
 
-  /* "sat_toolkit/formula.pyx":1482
+  /* "sat_toolkit/formula.pyx":1489
  *         return (self._clauses.partition(), self._xor_clauses.partition())
  * 
  *     def to_cnf(self) -> CNF:             # <<<<<<<<<<<<<<
  *         cdef CNF res = CNF.__new__(CNF)
  *         cdef size_t idx
  */
 
@@ -46492,15 +46629,15 @@
   __pyx_L0:;
   __Pyx_XDECREF((PyObject *)__pyx_v_res);
   __Pyx_XGIVEREF((PyObject *)__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "sat_toolkit/formula.pyx":1494
+/* "sat_toolkit/formula.pyx":1501
  *         return res
  * 
  *     def add_clauses(self, clauses):             # <<<<<<<<<<<<<<
  *         self._clauses.add_clauses(clauses)
  * 
  */
 
@@ -46554,31 +46691,31 @@
       kw_args = __Pyx_NumKwargs_FASTCALL(__pyx_kwds);
       switch (__pyx_nargs) {
         case  0:
         if (likely((values[0] = __Pyx_GetKwValue_FASTCALL(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_clauses)) != 0)) {
           (void)__Pyx_Arg_NewRef_FASTCALL(values[0]);
           kw_args--;
         }
-        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 1494, __pyx_L3_error)
+        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 1501, __pyx_L3_error)
         else goto __pyx_L5_argtuple_error;
       }
       if (unlikely(kw_args > 0)) {
         const Py_ssize_t kwd_pos_args = __pyx_nargs;
-        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values + 0, kwd_pos_args, "add_clauses") < 0)) __PYX_ERR(0, 1494, __pyx_L3_error)
+        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values + 0, kwd_pos_args, "add_clauses") < 0)) __PYX_ERR(0, 1501, __pyx_L3_error)
       }
     } else if (unlikely(__pyx_nargs != 1)) {
       goto __pyx_L5_argtuple_error;
     } else {
       values[0] = __Pyx_Arg_FASTCALL(__pyx_args, 0);
     }
     __pyx_v_clauses = values[0];
   }
   goto __pyx_L6_skip;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("add_clauses", 1, 1, 1, __pyx_nargs); __PYX_ERR(0, 1494, __pyx_L3_error)
+  __Pyx_RaiseArgtupleInvalid("add_clauses", 1, 1, 1, __pyx_nargs); __PYX_ERR(0, 1501, __pyx_L3_error)
   __pyx_L6_skip:;
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L3_error:;
   {
     Py_ssize_t __pyx_temp;
     for (__pyx_temp=0; __pyx_temp < (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
       __Pyx_Arg_XDECREF_FASTCALL(values[__pyx_temp]);
@@ -46609,22 +46746,22 @@
   PyObject *__pyx_t_3 = NULL;
   int __pyx_t_4;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("add_clauses", 1);
 
-  /* "sat_toolkit/formula.pyx":1495
+  /* "sat_toolkit/formula.pyx":1502
  * 
  *     def add_clauses(self, clauses):
  *         self._clauses.add_clauses(clauses)             # <<<<<<<<<<<<<<
  * 
  *     def add_xor_clauses(self, xor_clauses):
  */
-  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_self->_clauses), __pyx_n_s_add_clauses); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1495, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_self->_clauses), __pyx_n_s_add_clauses); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1502, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __pyx_t_3 = NULL;
   __pyx_t_4 = 0;
   #if CYTHON_UNPACK_METHODS
   if (likely(PyMethod_Check(__pyx_t_2))) {
     __pyx_t_3 = PyMethod_GET_SELF(__pyx_t_2);
     if (likely(__pyx_t_3)) {
@@ -46636,21 +46773,21 @@
     }
   }
   #endif
   {
     PyObject *__pyx_callargs[2] = {__pyx_t_3, __pyx_v_clauses};
     __pyx_t_1 = __Pyx_PyObject_FastCall(__pyx_t_2, __pyx_callargs+1-__pyx_t_4, 1+__pyx_t_4);
     __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
-    if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1495, __pyx_L1_error)
+    if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1502, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   }
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-  /* "sat_toolkit/formula.pyx":1494
+  /* "sat_toolkit/formula.pyx":1501
  *         return res
  * 
  *     def add_clauses(self, clauses):             # <<<<<<<<<<<<<<
  *         self._clauses.add_clauses(clauses)
  * 
  */
 
@@ -46665,15 +46802,15 @@
   __pyx_r = NULL;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "sat_toolkit/formula.pyx":1497
+/* "sat_toolkit/formula.pyx":1504
  *         self._clauses.add_clauses(clauses)
  * 
  *     def add_xor_clauses(self, xor_clauses):             # <<<<<<<<<<<<<<
  *         self._xor_clauses.add_clauses(xor_clauses)
  * 
  */
 
@@ -46727,31 +46864,31 @@
       kw_args = __Pyx_NumKwargs_FASTCALL(__pyx_kwds);
       switch (__pyx_nargs) {
         case  0:
         if (likely((values[0] = __Pyx_GetKwValue_FASTCALL(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_xor_clauses)) != 0)) {
           (void)__Pyx_Arg_NewRef_FASTCALL(values[0]);
           kw_args--;
         }
-        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 1497, __pyx_L3_error)
+        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 1504, __pyx_L3_error)
         else goto __pyx_L5_argtuple_error;
       }
       if (unlikely(kw_args > 0)) {
         const Py_ssize_t kwd_pos_args = __pyx_nargs;
-        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values + 0, kwd_pos_args, "add_xor_clauses") < 0)) __PYX_ERR(0, 1497, __pyx_L3_error)
+        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values + 0, kwd_pos_args, "add_xor_clauses") < 0)) __PYX_ERR(0, 1504, __pyx_L3_error)
       }
     } else if (unlikely(__pyx_nargs != 1)) {
       goto __pyx_L5_argtuple_error;
     } else {
       values[0] = __Pyx_Arg_FASTCALL(__pyx_args, 0);
     }
     __pyx_v_xor_clauses = values[0];
   }
   goto __pyx_L6_skip;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("add_xor_clauses", 1, 1, 1, __pyx_nargs); __PYX_ERR(0, 1497, __pyx_L3_error)
+  __Pyx_RaiseArgtupleInvalid("add_xor_clauses", 1, 1, 1, __pyx_nargs); __PYX_ERR(0, 1504, __pyx_L3_error)
   __pyx_L6_skip:;
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L3_error:;
   {
     Py_ssize_t __pyx_temp;
     for (__pyx_temp=0; __pyx_temp < (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
       __Pyx_Arg_XDECREF_FASTCALL(values[__pyx_temp]);
@@ -46782,22 +46919,22 @@
   PyObject *__pyx_t_3 = NULL;
   int __pyx_t_4;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("add_xor_clauses", 1);
 
-  /* "sat_toolkit/formula.pyx":1498
+  /* "sat_toolkit/formula.pyx":1505
  * 
  *     def add_xor_clauses(self, xor_clauses):
  *         self._xor_clauses.add_clauses(xor_clauses)             # <<<<<<<<<<<<<<
  * 
  *     cdef int _nvars(self) noexcept:
  */
-  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_self->_xor_clauses), __pyx_n_s_add_clauses); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1498, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_self->_xor_clauses), __pyx_n_s_add_clauses); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1505, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __pyx_t_3 = NULL;
   __pyx_t_4 = 0;
   #if CYTHON_UNPACK_METHODS
   if (likely(PyMethod_Check(__pyx_t_2))) {
     __pyx_t_3 = PyMethod_GET_SELF(__pyx_t_2);
     if (likely(__pyx_t_3)) {
@@ -46809,21 +46946,21 @@
     }
   }
   #endif
   {
     PyObject *__pyx_callargs[2] = {__pyx_t_3, __pyx_v_xor_clauses};
     __pyx_t_1 = __Pyx_PyObject_FastCall(__pyx_t_2, __pyx_callargs+1-__pyx_t_4, 1+__pyx_t_4);
     __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
-    if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1498, __pyx_L1_error)
+    if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1505, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   }
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-  /* "sat_toolkit/formula.pyx":1497
+  /* "sat_toolkit/formula.pyx":1504
  *         self._clauses.add_clauses(clauses)
  * 
  *     def add_xor_clauses(self, xor_clauses):             # <<<<<<<<<<<<<<
  *         self._xor_clauses.add_clauses(xor_clauses)
  * 
  */
 
@@ -46838,30 +46975,30 @@
   __pyx_r = NULL;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "sat_toolkit/formula.pyx":1500
+/* "sat_toolkit/formula.pyx":1507
  *         self._xor_clauses.add_clauses(xor_clauses)
  * 
  *     cdef int _nvars(self) noexcept:             # <<<<<<<<<<<<<<
  *         return max(self._clauses.nvars, self._xor_clauses.nvars)
  * 
  */
 
 static int __pyx_f_11sat_toolkit_7formula_6XorCNF__nvars(struct __pyx_obj_11sat_toolkit_7formula_XorCNF *__pyx_v_self) {
   int __pyx_r;
   int __pyx_t_1;
   int __pyx_t_2;
   int __pyx_t_3;
   int __pyx_t_4;
 
-  /* "sat_toolkit/formula.pyx":1501
+  /* "sat_toolkit/formula.pyx":1508
  * 
  *     cdef int _nvars(self) noexcept:
  *         return max(self._clauses.nvars, self._xor_clauses.nvars)             # <<<<<<<<<<<<<<
  * 
  *     @property
  */
   __pyx_t_1 = __pyx_v_self->_xor_clauses->__pyx_base.nvars;
@@ -46871,28 +47008,28 @@
     __pyx_t_3 = __pyx_t_1;
   } else {
     __pyx_t_3 = __pyx_t_2;
   }
   __pyx_r = __pyx_t_3;
   goto __pyx_L0;
 
-  /* "sat_toolkit/formula.pyx":1500
+  /* "sat_toolkit/formula.pyx":1507
  *         self._xor_clauses.add_clauses(xor_clauses)
  * 
  *     cdef int _nvars(self) noexcept:             # <<<<<<<<<<<<<<
  *         return max(self._clauses.nvars, self._xor_clauses.nvars)
  * 
  */
 
   /* function exit code */
   __pyx_L0:;
   return __pyx_r;
 }
 
-/* "sat_toolkit/formula.pyx":1503
+/* "sat_toolkit/formula.pyx":1510
  *         return max(self._clauses.nvars, self._xor_clauses.nvars)
  * 
  *     @property             # <<<<<<<<<<<<<<
  *     def nvars(self) -> int:
  *         return self._nvars()
  */
 
@@ -46916,29 +47053,29 @@
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("__get__", 1);
 
-  /* "sat_toolkit/formula.pyx":1505
+  /* "sat_toolkit/formula.pyx":1512
  *     @property
  *     def nvars(self) -> int:
  *         return self._nvars()             # <<<<<<<<<<<<<<
  * 
  *     @nvars.setter
  */
   __Pyx_XDECREF(__pyx_r);
-  __pyx_t_1 = __Pyx_PyInt_From_int(((struct __pyx_vtabstruct_11sat_toolkit_7formula_XorCNF *)__pyx_v_self->__pyx_vtab)->_nvars(__pyx_v_self)); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1505, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyInt_From_int(((struct __pyx_vtabstruct_11sat_toolkit_7formula_XorCNF *)__pyx_v_self->__pyx_vtab)->_nvars(__pyx_v_self)); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1512, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_r = __pyx_t_1;
   __pyx_t_1 = 0;
   goto __pyx_L0;
 
-  /* "sat_toolkit/formula.pyx":1503
+  /* "sat_toolkit/formula.pyx":1510
  *         return max(self._clauses.nvars, self._xor_clauses.nvars)
  * 
  *     @property             # <<<<<<<<<<<<<<
  *     def nvars(self) -> int:
  *         return self._nvars()
  */
 
@@ -46949,15 +47086,15 @@
   __pyx_r = NULL;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "sat_toolkit/formula.pyx":1507
+/* "sat_toolkit/formula.pyx":1514
  *         return self._nvars()
  * 
  *     @nvars.setter             # <<<<<<<<<<<<<<
  *     def nvars(self, int val):
  *         if val < 0:
  */
 
@@ -46970,15 +47107,15 @@
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   int __pyx_r;
   __Pyx_RefNannyDeclarations
   __Pyx_RefNannySetupContext("__set__ (wrapper)", 0);
   __pyx_kwvalues = __Pyx_KwValues_VARARGS(__pyx_args, __pyx_nargs);
   assert(__pyx_arg_val); {
-    __pyx_v_val = __Pyx_PyInt_As_int(__pyx_arg_val); if (unlikely((__pyx_v_val == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 1508, __pyx_L3_error)
+    __pyx_v_val = __Pyx_PyInt_As_int(__pyx_arg_val); if (unlikely((__pyx_v_val == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 1515, __pyx_L3_error)
   }
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L3_error:;
   __Pyx_AddTraceback("sat_toolkit.formula.XorCNF.nvars.__set__", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __Pyx_RefNannyFinishContext();
   return -1;
   __pyx_L4_argument_unpacking_done:;
@@ -47002,240 +47139,240 @@
   Py_UCS4 __pyx_t_7;
   PyObject *__pyx_t_8 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("__set__", 1);
 
-  /* "sat_toolkit/formula.pyx":1509
+  /* "sat_toolkit/formula.pyx":1516
  *     @nvars.setter
  *     def nvars(self, int val):
  *         if val < 0:             # <<<<<<<<<<<<<<
  *             raise ValueError('nvars must be nonnegative')
  * 
  */
   __pyx_t_1 = (__pyx_v_val < 0);
   if (unlikely(__pyx_t_1)) {
 
-    /* "sat_toolkit/formula.pyx":1510
+    /* "sat_toolkit/formula.pyx":1517
  *     def nvars(self, int val):
  *         if val < 0:
  *             raise ValueError('nvars must be nonnegative')             # <<<<<<<<<<<<<<
  * 
  *         if val >= self._nvars():
  */
-    __pyx_t_2 = __Pyx_PyObject_Call(__pyx_builtin_ValueError, __pyx_tuple__20, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1510, __pyx_L1_error)
+    __pyx_t_2 = __Pyx_PyObject_Call(__pyx_builtin_ValueError, __pyx_tuple__20, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1517, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
     __Pyx_Raise(__pyx_t_2, 0, 0, 0);
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-    __PYX_ERR(0, 1510, __pyx_L1_error)
+    __PYX_ERR(0, 1517, __pyx_L1_error)
 
-    /* "sat_toolkit/formula.pyx":1509
+    /* "sat_toolkit/formula.pyx":1516
  *     @nvars.setter
  *     def nvars(self, int val):
  *         if val < 0:             # <<<<<<<<<<<<<<
  *             raise ValueError('nvars must be nonnegative')
  * 
  */
   }
 
-  /* "sat_toolkit/formula.pyx":1512
+  /* "sat_toolkit/formula.pyx":1519
  *             raise ValueError('nvars must be nonnegative')
  * 
  *         if val >= self._nvars():             # <<<<<<<<<<<<<<
  *             self._clauses.nvars = val
  *             self._xor_clauses.nvars = val
  */
   __pyx_t_1 = (__pyx_v_val >= ((struct __pyx_vtabstruct_11sat_toolkit_7formula_XorCNF *)__pyx_v_self->__pyx_vtab)->_nvars(__pyx_v_self));
   if (__pyx_t_1) {
 
-    /* "sat_toolkit/formula.pyx":1513
+    /* "sat_toolkit/formula.pyx":1520
  * 
  *         if val >= self._nvars():
  *             self._clauses.nvars = val             # <<<<<<<<<<<<<<
  *             self._xor_clauses.nvars = val
  *             return
  */
     __pyx_v_self->_clauses->__pyx_base.nvars = __pyx_v_val;
 
-    /* "sat_toolkit/formula.pyx":1514
+    /* "sat_toolkit/formula.pyx":1521
  *         if val >= self._nvars():
  *             self._clauses.nvars = val
  *             self._xor_clauses.nvars = val             # <<<<<<<<<<<<<<
  *             return
  * 
  */
     __pyx_v_self->_xor_clauses->__pyx_base.nvars = __pyx_v_val;
 
-    /* "sat_toolkit/formula.pyx":1515
+    /* "sat_toolkit/formula.pyx":1522
  *             self._clauses.nvars = val
  *             self._xor_clauses.nvars = val
  *             return             # <<<<<<<<<<<<<<
  * 
  *         cdef size_t i
  */
     __pyx_r = 0;
     goto __pyx_L0;
 
-    /* "sat_toolkit/formula.pyx":1512
+    /* "sat_toolkit/formula.pyx":1519
  *             raise ValueError('nvars must be nonnegative')
  * 
  *         if val >= self._nvars():             # <<<<<<<<<<<<<<
  *             self._clauses.nvars = val
  *             self._xor_clauses.nvars = val
  */
   }
 
-  /* "sat_toolkit/formula.pyx":1518
+  /* "sat_toolkit/formula.pyx":1525
  * 
  *         cdef size_t i
  *         for i in range(self._xor_clauses._clauses.size()):             # <<<<<<<<<<<<<<
  *             if abs(self._xor_clauses._clauses[i]) > val:
  *                 raise ValueError(f'cannot set nvars to {val} as it is too small')
  */
   __pyx_t_3 = __pyx_v_self->_xor_clauses->__pyx_base._clauses.size();
   __pyx_t_4 = __pyx_t_3;
   for (__pyx_t_5 = 0; __pyx_t_5 < __pyx_t_4; __pyx_t_5+=1) {
     __pyx_v_i = __pyx_t_5;
 
-    /* "sat_toolkit/formula.pyx":1519
+    /* "sat_toolkit/formula.pyx":1526
  *         cdef size_t i
  *         for i in range(self._xor_clauses._clauses.size()):
  *             if abs(self._xor_clauses._clauses[i]) > val:             # <<<<<<<<<<<<<<
  *                 raise ValueError(f'cannot set nvars to {val} as it is too small')
  *         for i in range(self._clauses._clauses.size()):
  */
     __pyx_t_1 = (__pyx_f_11sat_toolkit_7formula_abs((__pyx_v_self->_xor_clauses->__pyx_base._clauses[__pyx_v_i])) > __pyx_v_val);
     if (unlikely(__pyx_t_1)) {
 
-      /* "sat_toolkit/formula.pyx":1520
+      /* "sat_toolkit/formula.pyx":1527
  *         for i in range(self._xor_clauses._clauses.size()):
  *             if abs(self._xor_clauses._clauses[i]) > val:
  *                 raise ValueError(f'cannot set nvars to {val} as it is too small')             # <<<<<<<<<<<<<<
  *         for i in range(self._clauses._clauses.size()):
  *             if abs(self._clauses._clauses[i]) > val:
  */
-      __pyx_t_2 = PyTuple_New(3); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1520, __pyx_L1_error)
+      __pyx_t_2 = PyTuple_New(3); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1527, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_2);
       __pyx_t_6 = 0;
       __pyx_t_7 = 127;
       __Pyx_INCREF(__pyx_kp_u_cannot_set_nvars_to);
       __pyx_t_6 += 20;
       __Pyx_GIVEREF(__pyx_kp_u_cannot_set_nvars_to);
       PyTuple_SET_ITEM(__pyx_t_2, 0, __pyx_kp_u_cannot_set_nvars_to);
-      __pyx_t_8 = __Pyx_PyUnicode_From_int(__pyx_v_val, 0, ' ', 'd'); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1520, __pyx_L1_error)
+      __pyx_t_8 = __Pyx_PyUnicode_From_int(__pyx_v_val, 0, ' ', 'd'); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1527, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_8);
       __pyx_t_6 += __Pyx_PyUnicode_GET_LENGTH(__pyx_t_8);
       __Pyx_GIVEREF(__pyx_t_8);
       PyTuple_SET_ITEM(__pyx_t_2, 1, __pyx_t_8);
       __pyx_t_8 = 0;
       __Pyx_INCREF(__pyx_kp_u_as_it_is_too_small);
       __pyx_t_6 += 19;
       __Pyx_GIVEREF(__pyx_kp_u_as_it_is_too_small);
       PyTuple_SET_ITEM(__pyx_t_2, 2, __pyx_kp_u_as_it_is_too_small);
-      __pyx_t_8 = __Pyx_PyUnicode_Join(__pyx_t_2, 3, __pyx_t_6, __pyx_t_7); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1520, __pyx_L1_error)
+      __pyx_t_8 = __Pyx_PyUnicode_Join(__pyx_t_2, 3, __pyx_t_6, __pyx_t_7); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1527, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_8);
       __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-      __pyx_t_2 = __Pyx_PyObject_CallOneArg(__pyx_builtin_ValueError, __pyx_t_8); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1520, __pyx_L1_error)
+      __pyx_t_2 = __Pyx_PyObject_CallOneArg(__pyx_builtin_ValueError, __pyx_t_8); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1527, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_2);
       __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
       __Pyx_Raise(__pyx_t_2, 0, 0, 0);
       __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-      __PYX_ERR(0, 1520, __pyx_L1_error)
+      __PYX_ERR(0, 1527, __pyx_L1_error)
 
-      /* "sat_toolkit/formula.pyx":1519
+      /* "sat_toolkit/formula.pyx":1526
  *         cdef size_t i
  *         for i in range(self._xor_clauses._clauses.size()):
  *             if abs(self._xor_clauses._clauses[i]) > val:             # <<<<<<<<<<<<<<
  *                 raise ValueError(f'cannot set nvars to {val} as it is too small')
  *         for i in range(self._clauses._clauses.size()):
  */
     }
   }
 
-  /* "sat_toolkit/formula.pyx":1521
+  /* "sat_toolkit/formula.pyx":1528
  *             if abs(self._xor_clauses._clauses[i]) > val:
  *                 raise ValueError(f'cannot set nvars to {val} as it is too small')
  *         for i in range(self._clauses._clauses.size()):             # <<<<<<<<<<<<<<
  *             if abs(self._clauses._clauses[i]) > val:
  *                 raise ValueError(f'cannot set nvars to {val} as it is too small')
  */
   __pyx_t_3 = __pyx_v_self->_clauses->__pyx_base._clauses.size();
   __pyx_t_4 = __pyx_t_3;
   for (__pyx_t_5 = 0; __pyx_t_5 < __pyx_t_4; __pyx_t_5+=1) {
     __pyx_v_i = __pyx_t_5;
 
-    /* "sat_toolkit/formula.pyx":1522
+    /* "sat_toolkit/formula.pyx":1529
  *                 raise ValueError(f'cannot set nvars to {val} as it is too small')
  *         for i in range(self._clauses._clauses.size()):
  *             if abs(self._clauses._clauses[i]) > val:             # <<<<<<<<<<<<<<
  *                 raise ValueError(f'cannot set nvars to {val} as it is too small')
  * 
  */
     __pyx_t_1 = (__pyx_f_11sat_toolkit_7formula_abs((__pyx_v_self->_clauses->__pyx_base._clauses[__pyx_v_i])) > __pyx_v_val);
     if (unlikely(__pyx_t_1)) {
 
-      /* "sat_toolkit/formula.pyx":1523
+      /* "sat_toolkit/formula.pyx":1530
  *         for i in range(self._clauses._clauses.size()):
  *             if abs(self._clauses._clauses[i]) > val:
  *                 raise ValueError(f'cannot set nvars to {val} as it is too small')             # <<<<<<<<<<<<<<
  * 
  *         self.nvars = val
  */
-      __pyx_t_2 = PyTuple_New(3); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1523, __pyx_L1_error)
+      __pyx_t_2 = PyTuple_New(3); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1530, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_2);
       __pyx_t_6 = 0;
       __pyx_t_7 = 127;
       __Pyx_INCREF(__pyx_kp_u_cannot_set_nvars_to);
       __pyx_t_6 += 20;
       __Pyx_GIVEREF(__pyx_kp_u_cannot_set_nvars_to);
       PyTuple_SET_ITEM(__pyx_t_2, 0, __pyx_kp_u_cannot_set_nvars_to);
-      __pyx_t_8 = __Pyx_PyUnicode_From_int(__pyx_v_val, 0, ' ', 'd'); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1523, __pyx_L1_error)
+      __pyx_t_8 = __Pyx_PyUnicode_From_int(__pyx_v_val, 0, ' ', 'd'); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1530, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_8);
       __pyx_t_6 += __Pyx_PyUnicode_GET_LENGTH(__pyx_t_8);
       __Pyx_GIVEREF(__pyx_t_8);
       PyTuple_SET_ITEM(__pyx_t_2, 1, __pyx_t_8);
       __pyx_t_8 = 0;
       __Pyx_INCREF(__pyx_kp_u_as_it_is_too_small);
       __pyx_t_6 += 19;
       __Pyx_GIVEREF(__pyx_kp_u_as_it_is_too_small);
       PyTuple_SET_ITEM(__pyx_t_2, 2, __pyx_kp_u_as_it_is_too_small);
-      __pyx_t_8 = __Pyx_PyUnicode_Join(__pyx_t_2, 3, __pyx_t_6, __pyx_t_7); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1523, __pyx_L1_error)
+      __pyx_t_8 = __Pyx_PyUnicode_Join(__pyx_t_2, 3, __pyx_t_6, __pyx_t_7); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1530, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_8);
       __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-      __pyx_t_2 = __Pyx_PyObject_CallOneArg(__pyx_builtin_ValueError, __pyx_t_8); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1523, __pyx_L1_error)
+      __pyx_t_2 = __Pyx_PyObject_CallOneArg(__pyx_builtin_ValueError, __pyx_t_8); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1530, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_2);
       __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
       __Pyx_Raise(__pyx_t_2, 0, 0, 0);
       __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-      __PYX_ERR(0, 1523, __pyx_L1_error)
+      __PYX_ERR(0, 1530, __pyx_L1_error)
 
-      /* "sat_toolkit/formula.pyx":1522
+      /* "sat_toolkit/formula.pyx":1529
  *                 raise ValueError(f'cannot set nvars to {val} as it is too small')
  *         for i in range(self._clauses._clauses.size()):
  *             if abs(self._clauses._clauses[i]) > val:             # <<<<<<<<<<<<<<
  *                 raise ValueError(f'cannot set nvars to {val} as it is too small')
  * 
  */
     }
   }
 
-  /* "sat_toolkit/formula.pyx":1525
+  /* "sat_toolkit/formula.pyx":1532
  *                 raise ValueError(f'cannot set nvars to {val} as it is too small')
  * 
  *         self.nvars = val             # <<<<<<<<<<<<<<
  * 
  *     @property
  */
-  __pyx_t_2 = __Pyx_PyInt_From_int(__pyx_v_val); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1525, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyInt_From_int(__pyx_v_val); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1532, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  if (__Pyx_PyObject_SetAttrStr(((PyObject *)__pyx_v_self), __pyx_n_s_nvars, __pyx_t_2) < 0) __PYX_ERR(0, 1525, __pyx_L1_error)
+  if (__Pyx_PyObject_SetAttrStr(((PyObject *)__pyx_v_self), __pyx_n_s_nvars, __pyx_t_2) < 0) __PYX_ERR(0, 1532, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
 
-  /* "sat_toolkit/formula.pyx":1507
+  /* "sat_toolkit/formula.pyx":1514
  *         return self._nvars()
  * 
  *     @nvars.setter             # <<<<<<<<<<<<<<
  *     def nvars(self, int val):
  *         if val < 0:
  */
 
@@ -47248,15 +47385,15 @@
   __Pyx_AddTraceback("sat_toolkit.formula.XorCNF.nvars.__set__", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __pyx_r = -1;
   __pyx_L0:;
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "sat_toolkit/formula.pyx":1527
+/* "sat_toolkit/formula.pyx":1534
  *         self.nvars = val
  * 
  *     @property             # <<<<<<<<<<<<<<
  *     def nclauses(self) -> int:
  *         return len(self._clauses)
  */
 
@@ -47281,33 +47418,33 @@
   PyObject *__pyx_t_1 = NULL;
   Py_ssize_t __pyx_t_2;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("__get__", 1);
 
-  /* "sat_toolkit/formula.pyx":1529
+  /* "sat_toolkit/formula.pyx":1536
  *     @property
  *     def nclauses(self) -> int:
  *         return len(self._clauses)             # <<<<<<<<<<<<<<
  * 
  *     @property
  */
   __Pyx_XDECREF(__pyx_r);
   __pyx_t_1 = ((PyObject *)__pyx_v_self->_clauses);
   __Pyx_INCREF(__pyx_t_1);
-  __pyx_t_2 = PyObject_Length(__pyx_t_1); if (unlikely(__pyx_t_2 == ((Py_ssize_t)-1))) __PYX_ERR(0, 1529, __pyx_L1_error)
+  __pyx_t_2 = PyObject_Length(__pyx_t_1); if (unlikely(__pyx_t_2 == ((Py_ssize_t)-1))) __PYX_ERR(0, 1536, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  __pyx_t_1 = PyInt_FromSsize_t(__pyx_t_2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1529, __pyx_L1_error)
+  __pyx_t_1 = PyInt_FromSsize_t(__pyx_t_2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1536, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_r = __pyx_t_1;
   __pyx_t_1 = 0;
   goto __pyx_L0;
 
-  /* "sat_toolkit/formula.pyx":1527
+  /* "sat_toolkit/formula.pyx":1534
  *         self.nvars = val
  * 
  *     @property             # <<<<<<<<<<<<<<
  *     def nclauses(self) -> int:
  *         return len(self._clauses)
  */
 
@@ -47318,15 +47455,15 @@
   __pyx_r = NULL;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "sat_toolkit/formula.pyx":1531
+/* "sat_toolkit/formula.pyx":1538
  *         return len(self._clauses)
  * 
  *     @property             # <<<<<<<<<<<<<<
  *     def nxor_clauses(self) -> int:
  *         return len(self._xor_clauses)
  */
 
@@ -47351,33 +47488,33 @@
   PyObject *__pyx_t_1 = NULL;
   Py_ssize_t __pyx_t_2;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("__get__", 1);
 
-  /* "sat_toolkit/formula.pyx":1533
+  /* "sat_toolkit/formula.pyx":1540
  *     @property
  *     def nxor_clauses(self) -> int:
  *         return len(self._xor_clauses)             # <<<<<<<<<<<<<<
  * 
  *     def __repr__(self) -> str:
  */
   __Pyx_XDECREF(__pyx_r);
   __pyx_t_1 = ((PyObject *)__pyx_v_self->_xor_clauses);
   __Pyx_INCREF(__pyx_t_1);
-  __pyx_t_2 = PyObject_Length(__pyx_t_1); if (unlikely(__pyx_t_2 == ((Py_ssize_t)-1))) __PYX_ERR(0, 1533, __pyx_L1_error)
+  __pyx_t_2 = PyObject_Length(__pyx_t_1); if (unlikely(__pyx_t_2 == ((Py_ssize_t)-1))) __PYX_ERR(0, 1540, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  __pyx_t_1 = PyInt_FromSsize_t(__pyx_t_2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1533, __pyx_L1_error)
+  __pyx_t_1 = PyInt_FromSsize_t(__pyx_t_2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1540, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_r = __pyx_t_1;
   __pyx_t_1 = 0;
   goto __pyx_L0;
 
-  /* "sat_toolkit/formula.pyx":1531
+  /* "sat_toolkit/formula.pyx":1538
  *         return len(self._clauses)
  * 
  *     @property             # <<<<<<<<<<<<<<
  *     def nxor_clauses(self) -> int:
  *         return len(self._xor_clauses)
  */
 
@@ -47388,15 +47525,15 @@
   __pyx_r = NULL;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "sat_toolkit/formula.pyx":1535
+/* "sat_toolkit/formula.pyx":1542
  *         return len(self._xor_clauses)
  * 
  *     def __repr__(self) -> str:             # <<<<<<<<<<<<<<
  *         return f'XorCNF over {self._nvars()} variables with {len(self._clauses)} clauses and {len(self._xor_clauses)} xor clauses'
  * 
  */
 
@@ -47424,76 +47561,76 @@
   PyObject *__pyx_t_4 = NULL;
   Py_ssize_t __pyx_t_5;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("__repr__", 1);
 
-  /* "sat_toolkit/formula.pyx":1536
+  /* "sat_toolkit/formula.pyx":1543
  * 
  *     def __repr__(self) -> str:
  *         return f'XorCNF over {self._nvars()} variables with {len(self._clauses)} clauses and {len(self._xor_clauses)} xor clauses'             # <<<<<<<<<<<<<<
  * 
  *     def __str__(self) -> str:
  */
   __Pyx_XDECREF(__pyx_r);
-  __pyx_t_1 = PyTuple_New(7); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1536, __pyx_L1_error)
+  __pyx_t_1 = PyTuple_New(7); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1543, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_t_2 = 0;
   __pyx_t_3 = 127;
   __Pyx_INCREF(__pyx_kp_u_XorCNF_over);
   __pyx_t_2 += 12;
   __Pyx_GIVEREF(__pyx_kp_u_XorCNF_over);
   PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_kp_u_XorCNF_over);
-  __pyx_t_4 = __Pyx_PyUnicode_From_int(((struct __pyx_vtabstruct_11sat_toolkit_7formula_XorCNF *)__pyx_v_self->__pyx_vtab)->_nvars(__pyx_v_self), 0, ' ', 'd'); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1536, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyUnicode_From_int(((struct __pyx_vtabstruct_11sat_toolkit_7formula_XorCNF *)__pyx_v_self->__pyx_vtab)->_nvars(__pyx_v_self), 0, ' ', 'd'); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1543, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __pyx_t_2 += __Pyx_PyUnicode_GET_LENGTH(__pyx_t_4);
   __Pyx_GIVEREF(__pyx_t_4);
   PyTuple_SET_ITEM(__pyx_t_1, 1, __pyx_t_4);
   __pyx_t_4 = 0;
   __Pyx_INCREF(__pyx_kp_u_variables_with);
   __pyx_t_2 += 16;
   __Pyx_GIVEREF(__pyx_kp_u_variables_with);
   PyTuple_SET_ITEM(__pyx_t_1, 2, __pyx_kp_u_variables_with);
   __pyx_t_4 = ((PyObject *)__pyx_v_self->_clauses);
   __Pyx_INCREF(__pyx_t_4);
-  __pyx_t_5 = PyObject_Length(__pyx_t_4); if (unlikely(__pyx_t_5 == ((Py_ssize_t)-1))) __PYX_ERR(0, 1536, __pyx_L1_error)
+  __pyx_t_5 = PyObject_Length(__pyx_t_4); if (unlikely(__pyx_t_5 == ((Py_ssize_t)-1))) __PYX_ERR(0, 1543, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-  __pyx_t_4 = __Pyx_PyUnicode_From_Py_ssize_t(__pyx_t_5, 0, ' ', 'd'); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1536, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyUnicode_From_Py_ssize_t(__pyx_t_5, 0, ' ', 'd'); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1543, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __pyx_t_2 += __Pyx_PyUnicode_GET_LENGTH(__pyx_t_4);
   __Pyx_GIVEREF(__pyx_t_4);
   PyTuple_SET_ITEM(__pyx_t_1, 3, __pyx_t_4);
   __pyx_t_4 = 0;
   __Pyx_INCREF(__pyx_kp_u_clauses_and);
   __pyx_t_2 += 13;
   __Pyx_GIVEREF(__pyx_kp_u_clauses_and);
   PyTuple_SET_ITEM(__pyx_t_1, 4, __pyx_kp_u_clauses_and);
   __pyx_t_4 = ((PyObject *)__pyx_v_self->_xor_clauses);
   __Pyx_INCREF(__pyx_t_4);
-  __pyx_t_5 = PyObject_Length(__pyx_t_4); if (unlikely(__pyx_t_5 == ((Py_ssize_t)-1))) __PYX_ERR(0, 1536, __pyx_L1_error)
+  __pyx_t_5 = PyObject_Length(__pyx_t_4); if (unlikely(__pyx_t_5 == ((Py_ssize_t)-1))) __PYX_ERR(0, 1543, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-  __pyx_t_4 = __Pyx_PyUnicode_From_Py_ssize_t(__pyx_t_5, 0, ' ', 'd'); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1536, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyUnicode_From_Py_ssize_t(__pyx_t_5, 0, ' ', 'd'); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1543, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __pyx_t_2 += __Pyx_PyUnicode_GET_LENGTH(__pyx_t_4);
   __Pyx_GIVEREF(__pyx_t_4);
   PyTuple_SET_ITEM(__pyx_t_1, 5, __pyx_t_4);
   __pyx_t_4 = 0;
   __Pyx_INCREF(__pyx_kp_u_xor_clauses_2);
   __pyx_t_2 += 12;
   __Pyx_GIVEREF(__pyx_kp_u_xor_clauses_2);
   PyTuple_SET_ITEM(__pyx_t_1, 6, __pyx_kp_u_xor_clauses_2);
-  __pyx_t_4 = __Pyx_PyUnicode_Join(__pyx_t_1, 7, __pyx_t_2, __pyx_t_3); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1536, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyUnicode_Join(__pyx_t_1, 7, __pyx_t_2, __pyx_t_3); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1543, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __pyx_r = __pyx_t_4;
   __pyx_t_4 = 0;
   goto __pyx_L0;
 
-  /* "sat_toolkit/formula.pyx":1535
+  /* "sat_toolkit/formula.pyx":1542
  *         return len(self._xor_clauses)
  * 
  *     def __repr__(self) -> str:             # <<<<<<<<<<<<<<
  *         return f'XorCNF over {self._nvars()} variables with {len(self._clauses)} clauses and {len(self._xor_clauses)} xor clauses'
  * 
  */
 
@@ -47505,15 +47642,15 @@
   __pyx_r = NULL;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "sat_toolkit/formula.pyx":1538
+/* "sat_toolkit/formula.pyx":1545
  *         return f'XorCNF over {self._nvars()} variables with {len(self._clauses)} clauses and {len(self._xor_clauses)} xor clauses'
  * 
  *     def __str__(self) -> str:             # <<<<<<<<<<<<<<
  *         return self.to_dimacs().rstrip()
  * 
  */
 
@@ -47541,23 +47678,23 @@
   PyObject *__pyx_t_4 = NULL;
   int __pyx_t_5;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("__str__", 1);
 
-  /* "sat_toolkit/formula.pyx":1539
+  /* "sat_toolkit/formula.pyx":1546
  * 
  *     def __str__(self) -> str:
  *         return self.to_dimacs().rstrip()             # <<<<<<<<<<<<<<
  * 
  *     def __iadd__(self, other):
  */
   __Pyx_XDECREF(__pyx_r);
-  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_self), __pyx_n_s_to_dimacs); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1539, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_self), __pyx_n_s_to_dimacs); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1546, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __pyx_t_4 = NULL;
   __pyx_t_5 = 0;
   #if CYTHON_UNPACK_METHODS
   if (likely(PyMethod_Check(__pyx_t_3))) {
     __pyx_t_4 = PyMethod_GET_SELF(__pyx_t_3);
     if (likely(__pyx_t_4)) {
@@ -47569,19 +47706,19 @@
     }
   }
   #endif
   {
     PyObject *__pyx_callargs[2] = {__pyx_t_4, NULL};
     __pyx_t_2 = __Pyx_PyObject_FastCall(__pyx_t_3, __pyx_callargs+1-__pyx_t_5, 0+__pyx_t_5);
     __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
-    if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1539, __pyx_L1_error)
+    if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1546, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   }
-  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_rstrip); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1539, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_rstrip); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1546, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   __pyx_t_2 = NULL;
   __pyx_t_5 = 0;
   #if CYTHON_UNPACK_METHODS
   if (likely(PyMethod_Check(__pyx_t_3))) {
     __pyx_t_2 = PyMethod_GET_SELF(__pyx_t_3);
@@ -47594,23 +47731,23 @@
     }
   }
   #endif
   {
     PyObject *__pyx_callargs[2] = {__pyx_t_2, NULL};
     __pyx_t_1 = __Pyx_PyObject_FastCall(__pyx_t_3, __pyx_callargs+1-__pyx_t_5, 0+__pyx_t_5);
     __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
-    if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1539, __pyx_L1_error)
+    if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1546, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   }
   __pyx_r = __pyx_t_1;
   __pyx_t_1 = 0;
   goto __pyx_L0;
 
-  /* "sat_toolkit/formula.pyx":1538
+  /* "sat_toolkit/formula.pyx":1545
  *         return f'XorCNF over {self._nvars()} variables with {len(self._clauses)} clauses and {len(self._xor_clauses)} xor clauses'
  * 
  *     def __str__(self) -> str:             # <<<<<<<<<<<<<<
  *         return self.to_dimacs().rstrip()
  * 
  */
 
@@ -47624,15 +47761,15 @@
   __pyx_r = NULL;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "sat_toolkit/formula.pyx":1541
+/* "sat_toolkit/formula.pyx":1548
  *         return self.to_dimacs().rstrip()
  * 
  *     def __iadd__(self, other):             # <<<<<<<<<<<<<<
  *         if isinstance(other, CNF):
  *             self._clauses._add_clauses(other)
  */
 
@@ -47665,37 +47802,37 @@
   PyObject *__pyx_t_9 = NULL;
   PyObject *__pyx_t_10 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("__iadd__", 1);
 
-  /* "sat_toolkit/formula.pyx":1542
+  /* "sat_toolkit/formula.pyx":1549
  * 
  *     def __iadd__(self, other):
  *         if isinstance(other, CNF):             # <<<<<<<<<<<<<<
  *             self._clauses._add_clauses(other)
  *             self._clauses.nvars = max(self._nvars(), (<CNF> other).nvars)
  */
   __pyx_t_1 = __Pyx_TypeCheck(__pyx_v_other, __pyx_ptype_11sat_toolkit_7formula_CNF); 
   if (__pyx_t_1) {
 
-    /* "sat_toolkit/formula.pyx":1543
+    /* "sat_toolkit/formula.pyx":1550
  *     def __iadd__(self, other):
  *         if isinstance(other, CNF):
  *             self._clauses._add_clauses(other)             # <<<<<<<<<<<<<<
  *             self._clauses.nvars = max(self._nvars(), (<CNF> other).nvars)
  *         elif isinstance(other, XorClauseList):
  */
-    __pyx_t_2 = __Pyx_PyObject_to_MemoryviewSlice_ds_int__const__(__pyx_v_other, 0); if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 1543, __pyx_L1_error)
-    __pyx_t_3 = ((struct __pyx_vtabstruct_11sat_toolkit_7formula_CNF *)__pyx_v_self->_clauses->__pyx_base.__pyx_vtab)->__pyx_base._add_clauses(((struct __pyx_obj_11sat_toolkit_7formula__ClauseList *)__pyx_v_self->_clauses), __pyx_t_2); if (unlikely(__pyx_t_3 == ((int)-1))) __PYX_ERR(0, 1543, __pyx_L1_error)
+    __pyx_t_2 = __Pyx_PyObject_to_MemoryviewSlice_ds_int__const__(__pyx_v_other, 0); if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 1550, __pyx_L1_error)
+    __pyx_t_3 = ((struct __pyx_vtabstruct_11sat_toolkit_7formula_CNF *)__pyx_v_self->_clauses->__pyx_base.__pyx_vtab)->__pyx_base._add_clauses(((struct __pyx_obj_11sat_toolkit_7formula__ClauseList *)__pyx_v_self->_clauses), __pyx_t_2); if (unlikely(__pyx_t_3 == ((int)-1))) __PYX_ERR(0, 1550, __pyx_L1_error)
     __PYX_XCLEAR_MEMVIEW(&__pyx_t_2, 1);
     __pyx_t_2.memview = NULL; __pyx_t_2.data = NULL;
 
-    /* "sat_toolkit/formula.pyx":1544
+    /* "sat_toolkit/formula.pyx":1551
  *         if isinstance(other, CNF):
  *             self._clauses._add_clauses(other)
  *             self._clauses.nvars = max(self._nvars(), (<CNF> other).nvars)             # <<<<<<<<<<<<<<
  *         elif isinstance(other, XorClauseList):
  *             self._xor_clauses._add_clauses(other)
  */
     __pyx_t_3 = ((struct __pyx_obj_11sat_toolkit_7formula_CNF *)__pyx_v_other)->__pyx_base.nvars;
@@ -47704,47 +47841,47 @@
     if (__pyx_t_1) {
       __pyx_t_5 = __pyx_t_3;
     } else {
       __pyx_t_5 = __pyx_t_4;
     }
     __pyx_v_self->_clauses->__pyx_base.nvars = __pyx_t_5;
 
-    /* "sat_toolkit/formula.pyx":1542
+    /* "sat_toolkit/formula.pyx":1549
  * 
  *     def __iadd__(self, other):
  *         if isinstance(other, CNF):             # <<<<<<<<<<<<<<
  *             self._clauses._add_clauses(other)
  *             self._clauses.nvars = max(self._nvars(), (<CNF> other).nvars)
  */
     goto __pyx_L3;
   }
 
-  /* "sat_toolkit/formula.pyx":1545
+  /* "sat_toolkit/formula.pyx":1552
  *             self._clauses._add_clauses(other)
  *             self._clauses.nvars = max(self._nvars(), (<CNF> other).nvars)
  *         elif isinstance(other, XorClauseList):             # <<<<<<<<<<<<<<
  *             self._xor_clauses._add_clauses(other)
  *             self._xor_clauses.nvars = max(self._nvars(), (<XorClauseList> other).nvars)
  */
   __pyx_t_1 = __Pyx_TypeCheck(__pyx_v_other, __pyx_ptype_11sat_toolkit_7formula_XorClauseList); 
   if (__pyx_t_1) {
 
-    /* "sat_toolkit/formula.pyx":1546
+    /* "sat_toolkit/formula.pyx":1553
  *             self._clauses.nvars = max(self._nvars(), (<CNF> other).nvars)
  *         elif isinstance(other, XorClauseList):
  *             self._xor_clauses._add_clauses(other)             # <<<<<<<<<<<<<<
  *             self._xor_clauses.nvars = max(self._nvars(), (<XorClauseList> other).nvars)
  *         elif isinstance(other, XorCNF):
  */
-    __pyx_t_2 = __Pyx_PyObject_to_MemoryviewSlice_ds_int__const__(__pyx_v_other, 0); if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 1546, __pyx_L1_error)
-    __pyx_t_5 = ((struct __pyx_vtabstruct_11sat_toolkit_7formula_XorClauseList *)__pyx_v_self->_xor_clauses->__pyx_base.__pyx_vtab)->__pyx_base._add_clauses(((struct __pyx_obj_11sat_toolkit_7formula__ClauseList *)__pyx_v_self->_xor_clauses), __pyx_t_2); if (unlikely(__pyx_t_5 == ((int)-1))) __PYX_ERR(0, 1546, __pyx_L1_error)
+    __pyx_t_2 = __Pyx_PyObject_to_MemoryviewSlice_ds_int__const__(__pyx_v_other, 0); if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 1553, __pyx_L1_error)
+    __pyx_t_5 = ((struct __pyx_vtabstruct_11sat_toolkit_7formula_XorClauseList *)__pyx_v_self->_xor_clauses->__pyx_base.__pyx_vtab)->__pyx_base._add_clauses(((struct __pyx_obj_11sat_toolkit_7formula__ClauseList *)__pyx_v_self->_xor_clauses), __pyx_t_2); if (unlikely(__pyx_t_5 == ((int)-1))) __PYX_ERR(0, 1553, __pyx_L1_error)
     __PYX_XCLEAR_MEMVIEW(&__pyx_t_2, 1);
     __pyx_t_2.memview = NULL; __pyx_t_2.data = NULL;
 
-    /* "sat_toolkit/formula.pyx":1547
+    /* "sat_toolkit/formula.pyx":1554
  *         elif isinstance(other, XorClauseList):
  *             self._xor_clauses._add_clauses(other)
  *             self._xor_clauses.nvars = max(self._nvars(), (<XorClauseList> other).nvars)             # <<<<<<<<<<<<<<
  *         elif isinstance(other, XorCNF):
  *             self._clauses._add_clauses((<XorCNF> other)._clauses)
  */
     __pyx_t_5 = ((struct __pyx_obj_11sat_toolkit_7formula_XorClauseList *)__pyx_v_other)->__pyx_base.nvars;
@@ -47753,59 +47890,59 @@
     if (__pyx_t_1) {
       __pyx_t_4 = __pyx_t_5;
     } else {
       __pyx_t_4 = __pyx_t_3;
     }
     __pyx_v_self->_xor_clauses->__pyx_base.nvars = __pyx_t_4;
 
-    /* "sat_toolkit/formula.pyx":1545
+    /* "sat_toolkit/formula.pyx":1552
  *             self._clauses._add_clauses(other)
  *             self._clauses.nvars = max(self._nvars(), (<CNF> other).nvars)
  *         elif isinstance(other, XorClauseList):             # <<<<<<<<<<<<<<
  *             self._xor_clauses._add_clauses(other)
  *             self._xor_clauses.nvars = max(self._nvars(), (<XorClauseList> other).nvars)
  */
     goto __pyx_L3;
   }
 
-  /* "sat_toolkit/formula.pyx":1548
+  /* "sat_toolkit/formula.pyx":1555
  *             self._xor_clauses._add_clauses(other)
  *             self._xor_clauses.nvars = max(self._nvars(), (<XorClauseList> other).nvars)
  *         elif isinstance(other, XorCNF):             # <<<<<<<<<<<<<<
  *             self._clauses._add_clauses((<XorCNF> other)._clauses)
  *             self._xor_clauses._add_clauses((<XorCNF> other)._xor_clauses)
  */
   __pyx_t_1 = __Pyx_TypeCheck(__pyx_v_other, __pyx_ptype_11sat_toolkit_7formula_XorCNF); 
   if (likely(__pyx_t_1)) {
 
-    /* "sat_toolkit/formula.pyx":1549
+    /* "sat_toolkit/formula.pyx":1556
  *             self._xor_clauses.nvars = max(self._nvars(), (<XorClauseList> other).nvars)
  *         elif isinstance(other, XorCNF):
  *             self._clauses._add_clauses((<XorCNF> other)._clauses)             # <<<<<<<<<<<<<<
  *             self._xor_clauses._add_clauses((<XorCNF> other)._xor_clauses)
  *             self._clauses.nvars = max(self._nvars(), (<XorCNF> other)._nvars())
  */
-    __pyx_t_2 = __Pyx_PyObject_to_MemoryviewSlice_ds_int__const__(((PyObject *)((struct __pyx_obj_11sat_toolkit_7formula_XorCNF *)__pyx_v_other)->_clauses), 0); if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 1549, __pyx_L1_error)
-    __pyx_t_4 = ((struct __pyx_vtabstruct_11sat_toolkit_7formula_CNF *)__pyx_v_self->_clauses->__pyx_base.__pyx_vtab)->__pyx_base._add_clauses(((struct __pyx_obj_11sat_toolkit_7formula__ClauseList *)__pyx_v_self->_clauses), __pyx_t_2); if (unlikely(__pyx_t_4 == ((int)-1))) __PYX_ERR(0, 1549, __pyx_L1_error)
+    __pyx_t_2 = __Pyx_PyObject_to_MemoryviewSlice_ds_int__const__(((PyObject *)((struct __pyx_obj_11sat_toolkit_7formula_XorCNF *)__pyx_v_other)->_clauses), 0); if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 1556, __pyx_L1_error)
+    __pyx_t_4 = ((struct __pyx_vtabstruct_11sat_toolkit_7formula_CNF *)__pyx_v_self->_clauses->__pyx_base.__pyx_vtab)->__pyx_base._add_clauses(((struct __pyx_obj_11sat_toolkit_7formula__ClauseList *)__pyx_v_self->_clauses), __pyx_t_2); if (unlikely(__pyx_t_4 == ((int)-1))) __PYX_ERR(0, 1556, __pyx_L1_error)
     __PYX_XCLEAR_MEMVIEW(&__pyx_t_2, 1);
     __pyx_t_2.memview = NULL; __pyx_t_2.data = NULL;
 
-    /* "sat_toolkit/formula.pyx":1550
+    /* "sat_toolkit/formula.pyx":1557
  *         elif isinstance(other, XorCNF):
  *             self._clauses._add_clauses((<XorCNF> other)._clauses)
  *             self._xor_clauses._add_clauses((<XorCNF> other)._xor_clauses)             # <<<<<<<<<<<<<<
  *             self._clauses.nvars = max(self._nvars(), (<XorCNF> other)._nvars())
  *             self._xor_clauses.nvars = max(self._nvars(), (<XorCNF> other)._nvars())
  */
-    __pyx_t_2 = __Pyx_PyObject_to_MemoryviewSlice_ds_int__const__(((PyObject *)((struct __pyx_obj_11sat_toolkit_7formula_XorCNF *)__pyx_v_other)->_xor_clauses), 0); if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 1550, __pyx_L1_error)
-    __pyx_t_4 = ((struct __pyx_vtabstruct_11sat_toolkit_7formula_XorClauseList *)__pyx_v_self->_xor_clauses->__pyx_base.__pyx_vtab)->__pyx_base._add_clauses(((struct __pyx_obj_11sat_toolkit_7formula__ClauseList *)__pyx_v_self->_xor_clauses), __pyx_t_2); if (unlikely(__pyx_t_4 == ((int)-1))) __PYX_ERR(0, 1550, __pyx_L1_error)
+    __pyx_t_2 = __Pyx_PyObject_to_MemoryviewSlice_ds_int__const__(((PyObject *)((struct __pyx_obj_11sat_toolkit_7formula_XorCNF *)__pyx_v_other)->_xor_clauses), 0); if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 1557, __pyx_L1_error)
+    __pyx_t_4 = ((struct __pyx_vtabstruct_11sat_toolkit_7formula_XorClauseList *)__pyx_v_self->_xor_clauses->__pyx_base.__pyx_vtab)->__pyx_base._add_clauses(((struct __pyx_obj_11sat_toolkit_7formula__ClauseList *)__pyx_v_self->_xor_clauses), __pyx_t_2); if (unlikely(__pyx_t_4 == ((int)-1))) __PYX_ERR(0, 1557, __pyx_L1_error)
     __PYX_XCLEAR_MEMVIEW(&__pyx_t_2, 1);
     __pyx_t_2.memview = NULL; __pyx_t_2.data = NULL;
 
-    /* "sat_toolkit/formula.pyx":1551
+    /* "sat_toolkit/formula.pyx":1558
  *             self._clauses._add_clauses((<XorCNF> other)._clauses)
  *             self._xor_clauses._add_clauses((<XorCNF> other)._xor_clauses)
  *             self._clauses.nvars = max(self._nvars(), (<XorCNF> other)._nvars())             # <<<<<<<<<<<<<<
  *             self._xor_clauses.nvars = max(self._nvars(), (<XorCNF> other)._nvars())
  *         else:
  */
     __pyx_t_4 = ((struct __pyx_vtabstruct_11sat_toolkit_7formula_XorCNF *)((struct __pyx_obj_11sat_toolkit_7formula_XorCNF *)__pyx_v_other)->__pyx_vtab)->_nvars(((struct __pyx_obj_11sat_toolkit_7formula_XorCNF *)__pyx_v_other));
@@ -47814,15 +47951,15 @@
     if (__pyx_t_1) {
       __pyx_t_3 = __pyx_t_4;
     } else {
       __pyx_t_3 = __pyx_t_5;
     }
     __pyx_v_self->_clauses->__pyx_base.nvars = __pyx_t_3;
 
-    /* "sat_toolkit/formula.pyx":1552
+    /* "sat_toolkit/formula.pyx":1559
  *             self._xor_clauses._add_clauses((<XorCNF> other)._xor_clauses)
  *             self._clauses.nvars = max(self._nvars(), (<XorCNF> other)._nvars())
  *             self._xor_clauses.nvars = max(self._nvars(), (<XorCNF> other)._nvars())             # <<<<<<<<<<<<<<
  *         else:
  *             raise ValueError(f'cannot add {type(other).__name__} to {type(self).__name__}')
  */
     __pyx_t_3 = ((struct __pyx_vtabstruct_11sat_toolkit_7formula_XorCNF *)((struct __pyx_obj_11sat_toolkit_7formula_XorCNF *)__pyx_v_other)->__pyx_vtab)->_nvars(((struct __pyx_obj_11sat_toolkit_7formula_XorCNF *)__pyx_v_other));
@@ -47831,89 +47968,89 @@
     if (__pyx_t_1) {
       __pyx_t_5 = __pyx_t_3;
     } else {
       __pyx_t_5 = __pyx_t_4;
     }
     __pyx_v_self->_xor_clauses->__pyx_base.nvars = __pyx_t_5;
 
-    /* "sat_toolkit/formula.pyx":1548
+    /* "sat_toolkit/formula.pyx":1555
  *             self._xor_clauses._add_clauses(other)
  *             self._xor_clauses.nvars = max(self._nvars(), (<XorClauseList> other).nvars)
  *         elif isinstance(other, XorCNF):             # <<<<<<<<<<<<<<
  *             self._clauses._add_clauses((<XorCNF> other)._clauses)
  *             self._xor_clauses._add_clauses((<XorCNF> other)._xor_clauses)
  */
     goto __pyx_L3;
   }
 
-  /* "sat_toolkit/formula.pyx":1554
+  /* "sat_toolkit/formula.pyx":1561
  *             self._xor_clauses.nvars = max(self._nvars(), (<XorCNF> other)._nvars())
  *         else:
  *             raise ValueError(f'cannot add {type(other).__name__} to {type(self).__name__}')             # <<<<<<<<<<<<<<
  * 
  *         return self
  */
   /*else*/ {
-    __pyx_t_6 = PyTuple_New(4); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1554, __pyx_L1_error)
+    __pyx_t_6 = PyTuple_New(4); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1561, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
     __pyx_t_7 = 0;
     __pyx_t_8 = 127;
     __Pyx_INCREF(__pyx_kp_u_cannot_add);
     __pyx_t_7 += 11;
     __Pyx_GIVEREF(__pyx_kp_u_cannot_add);
     PyTuple_SET_ITEM(__pyx_t_6, 0, __pyx_kp_u_cannot_add);
-    __pyx_t_9 = __Pyx_PyObject_GetAttrStr(((PyObject *)Py_TYPE(__pyx_v_other)), __pyx_n_s_name_2); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1554, __pyx_L1_error)
+    __pyx_t_9 = __Pyx_PyObject_GetAttrStr(((PyObject *)Py_TYPE(__pyx_v_other)), __pyx_n_s_name_2); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1561, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_9);
-    __pyx_t_10 = __Pyx_PyObject_FormatSimple(__pyx_t_9, __pyx_empty_unicode); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1554, __pyx_L1_error)
+    __pyx_t_10 = __Pyx_PyObject_FormatSimple(__pyx_t_9, __pyx_empty_unicode); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1561, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_10);
     __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
     __pyx_t_8 = (__Pyx_PyUnicode_MAX_CHAR_VALUE(__pyx_t_10) > __pyx_t_8) ? __Pyx_PyUnicode_MAX_CHAR_VALUE(__pyx_t_10) : __pyx_t_8;
     __pyx_t_7 += __Pyx_PyUnicode_GET_LENGTH(__pyx_t_10);
     __Pyx_GIVEREF(__pyx_t_10);
     PyTuple_SET_ITEM(__pyx_t_6, 1, __pyx_t_10);
     __pyx_t_10 = 0;
     __Pyx_INCREF(__pyx_kp_u_to);
     __pyx_t_7 += 4;
     __Pyx_GIVEREF(__pyx_kp_u_to);
     PyTuple_SET_ITEM(__pyx_t_6, 2, __pyx_kp_u_to);
-    __pyx_t_10 = __Pyx_PyObject_GetAttrStr(((PyObject *)Py_TYPE(((PyObject *)__pyx_v_self))), __pyx_n_s_name_2); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1554, __pyx_L1_error)
+    __pyx_t_10 = __Pyx_PyObject_GetAttrStr(((PyObject *)Py_TYPE(((PyObject *)__pyx_v_self))), __pyx_n_s_name_2); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1561, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_10);
-    __pyx_t_9 = __Pyx_PyObject_FormatSimple(__pyx_t_10, __pyx_empty_unicode); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1554, __pyx_L1_error)
+    __pyx_t_9 = __Pyx_PyObject_FormatSimple(__pyx_t_10, __pyx_empty_unicode); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1561, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_9);
     __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
     __pyx_t_8 = (__Pyx_PyUnicode_MAX_CHAR_VALUE(__pyx_t_9) > __pyx_t_8) ? __Pyx_PyUnicode_MAX_CHAR_VALUE(__pyx_t_9) : __pyx_t_8;
     __pyx_t_7 += __Pyx_PyUnicode_GET_LENGTH(__pyx_t_9);
     __Pyx_GIVEREF(__pyx_t_9);
     PyTuple_SET_ITEM(__pyx_t_6, 3, __pyx_t_9);
     __pyx_t_9 = 0;
-    __pyx_t_9 = __Pyx_PyUnicode_Join(__pyx_t_6, 4, __pyx_t_7, __pyx_t_8); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1554, __pyx_L1_error)
+    __pyx_t_9 = __Pyx_PyUnicode_Join(__pyx_t_6, 4, __pyx_t_7, __pyx_t_8); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1561, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_9);
     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-    __pyx_t_6 = __Pyx_PyObject_CallOneArg(__pyx_builtin_ValueError, __pyx_t_9); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1554, __pyx_L1_error)
+    __pyx_t_6 = __Pyx_PyObject_CallOneArg(__pyx_builtin_ValueError, __pyx_t_9); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1561, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
     __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
     __Pyx_Raise(__pyx_t_6, 0, 0, 0);
     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-    __PYX_ERR(0, 1554, __pyx_L1_error)
+    __PYX_ERR(0, 1561, __pyx_L1_error)
   }
   __pyx_L3:;
 
-  /* "sat_toolkit/formula.pyx":1556
+  /* "sat_toolkit/formula.pyx":1563
  *             raise ValueError(f'cannot add {type(other).__name__} to {type(self).__name__}')
  * 
  *         return self             # <<<<<<<<<<<<<<
  * 
  *     def __add__(self, other) -> Self:
  */
   __Pyx_XDECREF(__pyx_r);
   __Pyx_INCREF((PyObject *)__pyx_v_self);
   __pyx_r = ((PyObject *)__pyx_v_self);
   goto __pyx_L0;
 
-  /* "sat_toolkit/formula.pyx":1541
+  /* "sat_toolkit/formula.pyx":1548
  *         return self.to_dimacs().rstrip()
  * 
  *     def __iadd__(self, other):             # <<<<<<<<<<<<<<
  *         if isinstance(other, CNF):
  *             self._clauses._add_clauses(other)
  */
 
@@ -47927,15 +48064,15 @@
   __pyx_r = NULL;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "sat_toolkit/formula.pyx":1558
+/* "sat_toolkit/formula.pyx":1565
  *         return self
  * 
  *     def __add__(self, other) -> Self:             # <<<<<<<<<<<<<<
  *         cdef XorCNF res = type(self).__new__(type(self))
  *         res += self
  */
 
@@ -47963,22 +48100,22 @@
   PyObject *__pyx_t_3 = NULL;
   int __pyx_t_4;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("__add__", 1);
 
-  /* "sat_toolkit/formula.pyx":1559
+  /* "sat_toolkit/formula.pyx":1566
  * 
  *     def __add__(self, other) -> Self:
  *         cdef XorCNF res = type(self).__new__(type(self))             # <<<<<<<<<<<<<<
  *         res += self
  *         res += other
  */
-  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(((PyObject *)Py_TYPE(((PyObject *)__pyx_v_self))), __pyx_n_s_new); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1559, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(((PyObject *)Py_TYPE(((PyObject *)__pyx_v_self))), __pyx_n_s_new); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1566, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __pyx_t_3 = NULL;
   __pyx_t_4 = 0;
   #if CYTHON_UNPACK_METHODS
   if (likely(PyMethod_Check(__pyx_t_2))) {
     __pyx_t_3 = PyMethod_GET_SELF(__pyx_t_2);
     if (likely(__pyx_t_3)) {
@@ -47990,61 +48127,61 @@
     }
   }
   #endif
   {
     PyObject *__pyx_callargs[2] = {__pyx_t_3, ((PyObject *)Py_TYPE(((PyObject *)__pyx_v_self)))};
     __pyx_t_1 = __Pyx_PyObject_FastCall(__pyx_t_2, __pyx_callargs+1-__pyx_t_4, 1+__pyx_t_4);
     __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
-    if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1559, __pyx_L1_error)
+    if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1566, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   }
-  if (!(likely(((__pyx_t_1) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_1, __pyx_ptype_11sat_toolkit_7formula_XorCNF))))) __PYX_ERR(0, 1559, __pyx_L1_error)
+  if (!(likely(((__pyx_t_1) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_1, __pyx_ptype_11sat_toolkit_7formula_XorCNF))))) __PYX_ERR(0, 1566, __pyx_L1_error)
   __pyx_v_res = ((struct __pyx_obj_11sat_toolkit_7formula_XorCNF *)__pyx_t_1);
   __pyx_t_1 = 0;
 
-  /* "sat_toolkit/formula.pyx":1560
+  /* "sat_toolkit/formula.pyx":1567
  *     def __add__(self, other) -> Self:
  *         cdef XorCNF res = type(self).__new__(type(self))
  *         res += self             # <<<<<<<<<<<<<<
  *         res += other
  *         return res
  */
-  __pyx_t_1 = PyNumber_InPlaceAdd(((PyObject *)__pyx_v_res), ((PyObject *)__pyx_v_self)); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1560, __pyx_L1_error)
+  __pyx_t_1 = PyNumber_InPlaceAdd(((PyObject *)__pyx_v_res), ((PyObject *)__pyx_v_self)); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1567, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  if (!(likely(((__pyx_t_1) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_1, __pyx_ptype_11sat_toolkit_7formula_XorCNF))))) __PYX_ERR(0, 1560, __pyx_L1_error)
+  if (!(likely(((__pyx_t_1) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_1, __pyx_ptype_11sat_toolkit_7formula_XorCNF))))) __PYX_ERR(0, 1567, __pyx_L1_error)
   __Pyx_DECREF_SET(__pyx_v_res, ((struct __pyx_obj_11sat_toolkit_7formula_XorCNF *)__pyx_t_1));
   __pyx_t_1 = 0;
 
-  /* "sat_toolkit/formula.pyx":1561
+  /* "sat_toolkit/formula.pyx":1568
  *         cdef XorCNF res = type(self).__new__(type(self))
  *         res += self
  *         res += other             # <<<<<<<<<<<<<<
  *         return res
  * 
  */
-  __pyx_t_1 = PyNumber_InPlaceAdd(((PyObject *)__pyx_v_res), __pyx_v_other); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1561, __pyx_L1_error)
+  __pyx_t_1 = PyNumber_InPlaceAdd(((PyObject *)__pyx_v_res), __pyx_v_other); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1568, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  if (!(likely(((__pyx_t_1) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_1, __pyx_ptype_11sat_toolkit_7formula_XorCNF))))) __PYX_ERR(0, 1561, __pyx_L1_error)
+  if (!(likely(((__pyx_t_1) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_1, __pyx_ptype_11sat_toolkit_7formula_XorCNF))))) __PYX_ERR(0, 1568, __pyx_L1_error)
   __Pyx_DECREF_SET(__pyx_v_res, ((struct __pyx_obj_11sat_toolkit_7formula_XorCNF *)__pyx_t_1));
   __pyx_t_1 = 0;
 
-  /* "sat_toolkit/formula.pyx":1562
+  /* "sat_toolkit/formula.pyx":1569
  *         res += self
  *         res += other
  *         return res             # <<<<<<<<<<<<<<
  * 
  * 
  */
   __Pyx_XDECREF(__pyx_r);
   __Pyx_INCREF((PyObject *)__pyx_v_res);
   __pyx_r = ((PyObject *)__pyx_v_res);
   goto __pyx_L0;
 
-  /* "sat_toolkit/formula.pyx":1558
+  /* "sat_toolkit/formula.pyx":1565
  *         return self
  * 
  *     def __add__(self, other) -> Self:             # <<<<<<<<<<<<<<
  *         cdef XorCNF res = type(self).__new__(type(self))
  *         res += self
  */
 
@@ -48058,15 +48195,15 @@
   __pyx_L0:;
   __Pyx_XDECREF((PyObject *)__pyx_v_res);
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "sat_toolkit/formula.pyx":1565
+/* "sat_toolkit/formula.pyx":1572
  * 
  * 
  *     def to_dimacs(self) -> str:             # <<<<<<<<<<<<<<
  *         '''
  *         return the XorCNF formatted in the extended DIMACS file format
  */
 
@@ -48123,86 +48260,86 @@
   Py_ssize_t __pyx_t_6;
   PyObject *__pyx_t_7 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("to_dimacs", 1);
 
-  /* "sat_toolkit/formula.pyx":1569
+  /* "sat_toolkit/formula.pyx":1576
  *         return the XorCNF formatted in the extended DIMACS file format
  *         '''
  *         return f'p cnf {self._nvars()} {len(self._clauses) + len(self._xor_clauses)}\n{self._clauses._to_dimacs("")}{self._xor_clauses._to_dimacs("x")}'             # <<<<<<<<<<<<<<
  * 
  *     def __reduce__(self):
  */
   __Pyx_XDECREF(__pyx_r);
-  __pyx_t_1 = PyTuple_New(7); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1569, __pyx_L1_error)
+  __pyx_t_1 = PyTuple_New(7); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1576, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_t_2 = 0;
   __pyx_t_3 = 127;
   __Pyx_INCREF(__pyx_kp_u_p_cnf);
   __pyx_t_2 += 6;
   __Pyx_GIVEREF(__pyx_kp_u_p_cnf);
   PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_kp_u_p_cnf);
-  __pyx_t_4 = __Pyx_PyUnicode_From_int(((struct __pyx_vtabstruct_11sat_toolkit_7formula_XorCNF *)__pyx_v_self->__pyx_vtab)->_nvars(__pyx_v_self), 0, ' ', 'd'); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1569, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyUnicode_From_int(((struct __pyx_vtabstruct_11sat_toolkit_7formula_XorCNF *)__pyx_v_self->__pyx_vtab)->_nvars(__pyx_v_self), 0, ' ', 'd'); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1576, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __pyx_t_2 += __Pyx_PyUnicode_GET_LENGTH(__pyx_t_4);
   __Pyx_GIVEREF(__pyx_t_4);
   PyTuple_SET_ITEM(__pyx_t_1, 1, __pyx_t_4);
   __pyx_t_4 = 0;
   __Pyx_INCREF(__pyx_kp_u__32);
   __pyx_t_2 += 1;
   __Pyx_GIVEREF(__pyx_kp_u__32);
   PyTuple_SET_ITEM(__pyx_t_1, 2, __pyx_kp_u__32);
   __pyx_t_4 = ((PyObject *)__pyx_v_self->_clauses);
   __Pyx_INCREF(__pyx_t_4);
-  __pyx_t_5 = PyObject_Length(__pyx_t_4); if (unlikely(__pyx_t_5 == ((Py_ssize_t)-1))) __PYX_ERR(0, 1569, __pyx_L1_error)
+  __pyx_t_5 = PyObject_Length(__pyx_t_4); if (unlikely(__pyx_t_5 == ((Py_ssize_t)-1))) __PYX_ERR(0, 1576, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
   __pyx_t_4 = ((PyObject *)__pyx_v_self->_xor_clauses);
   __Pyx_INCREF(__pyx_t_4);
-  __pyx_t_6 = PyObject_Length(__pyx_t_4); if (unlikely(__pyx_t_6 == ((Py_ssize_t)-1))) __PYX_ERR(0, 1569, __pyx_L1_error)
+  __pyx_t_6 = PyObject_Length(__pyx_t_4); if (unlikely(__pyx_t_6 == ((Py_ssize_t)-1))) __PYX_ERR(0, 1576, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-  __pyx_t_4 = __Pyx_PyUnicode_From_Py_ssize_t((__pyx_t_5 + __pyx_t_6), 0, ' ', 'd'); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1569, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyUnicode_From_Py_ssize_t((__pyx_t_5 + __pyx_t_6), 0, ' ', 'd'); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1576, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __pyx_t_2 += __Pyx_PyUnicode_GET_LENGTH(__pyx_t_4);
   __Pyx_GIVEREF(__pyx_t_4);
   PyTuple_SET_ITEM(__pyx_t_1, 3, __pyx_t_4);
   __pyx_t_4 = 0;
   __Pyx_INCREF(__pyx_kp_u__33);
   __pyx_t_2 += 1;
   __Pyx_GIVEREF(__pyx_kp_u__33);
   PyTuple_SET_ITEM(__pyx_t_1, 4, __pyx_kp_u__33);
-  __pyx_t_4 = ((struct __pyx_vtabstruct_11sat_toolkit_7formula_CNF *)__pyx_v_self->_clauses->__pyx_base.__pyx_vtab)->__pyx_base._to_dimacs(((struct __pyx_obj_11sat_toolkit_7formula__ClauseList *)__pyx_v_self->_clauses), ((char const *)"")); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1569, __pyx_L1_error)
+  __pyx_t_4 = ((struct __pyx_vtabstruct_11sat_toolkit_7formula_CNF *)__pyx_v_self->_clauses->__pyx_base.__pyx_vtab)->__pyx_base._to_dimacs(((struct __pyx_obj_11sat_toolkit_7formula__ClauseList *)__pyx_v_self->_clauses), ((char const *)"")); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1576, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
-  __pyx_t_7 = __Pyx_PyUnicode_Unicode(__pyx_t_4); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1569, __pyx_L1_error)
+  __pyx_t_7 = __Pyx_PyUnicode_Unicode(__pyx_t_4); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1576, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_7);
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
   __pyx_t_3 = (__Pyx_PyUnicode_MAX_CHAR_VALUE(__pyx_t_7) > __pyx_t_3) ? __Pyx_PyUnicode_MAX_CHAR_VALUE(__pyx_t_7) : __pyx_t_3;
   __pyx_t_2 += __Pyx_PyUnicode_GET_LENGTH(__pyx_t_7);
   __Pyx_GIVEREF(__pyx_t_7);
   PyTuple_SET_ITEM(__pyx_t_1, 5, __pyx_t_7);
   __pyx_t_7 = 0;
-  __pyx_t_7 = ((struct __pyx_vtabstruct_11sat_toolkit_7formula_XorClauseList *)__pyx_v_self->_xor_clauses->__pyx_base.__pyx_vtab)->__pyx_base._to_dimacs(((struct __pyx_obj_11sat_toolkit_7formula__ClauseList *)__pyx_v_self->_xor_clauses), ((char const *)"x")); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1569, __pyx_L1_error)
+  __pyx_t_7 = ((struct __pyx_vtabstruct_11sat_toolkit_7formula_XorClauseList *)__pyx_v_self->_xor_clauses->__pyx_base.__pyx_vtab)->__pyx_base._to_dimacs(((struct __pyx_obj_11sat_toolkit_7formula__ClauseList *)__pyx_v_self->_xor_clauses), ((char const *)"x")); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1576, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_7);
-  __pyx_t_4 = __Pyx_PyUnicode_Unicode(__pyx_t_7); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1569, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyUnicode_Unicode(__pyx_t_7); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1576, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
   __pyx_t_3 = (__Pyx_PyUnicode_MAX_CHAR_VALUE(__pyx_t_4) > __pyx_t_3) ? __Pyx_PyUnicode_MAX_CHAR_VALUE(__pyx_t_4) : __pyx_t_3;
   __pyx_t_2 += __Pyx_PyUnicode_GET_LENGTH(__pyx_t_4);
   __Pyx_GIVEREF(__pyx_t_4);
   PyTuple_SET_ITEM(__pyx_t_1, 6, __pyx_t_4);
   __pyx_t_4 = 0;
-  __pyx_t_4 = __Pyx_PyUnicode_Join(__pyx_t_1, 7, __pyx_t_2, __pyx_t_3); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1569, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyUnicode_Join(__pyx_t_1, 7, __pyx_t_2, __pyx_t_3); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1576, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __pyx_r = ((PyObject*)__pyx_t_4);
   __pyx_t_4 = 0;
   goto __pyx_L0;
 
-  /* "sat_toolkit/formula.pyx":1565
+  /* "sat_toolkit/formula.pyx":1572
  * 
  * 
  *     def to_dimacs(self) -> str:             # <<<<<<<<<<<<<<
  *         '''
  *         return the XorCNF formatted in the extended DIMACS file format
  */
 
@@ -48215,15 +48352,15 @@
   __pyx_r = NULL;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "sat_toolkit/formula.pyx":1571
+/* "sat_toolkit/formula.pyx":1578
  *         return f'p cnf {self._nvars()} {len(self._clauses) + len(self._xor_clauses)}\n{self._clauses._to_dimacs("")}{self._xor_clauses._to_dimacs("x")}'
  * 
  *     def __reduce__(self):             # <<<<<<<<<<<<<<
  *         return type(self), (self._clauses, self._xor_clauses)
  * 
  */
 
@@ -48275,43 +48412,43 @@
   PyObject *__pyx_t_1 = NULL;
   PyObject *__pyx_t_2 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("__reduce__", 1);
 
-  /* "sat_toolkit/formula.pyx":1572
+  /* "sat_toolkit/formula.pyx":1579
  * 
  *     def __reduce__(self):
  *         return type(self), (self._clauses, self._xor_clauses)             # <<<<<<<<<<<<<<
  * 
  *     def __eq__(self, other):
  */
   __Pyx_XDECREF(__pyx_r);
-  __pyx_t_1 = PyTuple_New(2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1572, __pyx_L1_error)
+  __pyx_t_1 = PyTuple_New(2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1579, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_INCREF((PyObject *)__pyx_v_self->_clauses);
   __Pyx_GIVEREF((PyObject *)__pyx_v_self->_clauses);
-  if (__Pyx_PyTuple_SET_ITEM(__pyx_t_1, 0, ((PyObject *)__pyx_v_self->_clauses))) __PYX_ERR(0, 1572, __pyx_L1_error);
+  if (__Pyx_PyTuple_SET_ITEM(__pyx_t_1, 0, ((PyObject *)__pyx_v_self->_clauses))) __PYX_ERR(0, 1579, __pyx_L1_error);
   __Pyx_INCREF((PyObject *)__pyx_v_self->_xor_clauses);
   __Pyx_GIVEREF((PyObject *)__pyx_v_self->_xor_clauses);
-  if (__Pyx_PyTuple_SET_ITEM(__pyx_t_1, 1, ((PyObject *)__pyx_v_self->_xor_clauses))) __PYX_ERR(0, 1572, __pyx_L1_error);
-  __pyx_t_2 = PyTuple_New(2); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1572, __pyx_L1_error)
+  if (__Pyx_PyTuple_SET_ITEM(__pyx_t_1, 1, ((PyObject *)__pyx_v_self->_xor_clauses))) __PYX_ERR(0, 1579, __pyx_L1_error);
+  __pyx_t_2 = PyTuple_New(2); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1579, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_INCREF(((PyObject *)Py_TYPE(((PyObject *)__pyx_v_self))));
   __Pyx_GIVEREF(((PyObject *)Py_TYPE(((PyObject *)__pyx_v_self))));
-  if (__Pyx_PyTuple_SET_ITEM(__pyx_t_2, 0, ((PyObject *)Py_TYPE(((PyObject *)__pyx_v_self))))) __PYX_ERR(0, 1572, __pyx_L1_error);
+  if (__Pyx_PyTuple_SET_ITEM(__pyx_t_2, 0, ((PyObject *)Py_TYPE(((PyObject *)__pyx_v_self))))) __PYX_ERR(0, 1579, __pyx_L1_error);
   __Pyx_GIVEREF(__pyx_t_1);
-  if (__Pyx_PyTuple_SET_ITEM(__pyx_t_2, 1, __pyx_t_1)) __PYX_ERR(0, 1572, __pyx_L1_error);
+  if (__Pyx_PyTuple_SET_ITEM(__pyx_t_2, 1, __pyx_t_1)) __PYX_ERR(0, 1579, __pyx_L1_error);
   __pyx_t_1 = 0;
   __pyx_r = __pyx_t_2;
   __pyx_t_2 = 0;
   goto __pyx_L0;
 
-  /* "sat_toolkit/formula.pyx":1571
+  /* "sat_toolkit/formula.pyx":1578
  *         return f'p cnf {self._nvars()} {len(self._clauses) + len(self._xor_clauses)}\n{self._clauses._to_dimacs("")}{self._xor_clauses._to_dimacs("x")}'
  * 
  *     def __reduce__(self):             # <<<<<<<<<<<<<<
  *         return type(self), (self._clauses, self._xor_clauses)
  * 
  */
 
@@ -48323,15 +48460,15 @@
   __pyx_r = NULL;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "sat_toolkit/formula.pyx":1574
+/* "sat_toolkit/formula.pyx":1581
  *         return type(self), (self._clauses, self._xor_clauses)
  * 
  *     def __eq__(self, other):             # <<<<<<<<<<<<<<
  *         cdef XorCNF c_other
  * 
  */
 
@@ -48363,15 +48500,15 @@
   PyObject *__pyx_t_7 = NULL;
   int __pyx_t_8;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("__eq__", 1);
 
-  /* "sat_toolkit/formula.pyx":1577
+  /* "sat_toolkit/formula.pyx":1584
  *         cdef XorCNF c_other
  * 
  *         try:             # <<<<<<<<<<<<<<
  *             c_other = other
  *         except TypeError:
  */
   {
@@ -48379,58 +48516,58 @@
     __Pyx_PyThreadState_assign
     __Pyx_ExceptionSave(&__pyx_t_1, &__pyx_t_2, &__pyx_t_3);
     __Pyx_XGOTREF(__pyx_t_1);
     __Pyx_XGOTREF(__pyx_t_2);
     __Pyx_XGOTREF(__pyx_t_3);
     /*try:*/ {
 
-      /* "sat_toolkit/formula.pyx":1578
+      /* "sat_toolkit/formula.pyx":1585
  * 
  *         try:
  *             c_other = other             # <<<<<<<<<<<<<<
  *         except TypeError:
  *             return False
  */
-      if (!(likely(((__pyx_v_other) == Py_None) || likely(__Pyx_TypeTest(__pyx_v_other, __pyx_ptype_11sat_toolkit_7formula_XorCNF))))) __PYX_ERR(0, 1578, __pyx_L3_error)
+      if (!(likely(((__pyx_v_other) == Py_None) || likely(__Pyx_TypeTest(__pyx_v_other, __pyx_ptype_11sat_toolkit_7formula_XorCNF))))) __PYX_ERR(0, 1585, __pyx_L3_error)
       __pyx_t_4 = __pyx_v_other;
       __Pyx_INCREF(__pyx_t_4);
       __pyx_v_c_other = ((struct __pyx_obj_11sat_toolkit_7formula_XorCNF *)__pyx_t_4);
       __pyx_t_4 = 0;
 
-      /* "sat_toolkit/formula.pyx":1577
+      /* "sat_toolkit/formula.pyx":1584
  *         cdef XorCNF c_other
  * 
  *         try:             # <<<<<<<<<<<<<<
  *             c_other = other
  *         except TypeError:
  */
     }
     __Pyx_XDECREF(__pyx_t_1); __pyx_t_1 = 0;
     __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
     __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
     goto __pyx_L8_try_end;
     __pyx_L3_error:;
     __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
 
-    /* "sat_toolkit/formula.pyx":1579
+    /* "sat_toolkit/formula.pyx":1586
  *         try:
  *             c_other = other
  *         except TypeError:             # <<<<<<<<<<<<<<
  *             return False
  * 
  */
     __pyx_t_5 = __Pyx_PyErr_ExceptionMatches(__pyx_builtin_TypeError);
     if (__pyx_t_5) {
       __Pyx_AddTraceback("sat_toolkit.formula.XorCNF.__eq__", __pyx_clineno, __pyx_lineno, __pyx_filename);
-      if (__Pyx_GetException(&__pyx_t_4, &__pyx_t_6, &__pyx_t_7) < 0) __PYX_ERR(0, 1579, __pyx_L5_except_error)
+      if (__Pyx_GetException(&__pyx_t_4, &__pyx_t_6, &__pyx_t_7) < 0) __PYX_ERR(0, 1586, __pyx_L5_except_error)
       __Pyx_XGOTREF(__pyx_t_4);
       __Pyx_XGOTREF(__pyx_t_6);
       __Pyx_XGOTREF(__pyx_t_7);
 
-      /* "sat_toolkit/formula.pyx":1580
+      /* "sat_toolkit/formula.pyx":1587
  *             c_other = other
  *         except TypeError:
  *             return False             # <<<<<<<<<<<<<<
  * 
  *         if self._nvars() != c_other._nvars():
  */
       __Pyx_XDECREF(__pyx_r);
@@ -48439,15 +48576,15 @@
       __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
       __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
       __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
       goto __pyx_L6_except_return;
     }
     goto __pyx_L5_except_error;
 
-    /* "sat_toolkit/formula.pyx":1577
+    /* "sat_toolkit/formula.pyx":1584
  *         cdef XorCNF c_other
  * 
  *         try:             # <<<<<<<<<<<<<<
  *             c_other = other
  *         except TypeError:
  */
     __pyx_L5_except_error:;
@@ -48461,73 +48598,73 @@
     __Pyx_XGIVEREF(__pyx_t_2);
     __Pyx_XGIVEREF(__pyx_t_3);
     __Pyx_ExceptionReset(__pyx_t_1, __pyx_t_2, __pyx_t_3);
     goto __pyx_L0;
     __pyx_L8_try_end:;
   }
 
-  /* "sat_toolkit/formula.pyx":1582
+  /* "sat_toolkit/formula.pyx":1589
  *             return False
  * 
  *         if self._nvars() != c_other._nvars():             # <<<<<<<<<<<<<<
  *             return False
  * 
  */
   __pyx_t_8 = (((struct __pyx_vtabstruct_11sat_toolkit_7formula_XorCNF *)__pyx_v_self->__pyx_vtab)->_nvars(__pyx_v_self) != ((struct __pyx_vtabstruct_11sat_toolkit_7formula_XorCNF *)__pyx_v_c_other->__pyx_vtab)->_nvars(__pyx_v_c_other));
   if (__pyx_t_8) {
 
-    /* "sat_toolkit/formula.pyx":1583
+    /* "sat_toolkit/formula.pyx":1590
  * 
  *         if self._nvars() != c_other._nvars():
  *             return False             # <<<<<<<<<<<<<<
  * 
  *         return self._clauses._clauses == c_other._clauses._clauses and self._xor_clauses._clauses == c_other._xor_clauses._clauses
  */
     __Pyx_XDECREF(__pyx_r);
     __Pyx_INCREF(Py_False);
     __pyx_r = Py_False;
     goto __pyx_L0;
 
-    /* "sat_toolkit/formula.pyx":1582
+    /* "sat_toolkit/formula.pyx":1589
  *             return False
  * 
  *         if self._nvars() != c_other._nvars():             # <<<<<<<<<<<<<<
  *             return False
  * 
  */
   }
 
-  /* "sat_toolkit/formula.pyx":1585
+  /* "sat_toolkit/formula.pyx":1592
  *             return False
  * 
  *         return self._clauses._clauses == c_other._clauses._clauses and self._xor_clauses._clauses == c_other._xor_clauses._clauses             # <<<<<<<<<<<<<<
  * 
  *     def solve_dimacs(self, command: List[str]=['cryptominisat5'], verbose=False) -> Tuple[bool, np.array|None]:
  */
   __Pyx_XDECREF(__pyx_r);
   __pyx_t_8 = (__pyx_v_self->_clauses->__pyx_base._clauses == __pyx_v_c_other->_clauses->__pyx_base._clauses);
   if (__pyx_t_8) {
   } else {
-    __pyx_t_6 = __Pyx_PyBool_FromLong(__pyx_t_8); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1585, __pyx_L1_error)
+    __pyx_t_6 = __Pyx_PyBool_FromLong(__pyx_t_8); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1592, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
     __pyx_t_7 = __pyx_t_6;
     __pyx_t_6 = 0;
     goto __pyx_L12_bool_binop_done;
   }
   __pyx_t_8 = (__pyx_v_self->_xor_clauses->__pyx_base._clauses == __pyx_v_c_other->_xor_clauses->__pyx_base._clauses);
-  __pyx_t_6 = __Pyx_PyBool_FromLong(__pyx_t_8); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1585, __pyx_L1_error)
+  __pyx_t_6 = __Pyx_PyBool_FromLong(__pyx_t_8); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1592, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_6);
   __pyx_t_7 = __pyx_t_6;
   __pyx_t_6 = 0;
   __pyx_L12_bool_binop_done:;
   __pyx_r = __pyx_t_7;
   __pyx_t_7 = 0;
   goto __pyx_L0;
 
-  /* "sat_toolkit/formula.pyx":1574
+  /* "sat_toolkit/formula.pyx":1581
  *         return type(self), (self._clauses, self._xor_clauses)
  * 
  *     def __eq__(self, other):             # <<<<<<<<<<<<<<
  *         cdef XorCNF c_other
  * 
  */
 
@@ -48541,15 +48678,15 @@
   __pyx_L0:;
   __Pyx_XDECREF((PyObject *)__pyx_v_c_other);
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "sat_toolkit/formula.pyx":1587
+/* "sat_toolkit/formula.pyx":1594
  *         return self._clauses._clauses == c_other._clauses._clauses and self._xor_clauses._clauses == c_other._xor_clauses._clauses
  * 
  *     def solve_dimacs(self, command: List[str]=['cryptominisat5'], verbose=False) -> Tuple[bool, np.array|None]:             # <<<<<<<<<<<<<<
  *         """
  *         solves the SAT by calling a DIMACS compliant sat solver that also
  */
 
@@ -48607,27 +48744,27 @@
       }
       kw_args = __Pyx_NumKwargs_FASTCALL(__pyx_kwds);
       switch (__pyx_nargs) {
         case  0:
         if (kw_args > 0) {
           PyObject* value = __Pyx_GetKwValue_FASTCALL(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_command);
           if (value) { values[0] = __Pyx_Arg_NewRef_FASTCALL(value); kw_args--; }
-          else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 1587, __pyx_L3_error)
+          else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 1594, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  1:
         if (kw_args > 0) {
           PyObject* value = __Pyx_GetKwValue_FASTCALL(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_verbose);
           if (value) { values[1] = __Pyx_Arg_NewRef_FASTCALL(value); kw_args--; }
-          else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 1587, __pyx_L3_error)
+          else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 1594, __pyx_L3_error)
         }
       }
       if (unlikely(kw_args > 0)) {
         const Py_ssize_t kwd_pos_args = __pyx_nargs;
-        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values + 0, kwd_pos_args, "solve_dimacs") < 0)) __PYX_ERR(0, 1587, __pyx_L3_error)
+        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values + 0, kwd_pos_args, "solve_dimacs") < 0)) __PYX_ERR(0, 1594, __pyx_L3_error)
       }
     } else {
       switch (__pyx_nargs) {
         case  2: values[1] = __Pyx_Arg_FASTCALL(__pyx_args, 1);
         CYTHON_FALLTHROUGH;
         case  1: values[0] = __Pyx_Arg_FASTCALL(__pyx_args, 0);
         CYTHON_FALLTHROUGH;
@@ -48636,15 +48773,15 @@
       }
     }
     __pyx_v_command = values[0];
     __pyx_v_verbose = values[1];
   }
   goto __pyx_L6_skip;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("solve_dimacs", 0, 0, 2, __pyx_nargs); __PYX_ERR(0, 1587, __pyx_L3_error)
+  __Pyx_RaiseArgtupleInvalid("solve_dimacs", 0, 0, 2, __pyx_nargs); __PYX_ERR(0, 1594, __pyx_L3_error)
   __pyx_L6_skip:;
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L3_error:;
   {
     Py_ssize_t __pyx_temp;
     for (__pyx_temp=0; __pyx_temp < (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
       __Pyx_Arg_XDECREF_FASTCALL(values[__pyx_temp]);
@@ -48709,129 +48846,129 @@
   int __pyx_t_25;
   PyObject *__pyx_t_26 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("solve_dimacs", 1);
 
-  /* "sat_toolkit/formula.pyx":1597
+  /* "sat_toolkit/formula.pyx":1604
  *         Returns (False, None) for UNSAT instances.
  *         """
  *         cdef int echo_comments, ret_code = 0             # <<<<<<<<<<<<<<
  *         cdef uint8_t[:] result_view
  * 
  */
   __pyx_v_ret_code = 0;
 
-  /* "sat_toolkit/formula.pyx":1600
+  /* "sat_toolkit/formula.pyx":1607
  *         cdef uint8_t[:] result_view
  * 
  *         result = np.full(self.nvars + 1, 255, dtype=np.uint8)             # <<<<<<<<<<<<<<
  *         result_view = result
  *         echo_comments = verbose
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1600, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1607, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_full); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1600, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_full); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1607, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_self), __pyx_n_s_nvars); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1600, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_self), __pyx_n_s_nvars); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1607, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_3 = __Pyx_PyInt_AddObjC(__pyx_t_1, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1600, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyInt_AddObjC(__pyx_t_1, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1607, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  __pyx_t_1 = PyTuple_New(2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1600, __pyx_L1_error)
+  __pyx_t_1 = PyTuple_New(2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1607, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_GIVEREF(__pyx_t_3);
-  if (__Pyx_PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_t_3)) __PYX_ERR(0, 1600, __pyx_L1_error);
+  if (__Pyx_PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_t_3)) __PYX_ERR(0, 1607, __pyx_L1_error);
   __Pyx_INCREF(__pyx_int_255);
   __Pyx_GIVEREF(__pyx_int_255);
-  if (__Pyx_PyTuple_SET_ITEM(__pyx_t_1, 1, __pyx_int_255)) __PYX_ERR(0, 1600, __pyx_L1_error);
+  if (__Pyx_PyTuple_SET_ITEM(__pyx_t_1, 1, __pyx_int_255)) __PYX_ERR(0, 1607, __pyx_L1_error);
   __pyx_t_3 = 0;
-  __pyx_t_3 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1600, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1607, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_np); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1600, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_np); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1607, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
-  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_uint8); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1600, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_uint8); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1607, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-  if (PyDict_SetItem(__pyx_t_3, __pyx_n_s_dtype, __pyx_t_5) < 0) __PYX_ERR(0, 1600, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_3, __pyx_n_s_dtype, __pyx_t_5) < 0) __PYX_ERR(0, 1607, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-  __pyx_t_5 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_t_1, __pyx_t_3); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1600, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_t_1, __pyx_t_3); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1607, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   __pyx_v_result = __pyx_t_5;
   __pyx_t_5 = 0;
 
-  /* "sat_toolkit/formula.pyx":1601
+  /* "sat_toolkit/formula.pyx":1608
  * 
  *         result = np.full(self.nvars + 1, 255, dtype=np.uint8)
  *         result_view = result             # <<<<<<<<<<<<<<
  *         echo_comments = verbose
  * 
  */
-  __pyx_t_6 = __Pyx_PyObject_to_MemoryviewSlice_ds_nn___pyx_t_11sat_toolkit_5types_uint8_t(__pyx_v_result, PyBUF_WRITABLE); if (unlikely(!__pyx_t_6.memview)) __PYX_ERR(0, 1601, __pyx_L1_error)
+  __pyx_t_6 = __Pyx_PyObject_to_MemoryviewSlice_ds_nn___pyx_t_11sat_toolkit_5types_uint8_t(__pyx_v_result, PyBUF_WRITABLE); if (unlikely(!__pyx_t_6.memview)) __PYX_ERR(0, 1608, __pyx_L1_error)
   __pyx_v_result_view = __pyx_t_6;
   __pyx_t_6.memview = NULL;
   __pyx_t_6.data = NULL;
 
-  /* "sat_toolkit/formula.pyx":1602
+  /* "sat_toolkit/formula.pyx":1609
  *         result = np.full(self.nvars + 1, 255, dtype=np.uint8)
  *         result_view = result
  *         echo_comments = verbose             # <<<<<<<<<<<<<<
  * 
  *         cdef int32_t[::1] buf = None;
  */
-  __pyx_t_7 = __Pyx_PyInt_As_int(__pyx_v_verbose); if (unlikely((__pyx_t_7 == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 1602, __pyx_L1_error)
+  __pyx_t_7 = __Pyx_PyInt_As_int(__pyx_v_verbose); if (unlikely((__pyx_t_7 == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 1609, __pyx_L1_error)
   __pyx_v_echo_comments = __pyx_t_7;
 
-  /* "sat_toolkit/formula.pyx":1604
+  /* "sat_toolkit/formula.pyx":1611
  *         echo_comments = verbose
  * 
  *         cdef int32_t[::1] buf = None;             # <<<<<<<<<<<<<<
  *         cdef int32_t lit
  *         cdef ssize_t i
  */
-  __pyx_t_8 = __Pyx_PyObject_to_MemoryviewSlice_dc_nn___pyx_t_11sat_toolkit_5types_int32_t(Py_None, PyBUF_WRITABLE); if (unlikely(!__pyx_t_8.memview)) __PYX_ERR(0, 1604, __pyx_L1_error)
+  __pyx_t_8 = __Pyx_PyObject_to_MemoryviewSlice_dc_nn___pyx_t_11sat_toolkit_5types_int32_t(Py_None, PyBUF_WRITABLE); if (unlikely(!__pyx_t_8.memview)) __PYX_ERR(0, 1611, __pyx_L1_error)
   __pyx_v_buf = __pyx_t_8;
   __pyx_t_8.memview = NULL;
   __pyx_t_8.data = NULL;
 
-  /* "sat_toolkit/formula.pyx":1607
+  /* "sat_toolkit/formula.pyx":1614
  *         cdef int32_t lit
  *         cdef ssize_t i
  *         cdef bint is_sat = False             # <<<<<<<<<<<<<<
  * 
  * 
  */
   __pyx_v_is_sat = 0;
 
-  /* "sat_toolkit/formula.pyx":1610
+  /* "sat_toolkit/formula.pyx":1617
  * 
  * 
  *         with NamedTemporaryFile('w', prefix='sat_toolkit_', suffix='.cnf') as f:             # <<<<<<<<<<<<<<
  *             f.write(self.to_dimacs())
  *             f.flush()
  */
   /*with:*/ {
-    __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_NamedTemporaryFile); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1610, __pyx_L1_error)
+    __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_NamedTemporaryFile); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1617, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
-    __pyx_t_3 = __Pyx_PyDict_NewPresized(2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1610, __pyx_L1_error)
+    __pyx_t_3 = __Pyx_PyDict_NewPresized(2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1617, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
-    if (PyDict_SetItem(__pyx_t_3, __pyx_n_s_prefix, __pyx_n_u_sat_toolkit) < 0) __PYX_ERR(0, 1610, __pyx_L1_error)
-    if (PyDict_SetItem(__pyx_t_3, __pyx_n_s_suffix, __pyx_kp_u_cnf) < 0) __PYX_ERR(0, 1610, __pyx_L1_error)
-    __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_5, __pyx_tuple__37, __pyx_t_3); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1610, __pyx_L1_error)
+    if (PyDict_SetItem(__pyx_t_3, __pyx_n_s_prefix, __pyx_n_u_sat_toolkit) < 0) __PYX_ERR(0, 1617, __pyx_L1_error)
+    if (PyDict_SetItem(__pyx_t_3, __pyx_n_s_suffix, __pyx_kp_u_cnf) < 0) __PYX_ERR(0, 1617, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_5, __pyx_tuple__37, __pyx_t_3); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1617, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-    __pyx_t_9 = __Pyx_PyObject_LookupSpecial(__pyx_t_1, __pyx_n_s_exit); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1610, __pyx_L1_error)
+    __pyx_t_9 = __Pyx_PyObject_LookupSpecial(__pyx_t_1, __pyx_n_s_exit); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1617, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_9);
-    __pyx_t_5 = __Pyx_PyObject_LookupSpecial(__pyx_t_1, __pyx_n_s_enter); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1610, __pyx_L3_error)
+    __pyx_t_5 = __Pyx_PyObject_LookupSpecial(__pyx_t_1, __pyx_n_s_enter); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1617, __pyx_L3_error)
     __Pyx_GOTREF(__pyx_t_5);
     __pyx_t_2 = NULL;
     __pyx_t_7 = 0;
     #if CYTHON_UNPACK_METHODS
     if (likely(PyMethod_Check(__pyx_t_5))) {
       __pyx_t_2 = PyMethod_GET_SELF(__pyx_t_5);
       if (likely(__pyx_t_2)) {
@@ -48843,15 +48980,15 @@
       }
     }
     #endif
     {
       PyObject *__pyx_callargs[2] = {__pyx_t_2, NULL};
       __pyx_t_3 = __Pyx_PyObject_FastCall(__pyx_t_5, __pyx_callargs+1-__pyx_t_7, 0+__pyx_t_7);
       __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
-      if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1610, __pyx_L3_error)
+      if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1617, __pyx_L3_error)
       __Pyx_GOTREF(__pyx_t_3);
       __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
     }
     __pyx_t_5 = __pyx_t_3;
     __pyx_t_3 = 0;
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
     /*try:*/ {
@@ -48862,24 +48999,24 @@
         __Pyx_XGOTREF(__pyx_t_10);
         __Pyx_XGOTREF(__pyx_t_11);
         __Pyx_XGOTREF(__pyx_t_12);
         /*try:*/ {
           __pyx_v_f = __pyx_t_5;
           __pyx_t_5 = 0;
 
-          /* "sat_toolkit/formula.pyx":1611
+          /* "sat_toolkit/formula.pyx":1618
  * 
  *         with NamedTemporaryFile('w', prefix='sat_toolkit_', suffix='.cnf') as f:
  *             f.write(self.to_dimacs())             # <<<<<<<<<<<<<<
  *             f.flush()
  * 
  */
-          __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_f, __pyx_n_s_write); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1611, __pyx_L7_error)
+          __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_f, __pyx_n_s_write); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1618, __pyx_L7_error)
           __Pyx_GOTREF(__pyx_t_1);
-          __pyx_t_2 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_self), __pyx_n_s_to_dimacs); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1611, __pyx_L7_error)
+          __pyx_t_2 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_self), __pyx_n_s_to_dimacs); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1618, __pyx_L7_error)
           __Pyx_GOTREF(__pyx_t_2);
           __pyx_t_4 = NULL;
           __pyx_t_7 = 0;
           #if CYTHON_UNPACK_METHODS
           if (likely(PyMethod_Check(__pyx_t_2))) {
             __pyx_t_4 = PyMethod_GET_SELF(__pyx_t_2);
             if (likely(__pyx_t_4)) {
@@ -48891,15 +49028,15 @@
             }
           }
           #endif
           {
             PyObject *__pyx_callargs[2] = {__pyx_t_4, NULL};
             __pyx_t_3 = __Pyx_PyObject_FastCall(__pyx_t_2, __pyx_callargs+1-__pyx_t_7, 0+__pyx_t_7);
             __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
-            if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1611, __pyx_L7_error)
+            if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1618, __pyx_L7_error)
             __Pyx_GOTREF(__pyx_t_3);
             __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
           }
           __pyx_t_2 = NULL;
           __pyx_t_7 = 0;
           #if CYTHON_UNPACK_METHODS
           if (likely(PyMethod_Check(__pyx_t_1))) {
@@ -48914,28 +49051,28 @@
           }
           #endif
           {
             PyObject *__pyx_callargs[2] = {__pyx_t_2, __pyx_t_3};
             __pyx_t_5 = __Pyx_PyObject_FastCall(__pyx_t_1, __pyx_callargs+1-__pyx_t_7, 1+__pyx_t_7);
             __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
             __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-            if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1611, __pyx_L7_error)
+            if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1618, __pyx_L7_error)
             __Pyx_GOTREF(__pyx_t_5);
             __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
           }
           __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
 
-          /* "sat_toolkit/formula.pyx":1612
+          /* "sat_toolkit/formula.pyx":1619
  *         with NamedTemporaryFile('w', prefix='sat_toolkit_', suffix='.cnf') as f:
  *             f.write(self.to_dimacs())
  *             f.flush()             # <<<<<<<<<<<<<<
  * 
  *             args = command + [f.name]
  */
-          __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_f, __pyx_n_s_flush); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1612, __pyx_L7_error)
+          __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_f, __pyx_n_s_flush); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1619, __pyx_L7_error)
           __Pyx_GOTREF(__pyx_t_1);
           __pyx_t_3 = NULL;
           __pyx_t_7 = 0;
           #if CYTHON_UNPACK_METHODS
           if (likely(PyMethod_Check(__pyx_t_1))) {
             __pyx_t_3 = PyMethod_GET_SELF(__pyx_t_1);
             if (likely(__pyx_t_3)) {
@@ -48947,83 +49084,83 @@
             }
           }
           #endif
           {
             PyObject *__pyx_callargs[2] = {__pyx_t_3, NULL};
             __pyx_t_5 = __Pyx_PyObject_FastCall(__pyx_t_1, __pyx_callargs+1-__pyx_t_7, 0+__pyx_t_7);
             __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
-            if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1612, __pyx_L7_error)
+            if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1619, __pyx_L7_error)
             __Pyx_GOTREF(__pyx_t_5);
             __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
           }
           __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
 
-          /* "sat_toolkit/formula.pyx":1614
+          /* "sat_toolkit/formula.pyx":1621
  *             f.flush()
  * 
  *             args = command + [f.name]             # <<<<<<<<<<<<<<
  *             with sp.Popen(args, stdin=sp.DEVNULL, stdout=sp.PIPE, text=True) as solver:
  * 
  */
-          __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_v_f, __pyx_n_s_name); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1614, __pyx_L7_error)
+          __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_v_f, __pyx_n_s_name); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1621, __pyx_L7_error)
           __Pyx_GOTREF(__pyx_t_5);
-          __pyx_t_1 = PyList_New(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1614, __pyx_L7_error)
+          __pyx_t_1 = PyList_New(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1621, __pyx_L7_error)
           __Pyx_GOTREF(__pyx_t_1);
           __Pyx_GIVEREF(__pyx_t_5);
-          if (__Pyx_PyList_SET_ITEM(__pyx_t_1, 0, __pyx_t_5)) __PYX_ERR(0, 1614, __pyx_L7_error);
+          if (__Pyx_PyList_SET_ITEM(__pyx_t_1, 0, __pyx_t_5)) __PYX_ERR(0, 1621, __pyx_L7_error);
           __pyx_t_5 = 0;
-          __pyx_t_5 = PyNumber_Add(__pyx_v_command, __pyx_t_1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1614, __pyx_L7_error)
+          __pyx_t_5 = PyNumber_Add(__pyx_v_command, __pyx_t_1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1621, __pyx_L7_error)
           __Pyx_GOTREF(__pyx_t_5);
           __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
           __pyx_v_args = __pyx_t_5;
           __pyx_t_5 = 0;
 
-          /* "sat_toolkit/formula.pyx":1615
+          /* "sat_toolkit/formula.pyx":1622
  * 
  *             args = command + [f.name]
  *             with sp.Popen(args, stdin=sp.DEVNULL, stdout=sp.PIPE, text=True) as solver:             # <<<<<<<<<<<<<<
  * 
  *                 for line in solver.stdout:
  */
           /*with:*/ {
-            __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_sp); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1615, __pyx_L7_error)
+            __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_sp); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1622, __pyx_L7_error)
             __Pyx_GOTREF(__pyx_t_5);
-            __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_Popen); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1615, __pyx_L7_error)
+            __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_Popen); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1622, __pyx_L7_error)
             __Pyx_GOTREF(__pyx_t_1);
             __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-            __pyx_t_5 = PyTuple_New(1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1615, __pyx_L7_error)
+            __pyx_t_5 = PyTuple_New(1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1622, __pyx_L7_error)
             __Pyx_GOTREF(__pyx_t_5);
             __Pyx_INCREF(__pyx_v_args);
             __Pyx_GIVEREF(__pyx_v_args);
-            if (__Pyx_PyTuple_SET_ITEM(__pyx_t_5, 0, __pyx_v_args)) __PYX_ERR(0, 1615, __pyx_L7_error);
-            __pyx_t_3 = __Pyx_PyDict_NewPresized(3); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1615, __pyx_L7_error)
+            if (__Pyx_PyTuple_SET_ITEM(__pyx_t_5, 0, __pyx_v_args)) __PYX_ERR(0, 1622, __pyx_L7_error);
+            __pyx_t_3 = __Pyx_PyDict_NewPresized(3); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1622, __pyx_L7_error)
             __Pyx_GOTREF(__pyx_t_3);
-            __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_sp); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1615, __pyx_L7_error)
+            __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_sp); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1622, __pyx_L7_error)
             __Pyx_GOTREF(__pyx_t_2);
-            __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_DEVNULL); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1615, __pyx_L7_error)
+            __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_DEVNULL); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1622, __pyx_L7_error)
             __Pyx_GOTREF(__pyx_t_4);
             __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-            if (PyDict_SetItem(__pyx_t_3, __pyx_n_s_stdin, __pyx_t_4) < 0) __PYX_ERR(0, 1615, __pyx_L7_error)
+            if (PyDict_SetItem(__pyx_t_3, __pyx_n_s_stdin, __pyx_t_4) < 0) __PYX_ERR(0, 1622, __pyx_L7_error)
             __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-            __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_sp); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1615, __pyx_L7_error)
+            __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_sp); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1622, __pyx_L7_error)
             __Pyx_GOTREF(__pyx_t_4);
-            __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_PIPE); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1615, __pyx_L7_error)
+            __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_PIPE); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1622, __pyx_L7_error)
             __Pyx_GOTREF(__pyx_t_2);
             __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-            if (PyDict_SetItem(__pyx_t_3, __pyx_n_s_stdout, __pyx_t_2) < 0) __PYX_ERR(0, 1615, __pyx_L7_error)
+            if (PyDict_SetItem(__pyx_t_3, __pyx_n_s_stdout, __pyx_t_2) < 0) __PYX_ERR(0, 1622, __pyx_L7_error)
             __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-            if (PyDict_SetItem(__pyx_t_3, __pyx_n_s_text, Py_True) < 0) __PYX_ERR(0, 1615, __pyx_L7_error)
-            __pyx_t_2 = __Pyx_PyObject_Call(__pyx_t_1, __pyx_t_5, __pyx_t_3); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1615, __pyx_L7_error)
+            if (PyDict_SetItem(__pyx_t_3, __pyx_n_s_text, Py_True) < 0) __PYX_ERR(0, 1622, __pyx_L7_error)
+            __pyx_t_2 = __Pyx_PyObject_Call(__pyx_t_1, __pyx_t_5, __pyx_t_3); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1622, __pyx_L7_error)
             __Pyx_GOTREF(__pyx_t_2);
             __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
             __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
             __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-            __pyx_t_13 = __Pyx_PyObject_LookupSpecial(__pyx_t_2, __pyx_n_s_exit); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 1615, __pyx_L7_error)
+            __pyx_t_13 = __Pyx_PyObject_LookupSpecial(__pyx_t_2, __pyx_n_s_exit); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 1622, __pyx_L7_error)
             __Pyx_GOTREF(__pyx_t_13);
-            __pyx_t_5 = __Pyx_PyObject_LookupSpecial(__pyx_t_2, __pyx_n_s_enter); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1615, __pyx_L13_error)
+            __pyx_t_5 = __Pyx_PyObject_LookupSpecial(__pyx_t_2, __pyx_n_s_enter); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1622, __pyx_L13_error)
             __Pyx_GOTREF(__pyx_t_5);
             __pyx_t_1 = NULL;
             __pyx_t_7 = 0;
             #if CYTHON_UNPACK_METHODS
             if (likely(PyMethod_Check(__pyx_t_5))) {
               __pyx_t_1 = PyMethod_GET_SELF(__pyx_t_5);
               if (likely(__pyx_t_1)) {
@@ -49035,15 +49172,15 @@
               }
             }
             #endif
             {
               PyObject *__pyx_callargs[2] = {__pyx_t_1, NULL};
               __pyx_t_3 = __Pyx_PyObject_FastCall(__pyx_t_5, __pyx_callargs+1-__pyx_t_7, 0+__pyx_t_7);
               __Pyx_XDECREF(__pyx_t_1); __pyx_t_1 = 0;
-              if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1615, __pyx_L13_error)
+              if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1622, __pyx_L13_error)
               __Pyx_GOTREF(__pyx_t_3);
               __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
             }
             __pyx_t_5 = __pyx_t_3;
             __pyx_t_3 = 0;
             __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
             /*try:*/ {
@@ -49054,127 +49191,127 @@
                 __Pyx_XGOTREF(__pyx_t_14);
                 __Pyx_XGOTREF(__pyx_t_15);
                 __Pyx_XGOTREF(__pyx_t_16);
                 /*try:*/ {
                   __pyx_v_solver = __pyx_t_5;
                   __pyx_t_5 = 0;
 
-                  /* "sat_toolkit/formula.pyx":1617
+                  /* "sat_toolkit/formula.pyx":1624
  *             with sp.Popen(args, stdin=sp.DEVNULL, stdout=sp.PIPE, text=True) as solver:
  * 
  *                 for line in solver.stdout:             # <<<<<<<<<<<<<<
  *                     if echo_comments:
  *                         print(line, end='')
  */
-                  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_v_solver, __pyx_n_s_stdout); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1617, __pyx_L17_error)
+                  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_v_solver, __pyx_n_s_stdout); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1624, __pyx_L17_error)
                   __Pyx_GOTREF(__pyx_t_5);
                   if (likely(PyList_CheckExact(__pyx_t_5)) || PyTuple_CheckExact(__pyx_t_5)) {
                     __pyx_t_2 = __pyx_t_5; __Pyx_INCREF(__pyx_t_2);
                     __pyx_t_17 = 0;
                     __pyx_t_18 = NULL;
                   } else {
-                    __pyx_t_17 = -1; __pyx_t_2 = PyObject_GetIter(__pyx_t_5); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1617, __pyx_L17_error)
+                    __pyx_t_17 = -1; __pyx_t_2 = PyObject_GetIter(__pyx_t_5); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1624, __pyx_L17_error)
                     __Pyx_GOTREF(__pyx_t_2);
-                    __pyx_t_18 = __Pyx_PyObject_GetIterNextFunc(__pyx_t_2); if (unlikely(!__pyx_t_18)) __PYX_ERR(0, 1617, __pyx_L17_error)
+                    __pyx_t_18 = __Pyx_PyObject_GetIterNextFunc(__pyx_t_2); if (unlikely(!__pyx_t_18)) __PYX_ERR(0, 1624, __pyx_L17_error)
                   }
                   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
                   for (;;) {
                     if (likely(!__pyx_t_18)) {
                       if (likely(PyList_CheckExact(__pyx_t_2))) {
                         {
                           Py_ssize_t __pyx_temp = __Pyx_PyList_GET_SIZE(__pyx_t_2);
                           #if !CYTHON_ASSUME_SAFE_MACROS
-                          if (unlikely((__pyx_temp < 0))) __PYX_ERR(0, 1617, __pyx_L17_error)
+                          if (unlikely((__pyx_temp < 0))) __PYX_ERR(0, 1624, __pyx_L17_error)
                           #endif
                           if (__pyx_t_17 >= __pyx_temp) break;
                         }
                         #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-                        __pyx_t_5 = PyList_GET_ITEM(__pyx_t_2, __pyx_t_17); __Pyx_INCREF(__pyx_t_5); __pyx_t_17++; if (unlikely((0 < 0))) __PYX_ERR(0, 1617, __pyx_L17_error)
+                        __pyx_t_5 = PyList_GET_ITEM(__pyx_t_2, __pyx_t_17); __Pyx_INCREF(__pyx_t_5); __pyx_t_17++; if (unlikely((0 < 0))) __PYX_ERR(0, 1624, __pyx_L17_error)
                         #else
-                        __pyx_t_5 = __Pyx_PySequence_ITEM(__pyx_t_2, __pyx_t_17); __pyx_t_17++; if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1617, __pyx_L17_error)
+                        __pyx_t_5 = __Pyx_PySequence_ITEM(__pyx_t_2, __pyx_t_17); __pyx_t_17++; if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1624, __pyx_L17_error)
                         __Pyx_GOTREF(__pyx_t_5);
                         #endif
                       } else {
                         {
                           Py_ssize_t __pyx_temp = __Pyx_PyTuple_GET_SIZE(__pyx_t_2);
                           #if !CYTHON_ASSUME_SAFE_MACROS
-                          if (unlikely((__pyx_temp < 0))) __PYX_ERR(0, 1617, __pyx_L17_error)
+                          if (unlikely((__pyx_temp < 0))) __PYX_ERR(0, 1624, __pyx_L17_error)
                           #endif
                           if (__pyx_t_17 >= __pyx_temp) break;
                         }
                         #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-                        __pyx_t_5 = PyTuple_GET_ITEM(__pyx_t_2, __pyx_t_17); __Pyx_INCREF(__pyx_t_5); __pyx_t_17++; if (unlikely((0 < 0))) __PYX_ERR(0, 1617, __pyx_L17_error)
+                        __pyx_t_5 = PyTuple_GET_ITEM(__pyx_t_2, __pyx_t_17); __Pyx_INCREF(__pyx_t_5); __pyx_t_17++; if (unlikely((0 < 0))) __PYX_ERR(0, 1624, __pyx_L17_error)
                         #else
-                        __pyx_t_5 = __Pyx_PySequence_ITEM(__pyx_t_2, __pyx_t_17); __pyx_t_17++; if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1617, __pyx_L17_error)
+                        __pyx_t_5 = __Pyx_PySequence_ITEM(__pyx_t_2, __pyx_t_17); __pyx_t_17++; if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1624, __pyx_L17_error)
                         __Pyx_GOTREF(__pyx_t_5);
                         #endif
                       }
                     } else {
                       __pyx_t_5 = __pyx_t_18(__pyx_t_2);
                       if (unlikely(!__pyx_t_5)) {
                         PyObject* exc_type = PyErr_Occurred();
                         if (exc_type) {
                           if (likely(__Pyx_PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
-                          else __PYX_ERR(0, 1617, __pyx_L17_error)
+                          else __PYX_ERR(0, 1624, __pyx_L17_error)
                         }
                         break;
                       }
                       __Pyx_GOTREF(__pyx_t_5);
                     }
                     __Pyx_XDECREF_SET(__pyx_v_line, __pyx_t_5);
                     __pyx_t_5 = 0;
 
-                    /* "sat_toolkit/formula.pyx":1618
+                    /* "sat_toolkit/formula.pyx":1625
  * 
  *                 for line in solver.stdout:
  *                     if echo_comments:             # <<<<<<<<<<<<<<
  *                         print(line, end='')
  * 
  */
                     __pyx_t_19 = (__pyx_v_echo_comments != 0);
                     if (__pyx_t_19) {
 
-                      /* "sat_toolkit/formula.pyx":1619
+                      /* "sat_toolkit/formula.pyx":1626
  *                 for line in solver.stdout:
  *                     if echo_comments:
  *                         print(line, end='')             # <<<<<<<<<<<<<<
  * 
  *                     if line.startswith('c '):
  */
-                      __pyx_t_5 = PyTuple_New(1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1619, __pyx_L17_error)
+                      __pyx_t_5 = PyTuple_New(1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1626, __pyx_L17_error)
                       __Pyx_GOTREF(__pyx_t_5);
                       __Pyx_INCREF(__pyx_v_line);
                       __Pyx_GIVEREF(__pyx_v_line);
-                      if (__Pyx_PyTuple_SET_ITEM(__pyx_t_5, 0, __pyx_v_line)) __PYX_ERR(0, 1619, __pyx_L17_error);
-                      __pyx_t_3 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1619, __pyx_L17_error)
+                      if (__Pyx_PyTuple_SET_ITEM(__pyx_t_5, 0, __pyx_v_line)) __PYX_ERR(0, 1626, __pyx_L17_error);
+                      __pyx_t_3 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1626, __pyx_L17_error)
                       __Pyx_GOTREF(__pyx_t_3);
-                      if (PyDict_SetItem(__pyx_t_3, __pyx_n_s_end, __pyx_kp_u__10) < 0) __PYX_ERR(0, 1619, __pyx_L17_error)
-                      __pyx_t_1 = __Pyx_PyObject_Call(__pyx_builtin_print, __pyx_t_5, __pyx_t_3); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1619, __pyx_L17_error)
+                      if (PyDict_SetItem(__pyx_t_3, __pyx_n_s_end, __pyx_kp_u__10) < 0) __PYX_ERR(0, 1626, __pyx_L17_error)
+                      __pyx_t_1 = __Pyx_PyObject_Call(__pyx_builtin_print, __pyx_t_5, __pyx_t_3); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1626, __pyx_L17_error)
                       __Pyx_GOTREF(__pyx_t_1);
                       __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
                       __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
                       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-                      /* "sat_toolkit/formula.pyx":1618
+                      /* "sat_toolkit/formula.pyx":1625
  * 
  *                 for line in solver.stdout:
  *                     if echo_comments:             # <<<<<<<<<<<<<<
  *                         print(line, end='')
  * 
  */
                     }
 
-                    /* "sat_toolkit/formula.pyx":1621
+                    /* "sat_toolkit/formula.pyx":1628
  *                         print(line, end='')
  * 
  *                     if line.startswith('c '):             # <<<<<<<<<<<<<<
  *                         continue
  * 
  */
-                    __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_v_line, __pyx_n_s_startswith); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1621, __pyx_L17_error)
+                    __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_v_line, __pyx_n_s_startswith); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1628, __pyx_L17_error)
                     __Pyx_GOTREF(__pyx_t_3);
                     __pyx_t_5 = NULL;
                     __pyx_t_7 = 0;
                     #if CYTHON_UNPACK_METHODS
                     if (likely(PyMethod_Check(__pyx_t_3))) {
                       __pyx_t_5 = PyMethod_GET_SELF(__pyx_t_3);
                       if (likely(__pyx_t_5)) {
@@ -49186,48 +49323,48 @@
                       }
                     }
                     #endif
                     {
                       PyObject *__pyx_callargs[2] = {__pyx_t_5, __pyx_kp_u_c_2};
                       __pyx_t_1 = __Pyx_PyObject_FastCall(__pyx_t_3, __pyx_callargs+1-__pyx_t_7, 1+__pyx_t_7);
                       __Pyx_XDECREF(__pyx_t_5); __pyx_t_5 = 0;
-                      if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1621, __pyx_L17_error)
+                      if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1628, __pyx_L17_error)
                       __Pyx_GOTREF(__pyx_t_1);
                       __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
                     }
-                    __pyx_t_19 = __Pyx_PyObject_IsTrue(__pyx_t_1); if (unlikely((__pyx_t_19 < 0))) __PYX_ERR(0, 1621, __pyx_L17_error)
+                    __pyx_t_19 = __Pyx_PyObject_IsTrue(__pyx_t_1); if (unlikely((__pyx_t_19 < 0))) __PYX_ERR(0, 1628, __pyx_L17_error)
                     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
                     if (__pyx_t_19) {
 
-                      /* "sat_toolkit/formula.pyx":1622
+                      /* "sat_toolkit/formula.pyx":1629
  * 
  *                     if line.startswith('c '):
  *                         continue             # <<<<<<<<<<<<<<
  * 
  *                     if line.startswith('s '):
  */
                       goto __pyx_L23_continue;
 
-                      /* "sat_toolkit/formula.pyx":1621
+                      /* "sat_toolkit/formula.pyx":1628
  *                         print(line, end='')
  * 
  *                     if line.startswith('c '):             # <<<<<<<<<<<<<<
  *                         continue
  * 
  */
                     }
 
-                    /* "sat_toolkit/formula.pyx":1624
+                    /* "sat_toolkit/formula.pyx":1631
  *                         continue
  * 
  *                     if line.startswith('s '):             # <<<<<<<<<<<<<<
  *                         line = line[2:].strip()
  *                         if line == 'SATISFIABLE':
  */
-                    __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_v_line, __pyx_n_s_startswith); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1624, __pyx_L17_error)
+                    __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_v_line, __pyx_n_s_startswith); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1631, __pyx_L17_error)
                     __Pyx_GOTREF(__pyx_t_3);
                     __pyx_t_5 = NULL;
                     __pyx_t_7 = 0;
                     #if CYTHON_UNPACK_METHODS
                     if (likely(PyMethod_Check(__pyx_t_3))) {
                       __pyx_t_5 = PyMethod_GET_SELF(__pyx_t_3);
                       if (likely(__pyx_t_5)) {
@@ -49239,32 +49376,32 @@
                       }
                     }
                     #endif
                     {
                       PyObject *__pyx_callargs[2] = {__pyx_t_5, __pyx_kp_u_s_2};
                       __pyx_t_1 = __Pyx_PyObject_FastCall(__pyx_t_3, __pyx_callargs+1-__pyx_t_7, 1+__pyx_t_7);
                       __Pyx_XDECREF(__pyx_t_5); __pyx_t_5 = 0;
-                      if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1624, __pyx_L17_error)
+                      if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1631, __pyx_L17_error)
                       __Pyx_GOTREF(__pyx_t_1);
                       __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
                     }
-                    __pyx_t_19 = __Pyx_PyObject_IsTrue(__pyx_t_1); if (unlikely((__pyx_t_19 < 0))) __PYX_ERR(0, 1624, __pyx_L17_error)
+                    __pyx_t_19 = __Pyx_PyObject_IsTrue(__pyx_t_1); if (unlikely((__pyx_t_19 < 0))) __PYX_ERR(0, 1631, __pyx_L17_error)
                     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
                     if (__pyx_t_19) {
 
-                      /* "sat_toolkit/formula.pyx":1625
+                      /* "sat_toolkit/formula.pyx":1632
  * 
  *                     if line.startswith('s '):
  *                         line = line[2:].strip()             # <<<<<<<<<<<<<<
  *                         if line == 'SATISFIABLE':
  *                             is_sat = True
  */
-                      __pyx_t_3 = __Pyx_PyObject_GetSlice(__pyx_v_line, 2, 0, NULL, NULL, &__pyx_slice__38, 1, 0, 0); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1625, __pyx_L17_error)
+                      __pyx_t_3 = __Pyx_PyObject_GetSlice(__pyx_v_line, 2, 0, NULL, NULL, &__pyx_slice__38, 1, 0, 0); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1632, __pyx_L17_error)
                       __Pyx_GOTREF(__pyx_t_3);
-                      __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_strip); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1625, __pyx_L17_error)
+                      __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_strip); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1632, __pyx_L17_error)
                       __Pyx_GOTREF(__pyx_t_5);
                       __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
                       __pyx_t_3 = NULL;
                       __pyx_t_7 = 0;
                       #if CYTHON_UNPACK_METHODS
                       if (likely(PyMethod_Check(__pyx_t_5))) {
                         __pyx_t_3 = PyMethod_GET_SELF(__pyx_t_5);
@@ -49277,118 +49414,118 @@
                         }
                       }
                       #endif
                       {
                         PyObject *__pyx_callargs[2] = {__pyx_t_3, NULL};
                         __pyx_t_1 = __Pyx_PyObject_FastCall(__pyx_t_5, __pyx_callargs+1-__pyx_t_7, 0+__pyx_t_7);
                         __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
-                        if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1625, __pyx_L17_error)
+                        if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1632, __pyx_L17_error)
                         __Pyx_GOTREF(__pyx_t_1);
                         __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
                       }
                       __Pyx_DECREF_SET(__pyx_v_line, __pyx_t_1);
                       __pyx_t_1 = 0;
 
-                      /* "sat_toolkit/formula.pyx":1626
+                      /* "sat_toolkit/formula.pyx":1633
  *                     if line.startswith('s '):
  *                         line = line[2:].strip()
  *                         if line == 'SATISFIABLE':             # <<<<<<<<<<<<<<
  *                             is_sat = True
  *                         elif line == 'UNSATISFIABLE':
  */
-                      __pyx_t_19 = (__Pyx_PyUnicode_Equals(__pyx_v_line, __pyx_n_u_SATISFIABLE, Py_EQ)); if (unlikely((__pyx_t_19 < 0))) __PYX_ERR(0, 1626, __pyx_L17_error)
+                      __pyx_t_19 = (__Pyx_PyUnicode_Equals(__pyx_v_line, __pyx_n_u_SATISFIABLE, Py_EQ)); if (unlikely((__pyx_t_19 < 0))) __PYX_ERR(0, 1633, __pyx_L17_error)
                       if (__pyx_t_19) {
 
-                        /* "sat_toolkit/formula.pyx":1627
+                        /* "sat_toolkit/formula.pyx":1634
  *                         line = line[2:].strip()
  *                         if line == 'SATISFIABLE':
  *                             is_sat = True             # <<<<<<<<<<<<<<
  *                         elif line == 'UNSATISFIABLE':
  *                             is_sat = False
  */
                         __pyx_v_is_sat = 1;
 
-                        /* "sat_toolkit/formula.pyx":1626
+                        /* "sat_toolkit/formula.pyx":1633
  *                     if line.startswith('s '):
  *                         line = line[2:].strip()
  *                         if line == 'SATISFIABLE':             # <<<<<<<<<<<<<<
  *                             is_sat = True
  *                         elif line == 'UNSATISFIABLE':
  */
                         goto __pyx_L28;
                       }
 
-                      /* "sat_toolkit/formula.pyx":1628
+                      /* "sat_toolkit/formula.pyx":1635
  *                         if line == 'SATISFIABLE':
  *                             is_sat = True
  *                         elif line == 'UNSATISFIABLE':             # <<<<<<<<<<<<<<
  *                             is_sat = False
  *                         else:
  */
-                      __pyx_t_19 = (__Pyx_PyUnicode_Equals(__pyx_v_line, __pyx_n_u_UNSATISFIABLE, Py_EQ)); if (unlikely((__pyx_t_19 < 0))) __PYX_ERR(0, 1628, __pyx_L17_error)
+                      __pyx_t_19 = (__Pyx_PyUnicode_Equals(__pyx_v_line, __pyx_n_u_UNSATISFIABLE, Py_EQ)); if (unlikely((__pyx_t_19 < 0))) __PYX_ERR(0, 1635, __pyx_L17_error)
                       if (likely(__pyx_t_19)) {
 
-                        /* "sat_toolkit/formula.pyx":1629
+                        /* "sat_toolkit/formula.pyx":1636
  *                             is_sat = True
  *                         elif line == 'UNSATISFIABLE':
  *                             is_sat = False             # <<<<<<<<<<<<<<
  *                         else:
  *                             raise ValueError(f'unknown status: {line}')
  */
                         __pyx_v_is_sat = 0;
 
-                        /* "sat_toolkit/formula.pyx":1628
+                        /* "sat_toolkit/formula.pyx":1635
  *                         if line == 'SATISFIABLE':
  *                             is_sat = True
  *                         elif line == 'UNSATISFIABLE':             # <<<<<<<<<<<<<<
  *                             is_sat = False
  *                         else:
  */
                         goto __pyx_L28;
                       }
 
-                      /* "sat_toolkit/formula.pyx":1631
+                      /* "sat_toolkit/formula.pyx":1638
  *                             is_sat = False
  *                         else:
  *                             raise ValueError(f'unknown status: {line}')             # <<<<<<<<<<<<<<
  * 
  *                     if line.startswith('v '):
  */
                       /*else*/ {
-                        __pyx_t_1 = __Pyx_PyObject_FormatSimple(__pyx_v_line, __pyx_empty_unicode); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1631, __pyx_L17_error)
+                        __pyx_t_1 = __Pyx_PyObject_FormatSimple(__pyx_v_line, __pyx_empty_unicode); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1638, __pyx_L17_error)
                         __Pyx_GOTREF(__pyx_t_1);
-                        __pyx_t_5 = __Pyx_PyUnicode_Concat(__pyx_kp_u_unknown_status, __pyx_t_1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1631, __pyx_L17_error)
+                        __pyx_t_5 = __Pyx_PyUnicode_Concat(__pyx_kp_u_unknown_status, __pyx_t_1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1638, __pyx_L17_error)
                         __Pyx_GOTREF(__pyx_t_5);
                         __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-                        __pyx_t_1 = __Pyx_PyObject_CallOneArg(__pyx_builtin_ValueError, __pyx_t_5); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1631, __pyx_L17_error)
+                        __pyx_t_1 = __Pyx_PyObject_CallOneArg(__pyx_builtin_ValueError, __pyx_t_5); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1638, __pyx_L17_error)
                         __Pyx_GOTREF(__pyx_t_1);
                         __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
                         __Pyx_Raise(__pyx_t_1, 0, 0, 0);
                         __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-                        __PYX_ERR(0, 1631, __pyx_L17_error)
+                        __PYX_ERR(0, 1638, __pyx_L17_error)
                       }
                       __pyx_L28:;
 
-                      /* "sat_toolkit/formula.pyx":1624
+                      /* "sat_toolkit/formula.pyx":1631
  *                         continue
  * 
  *                     if line.startswith('s '):             # <<<<<<<<<<<<<<
  *                         line = line[2:].strip()
  *                         if line == 'SATISFIABLE':
  */
                     }
 
-                    /* "sat_toolkit/formula.pyx":1633
+                    /* "sat_toolkit/formula.pyx":1640
  *                             raise ValueError(f'unknown status: {line}')
  * 
  *                     if line.startswith('v '):             # <<<<<<<<<<<<<<
  *                         buf = np.fromstring(line[2:], dtype=np.int32, sep=' ')
  *                         for i in range(buf.shape[0]):
  */
-                    __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_v_line, __pyx_n_s_startswith); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1633, __pyx_L17_error)
+                    __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_v_line, __pyx_n_s_startswith); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1640, __pyx_L17_error)
                     __Pyx_GOTREF(__pyx_t_5);
                     __pyx_t_3 = NULL;
                     __pyx_t_7 = 0;
                     #if CYTHON_UNPACK_METHODS
                     if (likely(PyMethod_Check(__pyx_t_5))) {
                       __pyx_t_3 = PyMethod_GET_SELF(__pyx_t_5);
                       if (likely(__pyx_t_3)) {
@@ -49400,156 +49537,156 @@
                       }
                     }
                     #endif
                     {
                       PyObject *__pyx_callargs[2] = {__pyx_t_3, __pyx_kp_u_v};
                       __pyx_t_1 = __Pyx_PyObject_FastCall(__pyx_t_5, __pyx_callargs+1-__pyx_t_7, 1+__pyx_t_7);
                       __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
-                      if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1633, __pyx_L17_error)
+                      if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1640, __pyx_L17_error)
                       __Pyx_GOTREF(__pyx_t_1);
                       __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
                     }
-                    __pyx_t_19 = __Pyx_PyObject_IsTrue(__pyx_t_1); if (unlikely((__pyx_t_19 < 0))) __PYX_ERR(0, 1633, __pyx_L17_error)
+                    __pyx_t_19 = __Pyx_PyObject_IsTrue(__pyx_t_1); if (unlikely((__pyx_t_19 < 0))) __PYX_ERR(0, 1640, __pyx_L17_error)
                     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
                     if (__pyx_t_19) {
 
-                      /* "sat_toolkit/formula.pyx":1634
+                      /* "sat_toolkit/formula.pyx":1641
  * 
  *                     if line.startswith('v '):
  *                         buf = np.fromstring(line[2:], dtype=np.int32, sep=' ')             # <<<<<<<<<<<<<<
  *                         for i in range(buf.shape[0]):
  *                             lit = buf[i]
  */
-                      __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1634, __pyx_L17_error)
+                      __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1641, __pyx_L17_error)
                       __Pyx_GOTREF(__pyx_t_1);
-                      __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_fromstring); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1634, __pyx_L17_error)
+                      __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_fromstring); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1641, __pyx_L17_error)
                       __Pyx_GOTREF(__pyx_t_5);
                       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-                      __pyx_t_1 = __Pyx_PyObject_GetSlice(__pyx_v_line, 2, 0, NULL, NULL, &__pyx_slice__38, 1, 0, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1634, __pyx_L17_error)
+                      __pyx_t_1 = __Pyx_PyObject_GetSlice(__pyx_v_line, 2, 0, NULL, NULL, &__pyx_slice__38, 1, 0, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1641, __pyx_L17_error)
                       __Pyx_GOTREF(__pyx_t_1);
-                      __pyx_t_3 = PyTuple_New(1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1634, __pyx_L17_error)
+                      __pyx_t_3 = PyTuple_New(1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1641, __pyx_L17_error)
                       __Pyx_GOTREF(__pyx_t_3);
                       __Pyx_GIVEREF(__pyx_t_1);
-                      if (__Pyx_PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_t_1)) __PYX_ERR(0, 1634, __pyx_L17_error);
+                      if (__Pyx_PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_t_1)) __PYX_ERR(0, 1641, __pyx_L17_error);
                       __pyx_t_1 = 0;
-                      __pyx_t_1 = __Pyx_PyDict_NewPresized(2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1634, __pyx_L17_error)
+                      __pyx_t_1 = __Pyx_PyDict_NewPresized(2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1641, __pyx_L17_error)
                       __Pyx_GOTREF(__pyx_t_1);
-                      __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_np); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1634, __pyx_L17_error)
+                      __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_np); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1641, __pyx_L17_error)
                       __Pyx_GOTREF(__pyx_t_4);
-                      __pyx_t_20 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_int32); if (unlikely(!__pyx_t_20)) __PYX_ERR(0, 1634, __pyx_L17_error)
+                      __pyx_t_20 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_int32); if (unlikely(!__pyx_t_20)) __PYX_ERR(0, 1641, __pyx_L17_error)
                       __Pyx_GOTREF(__pyx_t_20);
                       __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-                      if (PyDict_SetItem(__pyx_t_1, __pyx_n_s_dtype, __pyx_t_20) < 0) __PYX_ERR(0, 1634, __pyx_L17_error)
+                      if (PyDict_SetItem(__pyx_t_1, __pyx_n_s_dtype, __pyx_t_20) < 0) __PYX_ERR(0, 1641, __pyx_L17_error)
                       __Pyx_DECREF(__pyx_t_20); __pyx_t_20 = 0;
-                      if (PyDict_SetItem(__pyx_t_1, __pyx_n_s_sep, __pyx_kp_u__32) < 0) __PYX_ERR(0, 1634, __pyx_L17_error)
-                      __pyx_t_20 = __Pyx_PyObject_Call(__pyx_t_5, __pyx_t_3, __pyx_t_1); if (unlikely(!__pyx_t_20)) __PYX_ERR(0, 1634, __pyx_L17_error)
+                      if (PyDict_SetItem(__pyx_t_1, __pyx_n_s_sep, __pyx_kp_u__32) < 0) __PYX_ERR(0, 1641, __pyx_L17_error)
+                      __pyx_t_20 = __Pyx_PyObject_Call(__pyx_t_5, __pyx_t_3, __pyx_t_1); if (unlikely(!__pyx_t_20)) __PYX_ERR(0, 1641, __pyx_L17_error)
                       __Pyx_GOTREF(__pyx_t_20);
                       __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
                       __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
                       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-                      __pyx_t_8 = __Pyx_PyObject_to_MemoryviewSlice_dc_nn___pyx_t_11sat_toolkit_5types_int32_t(__pyx_t_20, PyBUF_WRITABLE); if (unlikely(!__pyx_t_8.memview)) __PYX_ERR(0, 1634, __pyx_L17_error)
+                      __pyx_t_8 = __Pyx_PyObject_to_MemoryviewSlice_dc_nn___pyx_t_11sat_toolkit_5types_int32_t(__pyx_t_20, PyBUF_WRITABLE); if (unlikely(!__pyx_t_8.memview)) __PYX_ERR(0, 1641, __pyx_L17_error)
                       __Pyx_DECREF(__pyx_t_20); __pyx_t_20 = 0;
                       __PYX_XCLEAR_MEMVIEW(&__pyx_v_buf, 1);
                       __pyx_v_buf = __pyx_t_8;
                       __pyx_t_8.memview = NULL;
                       __pyx_t_8.data = NULL;
 
-                      /* "sat_toolkit/formula.pyx":1635
+                      /* "sat_toolkit/formula.pyx":1642
  *                     if line.startswith('v '):
  *                         buf = np.fromstring(line[2:], dtype=np.int32, sep=' ')
  *                         for i in range(buf.shape[0]):             # <<<<<<<<<<<<<<
  *                             lit = buf[i]
  *                             if abs(lit) >= result_view.shape[0]:
  */
                       __pyx_t_21 = (__pyx_v_buf.shape[0]);
                       __pyx_t_22 = __pyx_t_21;
                       for (__pyx_t_23 = 0; __pyx_t_23 < __pyx_t_22; __pyx_t_23+=1) {
                         __pyx_v_i = __pyx_t_23;
 
-                        /* "sat_toolkit/formula.pyx":1636
+                        /* "sat_toolkit/formula.pyx":1643
  *                         buf = np.fromstring(line[2:], dtype=np.int32, sep=' ')
  *                         for i in range(buf.shape[0]):
  *                             lit = buf[i]             # <<<<<<<<<<<<<<
  *                             if abs(lit) >= result_view.shape[0]:
  *                                 raise IndexError('solver returned model index that is out of bounds')
  */
                         __pyx_t_24 = __pyx_v_i;
                         __pyx_v_lit = (*((__pyx_t_11sat_toolkit_5types_int32_t *) ( /* dim=0 */ ((char *) (((__pyx_t_11sat_toolkit_5types_int32_t *) __pyx_v_buf.data) + __pyx_t_24)) )));
 
-                        /* "sat_toolkit/formula.pyx":1637
+                        /* "sat_toolkit/formula.pyx":1644
  *                         for i in range(buf.shape[0]):
  *                             lit = buf[i]
  *                             if abs(lit) >= result_view.shape[0]:             # <<<<<<<<<<<<<<
  *                                 raise IndexError('solver returned model index that is out of bounds')
  *                             result_view[abs(lit)] = lit > 0
  */
                         __pyx_t_19 = (__pyx_f_11sat_toolkit_7formula_abs(__pyx_v_lit) >= (__pyx_v_result_view.shape[0]));
                         if (unlikely(__pyx_t_19)) {
 
-                          /* "sat_toolkit/formula.pyx":1638
+                          /* "sat_toolkit/formula.pyx":1645
  *                             lit = buf[i]
  *                             if abs(lit) >= result_view.shape[0]:
  *                                 raise IndexError('solver returned model index that is out of bounds')             # <<<<<<<<<<<<<<
  *                             result_view[abs(lit)] = lit > 0
  * 
  */
-                          __pyx_t_20 = __Pyx_PyObject_Call(__pyx_builtin_IndexError, __pyx_tuple__39, NULL); if (unlikely(!__pyx_t_20)) __PYX_ERR(0, 1638, __pyx_L17_error)
+                          __pyx_t_20 = __Pyx_PyObject_Call(__pyx_builtin_IndexError, __pyx_tuple__39, NULL); if (unlikely(!__pyx_t_20)) __PYX_ERR(0, 1645, __pyx_L17_error)
                           __Pyx_GOTREF(__pyx_t_20);
                           __Pyx_Raise(__pyx_t_20, 0, 0, 0);
                           __Pyx_DECREF(__pyx_t_20); __pyx_t_20 = 0;
-                          __PYX_ERR(0, 1638, __pyx_L17_error)
+                          __PYX_ERR(0, 1645, __pyx_L17_error)
 
-                          /* "sat_toolkit/formula.pyx":1637
+                          /* "sat_toolkit/formula.pyx":1644
  *                         for i in range(buf.shape[0]):
  *                             lit = buf[i]
  *                             if abs(lit) >= result_view.shape[0]:             # <<<<<<<<<<<<<<
  *                                 raise IndexError('solver returned model index that is out of bounds')
  *                             result_view[abs(lit)] = lit > 0
  */
                         }
 
-                        /* "sat_toolkit/formula.pyx":1639
+                        /* "sat_toolkit/formula.pyx":1646
  *                             if abs(lit) >= result_view.shape[0]:
  *                                 raise IndexError('solver returned model index that is out of bounds')
  *                             result_view[abs(lit)] = lit > 0             # <<<<<<<<<<<<<<
  * 
  * 
  */
                         __pyx_t_24 = __pyx_f_11sat_toolkit_7formula_abs(__pyx_v_lit);
                         *((__pyx_t_11sat_toolkit_5types_uint8_t *) ( /* dim=0 */ (__pyx_v_result_view.data + __pyx_t_24 * __pyx_v_result_view.strides[0]) )) = (__pyx_v_lit > 0);
                       }
 
-                      /* "sat_toolkit/formula.pyx":1633
+                      /* "sat_toolkit/formula.pyx":1640
  *                             raise ValueError(f'unknown status: {line}')
  * 
  *                     if line.startswith('v '):             # <<<<<<<<<<<<<<
  *                         buf = np.fromstring(line[2:], dtype=np.int32, sep=' ')
  *                         for i in range(buf.shape[0]):
  */
                     }
 
-                    /* "sat_toolkit/formula.pyx":1617
+                    /* "sat_toolkit/formula.pyx":1624
  *             with sp.Popen(args, stdin=sp.DEVNULL, stdout=sp.PIPE, text=True) as solver:
  * 
  *                 for line in solver.stdout:             # <<<<<<<<<<<<<<
  *                     if echo_comments:
  *                         print(line, end='')
  */
                     __pyx_L23_continue:;
                   }
                   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
 
-                  /* "sat_toolkit/formula.pyx":1642
+                  /* "sat_toolkit/formula.pyx":1649
  * 
  * 
  *                 ret_code = solver.wait()             # <<<<<<<<<<<<<<
  *                 if ret_code not in [10, 20]:
  *                     # for SAT solvers ret_code == 10 corresponds to SATISFIABLE and
  */
-                  __pyx_t_20 = __Pyx_PyObject_GetAttrStr(__pyx_v_solver, __pyx_n_s_wait); if (unlikely(!__pyx_t_20)) __PYX_ERR(0, 1642, __pyx_L17_error)
+                  __pyx_t_20 = __Pyx_PyObject_GetAttrStr(__pyx_v_solver, __pyx_n_s_wait); if (unlikely(!__pyx_t_20)) __PYX_ERR(0, 1649, __pyx_L17_error)
                   __Pyx_GOTREF(__pyx_t_20);
                   __pyx_t_1 = NULL;
                   __pyx_t_7 = 0;
                   #if CYTHON_UNPACK_METHODS
                   if (likely(PyMethod_Check(__pyx_t_20))) {
                     __pyx_t_1 = PyMethod_GET_SELF(__pyx_t_20);
                     if (likely(__pyx_t_1)) {
@@ -49561,23 +49698,23 @@
                     }
                   }
                   #endif
                   {
                     PyObject *__pyx_callargs[2] = {__pyx_t_1, NULL};
                     __pyx_t_2 = __Pyx_PyObject_FastCall(__pyx_t_20, __pyx_callargs+1-__pyx_t_7, 0+__pyx_t_7);
                     __Pyx_XDECREF(__pyx_t_1); __pyx_t_1 = 0;
-                    if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1642, __pyx_L17_error)
+                    if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1649, __pyx_L17_error)
                     __Pyx_GOTREF(__pyx_t_2);
                     __Pyx_DECREF(__pyx_t_20); __pyx_t_20 = 0;
                   }
-                  __pyx_t_7 = __Pyx_PyInt_As_int(__pyx_t_2); if (unlikely((__pyx_t_7 == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 1642, __pyx_L17_error)
+                  __pyx_t_7 = __Pyx_PyInt_As_int(__pyx_t_2); if (unlikely((__pyx_t_7 == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 1649, __pyx_L17_error)
                   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
                   __pyx_v_ret_code = __pyx_t_7;
 
-                  /* "sat_toolkit/formula.pyx":1643
+                  /* "sat_toolkit/formula.pyx":1650
  * 
  *                 ret_code = solver.wait()
  *                 if ret_code not in [10, 20]:             # <<<<<<<<<<<<<<
  *                     # for SAT solvers ret_code == 10 corresponds to SATISFIABLE and
  *                     # ret == 20 to UNSATISFIABLE (see for example
  */
                   switch (__pyx_v_ret_code) {
@@ -49588,31 +49725,31 @@
                     default:
                     __pyx_t_19 = 1;
                     break;
                   }
                   __pyx_t_25 = __pyx_t_19;
                   if (unlikely(__pyx_t_25)) {
 
-                    /* "sat_toolkit/formula.pyx":1647
+                    /* "sat_toolkit/formula.pyx":1654
  *                     # ret == 20 to UNSATISFIABLE (see for example
  *                     # http://www.satcompetition.org/2004/format-solvers2004.html)
  *                     raise sp.CalledProcessError(ret_code, ' '.join(solver.args))             # <<<<<<<<<<<<<<
  * 
  *                 is_sat = ret_code == 10
  */
-                    __Pyx_GetModuleGlobalName(__pyx_t_20, __pyx_n_s_sp); if (unlikely(!__pyx_t_20)) __PYX_ERR(0, 1647, __pyx_L17_error)
+                    __Pyx_GetModuleGlobalName(__pyx_t_20, __pyx_n_s_sp); if (unlikely(!__pyx_t_20)) __PYX_ERR(0, 1654, __pyx_L17_error)
                     __Pyx_GOTREF(__pyx_t_20);
-                    __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_20, __pyx_n_s_CalledProcessError); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1647, __pyx_L17_error)
+                    __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_20, __pyx_n_s_CalledProcessError); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1654, __pyx_L17_error)
                     __Pyx_GOTREF(__pyx_t_1);
                     __Pyx_DECREF(__pyx_t_20); __pyx_t_20 = 0;
-                    __pyx_t_20 = __Pyx_PyInt_From_int(__pyx_v_ret_code); if (unlikely(!__pyx_t_20)) __PYX_ERR(0, 1647, __pyx_L17_error)
+                    __pyx_t_20 = __Pyx_PyInt_From_int(__pyx_v_ret_code); if (unlikely(!__pyx_t_20)) __PYX_ERR(0, 1654, __pyx_L17_error)
                     __Pyx_GOTREF(__pyx_t_20);
-                    __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_v_solver, __pyx_n_s_args); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1647, __pyx_L17_error)
+                    __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_v_solver, __pyx_n_s_args); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1654, __pyx_L17_error)
                     __Pyx_GOTREF(__pyx_t_3);
-                    __pyx_t_5 = PyUnicode_Join(__pyx_kp_u__32, __pyx_t_3); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1647, __pyx_L17_error)
+                    __pyx_t_5 = PyUnicode_Join(__pyx_kp_u__32, __pyx_t_3); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1654, __pyx_L17_error)
                     __Pyx_GOTREF(__pyx_t_5);
                     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
                     __pyx_t_3 = NULL;
                     __pyx_t_7 = 0;
                     #if CYTHON_UNPACK_METHODS
                     if (unlikely(PyMethod_Check(__pyx_t_1))) {
                       __pyx_t_3 = PyMethod_GET_SELF(__pyx_t_1);
@@ -49627,41 +49764,41 @@
                     #endif
                     {
                       PyObject *__pyx_callargs[3] = {__pyx_t_3, __pyx_t_20, __pyx_t_5};
                       __pyx_t_2 = __Pyx_PyObject_FastCall(__pyx_t_1, __pyx_callargs+1-__pyx_t_7, 2+__pyx_t_7);
                       __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
                       __Pyx_DECREF(__pyx_t_20); __pyx_t_20 = 0;
                       __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-                      if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1647, __pyx_L17_error)
+                      if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1654, __pyx_L17_error)
                       __Pyx_GOTREF(__pyx_t_2);
                       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
                     }
                     __Pyx_Raise(__pyx_t_2, 0, 0, 0);
                     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-                    __PYX_ERR(0, 1647, __pyx_L17_error)
+                    __PYX_ERR(0, 1654, __pyx_L17_error)
 
-                    /* "sat_toolkit/formula.pyx":1643
+                    /* "sat_toolkit/formula.pyx":1650
  * 
  *                 ret_code = solver.wait()
  *                 if ret_code not in [10, 20]:             # <<<<<<<<<<<<<<
  *                     # for SAT solvers ret_code == 10 corresponds to SATISFIABLE and
  *                     # ret == 20 to UNSATISFIABLE (see for example
  */
                   }
 
-                  /* "sat_toolkit/formula.pyx":1649
+                  /* "sat_toolkit/formula.pyx":1656
  *                     raise sp.CalledProcessError(ret_code, ' '.join(solver.args))
  * 
  *                 is_sat = ret_code == 10             # <<<<<<<<<<<<<<
  * 
  *             if is_sat:
  */
                   __pyx_v_is_sat = (__pyx_v_ret_code == 10);
 
-                  /* "sat_toolkit/formula.pyx":1615
+                  /* "sat_toolkit/formula.pyx":1622
  * 
  *             args = command + [f.name]
  *             with sp.Popen(args, stdin=sp.DEVNULL, stdout=sp.PIPE, text=True) as solver:             # <<<<<<<<<<<<<<
  * 
  *                 for line in solver.stdout:
  */
                 }
@@ -49678,36 +49815,36 @@
                 __Pyx_XDECREF(__pyx_t_5); __pyx_t_5 = 0;
                 __PYX_XCLEAR_MEMVIEW(&__pyx_t_6, 1);
                 __pyx_t_6.memview = NULL; __pyx_t_6.data = NULL;
                 __PYX_XCLEAR_MEMVIEW(&__pyx_t_8, 1);
                 __pyx_t_8.memview = NULL; __pyx_t_8.data = NULL;
                 /*except:*/ {
                   __Pyx_AddTraceback("sat_toolkit.formula.XorCNF.solve_dimacs", __pyx_clineno, __pyx_lineno, __pyx_filename);
-                  if (__Pyx_GetException(&__pyx_t_2, &__pyx_t_1, &__pyx_t_5) < 0) __PYX_ERR(0, 1615, __pyx_L19_except_error)
+                  if (__Pyx_GetException(&__pyx_t_2, &__pyx_t_1, &__pyx_t_5) < 0) __PYX_ERR(0, 1622, __pyx_L19_except_error)
                   __Pyx_XGOTREF(__pyx_t_2);
                   __Pyx_XGOTREF(__pyx_t_1);
                   __Pyx_XGOTREF(__pyx_t_5);
-                  __pyx_t_20 = PyTuple_Pack(3, __pyx_t_2, __pyx_t_1, __pyx_t_5); if (unlikely(!__pyx_t_20)) __PYX_ERR(0, 1615, __pyx_L19_except_error)
+                  __pyx_t_20 = PyTuple_Pack(3, __pyx_t_2, __pyx_t_1, __pyx_t_5); if (unlikely(!__pyx_t_20)) __PYX_ERR(0, 1622, __pyx_L19_except_error)
                   __Pyx_GOTREF(__pyx_t_20);
                   __pyx_t_26 = __Pyx_PyObject_Call(__pyx_t_13, __pyx_t_20, NULL);
                   __Pyx_DECREF(__pyx_t_13); __pyx_t_13 = 0;
                   __Pyx_DECREF(__pyx_t_20); __pyx_t_20 = 0;
-                  if (unlikely(!__pyx_t_26)) __PYX_ERR(0, 1615, __pyx_L19_except_error)
+                  if (unlikely(!__pyx_t_26)) __PYX_ERR(0, 1622, __pyx_L19_except_error)
                   __Pyx_GOTREF(__pyx_t_26);
                   __pyx_t_25 = __Pyx_PyObject_IsTrue(__pyx_t_26);
                   __Pyx_DECREF(__pyx_t_26); __pyx_t_26 = 0;
-                  if (__pyx_t_25 < 0) __PYX_ERR(0, 1615, __pyx_L19_except_error)
+                  if (__pyx_t_25 < 0) __PYX_ERR(0, 1622, __pyx_L19_except_error)
                   __pyx_t_19 = (!__pyx_t_25);
                   if (unlikely(__pyx_t_19)) {
                     __Pyx_GIVEREF(__pyx_t_2);
                     __Pyx_GIVEREF(__pyx_t_1);
                     __Pyx_XGIVEREF(__pyx_t_5);
                     __Pyx_ErrRestoreWithState(__pyx_t_2, __pyx_t_1, __pyx_t_5);
                     __pyx_t_2 = 0; __pyx_t_1 = 0; __pyx_t_5 = 0; 
-                    __PYX_ERR(0, 1615, __pyx_L19_except_error)
+                    __PYX_ERR(0, 1622, __pyx_L19_except_error)
                   }
                   __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
                   __Pyx_XDECREF(__pyx_t_1); __pyx_t_1 = 0;
                   __Pyx_XDECREF(__pyx_t_5); __pyx_t_5 = 0;
                   goto __pyx_L18_exception_handled;
                 }
                 __pyx_L19_except_error:;
@@ -49725,82 +49862,82 @@
               }
             }
             /*finally:*/ {
               /*normal exit:*/{
                 if (__pyx_t_13) {
                   __pyx_t_16 = __Pyx_PyObject_Call(__pyx_t_13, __pyx_tuple__35, NULL);
                   __Pyx_DECREF(__pyx_t_13); __pyx_t_13 = 0;
-                  if (unlikely(!__pyx_t_16)) __PYX_ERR(0, 1615, __pyx_L7_error)
+                  if (unlikely(!__pyx_t_16)) __PYX_ERR(0, 1622, __pyx_L7_error)
                   __Pyx_GOTREF(__pyx_t_16);
                   __Pyx_DECREF(__pyx_t_16); __pyx_t_16 = 0;
                 }
                 goto __pyx_L16;
               }
               __pyx_L16:;
             }
             goto __pyx_L38;
             __pyx_L13_error:;
             __Pyx_DECREF(__pyx_t_13); __pyx_t_13 = 0;
             goto __pyx_L7_error;
             __pyx_L38:;
           }
 
-          /* "sat_toolkit/formula.pyx":1651
+          /* "sat_toolkit/formula.pyx":1658
  *                 is_sat = ret_code == 10
  * 
  *             if is_sat:             # <<<<<<<<<<<<<<
  *                 return True, result
  *             else:
  */
           if (__pyx_v_is_sat) {
 
-            /* "sat_toolkit/formula.pyx":1652
+            /* "sat_toolkit/formula.pyx":1659
  * 
  *             if is_sat:
  *                 return True, result             # <<<<<<<<<<<<<<
  *             else:
  *                 return False, None
  */
             __Pyx_XDECREF(__pyx_r);
-            __pyx_t_5 = PyTuple_New(2); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1652, __pyx_L7_error)
+            __pyx_t_5 = PyTuple_New(2); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1659, __pyx_L7_error)
             __Pyx_GOTREF(__pyx_t_5);
             __Pyx_INCREF(Py_True);
             __Pyx_GIVEREF(Py_True);
-            if (__Pyx_PyTuple_SET_ITEM(__pyx_t_5, 0, Py_True)) __PYX_ERR(0, 1652, __pyx_L7_error);
+            if (__Pyx_PyTuple_SET_ITEM(__pyx_t_5, 0, Py_True)) __PYX_ERR(0, 1659, __pyx_L7_error);
             __Pyx_INCREF(__pyx_v_result);
             __Pyx_GIVEREF(__pyx_v_result);
-            if (__Pyx_PyTuple_SET_ITEM(__pyx_t_5, 1, __pyx_v_result)) __PYX_ERR(0, 1652, __pyx_L7_error);
+            if (__Pyx_PyTuple_SET_ITEM(__pyx_t_5, 1, __pyx_v_result)) __PYX_ERR(0, 1659, __pyx_L7_error);
             __pyx_r = __pyx_t_5;
             __pyx_t_5 = 0;
             goto __pyx_L11_try_return;
 
-            /* "sat_toolkit/formula.pyx":1651
+            /* "sat_toolkit/formula.pyx":1658
  *                 is_sat = ret_code == 10
  * 
  *             if is_sat:             # <<<<<<<<<<<<<<
  *                 return True, result
  *             else:
  */
           }
 
-          /* "sat_toolkit/formula.pyx":1654
+          /* "sat_toolkit/formula.pyx":1661
  *                 return True, result
  *             else:
  *                 return False, None             # <<<<<<<<<<<<<<
  * 
  * 
  */
           /*else*/ {
             __Pyx_XDECREF(__pyx_r);
             __Pyx_INCREF(__pyx_tuple__40);
             __pyx_r = __pyx_tuple__40;
             goto __pyx_L11_try_return;
           }
 
-          /* "sat_toolkit/formula.pyx":1610
+          /* "sat_toolkit/formula.pyx":1617
  * 
  * 
  *         with NamedTemporaryFile('w', prefix='sat_toolkit_', suffix='.cnf') as f:             # <<<<<<<<<<<<<<
  *             f.write(self.to_dimacs())
  *             f.flush()
  */
         }
@@ -49813,36 +49950,36 @@
         __Pyx_XDECREF(__pyx_t_5); __pyx_t_5 = 0;
         __PYX_XCLEAR_MEMVIEW(&__pyx_t_6, 1);
         __pyx_t_6.memview = NULL; __pyx_t_6.data = NULL;
         __PYX_XCLEAR_MEMVIEW(&__pyx_t_8, 1);
         __pyx_t_8.memview = NULL; __pyx_t_8.data = NULL;
         /*except:*/ {
           __Pyx_AddTraceback("sat_toolkit.formula.XorCNF.solve_dimacs", __pyx_clineno, __pyx_lineno, __pyx_filename);
-          if (__Pyx_GetException(&__pyx_t_5, &__pyx_t_1, &__pyx_t_2) < 0) __PYX_ERR(0, 1610, __pyx_L9_except_error)
+          if (__Pyx_GetException(&__pyx_t_5, &__pyx_t_1, &__pyx_t_2) < 0) __PYX_ERR(0, 1617, __pyx_L9_except_error)
           __Pyx_XGOTREF(__pyx_t_5);
           __Pyx_XGOTREF(__pyx_t_1);
           __Pyx_XGOTREF(__pyx_t_2);
-          __pyx_t_20 = PyTuple_Pack(3, __pyx_t_5, __pyx_t_1, __pyx_t_2); if (unlikely(!__pyx_t_20)) __PYX_ERR(0, 1610, __pyx_L9_except_error)
+          __pyx_t_20 = PyTuple_Pack(3, __pyx_t_5, __pyx_t_1, __pyx_t_2); if (unlikely(!__pyx_t_20)) __PYX_ERR(0, 1617, __pyx_L9_except_error)
           __Pyx_GOTREF(__pyx_t_20);
           __pyx_t_13 = __Pyx_PyObject_Call(__pyx_t_9, __pyx_t_20, NULL);
           __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
           __Pyx_DECREF(__pyx_t_20); __pyx_t_20 = 0;
-          if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 1610, __pyx_L9_except_error)
+          if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 1617, __pyx_L9_except_error)
           __Pyx_GOTREF(__pyx_t_13);
           __pyx_t_19 = __Pyx_PyObject_IsTrue(__pyx_t_13);
           __Pyx_DECREF(__pyx_t_13); __pyx_t_13 = 0;
-          if (__pyx_t_19 < 0) __PYX_ERR(0, 1610, __pyx_L9_except_error)
+          if (__pyx_t_19 < 0) __PYX_ERR(0, 1617, __pyx_L9_except_error)
           __pyx_t_25 = (!__pyx_t_19);
           if (unlikely(__pyx_t_25)) {
             __Pyx_GIVEREF(__pyx_t_5);
             __Pyx_GIVEREF(__pyx_t_1);
             __Pyx_XGIVEREF(__pyx_t_2);
             __Pyx_ErrRestoreWithState(__pyx_t_5, __pyx_t_1, __pyx_t_2);
             __pyx_t_5 = 0; __pyx_t_1 = 0; __pyx_t_2 = 0; 
-            __PYX_ERR(0, 1610, __pyx_L9_except_error)
+            __PYX_ERR(0, 1617, __pyx_L9_except_error)
           }
           __Pyx_XDECREF(__pyx_t_5); __pyx_t_5 = 0;
           __Pyx_XDECREF(__pyx_t_1); __pyx_t_1 = 0;
           __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
           goto __pyx_L8_exception_handled;
         }
         __pyx_L9_except_error:;
@@ -49865,27 +50002,27 @@
       }
     }
     /*finally:*/ {
       /*normal exit:*/{
         if (__pyx_t_9) {
           __pyx_t_12 = __Pyx_PyObject_Call(__pyx_t_9, __pyx_tuple__35, NULL);
           __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
-          if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 1610, __pyx_L1_error)
+          if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 1617, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_12);
           __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;
         }
         goto __pyx_L6;
       }
       __pyx_L4_return: {
         __pyx_t_12 = __pyx_r;
         __pyx_r = 0;
         if (__pyx_t_9) {
           __pyx_t_11 = __Pyx_PyObject_Call(__pyx_t_9, __pyx_tuple__35, NULL);
           __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
-          if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1610, __pyx_L1_error)
+          if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1617, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_11);
           __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
         }
         __pyx_r = __pyx_t_12;
         __pyx_t_12 = 0;
         goto __pyx_L0;
       }
@@ -49894,15 +50031,15 @@
     goto __pyx_L43;
     __pyx_L3_error:;
     __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
     goto __pyx_L1_error;
     __pyx_L43:;
   }
 
-  /* "sat_toolkit/formula.pyx":1587
+  /* "sat_toolkit/formula.pyx":1594
  *         return self._clauses._clauses == c_other._clauses._clauses and self._xor_clauses._clauses == c_other._xor_clauses._clauses
  * 
  *     def solve_dimacs(self, command: List[str]=['cryptominisat5'], verbose=False) -> Tuple[bool, np.array|None]:             # <<<<<<<<<<<<<<
  *         """
  *         solves the SAT by calling a DIMACS compliant sat solver that also
  */
 
@@ -49929,15 +50066,15 @@
   __Pyx_XDECREF(__pyx_v_solver);
   __Pyx_XDECREF(__pyx_v_line);
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "sat_toolkit/formula.pyx":1365
+/* "sat_toolkit/formula.pyx":1372
  * 
  * cdef class XorCNF:
  *     cdef readonly CNF _clauses             # <<<<<<<<<<<<<<
  *     cdef readonly XorClauseList _xor_clauses
  * 
  */
 
@@ -49968,15 +50105,15 @@
   /* function exit code */
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "sat_toolkit/formula.pyx":1366
+/* "sat_toolkit/formula.pyx":1373
  * cdef class XorCNF:
  *     cdef readonly CNF _clauses
  *     cdef readonly XorClauseList _xor_clauses             # <<<<<<<<<<<<<<
  * 
  *     def __cinit__(self):
  */
 
@@ -50007,15 +50144,15 @@
   /* function exit code */
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "sat_toolkit/formula.pyx":1672
+/* "sat_toolkit/formula.pyx":1679
  *     INIT_INDEX_SET = object()
  * 
  *     def __init__(self, init_key, numbits, on_set, dc_set):             # <<<<<<<<<<<<<<
  *         if init_key is not self.INIT_INDEX_SET:
  *             raise ValueError('use .from_lut or .from_indices')
  */
 
@@ -50060,50 +50197,50 @@
       kw_args = __Pyx_NumKwargs_VARARGS(__pyx_kwds);
       switch (__pyx_nargs) {
         case  0:
         if (likely((values[0] = __Pyx_GetKwValue_VARARGS(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_init_key)) != 0)) {
           (void)__Pyx_Arg_NewRef_VARARGS(values[0]);
           kw_args--;
         }
-        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 1672, __pyx_L3_error)
+        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 1679, __pyx_L3_error)
         else goto __pyx_L5_argtuple_error;
         CYTHON_FALLTHROUGH;
         case  1:
         if (likely((values[1] = __Pyx_GetKwValue_VARARGS(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_numbits)) != 0)) {
           (void)__Pyx_Arg_NewRef_VARARGS(values[1]);
           kw_args--;
         }
-        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 1672, __pyx_L3_error)
+        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 1679, __pyx_L3_error)
         else {
-          __Pyx_RaiseArgtupleInvalid("__init__", 1, 4, 4, 1); __PYX_ERR(0, 1672, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("__init__", 1, 4, 4, 1); __PYX_ERR(0, 1679, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  2:
         if (likely((values[2] = __Pyx_GetKwValue_VARARGS(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_on_set)) != 0)) {
           (void)__Pyx_Arg_NewRef_VARARGS(values[2]);
           kw_args--;
         }
-        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 1672, __pyx_L3_error)
+        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 1679, __pyx_L3_error)
         else {
-          __Pyx_RaiseArgtupleInvalid("__init__", 1, 4, 4, 2); __PYX_ERR(0, 1672, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("__init__", 1, 4, 4, 2); __PYX_ERR(0, 1679, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  3:
         if (likely((values[3] = __Pyx_GetKwValue_VARARGS(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_dc_set)) != 0)) {
           (void)__Pyx_Arg_NewRef_VARARGS(values[3]);
           kw_args--;
         }
-        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 1672, __pyx_L3_error)
+        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 1679, __pyx_L3_error)
         else {
-          __Pyx_RaiseArgtupleInvalid("__init__", 1, 4, 4, 3); __PYX_ERR(0, 1672, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("__init__", 1, 4, 4, 3); __PYX_ERR(0, 1679, __pyx_L3_error)
         }
       }
       if (unlikely(kw_args > 0)) {
         const Py_ssize_t kwd_pos_args = __pyx_nargs;
-        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values + 0, kwd_pos_args, "__init__") < 0)) __PYX_ERR(0, 1672, __pyx_L3_error)
+        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values + 0, kwd_pos_args, "__init__") < 0)) __PYX_ERR(0, 1679, __pyx_L3_error)
       }
     } else if (unlikely(__pyx_nargs != 4)) {
       goto __pyx_L5_argtuple_error;
     } else {
       values[0] = __Pyx_Arg_VARARGS(__pyx_args, 0);
       values[1] = __Pyx_Arg_VARARGS(__pyx_args, 1);
       values[2] = __Pyx_Arg_VARARGS(__pyx_args, 2);
@@ -50112,15 +50249,15 @@
     __pyx_v_init_key = values[0];
     __pyx_v_numbits = values[1];
     __pyx_v_on_set = values[2];
     __pyx_v_dc_set = values[3];
   }
   goto __pyx_L6_skip;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("__init__", 1, 4, 4, __pyx_nargs); __PYX_ERR(0, 1672, __pyx_L3_error)
+  __Pyx_RaiseArgtupleInvalid("__init__", 1, 4, 4, __pyx_nargs); __PYX_ERR(0, 1679, __pyx_L3_error)
   __pyx_L6_skip:;
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L3_error:;
   {
     Py_ssize_t __pyx_temp;
     for (__pyx_temp=0; __pyx_temp < (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
       __Pyx_Arg_XDECREF_VARARGS(values[__pyx_temp]);
@@ -50155,123 +50292,123 @@
   PyObject *__pyx_t_7 = NULL;
   int __pyx_t_8;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("__init__", 1);
 
-  /* "sat_toolkit/formula.pyx":1673
+  /* "sat_toolkit/formula.pyx":1680
  * 
  *     def __init__(self, init_key, numbits, on_set, dc_set):
  *         if init_key is not self.INIT_INDEX_SET:             # <<<<<<<<<<<<<<
  *             raise ValueError('use .from_lut or .from_indices')
  * 
  */
-  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_self), __pyx_n_s_INIT_INDEX_SET); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1673, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_self), __pyx_n_s_INIT_INDEX_SET); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1680, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_t_2 = (__pyx_v_init_key != __pyx_t_1);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   if (unlikely(__pyx_t_2)) {
 
-    /* "sat_toolkit/formula.pyx":1674
+    /* "sat_toolkit/formula.pyx":1681
  *     def __init__(self, init_key, numbits, on_set, dc_set):
  *         if init_key is not self.INIT_INDEX_SET:
  *             raise ValueError('use .from_lut or .from_indices')             # <<<<<<<<<<<<<<
  * 
  *         if len(on_set.shape) != 1 or (dc_set is not None and len(dc_set.shape) != 1):
  */
-    __pyx_t_1 = __Pyx_PyObject_Call(__pyx_builtin_ValueError, __pyx_tuple__51, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1674, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyObject_Call(__pyx_builtin_ValueError, __pyx_tuple__51, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1681, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_Raise(__pyx_t_1, 0, 0, 0);
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-    __PYX_ERR(0, 1674, __pyx_L1_error)
+    __PYX_ERR(0, 1681, __pyx_L1_error)
 
-    /* "sat_toolkit/formula.pyx":1673
+    /* "sat_toolkit/formula.pyx":1680
  * 
  *     def __init__(self, init_key, numbits, on_set, dc_set):
  *         if init_key is not self.INIT_INDEX_SET:             # <<<<<<<<<<<<<<
  *             raise ValueError('use .from_lut or .from_indices')
  * 
  */
   }
 
-  /* "sat_toolkit/formula.pyx":1676
+  /* "sat_toolkit/formula.pyx":1683
  *             raise ValueError('use .from_lut or .from_indices')
  * 
  *         if len(on_set.shape) != 1 or (dc_set is not None and len(dc_set.shape) != 1):             # <<<<<<<<<<<<<<
  *             raise ValueError('parameters must be one dimensional')
  * 
  */
-  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_on_set, __pyx_n_s_shape); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1676, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_on_set, __pyx_n_s_shape); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1683, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_3 = PyObject_Length(__pyx_t_1); if (unlikely(__pyx_t_3 == ((Py_ssize_t)-1))) __PYX_ERR(0, 1676, __pyx_L1_error)
+  __pyx_t_3 = PyObject_Length(__pyx_t_1); if (unlikely(__pyx_t_3 == ((Py_ssize_t)-1))) __PYX_ERR(0, 1683, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __pyx_t_4 = (__pyx_t_3 != 1);
   if (!__pyx_t_4) {
   } else {
     __pyx_t_2 = __pyx_t_4;
     goto __pyx_L5_bool_binop_done;
   }
   __pyx_t_4 = (__pyx_v_dc_set != Py_None);
   if (__pyx_t_4) {
   } else {
     __pyx_t_2 = __pyx_t_4;
     goto __pyx_L5_bool_binop_done;
   }
-  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_dc_set, __pyx_n_s_shape); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1676, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_dc_set, __pyx_n_s_shape); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1683, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_3 = PyObject_Length(__pyx_t_1); if (unlikely(__pyx_t_3 == ((Py_ssize_t)-1))) __PYX_ERR(0, 1676, __pyx_L1_error)
+  __pyx_t_3 = PyObject_Length(__pyx_t_1); if (unlikely(__pyx_t_3 == ((Py_ssize_t)-1))) __PYX_ERR(0, 1683, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __pyx_t_4 = (__pyx_t_3 != 1);
   __pyx_t_2 = __pyx_t_4;
   __pyx_L5_bool_binop_done:;
   if (unlikely(__pyx_t_2)) {
 
-    /* "sat_toolkit/formula.pyx":1677
+    /* "sat_toolkit/formula.pyx":1684
  * 
  *         if len(on_set.shape) != 1 or (dc_set is not None and len(dc_set.shape) != 1):
  *             raise ValueError('parameters must be one dimensional')             # <<<<<<<<<<<<<<
  * 
  *         self.numbits = numbits
  */
-    __pyx_t_1 = __Pyx_PyObject_Call(__pyx_builtin_ValueError, __pyx_tuple__52, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1677, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyObject_Call(__pyx_builtin_ValueError, __pyx_tuple__52, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1684, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_Raise(__pyx_t_1, 0, 0, 0);
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-    __PYX_ERR(0, 1677, __pyx_L1_error)
+    __PYX_ERR(0, 1684, __pyx_L1_error)
 
-    /* "sat_toolkit/formula.pyx":1676
+    /* "sat_toolkit/formula.pyx":1683
  *             raise ValueError('use .from_lut or .from_indices')
  * 
  *         if len(on_set.shape) != 1 or (dc_set is not None and len(dc_set.shape) != 1):             # <<<<<<<<<<<<<<
  *             raise ValueError('parameters must be one dimensional')
  * 
  */
   }
 
-  /* "sat_toolkit/formula.pyx":1679
+  /* "sat_toolkit/formula.pyx":1686
  *             raise ValueError('parameters must be one dimensional')
  * 
  *         self.numbits = numbits             # <<<<<<<<<<<<<<
  *         self.on_set = np.sort(on_set)
  *         self.dc_set = np.sort(dc_set)
  */
-  __pyx_t_5 = __Pyx_PyInt_As_unsigned_long(__pyx_v_numbits); if (unlikely((__pyx_t_5 == (unsigned long)-1) && PyErr_Occurred())) __PYX_ERR(0, 1679, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyInt_As_unsigned_long(__pyx_v_numbits); if (unlikely((__pyx_t_5 == (unsigned long)-1) && PyErr_Occurred())) __PYX_ERR(0, 1686, __pyx_L1_error)
   __pyx_v_self->numbits = __pyx_t_5;
 
-  /* "sat_toolkit/formula.pyx":1680
+  /* "sat_toolkit/formula.pyx":1687
  * 
  *         self.numbits = numbits
  *         self.on_set = np.sort(on_set)             # <<<<<<<<<<<<<<
  *         self.dc_set = np.sort(dc_set)
  * 
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_6, __pyx_n_s_np); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1680, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_6, __pyx_n_s_np); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1687, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_6);
-  __pyx_t_7 = __Pyx_PyObject_GetAttrStr(__pyx_t_6, __pyx_n_s_sort); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1680, __pyx_L1_error)
+  __pyx_t_7 = __Pyx_PyObject_GetAttrStr(__pyx_t_6, __pyx_n_s_sort); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1687, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_7);
   __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
   __pyx_t_6 = NULL;
   __pyx_t_8 = 0;
   #if CYTHON_UNPACK_METHODS
   if (unlikely(PyMethod_Check(__pyx_t_7))) {
     __pyx_t_6 = PyMethod_GET_SELF(__pyx_t_7);
@@ -50284,34 +50421,34 @@
     }
   }
   #endif
   {
     PyObject *__pyx_callargs[2] = {__pyx_t_6, __pyx_v_on_set};
     __pyx_t_1 = __Pyx_PyObject_FastCall(__pyx_t_7, __pyx_callargs+1-__pyx_t_8, 1+__pyx_t_8);
     __Pyx_XDECREF(__pyx_t_6); __pyx_t_6 = 0;
-    if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1680, __pyx_L1_error)
+    if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1687, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
   }
   __Pyx_GIVEREF(__pyx_t_1);
   __Pyx_GOTREF(__pyx_v_self->on_set);
   __Pyx_DECREF(__pyx_v_self->on_set);
   __pyx_v_self->on_set = __pyx_t_1;
   __pyx_t_1 = 0;
 
-  /* "sat_toolkit/formula.pyx":1681
+  /* "sat_toolkit/formula.pyx":1688
  *         self.numbits = numbits
  *         self.on_set = np.sort(on_set)
  *         self.dc_set = np.sort(dc_set)             # <<<<<<<<<<<<<<
  * 
  * 
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_7, __pyx_n_s_np); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1681, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_7, __pyx_n_s_np); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1688, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_7);
-  __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_t_7, __pyx_n_s_sort); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1681, __pyx_L1_error)
+  __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_t_7, __pyx_n_s_sort); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1688, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_6);
   __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
   __pyx_t_7 = NULL;
   __pyx_t_8 = 0;
   #if CYTHON_UNPACK_METHODS
   if (unlikely(PyMethod_Check(__pyx_t_6))) {
     __pyx_t_7 = PyMethod_GET_SELF(__pyx_t_6);
@@ -50324,25 +50461,25 @@
     }
   }
   #endif
   {
     PyObject *__pyx_callargs[2] = {__pyx_t_7, __pyx_v_dc_set};
     __pyx_t_1 = __Pyx_PyObject_FastCall(__pyx_t_6, __pyx_callargs+1-__pyx_t_8, 1+__pyx_t_8);
     __Pyx_XDECREF(__pyx_t_7); __pyx_t_7 = 0;
-    if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1681, __pyx_L1_error)
+    if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1688, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
   }
   __Pyx_GIVEREF(__pyx_t_1);
   __Pyx_GOTREF(__pyx_v_self->dc_set);
   __Pyx_DECREF(__pyx_v_self->dc_set);
   __pyx_v_self->dc_set = __pyx_t_1;
   __pyx_t_1 = 0;
 
-  /* "sat_toolkit/formula.pyx":1672
+  /* "sat_toolkit/formula.pyx":1679
  *     INIT_INDEX_SET = object()
  * 
  *     def __init__(self, init_key, numbits, on_set, dc_set):             # <<<<<<<<<<<<<<
  *         if init_key is not self.INIT_INDEX_SET:
  *             raise ValueError('use .from_lut or .from_indices')
  */
 
@@ -50356,15 +50493,15 @@
   __Pyx_AddTraceback("sat_toolkit.formula.Truthtable.__init__", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __pyx_r = -1;
   __pyx_L0:;
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "sat_toolkit/formula.pyx":1684
+/* "sat_toolkit/formula.pyx":1691
  * 
  * 
  *     @classmethod             # <<<<<<<<<<<<<<
  *     def from_lut(cls, on_lut: np.ndarray, dc_lut: Optional[np.ndarray] = None) -> Truthtable:
  *         """
  */
 
@@ -50405,15 +50542,15 @@
   __pyx_nargs = PyTuple_Size(__pyx_args); if (unlikely(__pyx_nargs < 0)) return NULL;
   #endif
   #endif
   __pyx_kwvalues = __Pyx_KwValues_FASTCALL(__pyx_args, __pyx_nargs);
   {
     PyObject **__pyx_pyargnames[] = {&__pyx_n_s_on_lut,&__pyx_n_s_dc_lut,0};
 
-    /* "sat_toolkit/formula.pyx":1685
+    /* "sat_toolkit/formula.pyx":1692
  * 
  *     @classmethod
  *     def from_lut(cls, on_lut: np.ndarray, dc_lut: Optional[np.ndarray] = None) -> Truthtable:             # <<<<<<<<<<<<<<
  *         """
  *         Creates a Truthtable from a lookup table (LUT).
  */
     values[1] = __Pyx_Arg_NewRef_FASTCALL(((PyObject *)Py_None));
@@ -50430,27 +50567,27 @@
       kw_args = __Pyx_NumKwargs_FASTCALL(__pyx_kwds);
       switch (__pyx_nargs) {
         case  0:
         if (likely((values[0] = __Pyx_GetKwValue_FASTCALL(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_on_lut)) != 0)) {
           (void)__Pyx_Arg_NewRef_FASTCALL(values[0]);
           kw_args--;
         }
-        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 1684, __pyx_L3_error)
+        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 1691, __pyx_L3_error)
         else goto __pyx_L5_argtuple_error;
         CYTHON_FALLTHROUGH;
         case  1:
         if (kw_args > 0) {
           PyObject* value = __Pyx_GetKwValue_FASTCALL(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_dc_lut);
           if (value) { values[1] = __Pyx_Arg_NewRef_FASTCALL(value); kw_args--; }
-          else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 1684, __pyx_L3_error)
+          else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 1691, __pyx_L3_error)
         }
       }
       if (unlikely(kw_args > 0)) {
         const Py_ssize_t kwd_pos_args = __pyx_nargs;
-        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values + 0, kwd_pos_args, "from_lut") < 0)) __PYX_ERR(0, 1684, __pyx_L3_error)
+        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values + 0, kwd_pos_args, "from_lut") < 0)) __PYX_ERR(0, 1691, __pyx_L3_error)
       }
     } else {
       switch (__pyx_nargs) {
         case  2: values[1] = __Pyx_Arg_FASTCALL(__pyx_args, 1);
         CYTHON_FALLTHROUGH;
         case  1: values[0] = __Pyx_Arg_FASTCALL(__pyx_args, 0);
         break;
@@ -50458,15 +50595,15 @@
       }
     }
     __pyx_v_on_lut = values[0];
     __pyx_v_dc_lut = values[1];
   }
   goto __pyx_L6_skip;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("from_lut", 0, 1, 2, __pyx_nargs); __PYX_ERR(0, 1684, __pyx_L3_error)
+  __Pyx_RaiseArgtupleInvalid("from_lut", 0, 1, 2, __pyx_nargs); __PYX_ERR(0, 1691, __pyx_L3_error)
   __pyx_L6_skip:;
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L3_error:;
   {
     Py_ssize_t __pyx_temp;
     for (__pyx_temp=0; __pyx_temp < (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
       __Pyx_Arg_XDECREF_FASTCALL(values[__pyx_temp]);
@@ -50474,15 +50611,15 @@
   }
   __Pyx_AddTraceback("sat_toolkit.formula.Truthtable.from_lut", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __Pyx_RefNannyFinishContext();
   return NULL;
   __pyx_L4_argument_unpacking_done:;
   __pyx_r = __pyx_pf_11sat_toolkit_7formula_10Truthtable_2from_lut(((PyTypeObject*)__pyx_v_cls), __pyx_v_on_lut, __pyx_v_dc_lut);
 
-  /* "sat_toolkit/formula.pyx":1684
+  /* "sat_toolkit/formula.pyx":1691
  * 
  * 
  *     @classmethod             # <<<<<<<<<<<<<<
  *     def from_lut(cls, on_lut: np.ndarray, dc_lut: Optional[np.ndarray] = None) -> Truthtable:
  *         """
  */
 
@@ -50515,185 +50652,185 @@
   PyObject *(*__pyx_t_9)(PyObject *);
   PyObject *__pyx_t_10 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("from_lut", 1);
 
-  /* "sat_toolkit/formula.pyx":1695
+  /* "sat_toolkit/formula.pyx":1702
  *         :rtype: Truthtable
  *         """
  *         if len(on_lut.shape) != 1 or (dc_lut is not None and len(dc_lut.shape) != 1):             # <<<<<<<<<<<<<<
  *             raise ValueError('parameters must be one dimensional')
  * 
  */
-  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_on_lut, __pyx_n_s_shape); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1695, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_on_lut, __pyx_n_s_shape); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1702, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_3 = PyObject_Length(__pyx_t_2); if (unlikely(__pyx_t_3 == ((Py_ssize_t)-1))) __PYX_ERR(0, 1695, __pyx_L1_error)
+  __pyx_t_3 = PyObject_Length(__pyx_t_2); if (unlikely(__pyx_t_3 == ((Py_ssize_t)-1))) __PYX_ERR(0, 1702, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   __pyx_t_4 = (__pyx_t_3 != 1);
   if (!__pyx_t_4) {
   } else {
     __pyx_t_1 = __pyx_t_4;
     goto __pyx_L4_bool_binop_done;
   }
   __pyx_t_4 = (__pyx_v_dc_lut != Py_None);
   if (__pyx_t_4) {
   } else {
     __pyx_t_1 = __pyx_t_4;
     goto __pyx_L4_bool_binop_done;
   }
-  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_dc_lut, __pyx_n_s_shape); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1695, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_dc_lut, __pyx_n_s_shape); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1702, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_3 = PyObject_Length(__pyx_t_2); if (unlikely(__pyx_t_3 == ((Py_ssize_t)-1))) __PYX_ERR(0, 1695, __pyx_L1_error)
+  __pyx_t_3 = PyObject_Length(__pyx_t_2); if (unlikely(__pyx_t_3 == ((Py_ssize_t)-1))) __PYX_ERR(0, 1702, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   __pyx_t_4 = (__pyx_t_3 != 1);
   __pyx_t_1 = __pyx_t_4;
   __pyx_L4_bool_binop_done:;
   if (unlikely(__pyx_t_1)) {
 
-    /* "sat_toolkit/formula.pyx":1696
+    /* "sat_toolkit/formula.pyx":1703
  *         """
  *         if len(on_lut.shape) != 1 or (dc_lut is not None and len(dc_lut.shape) != 1):
  *             raise ValueError('parameters must be one dimensional')             # <<<<<<<<<<<<<<
  * 
  *         if dc_lut is not None and on_lut.shape != dc_lut.shape:
  */
-    __pyx_t_2 = __Pyx_PyObject_Call(__pyx_builtin_ValueError, __pyx_tuple__52, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1696, __pyx_L1_error)
+    __pyx_t_2 = __Pyx_PyObject_Call(__pyx_builtin_ValueError, __pyx_tuple__52, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1703, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
     __Pyx_Raise(__pyx_t_2, 0, 0, 0);
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-    __PYX_ERR(0, 1696, __pyx_L1_error)
+    __PYX_ERR(0, 1703, __pyx_L1_error)
 
-    /* "sat_toolkit/formula.pyx":1695
+    /* "sat_toolkit/formula.pyx":1702
  *         :rtype: Truthtable
  *         """
  *         if len(on_lut.shape) != 1 or (dc_lut is not None and len(dc_lut.shape) != 1):             # <<<<<<<<<<<<<<
  *             raise ValueError('parameters must be one dimensional')
  * 
  */
   }
 
-  /* "sat_toolkit/formula.pyx":1698
+  /* "sat_toolkit/formula.pyx":1705
  *             raise ValueError('parameters must be one dimensional')
  * 
  *         if dc_lut is not None and on_lut.shape != dc_lut.shape:             # <<<<<<<<<<<<<<
  *             raise ValueError('parameters must have the same shape')
  * 
  */
   __pyx_t_4 = (__pyx_v_dc_lut != Py_None);
   if (__pyx_t_4) {
   } else {
     __pyx_t_1 = __pyx_t_4;
     goto __pyx_L8_bool_binop_done;
   }
-  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_on_lut, __pyx_n_s_shape); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1698, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_on_lut, __pyx_n_s_shape); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1705, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_v_dc_lut, __pyx_n_s_shape); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1698, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_v_dc_lut, __pyx_n_s_shape); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1705, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
-  __pyx_t_6 = PyObject_RichCompare(__pyx_t_2, __pyx_t_5, Py_NE); __Pyx_XGOTREF(__pyx_t_6); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1698, __pyx_L1_error)
+  __pyx_t_6 = PyObject_RichCompare(__pyx_t_2, __pyx_t_5, Py_NE); __Pyx_XGOTREF(__pyx_t_6); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1705, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-  __pyx_t_4 = __Pyx_PyObject_IsTrue(__pyx_t_6); if (unlikely((__pyx_t_4 < 0))) __PYX_ERR(0, 1698, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyObject_IsTrue(__pyx_t_6); if (unlikely((__pyx_t_4 < 0))) __PYX_ERR(0, 1705, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
   __pyx_t_1 = __pyx_t_4;
   __pyx_L8_bool_binop_done:;
   if (unlikely(__pyx_t_1)) {
 
-    /* "sat_toolkit/formula.pyx":1699
+    /* "sat_toolkit/formula.pyx":1706
  * 
  *         if dc_lut is not None and on_lut.shape != dc_lut.shape:
  *             raise ValueError('parameters must have the same shape')             # <<<<<<<<<<<<<<
  * 
  *         numvals = on_lut.shape[0]
  */
-    __pyx_t_6 = __Pyx_PyObject_Call(__pyx_builtin_ValueError, __pyx_tuple__53, NULL); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1699, __pyx_L1_error)
+    __pyx_t_6 = __Pyx_PyObject_Call(__pyx_builtin_ValueError, __pyx_tuple__53, NULL); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1706, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
     __Pyx_Raise(__pyx_t_6, 0, 0, 0);
     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-    __PYX_ERR(0, 1699, __pyx_L1_error)
+    __PYX_ERR(0, 1706, __pyx_L1_error)
 
-    /* "sat_toolkit/formula.pyx":1698
+    /* "sat_toolkit/formula.pyx":1705
  *             raise ValueError('parameters must be one dimensional')
  * 
  *         if dc_lut is not None and on_lut.shape != dc_lut.shape:             # <<<<<<<<<<<<<<
  *             raise ValueError('parameters must have the same shape')
  * 
  */
   }
 
-  /* "sat_toolkit/formula.pyx":1701
+  /* "sat_toolkit/formula.pyx":1708
  *             raise ValueError('parameters must have the same shape')
  * 
  *         numvals = on_lut.shape[0]             # <<<<<<<<<<<<<<
  *         if (numvals & (numvals - 1)) != 0 or numvals == 0:
  *             raise ValueError('length parameter must be a power of 2')
  */
-  __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_v_on_lut, __pyx_n_s_shape); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1701, __pyx_L1_error)
+  __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_v_on_lut, __pyx_n_s_shape); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1708, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_6);
-  __pyx_t_5 = __Pyx_GetItemInt(__pyx_t_6, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 0); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1701, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_GetItemInt(__pyx_t_6, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 0); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1708, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
   __pyx_v_numvals = __pyx_t_5;
   __pyx_t_5 = 0;
 
-  /* "sat_toolkit/formula.pyx":1702
+  /* "sat_toolkit/formula.pyx":1709
  * 
  *         numvals = on_lut.shape[0]
  *         if (numvals & (numvals - 1)) != 0 or numvals == 0:             # <<<<<<<<<<<<<<
  *             raise ValueError('length parameter must be a power of 2')
  * 
  */
-  __pyx_t_5 = __Pyx_PyInt_SubtractObjC(__pyx_v_numvals, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1702, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyInt_SubtractObjC(__pyx_v_numvals, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1709, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
-  __pyx_t_6 = PyNumber_And(__pyx_v_numvals, __pyx_t_5); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1702, __pyx_L1_error)
+  __pyx_t_6 = PyNumber_And(__pyx_v_numvals, __pyx_t_5); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1709, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_6);
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-  __pyx_t_4 = (__Pyx_PyInt_BoolNeObjC(__pyx_t_6, __pyx_int_0, 0, 0)); if (unlikely((__pyx_t_4 < 0))) __PYX_ERR(0, 1702, __pyx_L1_error)
+  __pyx_t_4 = (__Pyx_PyInt_BoolNeObjC(__pyx_t_6, __pyx_int_0, 0, 0)); if (unlikely((__pyx_t_4 < 0))) __PYX_ERR(0, 1709, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
   if (!__pyx_t_4) {
   } else {
     __pyx_t_1 = __pyx_t_4;
     goto __pyx_L11_bool_binop_done;
   }
-  __pyx_t_4 = (__Pyx_PyInt_BoolEqObjC(__pyx_v_numvals, __pyx_int_0, 0, 0)); if (unlikely((__pyx_t_4 < 0))) __PYX_ERR(0, 1702, __pyx_L1_error)
+  __pyx_t_4 = (__Pyx_PyInt_BoolEqObjC(__pyx_v_numvals, __pyx_int_0, 0, 0)); if (unlikely((__pyx_t_4 < 0))) __PYX_ERR(0, 1709, __pyx_L1_error)
   __pyx_t_1 = __pyx_t_4;
   __pyx_L11_bool_binop_done:;
   if (unlikely(__pyx_t_1)) {
 
-    /* "sat_toolkit/formula.pyx":1703
+    /* "sat_toolkit/formula.pyx":1710
  *         numvals = on_lut.shape[0]
  *         if (numvals & (numvals - 1)) != 0 or numvals == 0:
  *             raise ValueError('length parameter must be a power of 2')             # <<<<<<<<<<<<<<
  * 
  *         numbits = numvals.bit_length() - 1
  */
-    __pyx_t_6 = __Pyx_PyObject_Call(__pyx_builtin_ValueError, __pyx_tuple__54, NULL); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1703, __pyx_L1_error)
+    __pyx_t_6 = __Pyx_PyObject_Call(__pyx_builtin_ValueError, __pyx_tuple__54, NULL); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1710, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
     __Pyx_Raise(__pyx_t_6, 0, 0, 0);
     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-    __PYX_ERR(0, 1703, __pyx_L1_error)
+    __PYX_ERR(0, 1710, __pyx_L1_error)
 
-    /* "sat_toolkit/formula.pyx":1702
+    /* "sat_toolkit/formula.pyx":1709
  * 
  *         numvals = on_lut.shape[0]
  *         if (numvals & (numvals - 1)) != 0 or numvals == 0:             # <<<<<<<<<<<<<<
  *             raise ValueError('length parameter must be a power of 2')
  * 
  */
   }
 
-  /* "sat_toolkit/formula.pyx":1705
+  /* "sat_toolkit/formula.pyx":1712
  *             raise ValueError('length parameter must be a power of 2')
  * 
  *         numbits = numvals.bit_length() - 1             # <<<<<<<<<<<<<<
  * 
  *         if dc_lut is not None and np.any(on_lut & dc_lut):
  */
-  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_v_numvals, __pyx_n_s_bit_length); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1705, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_v_numvals, __pyx_n_s_bit_length); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1712, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
   __pyx_t_2 = NULL;
   __pyx_t_7 = 0;
   #if CYTHON_UNPACK_METHODS
   if (likely(PyMethod_Check(__pyx_t_5))) {
     __pyx_t_2 = PyMethod_GET_SELF(__pyx_t_5);
     if (likely(__pyx_t_2)) {
@@ -50705,43 +50842,43 @@
     }
   }
   #endif
   {
     PyObject *__pyx_callargs[2] = {__pyx_t_2, NULL};
     __pyx_t_6 = __Pyx_PyObject_FastCall(__pyx_t_5, __pyx_callargs+1-__pyx_t_7, 0+__pyx_t_7);
     __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
-    if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1705, __pyx_L1_error)
+    if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1712, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
   }
-  __pyx_t_5 = __Pyx_PyInt_SubtractObjC(__pyx_t_6, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1705, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyInt_SubtractObjC(__pyx_t_6, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1712, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
   __pyx_v_numbits = __pyx_t_5;
   __pyx_t_5 = 0;
 
-  /* "sat_toolkit/formula.pyx":1707
+  /* "sat_toolkit/formula.pyx":1714
  *         numbits = numvals.bit_length() - 1
  * 
  *         if dc_lut is not None and np.any(on_lut & dc_lut):             # <<<<<<<<<<<<<<
  *             raise ValueError('on_lut and dc_lut must be distinct')
  * 
  */
   __pyx_t_4 = (__pyx_v_dc_lut != Py_None);
   if (__pyx_t_4) {
   } else {
     __pyx_t_1 = __pyx_t_4;
     goto __pyx_L14_bool_binop_done;
   }
-  __Pyx_GetModuleGlobalName(__pyx_t_6, __pyx_n_s_np); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1707, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_6, __pyx_n_s_np); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1714, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_6);
-  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_6, __pyx_n_s_any); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1707, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_6, __pyx_n_s_any); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1714, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-  __pyx_t_6 = PyNumber_And(__pyx_v_on_lut, __pyx_v_dc_lut); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1707, __pyx_L1_error)
+  __pyx_t_6 = PyNumber_And(__pyx_v_on_lut, __pyx_v_dc_lut); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1714, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_6);
   __pyx_t_8 = NULL;
   __pyx_t_7 = 0;
   #if CYTHON_UNPACK_METHODS
   if (unlikely(PyMethod_Check(__pyx_t_2))) {
     __pyx_t_8 = PyMethod_GET_SELF(__pyx_t_2);
     if (likely(__pyx_t_8)) {
@@ -50754,56 +50891,56 @@
   }
   #endif
   {
     PyObject *__pyx_callargs[2] = {__pyx_t_8, __pyx_t_6};
     __pyx_t_5 = __Pyx_PyObject_FastCall(__pyx_t_2, __pyx_callargs+1-__pyx_t_7, 1+__pyx_t_7);
     __Pyx_XDECREF(__pyx_t_8); __pyx_t_8 = 0;
     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-    if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1707, __pyx_L1_error)
+    if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1714, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   }
-  __pyx_t_4 = __Pyx_PyObject_IsTrue(__pyx_t_5); if (unlikely((__pyx_t_4 < 0))) __PYX_ERR(0, 1707, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyObject_IsTrue(__pyx_t_5); if (unlikely((__pyx_t_4 < 0))) __PYX_ERR(0, 1714, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
   __pyx_t_1 = __pyx_t_4;
   __pyx_L14_bool_binop_done:;
   if (unlikely(__pyx_t_1)) {
 
-    /* "sat_toolkit/formula.pyx":1708
+    /* "sat_toolkit/formula.pyx":1715
  * 
  *         if dc_lut is not None and np.any(on_lut & dc_lut):
  *             raise ValueError('on_lut and dc_lut must be distinct')             # <<<<<<<<<<<<<<
  * 
  *         on_set, = np.where(on_lut)
  */
-    __pyx_t_5 = __Pyx_PyObject_Call(__pyx_builtin_ValueError, __pyx_tuple__55, NULL); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1708, __pyx_L1_error)
+    __pyx_t_5 = __Pyx_PyObject_Call(__pyx_builtin_ValueError, __pyx_tuple__55, NULL); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1715, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
     __Pyx_Raise(__pyx_t_5, 0, 0, 0);
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-    __PYX_ERR(0, 1708, __pyx_L1_error)
+    __PYX_ERR(0, 1715, __pyx_L1_error)
 
-    /* "sat_toolkit/formula.pyx":1707
+    /* "sat_toolkit/formula.pyx":1714
  *         numbits = numvals.bit_length() - 1
  * 
  *         if dc_lut is not None and np.any(on_lut & dc_lut):             # <<<<<<<<<<<<<<
  *             raise ValueError('on_lut and dc_lut must be distinct')
  * 
  */
   }
 
-  /* "sat_toolkit/formula.pyx":1710
+  /* "sat_toolkit/formula.pyx":1717
  *             raise ValueError('on_lut and dc_lut must be distinct')
  * 
  *         on_set, = np.where(on_lut)             # <<<<<<<<<<<<<<
  *         dc_set, = np.where(dc_lut) if dc_lut is not None else (np.array([], int),)
  *         return cls(cls.INIT_INDEX_SET, numbits, on_set, dc_set)
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1710, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1717, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_where); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1710, __pyx_L1_error)
+  __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_where); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1717, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_6);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   __pyx_t_2 = NULL;
   __pyx_t_7 = 0;
   #if CYTHON_UNPACK_METHODS
   if (unlikely(PyMethod_Check(__pyx_t_6))) {
     __pyx_t_2 = PyMethod_GET_SELF(__pyx_t_6);
@@ -50816,72 +50953,72 @@
     }
   }
   #endif
   {
     PyObject *__pyx_callargs[2] = {__pyx_t_2, __pyx_v_on_lut};
     __pyx_t_5 = __Pyx_PyObject_FastCall(__pyx_t_6, __pyx_callargs+1-__pyx_t_7, 1+__pyx_t_7);
     __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
-    if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1710, __pyx_L1_error)
+    if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1717, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
   }
   if ((likely(PyTuple_CheckExact(__pyx_t_5))) || (PyList_CheckExact(__pyx_t_5))) {
     PyObject* sequence = __pyx_t_5;
     Py_ssize_t size = __Pyx_PySequence_SIZE(sequence);
     if (unlikely(size != 1)) {
       if (size > 1) __Pyx_RaiseTooManyValuesError(1);
       else if (size >= 0) __Pyx_RaiseNeedMoreValuesError(size);
-      __PYX_ERR(0, 1710, __pyx_L1_error)
+      __PYX_ERR(0, 1717, __pyx_L1_error)
     }
     #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
     if (likely(PyTuple_CheckExact(sequence))) {
       __pyx_t_6 = PyTuple_GET_ITEM(sequence, 0); 
     } else {
       __pyx_t_6 = PyList_GET_ITEM(sequence, 0); 
     }
     __Pyx_INCREF(__pyx_t_6);
     #else
-    __pyx_t_6 = PySequence_ITEM(sequence, 0); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1710, __pyx_L1_error)
+    __pyx_t_6 = PySequence_ITEM(sequence, 0); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1717, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
     #endif
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
   } else {
     Py_ssize_t index = -1;
-    __pyx_t_2 = PyObject_GetIter(__pyx_t_5); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1710, __pyx_L1_error)
+    __pyx_t_2 = PyObject_GetIter(__pyx_t_5); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1717, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
     __pyx_t_9 = __Pyx_PyObject_GetIterNextFunc(__pyx_t_2);
     index = 0; __pyx_t_6 = __pyx_t_9(__pyx_t_2); if (unlikely(!__pyx_t_6)) goto __pyx_L16_unpacking_failed;
     __Pyx_GOTREF(__pyx_t_6);
-    if (__Pyx_IternextUnpackEndCheck(__pyx_t_9(__pyx_t_2), 1) < 0) __PYX_ERR(0, 1710, __pyx_L1_error)
+    if (__Pyx_IternextUnpackEndCheck(__pyx_t_9(__pyx_t_2), 1) < 0) __PYX_ERR(0, 1717, __pyx_L1_error)
     __pyx_t_9 = NULL;
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
     goto __pyx_L17_unpacking_done;
     __pyx_L16_unpacking_failed:;
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
     __pyx_t_9 = NULL;
     if (__Pyx_IterFinish() == 0) __Pyx_RaiseNeedMoreValuesError(index);
-    __PYX_ERR(0, 1710, __pyx_L1_error)
+    __PYX_ERR(0, 1717, __pyx_L1_error)
     __pyx_L17_unpacking_done:;
   }
   __pyx_v_on_set = __pyx_t_6;
   __pyx_t_6 = 0;
 
-  /* "sat_toolkit/formula.pyx":1711
+  /* "sat_toolkit/formula.pyx":1718
  * 
  *         on_set, = np.where(on_lut)
  *         dc_set, = np.where(dc_lut) if dc_lut is not None else (np.array([], int),)             # <<<<<<<<<<<<<<
  *         return cls(cls.INIT_INDEX_SET, numbits, on_set, dc_set)
  * 
  */
   __pyx_t_1 = (__pyx_v_dc_lut != Py_None);
   if (__pyx_t_1) {
-    __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1711, __pyx_L1_error)
+    __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1718, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
-    __pyx_t_8 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_where); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1711, __pyx_L1_error)
+    __pyx_t_8 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_where); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1718, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_8);
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
     __pyx_t_2 = NULL;
     __pyx_t_7 = 0;
     #if CYTHON_UNPACK_METHODS
     if (unlikely(PyMethod_Check(__pyx_t_8))) {
       __pyx_t_2 = PyMethod_GET_SELF(__pyx_t_8);
@@ -50894,27 +51031,27 @@
       }
     }
     #endif
     {
       PyObject *__pyx_callargs[2] = {__pyx_t_2, __pyx_v_dc_lut};
       __pyx_t_6 = __Pyx_PyObject_FastCall(__pyx_t_8, __pyx_callargs+1-__pyx_t_7, 1+__pyx_t_7);
       __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
-      if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1711, __pyx_L1_error)
+      if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1718, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_6);
       __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
     }
     __pyx_t_5 = __pyx_t_6;
     __pyx_t_6 = 0;
   } else {
-    __Pyx_GetModuleGlobalName(__pyx_t_8, __pyx_n_s_np); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1711, __pyx_L1_error)
+    __Pyx_GetModuleGlobalName(__pyx_t_8, __pyx_n_s_np); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1718, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_8);
-    __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_8, __pyx_n_s_array); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1711, __pyx_L1_error)
+    __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_8, __pyx_n_s_array); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1718, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
     __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
-    __pyx_t_8 = PyList_New(0); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1711, __pyx_L1_error)
+    __pyx_t_8 = PyList_New(0); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1718, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_8);
     __pyx_t_10 = NULL;
     __pyx_t_7 = 0;
     #if CYTHON_UNPACK_METHODS
     if (unlikely(PyMethod_Check(__pyx_t_2))) {
       __pyx_t_10 = PyMethod_GET_SELF(__pyx_t_2);
       if (likely(__pyx_t_10)) {
@@ -50927,101 +51064,101 @@
     }
     #endif
     {
       PyObject *__pyx_callargs[3] = {__pyx_t_10, __pyx_t_8, ((PyObject *)(&PyInt_Type))};
       __pyx_t_6 = __Pyx_PyObject_FastCall(__pyx_t_2, __pyx_callargs+1-__pyx_t_7, 2+__pyx_t_7);
       __Pyx_XDECREF(__pyx_t_10); __pyx_t_10 = 0;
       __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
-      if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1711, __pyx_L1_error)
+      if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1718, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_6);
       __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
     }
-    __pyx_t_2 = PyTuple_New(1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1711, __pyx_L1_error)
+    __pyx_t_2 = PyTuple_New(1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1718, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
     __Pyx_GIVEREF(__pyx_t_6);
-    if (__Pyx_PyTuple_SET_ITEM(__pyx_t_2, 0, __pyx_t_6)) __PYX_ERR(0, 1711, __pyx_L1_error);
+    if (__Pyx_PyTuple_SET_ITEM(__pyx_t_2, 0, __pyx_t_6)) __PYX_ERR(0, 1718, __pyx_L1_error);
     __pyx_t_6 = 0;
     __pyx_t_5 = __pyx_t_2;
     __pyx_t_2 = 0;
   }
   if ((likely(PyTuple_CheckExact(__pyx_t_5))) || (PyList_CheckExact(__pyx_t_5))) {
     PyObject* sequence = __pyx_t_5;
     Py_ssize_t size = __Pyx_PySequence_SIZE(sequence);
     if (unlikely(size != 1)) {
       if (size > 1) __Pyx_RaiseTooManyValuesError(1);
       else if (size >= 0) __Pyx_RaiseNeedMoreValuesError(size);
-      __PYX_ERR(0, 1711, __pyx_L1_error)
+      __PYX_ERR(0, 1718, __pyx_L1_error)
     }
     #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
     if (likely(PyTuple_CheckExact(sequence))) {
       __pyx_t_2 = PyTuple_GET_ITEM(sequence, 0); 
     } else {
       __pyx_t_2 = PyList_GET_ITEM(sequence, 0); 
     }
     __Pyx_INCREF(__pyx_t_2);
     #else
-    __pyx_t_2 = PySequence_ITEM(sequence, 0); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1711, __pyx_L1_error)
+    __pyx_t_2 = PySequence_ITEM(sequence, 0); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1718, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
     #endif
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
   } else {
     Py_ssize_t index = -1;
-    __pyx_t_6 = PyObject_GetIter(__pyx_t_5); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1711, __pyx_L1_error)
+    __pyx_t_6 = PyObject_GetIter(__pyx_t_5); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1718, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
     __pyx_t_9 = __Pyx_PyObject_GetIterNextFunc(__pyx_t_6);
     index = 0; __pyx_t_2 = __pyx_t_9(__pyx_t_6); if (unlikely(!__pyx_t_2)) goto __pyx_L18_unpacking_failed;
     __Pyx_GOTREF(__pyx_t_2);
-    if (__Pyx_IternextUnpackEndCheck(__pyx_t_9(__pyx_t_6), 1) < 0) __PYX_ERR(0, 1711, __pyx_L1_error)
+    if (__Pyx_IternextUnpackEndCheck(__pyx_t_9(__pyx_t_6), 1) < 0) __PYX_ERR(0, 1718, __pyx_L1_error)
     __pyx_t_9 = NULL;
     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
     goto __pyx_L19_unpacking_done;
     __pyx_L18_unpacking_failed:;
     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
     __pyx_t_9 = NULL;
     if (__Pyx_IterFinish() == 0) __Pyx_RaiseNeedMoreValuesError(index);
-    __PYX_ERR(0, 1711, __pyx_L1_error)
+    __PYX_ERR(0, 1718, __pyx_L1_error)
     __pyx_L19_unpacking_done:;
   }
   __pyx_v_dc_set = __pyx_t_2;
   __pyx_t_2 = 0;
 
-  /* "sat_toolkit/formula.pyx":1712
+  /* "sat_toolkit/formula.pyx":1719
  *         on_set, = np.where(on_lut)
  *         dc_set, = np.where(dc_lut) if dc_lut is not None else (np.array([], int),)
  *         return cls(cls.INIT_INDEX_SET, numbits, on_set, dc_set)             # <<<<<<<<<<<<<<
  * 
  *     @classmethod
  */
   __Pyx_XDECREF((PyObject *)__pyx_r);
-  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_cls), __pyx_n_s_INIT_INDEX_SET); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1712, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_cls), __pyx_n_s_INIT_INDEX_SET); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1719, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
-  __pyx_t_2 = PyTuple_New(4); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1712, __pyx_L1_error)
+  __pyx_t_2 = PyTuple_New(4); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1719, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_GIVEREF(__pyx_t_5);
-  if (__Pyx_PyTuple_SET_ITEM(__pyx_t_2, 0, __pyx_t_5)) __PYX_ERR(0, 1712, __pyx_L1_error);
+  if (__Pyx_PyTuple_SET_ITEM(__pyx_t_2, 0, __pyx_t_5)) __PYX_ERR(0, 1719, __pyx_L1_error);
   __Pyx_INCREF(__pyx_v_numbits);
   __Pyx_GIVEREF(__pyx_v_numbits);
-  if (__Pyx_PyTuple_SET_ITEM(__pyx_t_2, 1, __pyx_v_numbits)) __PYX_ERR(0, 1712, __pyx_L1_error);
+  if (__Pyx_PyTuple_SET_ITEM(__pyx_t_2, 1, __pyx_v_numbits)) __PYX_ERR(0, 1719, __pyx_L1_error);
   __Pyx_INCREF(__pyx_v_on_set);
   __Pyx_GIVEREF(__pyx_v_on_set);
-  if (__Pyx_PyTuple_SET_ITEM(__pyx_t_2, 2, __pyx_v_on_set)) __PYX_ERR(0, 1712, __pyx_L1_error);
+  if (__Pyx_PyTuple_SET_ITEM(__pyx_t_2, 2, __pyx_v_on_set)) __PYX_ERR(0, 1719, __pyx_L1_error);
   __Pyx_INCREF(__pyx_v_dc_set);
   __Pyx_GIVEREF(__pyx_v_dc_set);
-  if (__Pyx_PyTuple_SET_ITEM(__pyx_t_2, 3, __pyx_v_dc_set)) __PYX_ERR(0, 1712, __pyx_L1_error);
+  if (__Pyx_PyTuple_SET_ITEM(__pyx_t_2, 3, __pyx_v_dc_set)) __PYX_ERR(0, 1719, __pyx_L1_error);
   __pyx_t_5 = 0;
-  __pyx_t_5 = __Pyx_PyObject_Call(((PyObject *)__pyx_v_cls), __pyx_t_2, NULL); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1712, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyObject_Call(((PyObject *)__pyx_v_cls), __pyx_t_2, NULL); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1719, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  if (!(likely(((__pyx_t_5) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_5, __pyx_ptype_11sat_toolkit_7formula_Truthtable))))) __PYX_ERR(0, 1712, __pyx_L1_error)
+  if (!(likely(((__pyx_t_5) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_5, __pyx_ptype_11sat_toolkit_7formula_Truthtable))))) __PYX_ERR(0, 1719, __pyx_L1_error)
   __pyx_r = ((struct __pyx_obj_11sat_toolkit_7formula_Truthtable *)__pyx_t_5);
   __pyx_t_5 = 0;
   goto __pyx_L0;
 
-  /* "sat_toolkit/formula.pyx":1684
+  /* "sat_toolkit/formula.pyx":1691
  * 
  * 
  *     @classmethod             # <<<<<<<<<<<<<<
  *     def from_lut(cls, on_lut: np.ndarray, dc_lut: Optional[np.ndarray] = None) -> Truthtable:
  *         """
  */
 
@@ -51040,15 +51177,15 @@
   __Pyx_XDECREF(__pyx_v_on_set);
   __Pyx_XDECREF(__pyx_v_dc_set);
   __Pyx_XGIVEREF((PyObject *)__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "sat_toolkit/formula.pyx":1714
+/* "sat_toolkit/formula.pyx":1721
  *         return cls(cls.INIT_INDEX_SET, numbits, on_set, dc_set)
  * 
  *     @classmethod             # <<<<<<<<<<<<<<
  *     def from_indices(cls, numbits: int, on_indices: np.array, dc_indices = np.array([], dtype=int)) -> Truthtable:
  *         """
  */
 
@@ -51109,37 +51246,37 @@
       kw_args = __Pyx_NumKwargs_FASTCALL(__pyx_kwds);
       switch (__pyx_nargs) {
         case  0:
         if (likely((values[0] = __Pyx_GetKwValue_FASTCALL(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_numbits)) != 0)) {
           (void)__Pyx_Arg_NewRef_FASTCALL(values[0]);
           kw_args--;
         }
-        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 1714, __pyx_L3_error)
+        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 1721, __pyx_L3_error)
         else goto __pyx_L5_argtuple_error;
         CYTHON_FALLTHROUGH;
         case  1:
         if (likely((values[1] = __Pyx_GetKwValue_FASTCALL(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_on_indices)) != 0)) {
           (void)__Pyx_Arg_NewRef_FASTCALL(values[1]);
           kw_args--;
         }
-        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 1714, __pyx_L3_error)
+        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 1721, __pyx_L3_error)
         else {
-          __Pyx_RaiseArgtupleInvalid("from_indices", 0, 2, 3, 1); __PYX_ERR(0, 1714, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("from_indices", 0, 2, 3, 1); __PYX_ERR(0, 1721, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  2:
         if (kw_args > 0) {
           PyObject* value = __Pyx_GetKwValue_FASTCALL(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_dc_indices);
           if (value) { values[2] = __Pyx_Arg_NewRef_FASTCALL(value); kw_args--; }
-          else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 1714, __pyx_L3_error)
+          else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 1721, __pyx_L3_error)
         }
       }
       if (unlikely(kw_args > 0)) {
         const Py_ssize_t kwd_pos_args = __pyx_nargs;
-        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values + 0, kwd_pos_args, "from_indices") < 0)) __PYX_ERR(0, 1714, __pyx_L3_error)
+        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values + 0, kwd_pos_args, "from_indices") < 0)) __PYX_ERR(0, 1721, __pyx_L3_error)
       }
     } else {
       switch (__pyx_nargs) {
         case  3: values[2] = __Pyx_Arg_FASTCALL(__pyx_args, 2);
         CYTHON_FALLTHROUGH;
         case  2: values[1] = __Pyx_Arg_FASTCALL(__pyx_args, 1);
         values[0] = __Pyx_Arg_FASTCALL(__pyx_args, 0);
@@ -51149,29 +51286,29 @@
     }
     __pyx_v_numbits = ((PyObject*)values[0]);
     __pyx_v_on_indices = values[1];
     __pyx_v_dc_indices = values[2];
   }
   goto __pyx_L6_skip;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("from_indices", 0, 2, 3, __pyx_nargs); __PYX_ERR(0, 1714, __pyx_L3_error)
+  __Pyx_RaiseArgtupleInvalid("from_indices", 0, 2, 3, __pyx_nargs); __PYX_ERR(0, 1721, __pyx_L3_error)
   __pyx_L6_skip:;
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L3_error:;
   {
     Py_ssize_t __pyx_temp;
     for (__pyx_temp=0; __pyx_temp < (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
       __Pyx_Arg_XDECREF_FASTCALL(values[__pyx_temp]);
     }
   }
   __Pyx_AddTraceback("sat_toolkit.formula.Truthtable.from_indices", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __Pyx_RefNannyFinishContext();
   return NULL;
   __pyx_L4_argument_unpacking_done:;
-  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_numbits), (&PyInt_Type), 0, "numbits", 1))) __PYX_ERR(0, 1715, __pyx_L1_error)
+  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_numbits), (&PyInt_Type), 0, "numbits", 1))) __PYX_ERR(0, 1722, __pyx_L1_error)
   __pyx_r = __pyx_pf_11sat_toolkit_7formula_10Truthtable_4from_indices(((PyTypeObject*)__pyx_v_cls), __pyx_v_numbits, __pyx_v_on_indices, __pyx_v_dc_indices);
 
   /* function exit code */
   goto __pyx_L0;
   __pyx_L1_error:;
   __pyx_r = NULL;
   __pyx_L0:;
@@ -51191,47 +51328,47 @@
   PyObject *__pyx_t_1 = NULL;
   PyObject *__pyx_t_2 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("from_indices", 1);
 
-  /* "sat_toolkit/formula.pyx":1726
+  /* "sat_toolkit/formula.pyx":1733
  *         :rtype: Truthtable
  *         """
  *         return cls(cls.INIT_INDEX_SET, numbits, on_indices, dc_indices)             # <<<<<<<<<<<<<<
  * 
  * 
  */
   __Pyx_XDECREF((PyObject *)__pyx_r);
-  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_cls), __pyx_n_s_INIT_INDEX_SET); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1726, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_cls), __pyx_n_s_INIT_INDEX_SET); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1733, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_2 = PyTuple_New(4); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1726, __pyx_L1_error)
+  __pyx_t_2 = PyTuple_New(4); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1733, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_GIVEREF(__pyx_t_1);
-  if (__Pyx_PyTuple_SET_ITEM(__pyx_t_2, 0, __pyx_t_1)) __PYX_ERR(0, 1726, __pyx_L1_error);
+  if (__Pyx_PyTuple_SET_ITEM(__pyx_t_2, 0, __pyx_t_1)) __PYX_ERR(0, 1733, __pyx_L1_error);
   __Pyx_INCREF(__pyx_v_numbits);
   __Pyx_GIVEREF(__pyx_v_numbits);
-  if (__Pyx_PyTuple_SET_ITEM(__pyx_t_2, 1, __pyx_v_numbits)) __PYX_ERR(0, 1726, __pyx_L1_error);
+  if (__Pyx_PyTuple_SET_ITEM(__pyx_t_2, 1, __pyx_v_numbits)) __PYX_ERR(0, 1733, __pyx_L1_error);
   __Pyx_INCREF(__pyx_v_on_indices);
   __Pyx_GIVEREF(__pyx_v_on_indices);
-  if (__Pyx_PyTuple_SET_ITEM(__pyx_t_2, 2, __pyx_v_on_indices)) __PYX_ERR(0, 1726, __pyx_L1_error);
+  if (__Pyx_PyTuple_SET_ITEM(__pyx_t_2, 2, __pyx_v_on_indices)) __PYX_ERR(0, 1733, __pyx_L1_error);
   __Pyx_INCREF(__pyx_v_dc_indices);
   __Pyx_GIVEREF(__pyx_v_dc_indices);
-  if (__Pyx_PyTuple_SET_ITEM(__pyx_t_2, 3, __pyx_v_dc_indices)) __PYX_ERR(0, 1726, __pyx_L1_error);
+  if (__Pyx_PyTuple_SET_ITEM(__pyx_t_2, 3, __pyx_v_dc_indices)) __PYX_ERR(0, 1733, __pyx_L1_error);
   __pyx_t_1 = 0;
-  __pyx_t_1 = __Pyx_PyObject_Call(((PyObject *)__pyx_v_cls), __pyx_t_2, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1726, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_Call(((PyObject *)__pyx_v_cls), __pyx_t_2, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1733, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  if (!(likely(((__pyx_t_1) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_1, __pyx_ptype_11sat_toolkit_7formula_Truthtable))))) __PYX_ERR(0, 1726, __pyx_L1_error)
+  if (!(likely(((__pyx_t_1) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_1, __pyx_ptype_11sat_toolkit_7formula_Truthtable))))) __PYX_ERR(0, 1733, __pyx_L1_error)
   __pyx_r = ((struct __pyx_obj_11sat_toolkit_7formula_Truthtable *)__pyx_t_1);
   __pyx_t_1 = 0;
   goto __pyx_L0;
 
-  /* "sat_toolkit/formula.pyx":1714
+  /* "sat_toolkit/formula.pyx":1721
  *         return cls(cls.INIT_INDEX_SET, numbits, on_set, dc_set)
  * 
  *     @classmethod             # <<<<<<<<<<<<<<
  *     def from_indices(cls, numbits: int, on_indices: np.array, dc_indices = np.array([], dtype=int)) -> Truthtable:
  *         """
  */
 
@@ -51243,15 +51380,15 @@
   __pyx_r = NULL;
   __pyx_L0:;
   __Pyx_XGIVEREF((PyObject *)__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "sat_toolkit/formula.pyx":1729
+/* "sat_toolkit/formula.pyx":1736
  * 
  * 
  *     def _write(self, io: io.TextIOBase, espresso: bool = False, invert: bool = False) -> None:             # <<<<<<<<<<<<<<
  *         i_list = range(1 << self.numbits)
  * 
  */
 
@@ -51313,34 +51450,34 @@
       kw_args = __Pyx_NumKwargs_FASTCALL(__pyx_kwds);
       switch (__pyx_nargs) {
         case  0:
         if (likely((values[0] = __Pyx_GetKwValue_FASTCALL(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_io)) != 0)) {
           (void)__Pyx_Arg_NewRef_FASTCALL(values[0]);
           kw_args--;
         }
-        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 1729, __pyx_L3_error)
+        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 1736, __pyx_L3_error)
         else goto __pyx_L5_argtuple_error;
         CYTHON_FALLTHROUGH;
         case  1:
         if (kw_args > 0) {
           PyObject* value = __Pyx_GetKwValue_FASTCALL(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_espresso);
           if (value) { values[1] = __Pyx_Arg_NewRef_FASTCALL(value); kw_args--; }
-          else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 1729, __pyx_L3_error)
+          else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 1736, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  2:
         if (kw_args > 0) {
           PyObject* value = __Pyx_GetKwValue_FASTCALL(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_invert);
           if (value) { values[2] = __Pyx_Arg_NewRef_FASTCALL(value); kw_args--; }
-          else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 1729, __pyx_L3_error)
+          else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 1736, __pyx_L3_error)
         }
       }
       if (unlikely(kw_args > 0)) {
         const Py_ssize_t kwd_pos_args = __pyx_nargs;
-        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values + 0, kwd_pos_args, "_write") < 0)) __PYX_ERR(0, 1729, __pyx_L3_error)
+        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values + 0, kwd_pos_args, "_write") < 0)) __PYX_ERR(0, 1736, __pyx_L3_error)
       }
     } else {
       switch (__pyx_nargs) {
         case  3: values[2] = __Pyx_Arg_FASTCALL(__pyx_args, 2);
         CYTHON_FALLTHROUGH;
         case  2: values[1] = __Pyx_Arg_FASTCALL(__pyx_args, 1);
         CYTHON_FALLTHROUGH;
@@ -51351,15 +51488,15 @@
     }
     __pyx_v_io = values[0];
     __pyx_v_espresso = values[1];
     __pyx_v_invert = values[2];
   }
   goto __pyx_L6_skip;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("_write", 0, 1, 3, __pyx_nargs); __PYX_ERR(0, 1729, __pyx_L3_error)
+  __Pyx_RaiseArgtupleInvalid("_write", 0, 1, 3, __pyx_nargs); __PYX_ERR(0, 1736, __pyx_L3_error)
   __pyx_L6_skip:;
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L3_error:;
   {
     Py_ssize_t __pyx_temp;
     for (__pyx_temp=0; __pyx_temp < (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
       __Pyx_Arg_XDECREF_FASTCALL(values[__pyx_temp]);
@@ -51378,15 +51515,15 @@
       __Pyx_Arg_XDECREF_FASTCALL(values[__pyx_temp]);
     }
   }
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "sat_toolkit/formula.pyx":1742
+/* "sat_toolkit/formula.pyx":1749
  *             io.write(f'.phase {not invert:b}\n')
  * 
  *         def sorted_contains(a, v):             # <<<<<<<<<<<<<<
  *             idx = np.searchsorted(a, v)
  *             return idx < len(a) and a[idx] == v
  */
 
@@ -51442,43 +51579,43 @@
       kw_args = __Pyx_NumKwargs_FASTCALL(__pyx_kwds);
       switch (__pyx_nargs) {
         case  0:
         if (likely((values[0] = __Pyx_GetKwValue_FASTCALL(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_a)) != 0)) {
           (void)__Pyx_Arg_NewRef_FASTCALL(values[0]);
           kw_args--;
         }
-        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 1742, __pyx_L3_error)
+        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 1749, __pyx_L3_error)
         else goto __pyx_L5_argtuple_error;
         CYTHON_FALLTHROUGH;
         case  1:
         if (likely((values[1] = __Pyx_GetKwValue_FASTCALL(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_v_2)) != 0)) {
           (void)__Pyx_Arg_NewRef_FASTCALL(values[1]);
           kw_args--;
         }
-        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 1742, __pyx_L3_error)
+        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 1749, __pyx_L3_error)
         else {
-          __Pyx_RaiseArgtupleInvalid("sorted_contains", 1, 2, 2, 1); __PYX_ERR(0, 1742, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("sorted_contains", 1, 2, 2, 1); __PYX_ERR(0, 1749, __pyx_L3_error)
         }
       }
       if (unlikely(kw_args > 0)) {
         const Py_ssize_t kwd_pos_args = __pyx_nargs;
-        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values + 0, kwd_pos_args, "sorted_contains") < 0)) __PYX_ERR(0, 1742, __pyx_L3_error)
+        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values + 0, kwd_pos_args, "sorted_contains") < 0)) __PYX_ERR(0, 1749, __pyx_L3_error)
       }
     } else if (unlikely(__pyx_nargs != 2)) {
       goto __pyx_L5_argtuple_error;
     } else {
       values[0] = __Pyx_Arg_FASTCALL(__pyx_args, 0);
       values[1] = __Pyx_Arg_FASTCALL(__pyx_args, 1);
     }
     __pyx_v_a = values[0];
     __pyx_v_v = values[1];
   }
   goto __pyx_L6_skip;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("sorted_contains", 1, 2, 2, __pyx_nargs); __PYX_ERR(0, 1742, __pyx_L3_error)
+  __Pyx_RaiseArgtupleInvalid("sorted_contains", 1, 2, 2, __pyx_nargs); __PYX_ERR(0, 1749, __pyx_L3_error)
   __pyx_L6_skip:;
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L3_error:;
   {
     Py_ssize_t __pyx_temp;
     for (__pyx_temp=0; __pyx_temp < (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
       __Pyx_Arg_XDECREF_FASTCALL(values[__pyx_temp]);
@@ -51512,24 +51649,24 @@
   Py_ssize_t __pyx_t_5;
   int __pyx_t_6;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("sorted_contains", 1);
 
-  /* "sat_toolkit/formula.pyx":1743
+  /* "sat_toolkit/formula.pyx":1750
  * 
  *         def sorted_contains(a, v):
  *             idx = np.searchsorted(a, v)             # <<<<<<<<<<<<<<
  *             return idx < len(a) and a[idx] == v
  * 
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1743, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1750, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_searchsorted); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1743, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_searchsorted); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1750, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   __pyx_t_2 = NULL;
   __pyx_t_4 = 0;
   #if CYTHON_UNPACK_METHODS
   if (unlikely(PyMethod_Check(__pyx_t_3))) {
     __pyx_t_2 = PyMethod_GET_SELF(__pyx_t_3);
@@ -51542,56 +51679,56 @@
     }
   }
   #endif
   {
     PyObject *__pyx_callargs[3] = {__pyx_t_2, __pyx_v_a, __pyx_v_v};
     __pyx_t_1 = __Pyx_PyObject_FastCall(__pyx_t_3, __pyx_callargs+1-__pyx_t_4, 2+__pyx_t_4);
     __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
-    if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1743, __pyx_L1_error)
+    if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1750, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   }
   __pyx_v_idx = __pyx_t_1;
   __pyx_t_1 = 0;
 
-  /* "sat_toolkit/formula.pyx":1744
+  /* "sat_toolkit/formula.pyx":1751
  *         def sorted_contains(a, v):
  *             idx = np.searchsorted(a, v)
  *             return idx < len(a) and a[idx] == v             # <<<<<<<<<<<<<<
  * 
  *         for i in i_list:
  */
   __Pyx_XDECREF(__pyx_r);
-  __pyx_t_5 = PyObject_Length(__pyx_v_a); if (unlikely(__pyx_t_5 == ((Py_ssize_t)-1))) __PYX_ERR(0, 1744, __pyx_L1_error)
-  __pyx_t_3 = PyInt_FromSsize_t(__pyx_t_5); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1744, __pyx_L1_error)
+  __pyx_t_5 = PyObject_Length(__pyx_v_a); if (unlikely(__pyx_t_5 == ((Py_ssize_t)-1))) __PYX_ERR(0, 1751, __pyx_L1_error)
+  __pyx_t_3 = PyInt_FromSsize_t(__pyx_t_5); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1751, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  __pyx_t_2 = PyObject_RichCompare(__pyx_v_idx, __pyx_t_3, Py_LT); __Pyx_XGOTREF(__pyx_t_2); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1744, __pyx_L1_error)
+  __pyx_t_2 = PyObject_RichCompare(__pyx_v_idx, __pyx_t_3, Py_LT); __Pyx_XGOTREF(__pyx_t_2); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1751, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  __pyx_t_6 = __Pyx_PyObject_IsTrue(__pyx_t_2); if (unlikely((__pyx_t_6 < 0))) __PYX_ERR(0, 1744, __pyx_L1_error)
+  __pyx_t_6 = __Pyx_PyObject_IsTrue(__pyx_t_2); if (unlikely((__pyx_t_6 < 0))) __PYX_ERR(0, 1751, __pyx_L1_error)
   if (__pyx_t_6) {
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   } else {
     __Pyx_INCREF(__pyx_t_2);
     __pyx_t_1 = __pyx_t_2;
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
     goto __pyx_L3_bool_binop_done;
   }
-  __pyx_t_2 = __Pyx_PyObject_GetItem(__pyx_v_a, __pyx_v_idx); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1744, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_GetItem(__pyx_v_a, __pyx_v_idx); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1751, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_3 = PyObject_RichCompare(__pyx_t_2, __pyx_v_v, Py_EQ); __Pyx_XGOTREF(__pyx_t_3); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1744, __pyx_L1_error)
+  __pyx_t_3 = PyObject_RichCompare(__pyx_t_2, __pyx_v_v, Py_EQ); __Pyx_XGOTREF(__pyx_t_3); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1751, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   __Pyx_INCREF(__pyx_t_3);
   __pyx_t_1 = __pyx_t_3;
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   __pyx_L3_bool_binop_done:;
   __pyx_r = __pyx_t_1;
   __pyx_t_1 = 0;
   goto __pyx_L0;
 
-  /* "sat_toolkit/formula.pyx":1742
+  /* "sat_toolkit/formula.pyx":1749
  *             io.write(f'.phase {not invert:b}\n')
  * 
  *         def sorted_contains(a, v):             # <<<<<<<<<<<<<<
  *             idx = np.searchsorted(a, v)
  *             return idx < len(a) and a[idx] == v
  */
 
@@ -51605,15 +51742,15 @@
   __pyx_L0:;
   __Pyx_XDECREF(__pyx_v_idx);
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "sat_toolkit/formula.pyx":1729
+/* "sat_toolkit/formula.pyx":1736
  * 
  * 
  *     def _write(self, io: io.TextIOBase, espresso: bool = False, invert: bool = False) -> None:             # <<<<<<<<<<<<<<
  *         i_list = range(1 << self.numbits)
  * 
  */
 
@@ -51642,83 +51779,83 @@
   PyObject *__pyx_t_14 = NULL;
   PyObject *__pyx_t_15 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("_write", 1);
 
-  /* "sat_toolkit/formula.pyx":1730
+  /* "sat_toolkit/formula.pyx":1737
  * 
  *     def _write(self, io: io.TextIOBase, espresso: bool = False, invert: bool = False) -> None:
  *         i_list = range(1 << self.numbits)             # <<<<<<<<<<<<<<
  * 
  *         if espresso:
  */
-  __pyx_t_1 = __Pyx_PyInt_From_unsigned_long((1 << __pyx_v_self->numbits)); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1730, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyInt_From_unsigned_long((1 << __pyx_v_self->numbits)); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1737, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_2 = __Pyx_PyObject_CallOneArg(__pyx_builtin_range, __pyx_t_1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1730, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_CallOneArg(__pyx_builtin_range, __pyx_t_1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1737, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __pyx_v_i_list = __pyx_t_2;
   __pyx_t_2 = 0;
 
-  /* "sat_toolkit/formula.pyx":1732
+  /* "sat_toolkit/formula.pyx":1739
  *         i_list = range(1 << self.numbits)
  * 
  *         if espresso:             # <<<<<<<<<<<<<<
  *             i_list = np.concatenate((self.on_set, self.dc_set), axis=0)
  *             i_list.sort()
  */
-  __pyx_t_3 = __Pyx_PyObject_IsTrue(__pyx_v_espresso); if (unlikely((__pyx_t_3 < 0))) __PYX_ERR(0, 1732, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_IsTrue(__pyx_v_espresso); if (unlikely((__pyx_t_3 < 0))) __PYX_ERR(0, 1739, __pyx_L1_error)
   if (__pyx_t_3) {
 
-    /* "sat_toolkit/formula.pyx":1733
+    /* "sat_toolkit/formula.pyx":1740
  * 
  *         if espresso:
  *             i_list = np.concatenate((self.on_set, self.dc_set), axis=0)             # <<<<<<<<<<<<<<
  *             i_list.sort()
  *             io.write(f'.i {self.numbits}\n')
  */
-    __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1733, __pyx_L1_error)
+    __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1740, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
-    __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_concatenate); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1733, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_concatenate); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1740, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-    __pyx_t_2 = PyTuple_New(2); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1733, __pyx_L1_error)
+    __pyx_t_2 = PyTuple_New(2); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1740, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
     __Pyx_INCREF(__pyx_v_self->on_set);
     __Pyx_GIVEREF(__pyx_v_self->on_set);
-    if (__Pyx_PyTuple_SET_ITEM(__pyx_t_2, 0, __pyx_v_self->on_set)) __PYX_ERR(0, 1733, __pyx_L1_error);
+    if (__Pyx_PyTuple_SET_ITEM(__pyx_t_2, 0, __pyx_v_self->on_set)) __PYX_ERR(0, 1740, __pyx_L1_error);
     __Pyx_INCREF(__pyx_v_self->dc_set);
     __Pyx_GIVEREF(__pyx_v_self->dc_set);
-    if (__Pyx_PyTuple_SET_ITEM(__pyx_t_2, 1, __pyx_v_self->dc_set)) __PYX_ERR(0, 1733, __pyx_L1_error);
-    __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1733, __pyx_L1_error)
+    if (__Pyx_PyTuple_SET_ITEM(__pyx_t_2, 1, __pyx_v_self->dc_set)) __PYX_ERR(0, 1740, __pyx_L1_error);
+    __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1740, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
     __Pyx_GIVEREF(__pyx_t_2);
-    if (__Pyx_PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_2)) __PYX_ERR(0, 1733, __pyx_L1_error);
+    if (__Pyx_PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_2)) __PYX_ERR(0, 1740, __pyx_L1_error);
     __pyx_t_2 = 0;
-    __pyx_t_2 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1733, __pyx_L1_error)
+    __pyx_t_2 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1740, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
-    if (PyDict_SetItem(__pyx_t_2, __pyx_n_s_axis, __pyx_int_0) < 0) __PYX_ERR(0, 1733, __pyx_L1_error)
-    __pyx_t_5 = __Pyx_PyObject_Call(__pyx_t_1, __pyx_t_4, __pyx_t_2); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1733, __pyx_L1_error)
+    if (PyDict_SetItem(__pyx_t_2, __pyx_n_s_axis, __pyx_int_0) < 0) __PYX_ERR(0, 1740, __pyx_L1_error)
+    __pyx_t_5 = __Pyx_PyObject_Call(__pyx_t_1, __pyx_t_4, __pyx_t_2); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1740, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
     __Pyx_DECREF_SET(__pyx_v_i_list, __pyx_t_5);
     __pyx_t_5 = 0;
 
-    /* "sat_toolkit/formula.pyx":1734
+    /* "sat_toolkit/formula.pyx":1741
  *         if espresso:
  *             i_list = np.concatenate((self.on_set, self.dc_set), axis=0)
  *             i_list.sort()             # <<<<<<<<<<<<<<
  *             io.write(f'.i {self.numbits}\n')
  *             io.write(f'.o 1\n')
  */
-    __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_i_list, __pyx_n_s_sort); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1734, __pyx_L1_error)
+    __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_i_list, __pyx_n_s_sort); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1741, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
     __pyx_t_4 = NULL;
     __pyx_t_6 = 0;
     #if CYTHON_UNPACK_METHODS
     if (likely(PyMethod_Check(__pyx_t_2))) {
       __pyx_t_4 = PyMethod_GET_SELF(__pyx_t_2);
       if (likely(__pyx_t_4)) {
@@ -51730,52 +51867,52 @@
       }
     }
     #endif
     {
       PyObject *__pyx_callargs[2] = {__pyx_t_4, NULL};
       __pyx_t_5 = __Pyx_PyObject_FastCall(__pyx_t_2, __pyx_callargs+1-__pyx_t_6, 0+__pyx_t_6);
       __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
-      if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1734, __pyx_L1_error)
+      if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1741, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_5);
       __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
     }
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
 
-    /* "sat_toolkit/formula.pyx":1735
+    /* "sat_toolkit/formula.pyx":1742
  *             i_list = np.concatenate((self.on_set, self.dc_set), axis=0)
  *             i_list.sort()
  *             io.write(f'.i {self.numbits}\n')             # <<<<<<<<<<<<<<
  *             io.write(f'.o 1\n')
  *             io.write(f'.p {len(i_list)}\n')
  */
-    __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_io, __pyx_n_s_write); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1735, __pyx_L1_error)
+    __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_io, __pyx_n_s_write); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1742, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
-    __pyx_t_4 = PyTuple_New(3); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1735, __pyx_L1_error)
+    __pyx_t_4 = PyTuple_New(3); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1742, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
     __pyx_t_7 = 0;
     __pyx_t_8 = 127;
     __Pyx_INCREF(__pyx_kp_u_i);
     __pyx_t_7 += 3;
     __Pyx_GIVEREF(__pyx_kp_u_i);
     PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_kp_u_i);
-    __pyx_t_1 = __Pyx_PyInt_From_unsigned_long(__pyx_v_self->numbits); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1735, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyInt_From_unsigned_long(__pyx_v_self->numbits); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1742, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
-    __pyx_t_9 = __Pyx_PyObject_FormatSimple(__pyx_t_1, __pyx_empty_unicode); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1735, __pyx_L1_error)
+    __pyx_t_9 = __Pyx_PyObject_FormatSimple(__pyx_t_1, __pyx_empty_unicode); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1742, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_9);
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
     __pyx_t_8 = (__Pyx_PyUnicode_MAX_CHAR_VALUE(__pyx_t_9) > __pyx_t_8) ? __Pyx_PyUnicode_MAX_CHAR_VALUE(__pyx_t_9) : __pyx_t_8;
     __pyx_t_7 += __Pyx_PyUnicode_GET_LENGTH(__pyx_t_9);
     __Pyx_GIVEREF(__pyx_t_9);
     PyTuple_SET_ITEM(__pyx_t_4, 1, __pyx_t_9);
     __pyx_t_9 = 0;
     __Pyx_INCREF(__pyx_kp_u__33);
     __pyx_t_7 += 1;
     __Pyx_GIVEREF(__pyx_kp_u__33);
     PyTuple_SET_ITEM(__pyx_t_4, 2, __pyx_kp_u__33);
-    __pyx_t_9 = __Pyx_PyUnicode_Join(__pyx_t_4, 3, __pyx_t_7, __pyx_t_8); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1735, __pyx_L1_error)
+    __pyx_t_9 = __Pyx_PyUnicode_Join(__pyx_t_4, 3, __pyx_t_7, __pyx_t_8); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1742, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_9);
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
     __pyx_t_4 = NULL;
     __pyx_t_6 = 0;
     #if CYTHON_UNPACK_METHODS
     if (likely(PyMethod_Check(__pyx_t_2))) {
       __pyx_t_4 = PyMethod_GET_SELF(__pyx_t_2);
@@ -51789,28 +51926,28 @@
     }
     #endif
     {
       PyObject *__pyx_callargs[2] = {__pyx_t_4, __pyx_t_9};
       __pyx_t_5 = __Pyx_PyObject_FastCall(__pyx_t_2, __pyx_callargs+1-__pyx_t_6, 1+__pyx_t_6);
       __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
       __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
-      if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1735, __pyx_L1_error)
+      if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1742, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_5);
       __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
     }
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
 
-    /* "sat_toolkit/formula.pyx":1736
+    /* "sat_toolkit/formula.pyx":1743
  *             i_list.sort()
  *             io.write(f'.i {self.numbits}\n')
  *             io.write(f'.o 1\n')             # <<<<<<<<<<<<<<
  *             io.write(f'.p {len(i_list)}\n')
  * 
  */
-    __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_io, __pyx_n_s_write); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1736, __pyx_L1_error)
+    __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_io, __pyx_n_s_write); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1743, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
     __pyx_t_9 = NULL;
     __pyx_t_6 = 0;
     #if CYTHON_UNPACK_METHODS
     if (likely(PyMethod_Check(__pyx_t_2))) {
       __pyx_t_9 = PyMethod_GET_SELF(__pyx_t_2);
       if (likely(__pyx_t_9)) {
@@ -51822,49 +51959,49 @@
       }
     }
     #endif
     {
       PyObject *__pyx_callargs[2] = {__pyx_t_9, __pyx_kp_u_o_1};
       __pyx_t_5 = __Pyx_PyObject_FastCall(__pyx_t_2, __pyx_callargs+1-__pyx_t_6, 1+__pyx_t_6);
       __Pyx_XDECREF(__pyx_t_9); __pyx_t_9 = 0;
-      if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1736, __pyx_L1_error)
+      if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1743, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_5);
       __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
     }
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
 
-    /* "sat_toolkit/formula.pyx":1737
+    /* "sat_toolkit/formula.pyx":1744
  *             io.write(f'.i {self.numbits}\n')
  *             io.write(f'.o 1\n')
  *             io.write(f'.p {len(i_list)}\n')             # <<<<<<<<<<<<<<
  * 
  *             # this parameter is important so espresso minimizes the inverted function
  */
-    __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_io, __pyx_n_s_write); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1737, __pyx_L1_error)
+    __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_io, __pyx_n_s_write); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1744, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
-    __pyx_t_9 = PyTuple_New(3); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1737, __pyx_L1_error)
+    __pyx_t_9 = PyTuple_New(3); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1744, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_9);
     __pyx_t_7 = 0;
     __pyx_t_8 = 127;
     __Pyx_INCREF(__pyx_kp_u_p);
     __pyx_t_7 += 3;
     __Pyx_GIVEREF(__pyx_kp_u_p);
     PyTuple_SET_ITEM(__pyx_t_9, 0, __pyx_kp_u_p);
-    __pyx_t_10 = PyObject_Length(__pyx_v_i_list); if (unlikely(__pyx_t_10 == ((Py_ssize_t)-1))) __PYX_ERR(0, 1737, __pyx_L1_error)
-    __pyx_t_4 = __Pyx_PyUnicode_From_Py_ssize_t(__pyx_t_10, 0, ' ', 'd'); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1737, __pyx_L1_error)
+    __pyx_t_10 = PyObject_Length(__pyx_v_i_list); if (unlikely(__pyx_t_10 == ((Py_ssize_t)-1))) __PYX_ERR(0, 1744, __pyx_L1_error)
+    __pyx_t_4 = __Pyx_PyUnicode_From_Py_ssize_t(__pyx_t_10, 0, ' ', 'd'); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1744, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
     __pyx_t_7 += __Pyx_PyUnicode_GET_LENGTH(__pyx_t_4);
     __Pyx_GIVEREF(__pyx_t_4);
     PyTuple_SET_ITEM(__pyx_t_9, 1, __pyx_t_4);
     __pyx_t_4 = 0;
     __Pyx_INCREF(__pyx_kp_u__33);
     __pyx_t_7 += 1;
     __Pyx_GIVEREF(__pyx_kp_u__33);
     PyTuple_SET_ITEM(__pyx_t_9, 2, __pyx_kp_u__33);
-    __pyx_t_4 = __Pyx_PyUnicode_Join(__pyx_t_9, 3, __pyx_t_7, __pyx_t_8); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1737, __pyx_L1_error)
+    __pyx_t_4 = __Pyx_PyUnicode_Join(__pyx_t_9, 3, __pyx_t_7, __pyx_t_8); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1744, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
     __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
     __pyx_t_9 = NULL;
     __pyx_t_6 = 0;
     #if CYTHON_UNPACK_METHODS
     if (likely(PyMethod_Check(__pyx_t_2))) {
       __pyx_t_9 = PyMethod_GET_SELF(__pyx_t_2);
@@ -51878,53 +52015,53 @@
     }
     #endif
     {
       PyObject *__pyx_callargs[2] = {__pyx_t_9, __pyx_t_4};
       __pyx_t_5 = __Pyx_PyObject_FastCall(__pyx_t_2, __pyx_callargs+1-__pyx_t_6, 1+__pyx_t_6);
       __Pyx_XDECREF(__pyx_t_9); __pyx_t_9 = 0;
       __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-      if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1737, __pyx_L1_error)
+      if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1744, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_5);
       __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
     }
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
 
-    /* "sat_toolkit/formula.pyx":1740
+    /* "sat_toolkit/formula.pyx":1747
  * 
  *             # this parameter is important so espresso minimizes the inverted function
  *             io.write(f'.phase {not invert:b}\n')             # <<<<<<<<<<<<<<
  * 
  *         def sorted_contains(a, v):
  */
-    __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_io, __pyx_n_s_write); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1740, __pyx_L1_error)
+    __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_io, __pyx_n_s_write); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1747, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
-    __pyx_t_4 = PyTuple_New(3); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1740, __pyx_L1_error)
+    __pyx_t_4 = PyTuple_New(3); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1747, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
     __pyx_t_7 = 0;
     __pyx_t_8 = 127;
     __Pyx_INCREF(__pyx_kp_u_phase);
     __pyx_t_7 += 7;
     __Pyx_GIVEREF(__pyx_kp_u_phase);
     PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_kp_u_phase);
-    __pyx_t_3 = __Pyx_PyObject_IsTrue(__pyx_v_invert); if (unlikely((__pyx_t_3 < 0))) __PYX_ERR(0, 1740, __pyx_L1_error)
-    __pyx_t_9 = __Pyx_PyBool_FromLong((!__pyx_t_3)); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1740, __pyx_L1_error)
+    __pyx_t_3 = __Pyx_PyObject_IsTrue(__pyx_v_invert); if (unlikely((__pyx_t_3 < 0))) __PYX_ERR(0, 1747, __pyx_L1_error)
+    __pyx_t_9 = __Pyx_PyBool_FromLong((!__pyx_t_3)); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1747, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_9);
-    __pyx_t_1 = __Pyx_PyObject_Format(__pyx_t_9, __pyx_n_u_b); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1740, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyObject_Format(__pyx_t_9, __pyx_n_u_b); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1747, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
     __pyx_t_8 = (__Pyx_PyUnicode_MAX_CHAR_VALUE(__pyx_t_1) > __pyx_t_8) ? __Pyx_PyUnicode_MAX_CHAR_VALUE(__pyx_t_1) : __pyx_t_8;
     __pyx_t_7 += __Pyx_PyUnicode_GET_LENGTH(__pyx_t_1);
     __Pyx_GIVEREF(__pyx_t_1);
     PyTuple_SET_ITEM(__pyx_t_4, 1, __pyx_t_1);
     __pyx_t_1 = 0;
     __Pyx_INCREF(__pyx_kp_u__33);
     __pyx_t_7 += 1;
     __Pyx_GIVEREF(__pyx_kp_u__33);
     PyTuple_SET_ITEM(__pyx_t_4, 2, __pyx_kp_u__33);
-    __pyx_t_1 = __Pyx_PyUnicode_Join(__pyx_t_4, 3, __pyx_t_7, __pyx_t_8); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1740, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyUnicode_Join(__pyx_t_4, 3, __pyx_t_7, __pyx_t_8); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1747, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
     __pyx_t_4 = NULL;
     __pyx_t_6 = 0;
     #if CYTHON_UNPACK_METHODS
     if (likely(PyMethod_Check(__pyx_t_2))) {
       __pyx_t_4 = PyMethod_GET_SELF(__pyx_t_2);
@@ -51938,207 +52075,207 @@
     }
     #endif
     {
       PyObject *__pyx_callargs[2] = {__pyx_t_4, __pyx_t_1};
       __pyx_t_5 = __Pyx_PyObject_FastCall(__pyx_t_2, __pyx_callargs+1-__pyx_t_6, 1+__pyx_t_6);
       __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-      if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1740, __pyx_L1_error)
+      if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1747, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_5);
       __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
     }
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
 
-    /* "sat_toolkit/formula.pyx":1732
+    /* "sat_toolkit/formula.pyx":1739
  *         i_list = range(1 << self.numbits)
  * 
  *         if espresso:             # <<<<<<<<<<<<<<
  *             i_list = np.concatenate((self.on_set, self.dc_set), axis=0)
  *             i_list.sort()
  */
   }
 
-  /* "sat_toolkit/formula.pyx":1742
+  /* "sat_toolkit/formula.pyx":1749
  *             io.write(f'.phase {not invert:b}\n')
  * 
  *         def sorted_contains(a, v):             # <<<<<<<<<<<<<<
  *             idx = np.searchsorted(a, v)
  *             return idx < len(a) and a[idx] == v
  */
-  __pyx_t_5 = __Pyx_CyFunction_New(&__pyx_mdef_11sat_toolkit_7formula_10Truthtable_6_write_1sorted_contains, 0, __pyx_n_s_write_locals_sorted_contains, NULL, __pyx_n_s_sat_toolkit_formula, __pyx_d, ((PyObject *)__pyx_codeobj__58)); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1742, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_CyFunction_New(&__pyx_mdef_11sat_toolkit_7formula_10Truthtable_6_write_1sorted_contains, 0, __pyx_n_s_write_locals_sorted_contains, NULL, __pyx_n_s_sat_toolkit_formula, __pyx_d, ((PyObject *)__pyx_codeobj__58)); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1749, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
   __pyx_v_sorted_contains = __pyx_t_5;
   __pyx_t_5 = 0;
 
-  /* "sat_toolkit/formula.pyx":1746
+  /* "sat_toolkit/formula.pyx":1753
  *             return idx < len(a) and a[idx] == v
  * 
  *         for i in i_list:             # <<<<<<<<<<<<<<
  *             on, dc = sorted_contains(self.on_set, i), sorted_contains(self.dc_set, i)
  *             desc = '-' if dc else f'{on:b}'
  */
   if (likely(PyList_CheckExact(__pyx_v_i_list)) || PyTuple_CheckExact(__pyx_v_i_list)) {
     __pyx_t_5 = __pyx_v_i_list; __Pyx_INCREF(__pyx_t_5);
     __pyx_t_7 = 0;
     __pyx_t_11 = NULL;
   } else {
-    __pyx_t_7 = -1; __pyx_t_5 = PyObject_GetIter(__pyx_v_i_list); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1746, __pyx_L1_error)
+    __pyx_t_7 = -1; __pyx_t_5 = PyObject_GetIter(__pyx_v_i_list); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1753, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
-    __pyx_t_11 = __Pyx_PyObject_GetIterNextFunc(__pyx_t_5); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1746, __pyx_L1_error)
+    __pyx_t_11 = __Pyx_PyObject_GetIterNextFunc(__pyx_t_5); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1753, __pyx_L1_error)
   }
   for (;;) {
     if (likely(!__pyx_t_11)) {
       if (likely(PyList_CheckExact(__pyx_t_5))) {
         {
           Py_ssize_t __pyx_temp = __Pyx_PyList_GET_SIZE(__pyx_t_5);
           #if !CYTHON_ASSUME_SAFE_MACROS
-          if (unlikely((__pyx_temp < 0))) __PYX_ERR(0, 1746, __pyx_L1_error)
+          if (unlikely((__pyx_temp < 0))) __PYX_ERR(0, 1753, __pyx_L1_error)
           #endif
           if (__pyx_t_7 >= __pyx_temp) break;
         }
         #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-        __pyx_t_2 = PyList_GET_ITEM(__pyx_t_5, __pyx_t_7); __Pyx_INCREF(__pyx_t_2); __pyx_t_7++; if (unlikely((0 < 0))) __PYX_ERR(0, 1746, __pyx_L1_error)
+        __pyx_t_2 = PyList_GET_ITEM(__pyx_t_5, __pyx_t_7); __Pyx_INCREF(__pyx_t_2); __pyx_t_7++; if (unlikely((0 < 0))) __PYX_ERR(0, 1753, __pyx_L1_error)
         #else
-        __pyx_t_2 = __Pyx_PySequence_ITEM(__pyx_t_5, __pyx_t_7); __pyx_t_7++; if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1746, __pyx_L1_error)
+        __pyx_t_2 = __Pyx_PySequence_ITEM(__pyx_t_5, __pyx_t_7); __pyx_t_7++; if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1753, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_2);
         #endif
       } else {
         {
           Py_ssize_t __pyx_temp = __Pyx_PyTuple_GET_SIZE(__pyx_t_5);
           #if !CYTHON_ASSUME_SAFE_MACROS
-          if (unlikely((__pyx_temp < 0))) __PYX_ERR(0, 1746, __pyx_L1_error)
+          if (unlikely((__pyx_temp < 0))) __PYX_ERR(0, 1753, __pyx_L1_error)
           #endif
           if (__pyx_t_7 >= __pyx_temp) break;
         }
         #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-        __pyx_t_2 = PyTuple_GET_ITEM(__pyx_t_5, __pyx_t_7); __Pyx_INCREF(__pyx_t_2); __pyx_t_7++; if (unlikely((0 < 0))) __PYX_ERR(0, 1746, __pyx_L1_error)
+        __pyx_t_2 = PyTuple_GET_ITEM(__pyx_t_5, __pyx_t_7); __Pyx_INCREF(__pyx_t_2); __pyx_t_7++; if (unlikely((0 < 0))) __PYX_ERR(0, 1753, __pyx_L1_error)
         #else
-        __pyx_t_2 = __Pyx_PySequence_ITEM(__pyx_t_5, __pyx_t_7); __pyx_t_7++; if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1746, __pyx_L1_error)
+        __pyx_t_2 = __Pyx_PySequence_ITEM(__pyx_t_5, __pyx_t_7); __pyx_t_7++; if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1753, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_2);
         #endif
       }
     } else {
       __pyx_t_2 = __pyx_t_11(__pyx_t_5);
       if (unlikely(!__pyx_t_2)) {
         PyObject* exc_type = PyErr_Occurred();
         if (exc_type) {
           if (likely(__Pyx_PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
-          else __PYX_ERR(0, 1746, __pyx_L1_error)
+          else __PYX_ERR(0, 1753, __pyx_L1_error)
         }
         break;
       }
       __Pyx_GOTREF(__pyx_t_2);
     }
     __Pyx_XDECREF_SET(__pyx_v_i, __pyx_t_2);
     __pyx_t_2 = 0;
 
-    /* "sat_toolkit/formula.pyx":1747
+    /* "sat_toolkit/formula.pyx":1754
  * 
  *         for i in i_list:
  *             on, dc = sorted_contains(self.on_set, i), sorted_contains(self.dc_set, i)             # <<<<<<<<<<<<<<
  *             desc = '-' if dc else f'{on:b}'
  *             io.write(f'{i:0{self.numbits}b} {desc}\n')
  */
     __pyx_t_2 = __pyx_v_self->on_set;
     __Pyx_INCREF(__pyx_t_2);
-    __pyx_t_1 = __pyx_pf_11sat_toolkit_7formula_10Truthtable_6_write_sorted_contains(__pyx_v_sorted_contains, __pyx_t_2, __pyx_v_i); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1747, __pyx_L1_error)
+    __pyx_t_1 = __pyx_pf_11sat_toolkit_7formula_10Truthtable_6_write_sorted_contains(__pyx_v_sorted_contains, __pyx_t_2, __pyx_v_i); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1754, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
     __pyx_t_2 = __pyx_v_self->dc_set;
     __Pyx_INCREF(__pyx_t_2);
-    __pyx_t_4 = __pyx_pf_11sat_toolkit_7formula_10Truthtable_6_write_sorted_contains(__pyx_v_sorted_contains, __pyx_t_2, __pyx_v_i); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1747, __pyx_L1_error)
+    __pyx_t_4 = __pyx_pf_11sat_toolkit_7formula_10Truthtable_6_write_sorted_contains(__pyx_v_sorted_contains, __pyx_t_2, __pyx_v_i); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1754, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
     __Pyx_XDECREF_SET(__pyx_v_on, __pyx_t_1);
     __pyx_t_1 = 0;
     __Pyx_XDECREF_SET(__pyx_v_dc, __pyx_t_4);
     __pyx_t_4 = 0;
 
-    /* "sat_toolkit/formula.pyx":1748
+    /* "sat_toolkit/formula.pyx":1755
  *         for i in i_list:
  *             on, dc = sorted_contains(self.on_set, i), sorted_contains(self.dc_set, i)
  *             desc = '-' if dc else f'{on:b}'             # <<<<<<<<<<<<<<
  *             io.write(f'{i:0{self.numbits}b} {desc}\n')
  * 
  */
-    __pyx_t_3 = __Pyx_PyObject_IsTrue(__pyx_v_dc); if (unlikely((__pyx_t_3 < 0))) __PYX_ERR(0, 1748, __pyx_L1_error)
+    __pyx_t_3 = __Pyx_PyObject_IsTrue(__pyx_v_dc); if (unlikely((__pyx_t_3 < 0))) __PYX_ERR(0, 1755, __pyx_L1_error)
     if (__pyx_t_3) {
       __Pyx_INCREF(__pyx_kp_u__59);
       __pyx_t_4 = __pyx_kp_u__59;
     } else {
-      __pyx_t_1 = __Pyx_PyObject_Format(__pyx_v_on, __pyx_n_u_b); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1748, __pyx_L1_error)
+      __pyx_t_1 = __Pyx_PyObject_Format(__pyx_v_on, __pyx_n_u_b); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1755, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_1);
       __pyx_t_4 = __pyx_t_1;
       __pyx_t_1 = 0;
     }
     __Pyx_XDECREF_SET(__pyx_v_desc, ((PyObject*)__pyx_t_4));
     __pyx_t_4 = 0;
 
-    /* "sat_toolkit/formula.pyx":1749
+    /* "sat_toolkit/formula.pyx":1756
  *             on, dc = sorted_contains(self.on_set, i), sorted_contains(self.dc_set, i)
  *             desc = '-' if dc else f'{on:b}'
  *             io.write(f'{i:0{self.numbits}b} {desc}\n')             # <<<<<<<<<<<<<<
  * 
  *         # ensure that we write some PLA description
  */
-    __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_io, __pyx_n_s_write); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1749, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_io, __pyx_n_s_write); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1756, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
-    __pyx_t_2 = PyTuple_New(4); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1749, __pyx_L1_error)
+    __pyx_t_2 = PyTuple_New(4); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1756, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
     __pyx_t_10 = 0;
     __pyx_t_8 = 127;
-    __pyx_t_9 = PyTuple_New(3); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1749, __pyx_L1_error)
+    __pyx_t_9 = PyTuple_New(3); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1756, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_9);
     __pyx_t_12 = 0;
     __pyx_t_13 = 127;
     __Pyx_INCREF(__pyx_kp_u_0);
     __pyx_t_12 += 1;
     __Pyx_GIVEREF(__pyx_kp_u_0);
     PyTuple_SET_ITEM(__pyx_t_9, 0, __pyx_kp_u_0);
-    __pyx_t_14 = __Pyx_PyInt_From_unsigned_long(__pyx_v_self->numbits); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 1749, __pyx_L1_error)
+    __pyx_t_14 = __Pyx_PyInt_From_unsigned_long(__pyx_v_self->numbits); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 1756, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_14);
-    __pyx_t_15 = __Pyx_PyObject_FormatSimple(__pyx_t_14, __pyx_empty_unicode); if (unlikely(!__pyx_t_15)) __PYX_ERR(0, 1749, __pyx_L1_error)
+    __pyx_t_15 = __Pyx_PyObject_FormatSimple(__pyx_t_14, __pyx_empty_unicode); if (unlikely(!__pyx_t_15)) __PYX_ERR(0, 1756, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_15);
     __Pyx_DECREF(__pyx_t_14); __pyx_t_14 = 0;
     __pyx_t_13 = (__Pyx_PyUnicode_MAX_CHAR_VALUE(__pyx_t_15) > __pyx_t_13) ? __Pyx_PyUnicode_MAX_CHAR_VALUE(__pyx_t_15) : __pyx_t_13;
     __pyx_t_12 += __Pyx_PyUnicode_GET_LENGTH(__pyx_t_15);
     __Pyx_GIVEREF(__pyx_t_15);
     PyTuple_SET_ITEM(__pyx_t_9, 1, __pyx_t_15);
     __pyx_t_15 = 0;
     __Pyx_INCREF(__pyx_n_u_b);
     __pyx_t_12 += 1;
     __Pyx_GIVEREF(__pyx_n_u_b);
     PyTuple_SET_ITEM(__pyx_t_9, 2, __pyx_n_u_b);
-    __pyx_t_15 = __Pyx_PyUnicode_Join(__pyx_t_9, 3, __pyx_t_12, __pyx_t_13); if (unlikely(!__pyx_t_15)) __PYX_ERR(0, 1749, __pyx_L1_error)
+    __pyx_t_15 = __Pyx_PyUnicode_Join(__pyx_t_9, 3, __pyx_t_12, __pyx_t_13); if (unlikely(!__pyx_t_15)) __PYX_ERR(0, 1756, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_15);
     __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
-    __pyx_t_9 = __Pyx_PyObject_Format(__pyx_v_i, __pyx_t_15); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1749, __pyx_L1_error)
+    __pyx_t_9 = __Pyx_PyObject_Format(__pyx_v_i, __pyx_t_15); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1756, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_9);
     __Pyx_DECREF(__pyx_t_15); __pyx_t_15 = 0;
     __pyx_t_8 = (__Pyx_PyUnicode_MAX_CHAR_VALUE(__pyx_t_9) > __pyx_t_8) ? __Pyx_PyUnicode_MAX_CHAR_VALUE(__pyx_t_9) : __pyx_t_8;
     __pyx_t_10 += __Pyx_PyUnicode_GET_LENGTH(__pyx_t_9);
     __Pyx_GIVEREF(__pyx_t_9);
     PyTuple_SET_ITEM(__pyx_t_2, 0, __pyx_t_9);
     __pyx_t_9 = 0;
     __Pyx_INCREF(__pyx_kp_u__32);
     __pyx_t_10 += 1;
     __Pyx_GIVEREF(__pyx_kp_u__32);
     PyTuple_SET_ITEM(__pyx_t_2, 1, __pyx_kp_u__32);
-    __pyx_t_9 = __Pyx_PyUnicode_Unicode(__pyx_v_desc); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1749, __pyx_L1_error)
+    __pyx_t_9 = __Pyx_PyUnicode_Unicode(__pyx_v_desc); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1756, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_9);
     __pyx_t_8 = (__Pyx_PyUnicode_MAX_CHAR_VALUE(__pyx_t_9) > __pyx_t_8) ? __Pyx_PyUnicode_MAX_CHAR_VALUE(__pyx_t_9) : __pyx_t_8;
     __pyx_t_10 += __Pyx_PyUnicode_GET_LENGTH(__pyx_t_9);
     __Pyx_GIVEREF(__pyx_t_9);
     PyTuple_SET_ITEM(__pyx_t_2, 2, __pyx_t_9);
     __pyx_t_9 = 0;
     __Pyx_INCREF(__pyx_kp_u__33);
     __pyx_t_10 += 1;
     __Pyx_GIVEREF(__pyx_kp_u__33);
     PyTuple_SET_ITEM(__pyx_t_2, 3, __pyx_kp_u__33);
-    __pyx_t_9 = __Pyx_PyUnicode_Join(__pyx_t_2, 4, __pyx_t_10, __pyx_t_8); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1749, __pyx_L1_error)
+    __pyx_t_9 = __Pyx_PyUnicode_Join(__pyx_t_2, 4, __pyx_t_10, __pyx_t_8); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1756, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_9);
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
     __pyx_t_2 = NULL;
     __pyx_t_6 = 0;
     #if CYTHON_UNPACK_METHODS
     if (likely(PyMethod_Check(__pyx_t_1))) {
       __pyx_t_2 = PyMethod_GET_SELF(__pyx_t_1);
@@ -52152,53 +52289,53 @@
     }
     #endif
     {
       PyObject *__pyx_callargs[2] = {__pyx_t_2, __pyx_t_9};
       __pyx_t_4 = __Pyx_PyObject_FastCall(__pyx_t_1, __pyx_callargs+1-__pyx_t_6, 1+__pyx_t_6);
       __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
       __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
-      if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1749, __pyx_L1_error)
+      if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1756, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_4);
       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
     }
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
 
-    /* "sat_toolkit/formula.pyx":1746
+    /* "sat_toolkit/formula.pyx":1753
  *             return idx < len(a) and a[idx] == v
  * 
  *         for i in i_list:             # <<<<<<<<<<<<<<
  *             on, dc = sorted_contains(self.on_set, i), sorted_contains(self.dc_set, i)
  *             desc = '-' if dc else f'{on:b}'
  */
   }
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
 
-  /* "sat_toolkit/formula.pyx":1752
+  /* "sat_toolkit/formula.pyx":1759
  * 
  *         # ensure that we write some PLA description
  *         if len(i_list) == 0:             # <<<<<<<<<<<<<<
  *             io.write('-' * self.numbits + ' 0\n')
  * 
  */
-  __pyx_t_7 = PyObject_Length(__pyx_v_i_list); if (unlikely(__pyx_t_7 == ((Py_ssize_t)-1))) __PYX_ERR(0, 1752, __pyx_L1_error)
+  __pyx_t_7 = PyObject_Length(__pyx_v_i_list); if (unlikely(__pyx_t_7 == ((Py_ssize_t)-1))) __PYX_ERR(0, 1759, __pyx_L1_error)
   __pyx_t_3 = (__pyx_t_7 == 0);
   if (__pyx_t_3) {
 
-    /* "sat_toolkit/formula.pyx":1753
+    /* "sat_toolkit/formula.pyx":1760
  *         # ensure that we write some PLA description
  *         if len(i_list) == 0:
  *             io.write('-' * self.numbits + ' 0\n')             # <<<<<<<<<<<<<<
  * 
  *         if espresso:
  */
-    __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_v_io, __pyx_n_s_write); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1753, __pyx_L1_error)
+    __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_v_io, __pyx_n_s_write); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1760, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
-    __pyx_t_1 = __Pyx_PySequence_Multiply(__pyx_kp_u__59, __pyx_v_self->numbits); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1753, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PySequence_Multiply(__pyx_kp_u__59, __pyx_v_self->numbits); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1760, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
-    __pyx_t_9 = __Pyx_PyUnicode_ConcatInPlace(__pyx_t_1, __pyx_kp_u_0_2); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1753, __pyx_L1_error)
+    __pyx_t_9 = __Pyx_PyUnicode_ConcatInPlace(__pyx_t_1, __pyx_kp_u_0_2); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1760, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_9);
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
     __pyx_t_1 = NULL;
     __pyx_t_6 = 0;
     #if CYTHON_UNPACK_METHODS
     if (likely(PyMethod_Check(__pyx_t_4))) {
       __pyx_t_1 = PyMethod_GET_SELF(__pyx_t_4);
@@ -52212,47 +52349,47 @@
     }
     #endif
     {
       PyObject *__pyx_callargs[2] = {__pyx_t_1, __pyx_t_9};
       __pyx_t_5 = __Pyx_PyObject_FastCall(__pyx_t_4, __pyx_callargs+1-__pyx_t_6, 1+__pyx_t_6);
       __Pyx_XDECREF(__pyx_t_1); __pyx_t_1 = 0;
       __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
-      if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1753, __pyx_L1_error)
+      if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1760, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_5);
       __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
     }
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
 
-    /* "sat_toolkit/formula.pyx":1752
+    /* "sat_toolkit/formula.pyx":1759
  * 
  *         # ensure that we write some PLA description
  *         if len(i_list) == 0:             # <<<<<<<<<<<<<<
  *             io.write('-' * self.numbits + ' 0\n')
  * 
  */
   }
 
-  /* "sat_toolkit/formula.pyx":1755
+  /* "sat_toolkit/formula.pyx":1762
  *             io.write('-' * self.numbits + ' 0\n')
  * 
  *         if espresso:             # <<<<<<<<<<<<<<
  *             io.write(f'.end\n')
  * 
  */
-  __pyx_t_3 = __Pyx_PyObject_IsTrue(__pyx_v_espresso); if (unlikely((__pyx_t_3 < 0))) __PYX_ERR(0, 1755, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_IsTrue(__pyx_v_espresso); if (unlikely((__pyx_t_3 < 0))) __PYX_ERR(0, 1762, __pyx_L1_error)
   if (__pyx_t_3) {
 
-    /* "sat_toolkit/formula.pyx":1756
+    /* "sat_toolkit/formula.pyx":1763
  * 
  *         if espresso:
  *             io.write(f'.end\n')             # <<<<<<<<<<<<<<
  * 
  *     def to_espresso(self, phase='cnf') -> str:
  */
-    __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_v_io, __pyx_n_s_write); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1756, __pyx_L1_error)
+    __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_v_io, __pyx_n_s_write); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1763, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
     __pyx_t_9 = NULL;
     __pyx_t_6 = 0;
     #if CYTHON_UNPACK_METHODS
     if (likely(PyMethod_Check(__pyx_t_4))) {
       __pyx_t_9 = PyMethod_GET_SELF(__pyx_t_4);
       if (likely(__pyx_t_9)) {
@@ -52264,30 +52401,30 @@
       }
     }
     #endif
     {
       PyObject *__pyx_callargs[2] = {__pyx_t_9, __pyx_kp_u_end_2};
       __pyx_t_5 = __Pyx_PyObject_FastCall(__pyx_t_4, __pyx_callargs+1-__pyx_t_6, 1+__pyx_t_6);
       __Pyx_XDECREF(__pyx_t_9); __pyx_t_9 = 0;
-      if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1756, __pyx_L1_error)
+      if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1763, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_5);
       __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
     }
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
 
-    /* "sat_toolkit/formula.pyx":1755
+    /* "sat_toolkit/formula.pyx":1762
  *             io.write('-' * self.numbits + ' 0\n')
  * 
  *         if espresso:             # <<<<<<<<<<<<<<
  *             io.write(f'.end\n')
  * 
  */
   }
 
-  /* "sat_toolkit/formula.pyx":1729
+  /* "sat_toolkit/formula.pyx":1736
  * 
  * 
  *     def _write(self, io: io.TextIOBase, espresso: bool = False, invert: bool = False) -> None:             # <<<<<<<<<<<<<<
  *         i_list = range(1 << self.numbits)
  * 
  */
 
@@ -52312,15 +52449,15 @@
   __Pyx_XDECREF(__pyx_v_dc);
   __Pyx_XDECREF(__pyx_v_desc);
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "sat_toolkit/formula.pyx":1758
+/* "sat_toolkit/formula.pyx":1765
  *             io.write(f'.end\n')
  * 
  *     def to_espresso(self, phase='cnf') -> str:             # <<<<<<<<<<<<<<
  *         """
  *         return the truthtable in espresso format
  */
 
@@ -52374,34 +52511,34 @@
       }
       kw_args = __Pyx_NumKwargs_FASTCALL(__pyx_kwds);
       switch (__pyx_nargs) {
         case  0:
         if (kw_args > 0) {
           PyObject* value = __Pyx_GetKwValue_FASTCALL(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_phase_2);
           if (value) { values[0] = __Pyx_Arg_NewRef_FASTCALL(value); kw_args--; }
-          else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 1758, __pyx_L3_error)
+          else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 1765, __pyx_L3_error)
         }
       }
       if (unlikely(kw_args > 0)) {
         const Py_ssize_t kwd_pos_args = __pyx_nargs;
-        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values + 0, kwd_pos_args, "to_espresso") < 0)) __PYX_ERR(0, 1758, __pyx_L3_error)
+        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values + 0, kwd_pos_args, "to_espresso") < 0)) __PYX_ERR(0, 1765, __pyx_L3_error)
       }
     } else {
       switch (__pyx_nargs) {
         case  1: values[0] = __Pyx_Arg_FASTCALL(__pyx_args, 0);
         CYTHON_FALLTHROUGH;
         case  0: break;
         default: goto __pyx_L5_argtuple_error;
       }
     }
     __pyx_v_phase = values[0];
   }
   goto __pyx_L6_skip;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("to_espresso", 0, 0, 1, __pyx_nargs); __PYX_ERR(0, 1758, __pyx_L3_error)
+  __Pyx_RaiseArgtupleInvalid("to_espresso", 0, 0, 1, __pyx_nargs); __PYX_ERR(0, 1765, __pyx_L3_error)
   __pyx_L6_skip:;
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L3_error:;
   {
     Py_ssize_t __pyx_temp;
     for (__pyx_temp=0; __pyx_temp < (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
       __Pyx_Arg_XDECREF_FASTCALL(values[__pyx_temp]);
@@ -52437,126 +52574,126 @@
   int __pyx_t_6;
   PyObject *__pyx_t_7 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("to_espresso", 1);
 
-  /* "sat_toolkit/formula.pyx":1767
+  /* "sat_toolkit/formula.pyx":1774
  *         :rtype: Truthtable
  *         """
  *         if phase == 'cnf' or phase == '0' or phase == 0:             # <<<<<<<<<<<<<<
  *             invert = True
  *         elif phase == 'dnf' or phase == '1' or phase == 1:
  */
-  __pyx_t_2 = (__Pyx_PyUnicode_Equals(__pyx_v_phase, __pyx_n_u_cnf_2, Py_EQ)); if (unlikely((__pyx_t_2 < 0))) __PYX_ERR(0, 1767, __pyx_L1_error)
+  __pyx_t_2 = (__Pyx_PyUnicode_Equals(__pyx_v_phase, __pyx_n_u_cnf_2, Py_EQ)); if (unlikely((__pyx_t_2 < 0))) __PYX_ERR(0, 1774, __pyx_L1_error)
   if (!__pyx_t_2) {
   } else {
     __pyx_t_1 = __pyx_t_2;
     goto __pyx_L4_bool_binop_done;
   }
-  __pyx_t_2 = (__Pyx_PyUnicode_Equals(__pyx_v_phase, __pyx_kp_u_0, Py_EQ)); if (unlikely((__pyx_t_2 < 0))) __PYX_ERR(0, 1767, __pyx_L1_error)
+  __pyx_t_2 = (__Pyx_PyUnicode_Equals(__pyx_v_phase, __pyx_kp_u_0, Py_EQ)); if (unlikely((__pyx_t_2 < 0))) __PYX_ERR(0, 1774, __pyx_L1_error)
   if (!__pyx_t_2) {
   } else {
     __pyx_t_1 = __pyx_t_2;
     goto __pyx_L4_bool_binop_done;
   }
-  __pyx_t_2 = (__Pyx_PyInt_BoolEqObjC(__pyx_v_phase, __pyx_int_0, 0, 0)); if (unlikely((__pyx_t_2 < 0))) __PYX_ERR(0, 1767, __pyx_L1_error)
+  __pyx_t_2 = (__Pyx_PyInt_BoolEqObjC(__pyx_v_phase, __pyx_int_0, 0, 0)); if (unlikely((__pyx_t_2 < 0))) __PYX_ERR(0, 1774, __pyx_L1_error)
   __pyx_t_1 = __pyx_t_2;
   __pyx_L4_bool_binop_done:;
   if (__pyx_t_1) {
 
-    /* "sat_toolkit/formula.pyx":1768
+    /* "sat_toolkit/formula.pyx":1775
  *         """
  *         if phase == 'cnf' or phase == '0' or phase == 0:
  *             invert = True             # <<<<<<<<<<<<<<
  *         elif phase == 'dnf' or phase == '1' or phase == 1:
  *             invert = False
  */
     __pyx_v_invert = 1;
 
-    /* "sat_toolkit/formula.pyx":1767
+    /* "sat_toolkit/formula.pyx":1774
  *         :rtype: Truthtable
  *         """
  *         if phase == 'cnf' or phase == '0' or phase == 0:             # <<<<<<<<<<<<<<
  *             invert = True
  *         elif phase == 'dnf' or phase == '1' or phase == 1:
  */
     goto __pyx_L3;
   }
 
-  /* "sat_toolkit/formula.pyx":1769
+  /* "sat_toolkit/formula.pyx":1776
  *         if phase == 'cnf' or phase == '0' or phase == 0:
  *             invert = True
  *         elif phase == 'dnf' or phase == '1' or phase == 1:             # <<<<<<<<<<<<<<
  *             invert = False
  *         else:
  */
-  __pyx_t_2 = (__Pyx_PyUnicode_Equals(__pyx_v_phase, __pyx_n_u_dnf, Py_EQ)); if (unlikely((__pyx_t_2 < 0))) __PYX_ERR(0, 1769, __pyx_L1_error)
+  __pyx_t_2 = (__Pyx_PyUnicode_Equals(__pyx_v_phase, __pyx_n_u_dnf, Py_EQ)); if (unlikely((__pyx_t_2 < 0))) __PYX_ERR(0, 1776, __pyx_L1_error)
   if (!__pyx_t_2) {
   } else {
     __pyx_t_1 = __pyx_t_2;
     goto __pyx_L7_bool_binop_done;
   }
-  __pyx_t_2 = (__Pyx_PyUnicode_Equals(__pyx_v_phase, __pyx_kp_u_1, Py_EQ)); if (unlikely((__pyx_t_2 < 0))) __PYX_ERR(0, 1769, __pyx_L1_error)
+  __pyx_t_2 = (__Pyx_PyUnicode_Equals(__pyx_v_phase, __pyx_kp_u_1, Py_EQ)); if (unlikely((__pyx_t_2 < 0))) __PYX_ERR(0, 1776, __pyx_L1_error)
   if (!__pyx_t_2) {
   } else {
     __pyx_t_1 = __pyx_t_2;
     goto __pyx_L7_bool_binop_done;
   }
-  __pyx_t_2 = (__Pyx_PyInt_BoolEqObjC(__pyx_v_phase, __pyx_int_1, 1, 0)); if (unlikely((__pyx_t_2 < 0))) __PYX_ERR(0, 1769, __pyx_L1_error)
+  __pyx_t_2 = (__Pyx_PyInt_BoolEqObjC(__pyx_v_phase, __pyx_int_1, 1, 0)); if (unlikely((__pyx_t_2 < 0))) __PYX_ERR(0, 1776, __pyx_L1_error)
   __pyx_t_1 = __pyx_t_2;
   __pyx_L7_bool_binop_done:;
   if (likely(__pyx_t_1)) {
 
-    /* "sat_toolkit/formula.pyx":1770
+    /* "sat_toolkit/formula.pyx":1777
  *             invert = True
  *         elif phase == 'dnf' or phase == '1' or phase == 1:
  *             invert = False             # <<<<<<<<<<<<<<
  *         else:
  *             raise ValueError('invalid value for `phase`')
  */
     __pyx_v_invert = 0;
 
-    /* "sat_toolkit/formula.pyx":1769
+    /* "sat_toolkit/formula.pyx":1776
  *         if phase == 'cnf' or phase == '0' or phase == 0:
  *             invert = True
  *         elif phase == 'dnf' or phase == '1' or phase == 1:             # <<<<<<<<<<<<<<
  *             invert = False
  *         else:
  */
     goto __pyx_L3;
   }
 
-  /* "sat_toolkit/formula.pyx":1772
+  /* "sat_toolkit/formula.pyx":1779
  *             invert = False
  *         else:
  *             raise ValueError('invalid value for `phase`')             # <<<<<<<<<<<<<<
  * 
  *         res = io.StringIO()
  */
   /*else*/ {
-    __pyx_t_3 = __Pyx_PyObject_Call(__pyx_builtin_ValueError, __pyx_tuple__60, NULL); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1772, __pyx_L1_error)
+    __pyx_t_3 = __Pyx_PyObject_Call(__pyx_builtin_ValueError, __pyx_tuple__60, NULL); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1779, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
     __Pyx_Raise(__pyx_t_3, 0, 0, 0);
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-    __PYX_ERR(0, 1772, __pyx_L1_error)
+    __PYX_ERR(0, 1779, __pyx_L1_error)
   }
   __pyx_L3:;
 
-  /* "sat_toolkit/formula.pyx":1774
+  /* "sat_toolkit/formula.pyx":1781
  *             raise ValueError('invalid value for `phase`')
  * 
  *         res = io.StringIO()             # <<<<<<<<<<<<<<
  *         self._write(res, True, invert)
  *         return res.getvalue()
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_io); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1774, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_io); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1781, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
-  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_StringIO); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1774, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_StringIO); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1781, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
   __pyx_t_4 = NULL;
   __pyx_t_6 = 0;
   #if CYTHON_UNPACK_METHODS
   if (unlikely(PyMethod_Check(__pyx_t_5))) {
     __pyx_t_4 = PyMethod_GET_SELF(__pyx_t_5);
@@ -52569,31 +52706,31 @@
     }
   }
   #endif
   {
     PyObject *__pyx_callargs[2] = {__pyx_t_4, NULL};
     __pyx_t_3 = __Pyx_PyObject_FastCall(__pyx_t_5, __pyx_callargs+1-__pyx_t_6, 0+__pyx_t_6);
     __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
-    if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1774, __pyx_L1_error)
+    if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1781, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
   }
   __pyx_v_res = __pyx_t_3;
   __pyx_t_3 = 0;
 
-  /* "sat_toolkit/formula.pyx":1775
+  /* "sat_toolkit/formula.pyx":1782
  * 
  *         res = io.StringIO()
  *         self._write(res, True, invert)             # <<<<<<<<<<<<<<
  *         return res.getvalue()
  * 
  */
-  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_self), __pyx_n_s_write_2); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1775, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_self), __pyx_n_s_write_2); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1782, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
-  __pyx_t_4 = __Pyx_PyBool_FromLong(__pyx_v_invert); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1775, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyBool_FromLong(__pyx_v_invert); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1782, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __pyx_t_7 = NULL;
   __pyx_t_6 = 0;
   #if CYTHON_UNPACK_METHODS
   if (likely(PyMethod_Check(__pyx_t_5))) {
     __pyx_t_7 = PyMethod_GET_SELF(__pyx_t_5);
     if (likely(__pyx_t_7)) {
@@ -52606,29 +52743,29 @@
   }
   #endif
   {
     PyObject *__pyx_callargs[4] = {__pyx_t_7, __pyx_v_res, Py_True, __pyx_t_4};
     __pyx_t_3 = __Pyx_PyObject_FastCall(__pyx_t_5, __pyx_callargs+1-__pyx_t_6, 3+__pyx_t_6);
     __Pyx_XDECREF(__pyx_t_7); __pyx_t_7 = 0;
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-    if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1775, __pyx_L1_error)
+    if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1782, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
   }
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
 
-  /* "sat_toolkit/formula.pyx":1776
+  /* "sat_toolkit/formula.pyx":1783
  *         res = io.StringIO()
  *         self._write(res, True, invert)
  *         return res.getvalue()             # <<<<<<<<<<<<<<
  * 
  *     def __repr__(self) -> str:
  */
   __Pyx_XDECREF(__pyx_r);
-  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_v_res, __pyx_n_s_getvalue); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1776, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_v_res, __pyx_n_s_getvalue); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1783, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
   __pyx_t_4 = NULL;
   __pyx_t_6 = 0;
   #if CYTHON_UNPACK_METHODS
   if (likely(PyMethod_Check(__pyx_t_5))) {
     __pyx_t_4 = PyMethod_GET_SELF(__pyx_t_5);
     if (likely(__pyx_t_4)) {
@@ -52640,24 +52777,24 @@
     }
   }
   #endif
   {
     PyObject *__pyx_callargs[2] = {__pyx_t_4, NULL};
     __pyx_t_3 = __Pyx_PyObject_FastCall(__pyx_t_5, __pyx_callargs+1-__pyx_t_6, 0+__pyx_t_6);
     __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
-    if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1776, __pyx_L1_error)
+    if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1783, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
   }
-  if (!(likely(PyUnicode_CheckExact(__pyx_t_3))||((__pyx_t_3) == Py_None) || __Pyx_RaiseUnexpectedTypeError("unicode", __pyx_t_3))) __PYX_ERR(0, 1776, __pyx_L1_error)
+  if (!(likely(PyUnicode_CheckExact(__pyx_t_3))||((__pyx_t_3) == Py_None) || __Pyx_RaiseUnexpectedTypeError("unicode", __pyx_t_3))) __PYX_ERR(0, 1783, __pyx_L1_error)
   __pyx_r = ((PyObject*)__pyx_t_3);
   __pyx_t_3 = 0;
   goto __pyx_L0;
 
-  /* "sat_toolkit/formula.pyx":1758
+  /* "sat_toolkit/formula.pyx":1765
  *             io.write(f'.end\n')
  * 
  *     def to_espresso(self, phase='cnf') -> str:             # <<<<<<<<<<<<<<
  *         """
  *         return the truthtable in espresso format
  */
 
@@ -52672,15 +52809,15 @@
   __pyx_L0:;
   __Pyx_XDECREF(__pyx_v_res);
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "sat_toolkit/formula.pyx":1778
+/* "sat_toolkit/formula.pyx":1785
  *         return res.getvalue()
  * 
  *     def __repr__(self) -> str:             # <<<<<<<<<<<<<<
  *         result = io.StringIO()
  *         result.write("Truthtable\n")
  */
 
@@ -52708,24 +52845,24 @@
   PyObject *__pyx_t_3 = NULL;
   int __pyx_t_4;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("__repr__", 1);
 
-  /* "sat_toolkit/formula.pyx":1779
+  /* "sat_toolkit/formula.pyx":1786
  * 
  *     def __repr__(self) -> str:
  *         result = io.StringIO()             # <<<<<<<<<<<<<<
  *         result.write("Truthtable\n")
  *         self._write(result)
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_io); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1779, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_io); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1786, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_StringIO); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1779, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_StringIO); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1786, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   __pyx_t_2 = NULL;
   __pyx_t_4 = 0;
   #if CYTHON_UNPACK_METHODS
   if (unlikely(PyMethod_Check(__pyx_t_3))) {
     __pyx_t_2 = PyMethod_GET_SELF(__pyx_t_3);
@@ -52738,29 +52875,29 @@
     }
   }
   #endif
   {
     PyObject *__pyx_callargs[2] = {__pyx_t_2, NULL};
     __pyx_t_1 = __Pyx_PyObject_FastCall(__pyx_t_3, __pyx_callargs+1-__pyx_t_4, 0+__pyx_t_4);
     __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
-    if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1779, __pyx_L1_error)
+    if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1786, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   }
   __pyx_v_result = __pyx_t_1;
   __pyx_t_1 = 0;
 
-  /* "sat_toolkit/formula.pyx":1780
+  /* "sat_toolkit/formula.pyx":1787
  *     def __repr__(self) -> str:
  *         result = io.StringIO()
  *         result.write("Truthtable\n")             # <<<<<<<<<<<<<<
  *         self._write(result)
  *         return result.getvalue()
  */
-  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_v_result, __pyx_n_s_write); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1780, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_v_result, __pyx_n_s_write); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1787, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __pyx_t_2 = NULL;
   __pyx_t_4 = 0;
   #if CYTHON_UNPACK_METHODS
   if (likely(PyMethod_Check(__pyx_t_3))) {
     __pyx_t_2 = PyMethod_GET_SELF(__pyx_t_3);
     if (likely(__pyx_t_2)) {
@@ -52772,28 +52909,28 @@
     }
   }
   #endif
   {
     PyObject *__pyx_callargs[2] = {__pyx_t_2, __pyx_n_u_Truthtable};
     __pyx_t_1 = __Pyx_PyObject_FastCall(__pyx_t_3, __pyx_callargs+1-__pyx_t_4, 1+__pyx_t_4);
     __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
-    if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1780, __pyx_L1_error)
+    if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1787, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   }
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-  /* "sat_toolkit/formula.pyx":1781
+  /* "sat_toolkit/formula.pyx":1788
  *         result = io.StringIO()
  *         result.write("Truthtable\n")
  *         self._write(result)             # <<<<<<<<<<<<<<
  *         return result.getvalue()
  * 
  */
-  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_self), __pyx_n_s_write_2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1781, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_self), __pyx_n_s_write_2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1788, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __pyx_t_2 = NULL;
   __pyx_t_4 = 0;
   #if CYTHON_UNPACK_METHODS
   if (likely(PyMethod_Check(__pyx_t_3))) {
     __pyx_t_2 = PyMethod_GET_SELF(__pyx_t_3);
     if (likely(__pyx_t_2)) {
@@ -52805,29 +52942,29 @@
     }
   }
   #endif
   {
     PyObject *__pyx_callargs[2] = {__pyx_t_2, __pyx_v_result};
     __pyx_t_1 = __Pyx_PyObject_FastCall(__pyx_t_3, __pyx_callargs+1-__pyx_t_4, 1+__pyx_t_4);
     __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
-    if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1781, __pyx_L1_error)
+    if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1788, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   }
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-  /* "sat_toolkit/formula.pyx":1782
+  /* "sat_toolkit/formula.pyx":1789
  *         result.write("Truthtable\n")
  *         self._write(result)
  *         return result.getvalue()             # <<<<<<<<<<<<<<
  * 
  *     def __eq__(self, other) -> bool:
  */
   __Pyx_XDECREF(__pyx_r);
-  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_v_result, __pyx_n_s_getvalue); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1782, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_v_result, __pyx_n_s_getvalue); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1789, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __pyx_t_2 = NULL;
   __pyx_t_4 = 0;
   #if CYTHON_UNPACK_METHODS
   if (likely(PyMethod_Check(__pyx_t_3))) {
     __pyx_t_2 = PyMethod_GET_SELF(__pyx_t_3);
     if (likely(__pyx_t_2)) {
@@ -52839,23 +52976,23 @@
     }
   }
   #endif
   {
     PyObject *__pyx_callargs[2] = {__pyx_t_2, NULL};
     __pyx_t_1 = __Pyx_PyObject_FastCall(__pyx_t_3, __pyx_callargs+1-__pyx_t_4, 0+__pyx_t_4);
     __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
-    if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1782, __pyx_L1_error)
+    if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1789, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   }
   __pyx_r = __pyx_t_1;
   __pyx_t_1 = 0;
   goto __pyx_L0;
 
-  /* "sat_toolkit/formula.pyx":1778
+  /* "sat_toolkit/formula.pyx":1785
  *         return res.getvalue()
  * 
  *     def __repr__(self) -> str:             # <<<<<<<<<<<<<<
  *         result = io.StringIO()
  *         result.write("Truthtable\n")
  */
 
@@ -52869,15 +53006,15 @@
   __pyx_L0:;
   __Pyx_XDECREF(__pyx_v_result);
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "sat_toolkit/formula.pyx":1784
+/* "sat_toolkit/formula.pyx":1791
  *         return result.getvalue()
  * 
  *     def __eq__(self, other) -> bool:             # <<<<<<<<<<<<<<
  *         if self.numbits != other.numbits:
  *             return False
  */
 
@@ -52907,68 +53044,68 @@
   int __pyx_t_6;
   int __pyx_t_7;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("__eq__", 1);
 
-  /* "sat_toolkit/formula.pyx":1785
+  /* "sat_toolkit/formula.pyx":1792
  * 
  *     def __eq__(self, other) -> bool:
  *         if self.numbits != other.numbits:             # <<<<<<<<<<<<<<
  *             return False
  *         if not np.all(self.on_set == other.on_set):
  */
-  __pyx_t_1 = __Pyx_PyInt_From_unsigned_long(__pyx_v_self->numbits); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1785, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyInt_From_unsigned_long(__pyx_v_self->numbits); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1792, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_other, __pyx_n_s_numbits); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1785, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_other, __pyx_n_s_numbits); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1792, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_3 = PyObject_RichCompare(__pyx_t_1, __pyx_t_2, Py_NE); __Pyx_XGOTREF(__pyx_t_3); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1785, __pyx_L1_error)
+  __pyx_t_3 = PyObject_RichCompare(__pyx_t_1, __pyx_t_2, Py_NE); __Pyx_XGOTREF(__pyx_t_3); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1792, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __pyx_t_4 = __Pyx_PyObject_IsTrue(__pyx_t_3); if (unlikely((__pyx_t_4 < 0))) __PYX_ERR(0, 1785, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyObject_IsTrue(__pyx_t_3); if (unlikely((__pyx_t_4 < 0))) __PYX_ERR(0, 1792, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   if (__pyx_t_4) {
 
-    /* "sat_toolkit/formula.pyx":1786
+    /* "sat_toolkit/formula.pyx":1793
  *     def __eq__(self, other) -> bool:
  *         if self.numbits != other.numbits:
  *             return False             # <<<<<<<<<<<<<<
  *         if not np.all(self.on_set == other.on_set):
  *             return False
  */
     __Pyx_XDECREF(__pyx_r);
     __Pyx_INCREF(Py_False);
     __pyx_r = Py_False;
     goto __pyx_L0;
 
-    /* "sat_toolkit/formula.pyx":1785
+    /* "sat_toolkit/formula.pyx":1792
  * 
  *     def __eq__(self, other) -> bool:
  *         if self.numbits != other.numbits:             # <<<<<<<<<<<<<<
  *             return False
  *         if not np.all(self.on_set == other.on_set):
  */
   }
 
-  /* "sat_toolkit/formula.pyx":1787
+  /* "sat_toolkit/formula.pyx":1794
  *         if self.numbits != other.numbits:
  *             return False
  *         if not np.all(self.on_set == other.on_set):             # <<<<<<<<<<<<<<
  *             return False
  *         if self.dc_set is None and other.dc_set is not None:
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1787, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1794, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_all); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1787, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_all); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1794, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_other, __pyx_n_s_on_set); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1787, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_other, __pyx_n_s_on_set); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1794, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_5 = PyObject_RichCompare(__pyx_v_self->on_set, __pyx_t_2, Py_EQ); __Pyx_XGOTREF(__pyx_t_5); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1787, __pyx_L1_error)
+  __pyx_t_5 = PyObject_RichCompare(__pyx_v_self->on_set, __pyx_t_2, Py_EQ); __Pyx_XGOTREF(__pyx_t_5); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1794, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   __pyx_t_2 = NULL;
   __pyx_t_6 = 0;
   #if CYTHON_UNPACK_METHODS
   if (unlikely(PyMethod_Check(__pyx_t_1))) {
     __pyx_t_2 = PyMethod_GET_SELF(__pyx_t_1);
     if (likely(__pyx_t_2)) {
@@ -52981,143 +53118,143 @@
   }
   #endif
   {
     PyObject *__pyx_callargs[2] = {__pyx_t_2, __pyx_t_5};
     __pyx_t_3 = __Pyx_PyObject_FastCall(__pyx_t_1, __pyx_callargs+1-__pyx_t_6, 1+__pyx_t_6);
     __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-    if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1787, __pyx_L1_error)
+    if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1794, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   }
-  __pyx_t_4 = __Pyx_PyObject_IsTrue(__pyx_t_3); if (unlikely((__pyx_t_4 < 0))) __PYX_ERR(0, 1787, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyObject_IsTrue(__pyx_t_3); if (unlikely((__pyx_t_4 < 0))) __PYX_ERR(0, 1794, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   __pyx_t_7 = (!__pyx_t_4);
   if (__pyx_t_7) {
 
-    /* "sat_toolkit/formula.pyx":1788
+    /* "sat_toolkit/formula.pyx":1795
  *             return False
  *         if not np.all(self.on_set == other.on_set):
  *             return False             # <<<<<<<<<<<<<<
  *         if self.dc_set is None and other.dc_set is not None:
  *             return False
  */
     __Pyx_XDECREF(__pyx_r);
     __Pyx_INCREF(Py_False);
     __pyx_r = Py_False;
     goto __pyx_L0;
 
-    /* "sat_toolkit/formula.pyx":1787
+    /* "sat_toolkit/formula.pyx":1794
  *         if self.numbits != other.numbits:
  *             return False
  *         if not np.all(self.on_set == other.on_set):             # <<<<<<<<<<<<<<
  *             return False
  *         if self.dc_set is None and other.dc_set is not None:
  */
   }
 
-  /* "sat_toolkit/formula.pyx":1789
+  /* "sat_toolkit/formula.pyx":1796
  *         if not np.all(self.on_set == other.on_set):
  *             return False
  *         if self.dc_set is None and other.dc_set is not None:             # <<<<<<<<<<<<<<
  *             return False
  *         if other.dc_set is None and self.dc_set is not None:
  */
   __pyx_t_4 = (__pyx_v_self->dc_set == Py_None);
   if (__pyx_t_4) {
   } else {
     __pyx_t_7 = __pyx_t_4;
     goto __pyx_L6_bool_binop_done;
   }
-  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_v_other, __pyx_n_s_dc_set); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1789, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_v_other, __pyx_n_s_dc_set); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1796, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __pyx_t_4 = (__pyx_t_3 != Py_None);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   __pyx_t_7 = __pyx_t_4;
   __pyx_L6_bool_binop_done:;
   if (__pyx_t_7) {
 
-    /* "sat_toolkit/formula.pyx":1790
+    /* "sat_toolkit/formula.pyx":1797
  *             return False
  *         if self.dc_set is None and other.dc_set is not None:
  *             return False             # <<<<<<<<<<<<<<
  *         if other.dc_set is None and self.dc_set is not None:
  *             return False
  */
     __Pyx_XDECREF(__pyx_r);
     __Pyx_INCREF(Py_False);
     __pyx_r = Py_False;
     goto __pyx_L0;
 
-    /* "sat_toolkit/formula.pyx":1789
+    /* "sat_toolkit/formula.pyx":1796
  *         if not np.all(self.on_set == other.on_set):
  *             return False
  *         if self.dc_set is None and other.dc_set is not None:             # <<<<<<<<<<<<<<
  *             return False
  *         if other.dc_set is None and self.dc_set is not None:
  */
   }
 
-  /* "sat_toolkit/formula.pyx":1791
+  /* "sat_toolkit/formula.pyx":1798
  *         if self.dc_set is None and other.dc_set is not None:
  *             return False
  *         if other.dc_set is None and self.dc_set is not None:             # <<<<<<<<<<<<<<
  *             return False
  *         if not np.all(self.dc_set == other.dc_set):
  */
-  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_v_other, __pyx_n_s_dc_set); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1791, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_v_other, __pyx_n_s_dc_set); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1798, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __pyx_t_4 = (__pyx_t_3 == Py_None);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   if (__pyx_t_4) {
   } else {
     __pyx_t_7 = __pyx_t_4;
     goto __pyx_L9_bool_binop_done;
   }
   __pyx_t_4 = (__pyx_v_self->dc_set != Py_None);
   __pyx_t_7 = __pyx_t_4;
   __pyx_L9_bool_binop_done:;
   if (__pyx_t_7) {
 
-    /* "sat_toolkit/formula.pyx":1792
+    /* "sat_toolkit/formula.pyx":1799
  *             return False
  *         if other.dc_set is None and self.dc_set is not None:
  *             return False             # <<<<<<<<<<<<<<
  *         if not np.all(self.dc_set == other.dc_set):
  *             return False
  */
     __Pyx_XDECREF(__pyx_r);
     __Pyx_INCREF(Py_False);
     __pyx_r = Py_False;
     goto __pyx_L0;
 
-    /* "sat_toolkit/formula.pyx":1791
+    /* "sat_toolkit/formula.pyx":1798
  *         if self.dc_set is None and other.dc_set is not None:
  *             return False
  *         if other.dc_set is None and self.dc_set is not None:             # <<<<<<<<<<<<<<
  *             return False
  *         if not np.all(self.dc_set == other.dc_set):
  */
   }
 
-  /* "sat_toolkit/formula.pyx":1793
+  /* "sat_toolkit/formula.pyx":1800
  *         if other.dc_set is None and self.dc_set is not None:
  *             return False
  *         if not np.all(self.dc_set == other.dc_set):             # <<<<<<<<<<<<<<
  *             return False
  *         return True
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1793, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1800, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_all); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1793, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_all); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1800, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_other, __pyx_n_s_dc_set); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1793, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_other, __pyx_n_s_dc_set); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1800, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_2 = PyObject_RichCompare(__pyx_v_self->dc_set, __pyx_t_1, Py_EQ); __Pyx_XGOTREF(__pyx_t_2); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1793, __pyx_L1_error)
+  __pyx_t_2 = PyObject_RichCompare(__pyx_v_self->dc_set, __pyx_t_1, Py_EQ); __Pyx_XGOTREF(__pyx_t_2); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1800, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __pyx_t_1 = NULL;
   __pyx_t_6 = 0;
   #if CYTHON_UNPACK_METHODS
   if (unlikely(PyMethod_Check(__pyx_t_5))) {
     __pyx_t_1 = PyMethod_GET_SELF(__pyx_t_5);
     if (likely(__pyx_t_1)) {
@@ -53130,57 +53267,57 @@
   }
   #endif
   {
     PyObject *__pyx_callargs[2] = {__pyx_t_1, __pyx_t_2};
     __pyx_t_3 = __Pyx_PyObject_FastCall(__pyx_t_5, __pyx_callargs+1-__pyx_t_6, 1+__pyx_t_6);
     __Pyx_XDECREF(__pyx_t_1); __pyx_t_1 = 0;
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-    if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1793, __pyx_L1_error)
+    if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1800, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
   }
-  __pyx_t_7 = __Pyx_PyObject_IsTrue(__pyx_t_3); if (unlikely((__pyx_t_7 < 0))) __PYX_ERR(0, 1793, __pyx_L1_error)
+  __pyx_t_7 = __Pyx_PyObject_IsTrue(__pyx_t_3); if (unlikely((__pyx_t_7 < 0))) __PYX_ERR(0, 1800, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   __pyx_t_4 = (!__pyx_t_7);
   if (__pyx_t_4) {
 
-    /* "sat_toolkit/formula.pyx":1794
+    /* "sat_toolkit/formula.pyx":1801
  *             return False
  *         if not np.all(self.dc_set == other.dc_set):
  *             return False             # <<<<<<<<<<<<<<
  *         return True
  * 
  */
     __Pyx_XDECREF(__pyx_r);
     __Pyx_INCREF(Py_False);
     __pyx_r = Py_False;
     goto __pyx_L0;
 
-    /* "sat_toolkit/formula.pyx":1793
+    /* "sat_toolkit/formula.pyx":1800
  *         if other.dc_set is None and self.dc_set is not None:
  *             return False
  *         if not np.all(self.dc_set == other.dc_set):             # <<<<<<<<<<<<<<
  *             return False
  *         return True
  */
   }
 
-  /* "sat_toolkit/formula.pyx":1795
+  /* "sat_toolkit/formula.pyx":1802
  *         if not np.all(self.dc_set == other.dc_set):
  *             return False
  *         return True             # <<<<<<<<<<<<<<
  * 
  *     def to_cnf(self, espresso_args: List[str] = []) -> CNF:
  */
   __Pyx_XDECREF(__pyx_r);
   __Pyx_INCREF(Py_True);
   __pyx_r = Py_True;
   goto __pyx_L0;
 
-  /* "sat_toolkit/formula.pyx":1784
+  /* "sat_toolkit/formula.pyx":1791
  *         return result.getvalue()
  * 
  *     def __eq__(self, other) -> bool:             # <<<<<<<<<<<<<<
  *         if self.numbits != other.numbits:
  *             return False
  */
 
@@ -53194,15 +53331,15 @@
   __pyx_r = NULL;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "sat_toolkit/formula.pyx":1797
+/* "sat_toolkit/formula.pyx":1804
  *         return True
  * 
  *     def to_cnf(self, espresso_args: List[str] = []) -> CNF:             # <<<<<<<<<<<<<<
  *         """
  *         Uses espresso to convert the Truthtable to a minimized CNF.
  */
 
@@ -53256,34 +53393,34 @@
       }
       kw_args = __Pyx_NumKwargs_FASTCALL(__pyx_kwds);
       switch (__pyx_nargs) {
         case  0:
         if (kw_args > 0) {
           PyObject* value = __Pyx_GetKwValue_FASTCALL(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_espresso_args);
           if (value) { values[0] = __Pyx_Arg_NewRef_FASTCALL(value); kw_args--; }
-          else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 1797, __pyx_L3_error)
+          else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 1804, __pyx_L3_error)
         }
       }
       if (unlikely(kw_args > 0)) {
         const Py_ssize_t kwd_pos_args = __pyx_nargs;
-        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values + 0, kwd_pos_args, "to_cnf") < 0)) __PYX_ERR(0, 1797, __pyx_L3_error)
+        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values + 0, kwd_pos_args, "to_cnf") < 0)) __PYX_ERR(0, 1804, __pyx_L3_error)
       }
     } else {
       switch (__pyx_nargs) {
         case  1: values[0] = __Pyx_Arg_FASTCALL(__pyx_args, 0);
         CYTHON_FALLTHROUGH;
         case  0: break;
         default: goto __pyx_L5_argtuple_error;
       }
     }
     __pyx_v_espresso_args = values[0];
   }
   goto __pyx_L6_skip;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("to_cnf", 0, 0, 1, __pyx_nargs); __PYX_ERR(0, 1797, __pyx_L3_error)
+  __Pyx_RaiseArgtupleInvalid("to_cnf", 0, 0, 1, __pyx_nargs); __PYX_ERR(0, 1804, __pyx_L3_error)
   __pyx_L6_skip:;
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L3_error:;
   {
     Py_ssize_t __pyx_temp;
     for (__pyx_temp=0; __pyx_temp < (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
       __Pyx_Arg_XDECREF_FASTCALL(values[__pyx_temp]);
@@ -53327,65 +53464,65 @@
   int __pyx_t_13;
   struct __pyx_obj_11sat_toolkit_7formula_CNF *__pyx_t_14 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("to_cnf", 1);
 
-  /* "sat_toolkit/formula.pyx":1809
+  /* "sat_toolkit/formula.pyx":1816
  *         :rtype: CNF
  *         """
  *         with sp.Popen(['espresso'] + espresso_args, stdin=sp.PIPE, stdout=sp.PIPE, text=True) as espresso:             # <<<<<<<<<<<<<<
  *             self._write(espresso.stdin, True, True)
  *             espresso.stdin.close()
  */
   /*with:*/ {
-    __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_sp); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1809, __pyx_L1_error)
+    __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_sp); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1816, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
-    __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_Popen); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1809, __pyx_L1_error)
+    __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_Popen); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1816, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-    __pyx_t_1 = PyList_New(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1809, __pyx_L1_error)
+    __pyx_t_1 = PyList_New(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1816, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_INCREF(__pyx_n_u_espresso);
     __Pyx_GIVEREF(__pyx_n_u_espresso);
-    if (__Pyx_PyList_SET_ITEM(__pyx_t_1, 0, __pyx_n_u_espresso)) __PYX_ERR(0, 1809, __pyx_L1_error);
-    __pyx_t_3 = PyNumber_Add(__pyx_t_1, __pyx_v_espresso_args); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1809, __pyx_L1_error)
+    if (__Pyx_PyList_SET_ITEM(__pyx_t_1, 0, __pyx_n_u_espresso)) __PYX_ERR(0, 1816, __pyx_L1_error);
+    __pyx_t_3 = PyNumber_Add(__pyx_t_1, __pyx_v_espresso_args); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1816, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-    __pyx_t_1 = PyTuple_New(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1809, __pyx_L1_error)
+    __pyx_t_1 = PyTuple_New(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1816, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_GIVEREF(__pyx_t_3);
-    if (__Pyx_PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_t_3)) __PYX_ERR(0, 1809, __pyx_L1_error);
+    if (__Pyx_PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_t_3)) __PYX_ERR(0, 1816, __pyx_L1_error);
     __pyx_t_3 = 0;
-    __pyx_t_3 = __Pyx_PyDict_NewPresized(3); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1809, __pyx_L1_error)
+    __pyx_t_3 = __Pyx_PyDict_NewPresized(3); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1816, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
-    __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_sp); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1809, __pyx_L1_error)
+    __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_sp); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1816, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
-    __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_PIPE); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1809, __pyx_L1_error)
+    __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_PIPE); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1816, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-    if (PyDict_SetItem(__pyx_t_3, __pyx_n_s_stdin, __pyx_t_5) < 0) __PYX_ERR(0, 1809, __pyx_L1_error)
+    if (PyDict_SetItem(__pyx_t_3, __pyx_n_s_stdin, __pyx_t_5) < 0) __PYX_ERR(0, 1816, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-    __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_sp); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1809, __pyx_L1_error)
+    __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_sp); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1816, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
-    __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_PIPE); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1809, __pyx_L1_error)
+    __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_PIPE); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1816, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-    if (PyDict_SetItem(__pyx_t_3, __pyx_n_s_stdout, __pyx_t_4) < 0) __PYX_ERR(0, 1809, __pyx_L1_error)
+    if (PyDict_SetItem(__pyx_t_3, __pyx_n_s_stdout, __pyx_t_4) < 0) __PYX_ERR(0, 1816, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-    if (PyDict_SetItem(__pyx_t_3, __pyx_n_s_text, Py_True) < 0) __PYX_ERR(0, 1809, __pyx_L1_error)
-    __pyx_t_4 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_t_1, __pyx_t_3); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1809, __pyx_L1_error)
+    if (PyDict_SetItem(__pyx_t_3, __pyx_n_s_text, Py_True) < 0) __PYX_ERR(0, 1816, __pyx_L1_error)
+    __pyx_t_4 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_t_1, __pyx_t_3); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1816, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-    __pyx_t_6 = __Pyx_PyObject_LookupSpecial(__pyx_t_4, __pyx_n_s_exit); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1809, __pyx_L1_error)
+    __pyx_t_6 = __Pyx_PyObject_LookupSpecial(__pyx_t_4, __pyx_n_s_exit); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1816, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
-    __pyx_t_1 = __Pyx_PyObject_LookupSpecial(__pyx_t_4, __pyx_n_s_enter); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1809, __pyx_L3_error)
+    __pyx_t_1 = __Pyx_PyObject_LookupSpecial(__pyx_t_4, __pyx_n_s_enter); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1816, __pyx_L3_error)
     __Pyx_GOTREF(__pyx_t_1);
     __pyx_t_2 = NULL;
     __pyx_t_7 = 0;
     #if CYTHON_UNPACK_METHODS
     if (likely(PyMethod_Check(__pyx_t_1))) {
       __pyx_t_2 = PyMethod_GET_SELF(__pyx_t_1);
       if (likely(__pyx_t_2)) {
@@ -53397,15 +53534,15 @@
       }
     }
     #endif
     {
       PyObject *__pyx_callargs[2] = {__pyx_t_2, NULL};
       __pyx_t_3 = __Pyx_PyObject_FastCall(__pyx_t_1, __pyx_callargs+1-__pyx_t_7, 0+__pyx_t_7);
       __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
-      if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1809, __pyx_L3_error)
+      if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1816, __pyx_L3_error)
       __Pyx_GOTREF(__pyx_t_3);
       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
     }
     __pyx_t_1 = __pyx_t_3;
     __pyx_t_3 = 0;
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
     /*try:*/ {
@@ -53416,24 +53553,24 @@
         __Pyx_XGOTREF(__pyx_t_8);
         __Pyx_XGOTREF(__pyx_t_9);
         __Pyx_XGOTREF(__pyx_t_10);
         /*try:*/ {
           __pyx_v_espresso = __pyx_t_1;
           __pyx_t_1 = 0;
 
-          /* "sat_toolkit/formula.pyx":1810
+          /* "sat_toolkit/formula.pyx":1817
  *         """
  *         with sp.Popen(['espresso'] + espresso_args, stdin=sp.PIPE, stdout=sp.PIPE, text=True) as espresso:
  *             self._write(espresso.stdin, True, True)             # <<<<<<<<<<<<<<
  *             espresso.stdin.close()
  * 
  */
-          __pyx_t_4 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_self), __pyx_n_s_write_2); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1810, __pyx_L7_error)
+          __pyx_t_4 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_self), __pyx_n_s_write_2); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1817, __pyx_L7_error)
           __Pyx_GOTREF(__pyx_t_4);
-          __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_v_espresso, __pyx_n_s_stdin); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1810, __pyx_L7_error)
+          __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_v_espresso, __pyx_n_s_stdin); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1817, __pyx_L7_error)
           __Pyx_GOTREF(__pyx_t_3);
           __pyx_t_2 = NULL;
           __pyx_t_7 = 0;
           #if CYTHON_UNPACK_METHODS
           if (likely(PyMethod_Check(__pyx_t_4))) {
             __pyx_t_2 = PyMethod_GET_SELF(__pyx_t_4);
             if (likely(__pyx_t_2)) {
@@ -53446,30 +53583,30 @@
           }
           #endif
           {
             PyObject *__pyx_callargs[4] = {__pyx_t_2, __pyx_t_3, Py_True, Py_True};
             __pyx_t_1 = __Pyx_PyObject_FastCall(__pyx_t_4, __pyx_callargs+1-__pyx_t_7, 3+__pyx_t_7);
             __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
             __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-            if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1810, __pyx_L7_error)
+            if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1817, __pyx_L7_error)
             __Pyx_GOTREF(__pyx_t_1);
             __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
           }
           __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-          /* "sat_toolkit/formula.pyx":1811
+          /* "sat_toolkit/formula.pyx":1818
  *         with sp.Popen(['espresso'] + espresso_args, stdin=sp.PIPE, stdout=sp.PIPE, text=True) as espresso:
  *             self._write(espresso.stdin, True, True)
  *             espresso.stdin.close()             # <<<<<<<<<<<<<<
  * 
  *             cnf = CNF.from_espresso(espresso.stdout.read())
  */
-          __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_v_espresso, __pyx_n_s_stdin); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1811, __pyx_L7_error)
+          __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_v_espresso, __pyx_n_s_stdin); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1818, __pyx_L7_error)
           __Pyx_GOTREF(__pyx_t_4);
-          __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_close); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1811, __pyx_L7_error)
+          __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_close); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1818, __pyx_L7_error)
           __Pyx_GOTREF(__pyx_t_3);
           __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
           __pyx_t_4 = NULL;
           __pyx_t_7 = 0;
           #if CYTHON_UNPACK_METHODS
           if (likely(PyMethod_Check(__pyx_t_3))) {
             __pyx_t_4 = PyMethod_GET_SELF(__pyx_t_3);
@@ -53482,32 +53619,32 @@
             }
           }
           #endif
           {
             PyObject *__pyx_callargs[2] = {__pyx_t_4, NULL};
             __pyx_t_1 = __Pyx_PyObject_FastCall(__pyx_t_3, __pyx_callargs+1-__pyx_t_7, 0+__pyx_t_7);
             __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
-            if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1811, __pyx_L7_error)
+            if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1818, __pyx_L7_error)
             __Pyx_GOTREF(__pyx_t_1);
             __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
           }
           __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-          /* "sat_toolkit/formula.pyx":1813
+          /* "sat_toolkit/formula.pyx":1820
  *             espresso.stdin.close()
  * 
  *             cnf = CNF.from_espresso(espresso.stdout.read())             # <<<<<<<<<<<<<<
  * 
  *             ret_code = espresso.wait()
  */
-          __pyx_t_3 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_ptype_11sat_toolkit_7formula_CNF), __pyx_n_s_from_espresso); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1813, __pyx_L7_error)
+          __pyx_t_3 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_ptype_11sat_toolkit_7formula_CNF), __pyx_n_s_from_espresso); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1820, __pyx_L7_error)
           __Pyx_GOTREF(__pyx_t_3);
-          __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_espresso, __pyx_n_s_stdout); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1813, __pyx_L7_error)
+          __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_espresso, __pyx_n_s_stdout); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1820, __pyx_L7_error)
           __Pyx_GOTREF(__pyx_t_2);
-          __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_read); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1813, __pyx_L7_error)
+          __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_read); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1820, __pyx_L7_error)
           __Pyx_GOTREF(__pyx_t_5);
           __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
           __pyx_t_2 = NULL;
           __pyx_t_7 = 0;
           #if CYTHON_UNPACK_METHODS
           if (likely(PyMethod_Check(__pyx_t_5))) {
             __pyx_t_2 = PyMethod_GET_SELF(__pyx_t_5);
@@ -53520,15 +53657,15 @@
             }
           }
           #endif
           {
             PyObject *__pyx_callargs[2] = {__pyx_t_2, NULL};
             __pyx_t_4 = __Pyx_PyObject_FastCall(__pyx_t_5, __pyx_callargs+1-__pyx_t_7, 0+__pyx_t_7);
             __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
-            if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1813, __pyx_L7_error)
+            if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1820, __pyx_L7_error)
             __Pyx_GOTREF(__pyx_t_4);
             __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
           }
           __pyx_t_5 = NULL;
           __pyx_t_7 = 0;
           #if CYTHON_UNPACK_METHODS
           if (likely(PyMethod_Check(__pyx_t_3))) {
@@ -53543,29 +53680,29 @@
           }
           #endif
           {
             PyObject *__pyx_callargs[2] = {__pyx_t_5, __pyx_t_4};
             __pyx_t_1 = __Pyx_PyObject_FastCall(__pyx_t_3, __pyx_callargs+1-__pyx_t_7, 1+__pyx_t_7);
             __Pyx_XDECREF(__pyx_t_5); __pyx_t_5 = 0;
             __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-            if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1813, __pyx_L7_error)
+            if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1820, __pyx_L7_error)
             __Pyx_GOTREF(__pyx_t_1);
             __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
           }
           __pyx_v_cnf = __pyx_t_1;
           __pyx_t_1 = 0;
 
-          /* "sat_toolkit/formula.pyx":1815
+          /* "sat_toolkit/formula.pyx":1822
  *             cnf = CNF.from_espresso(espresso.stdout.read())
  * 
  *             ret_code = espresso.wait()             # <<<<<<<<<<<<<<
  *             if ret_code != 0:
  *                 raise sp.CalledProcessError(ret_code, ' '.join(espresso.args))
  */
-          __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_v_espresso, __pyx_n_s_wait); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1815, __pyx_L7_error)
+          __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_v_espresso, __pyx_n_s_wait); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1822, __pyx_L7_error)
           __Pyx_GOTREF(__pyx_t_3);
           __pyx_t_4 = NULL;
           __pyx_t_7 = 0;
           #if CYTHON_UNPACK_METHODS
           if (likely(PyMethod_Check(__pyx_t_3))) {
             __pyx_t_4 = PyMethod_GET_SELF(__pyx_t_3);
             if (likely(__pyx_t_4)) {
@@ -53577,46 +53714,46 @@
             }
           }
           #endif
           {
             PyObject *__pyx_callargs[2] = {__pyx_t_4, NULL};
             __pyx_t_1 = __Pyx_PyObject_FastCall(__pyx_t_3, __pyx_callargs+1-__pyx_t_7, 0+__pyx_t_7);
             __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
-            if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1815, __pyx_L7_error)
+            if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1822, __pyx_L7_error)
             __Pyx_GOTREF(__pyx_t_1);
             __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
           }
           __pyx_v_ret_code = __pyx_t_1;
           __pyx_t_1 = 0;
 
-          /* "sat_toolkit/formula.pyx":1816
+          /* "sat_toolkit/formula.pyx":1823
  * 
  *             ret_code = espresso.wait()
  *             if ret_code != 0:             # <<<<<<<<<<<<<<
  *                 raise sp.CalledProcessError(ret_code, ' '.join(espresso.args))
  * 
  */
-          __pyx_t_11 = (__Pyx_PyInt_BoolNeObjC(__pyx_v_ret_code, __pyx_int_0, 0, 0)); if (unlikely((__pyx_t_11 < 0))) __PYX_ERR(0, 1816, __pyx_L7_error)
+          __pyx_t_11 = (__Pyx_PyInt_BoolNeObjC(__pyx_v_ret_code, __pyx_int_0, 0, 0)); if (unlikely((__pyx_t_11 < 0))) __PYX_ERR(0, 1823, __pyx_L7_error)
           if (unlikely(__pyx_t_11)) {
 
-            /* "sat_toolkit/formula.pyx":1817
+            /* "sat_toolkit/formula.pyx":1824
  *             ret_code = espresso.wait()
  *             if ret_code != 0:
  *                 raise sp.CalledProcessError(ret_code, ' '.join(espresso.args))             # <<<<<<<<<<<<<<
  * 
  *             return cnf
  */
-            __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_sp); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1817, __pyx_L7_error)
+            __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_sp); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1824, __pyx_L7_error)
             __Pyx_GOTREF(__pyx_t_3);
-            __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_CalledProcessError); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1817, __pyx_L7_error)
+            __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_CalledProcessError); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1824, __pyx_L7_error)
             __Pyx_GOTREF(__pyx_t_4);
             __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-            __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_v_espresso, __pyx_n_s_args); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1817, __pyx_L7_error)
+            __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_v_espresso, __pyx_n_s_args); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1824, __pyx_L7_error)
             __Pyx_GOTREF(__pyx_t_3);
-            __pyx_t_5 = PyUnicode_Join(__pyx_kp_u__32, __pyx_t_3); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1817, __pyx_L7_error)
+            __pyx_t_5 = PyUnicode_Join(__pyx_kp_u__32, __pyx_t_3); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1824, __pyx_L7_error)
             __Pyx_GOTREF(__pyx_t_5);
             __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
             __pyx_t_3 = NULL;
             __pyx_t_7 = 0;
             #if CYTHON_UNPACK_METHODS
             if (unlikely(PyMethod_Check(__pyx_t_4))) {
               __pyx_t_3 = PyMethod_GET_SELF(__pyx_t_4);
@@ -53630,43 +53767,43 @@
             }
             #endif
             {
               PyObject *__pyx_callargs[3] = {__pyx_t_3, __pyx_v_ret_code, __pyx_t_5};
               __pyx_t_1 = __Pyx_PyObject_FastCall(__pyx_t_4, __pyx_callargs+1-__pyx_t_7, 2+__pyx_t_7);
               __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
               __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-              if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1817, __pyx_L7_error)
+              if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1824, __pyx_L7_error)
               __Pyx_GOTREF(__pyx_t_1);
               __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
             }
             __Pyx_Raise(__pyx_t_1, 0, 0, 0);
             __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-            __PYX_ERR(0, 1817, __pyx_L7_error)
+            __PYX_ERR(0, 1824, __pyx_L7_error)
 
-            /* "sat_toolkit/formula.pyx":1816
+            /* "sat_toolkit/formula.pyx":1823
  * 
  *             ret_code = espresso.wait()
  *             if ret_code != 0:             # <<<<<<<<<<<<<<
  *                 raise sp.CalledProcessError(ret_code, ' '.join(espresso.args))
  * 
  */
           }
 
-          /* "sat_toolkit/formula.pyx":1819
+          /* "sat_toolkit/formula.pyx":1826
  *                 raise sp.CalledProcessError(ret_code, ' '.join(espresso.args))
  * 
  *             return cnf             # <<<<<<<<<<<<<<
  */
           __Pyx_XDECREF((PyObject *)__pyx_r);
-          if (!(likely(((__pyx_v_cnf) == Py_None) || likely(__Pyx_TypeTest(__pyx_v_cnf, __pyx_ptype_11sat_toolkit_7formula_CNF))))) __PYX_ERR(0, 1819, __pyx_L7_error)
+          if (!(likely(((__pyx_v_cnf) == Py_None) || likely(__Pyx_TypeTest(__pyx_v_cnf, __pyx_ptype_11sat_toolkit_7formula_CNF))))) __PYX_ERR(0, 1826, __pyx_L7_error)
           __Pyx_INCREF(__pyx_v_cnf);
           __pyx_r = ((struct __pyx_obj_11sat_toolkit_7formula_CNF *)__pyx_v_cnf);
           goto __pyx_L11_try_return;
 
-          /* "sat_toolkit/formula.pyx":1809
+          /* "sat_toolkit/formula.pyx":1816
  *         :rtype: CNF
  *         """
  *         with sp.Popen(['espresso'] + espresso_args, stdin=sp.PIPE, stdout=sp.PIPE, text=True) as espresso:             # <<<<<<<<<<<<<<
  *             self._write(espresso.stdin, True, True)
  *             espresso.stdin.close()
  */
         }
@@ -53674,36 +53811,36 @@
         __Pyx_XDECREF(__pyx_t_1); __pyx_t_1 = 0;
         __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
         __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
         __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
         __Pyx_XDECREF(__pyx_t_5); __pyx_t_5 = 0;
         /*except:*/ {
           __Pyx_AddTraceback("sat_toolkit.formula.Truthtable.to_cnf", __pyx_clineno, __pyx_lineno, __pyx_filename);
-          if (__Pyx_GetException(&__pyx_t_1, &__pyx_t_4, &__pyx_t_5) < 0) __PYX_ERR(0, 1809, __pyx_L9_except_error)
+          if (__Pyx_GetException(&__pyx_t_1, &__pyx_t_4, &__pyx_t_5) < 0) __PYX_ERR(0, 1816, __pyx_L9_except_error)
           __Pyx_XGOTREF(__pyx_t_1);
           __Pyx_XGOTREF(__pyx_t_4);
           __Pyx_XGOTREF(__pyx_t_5);
-          __pyx_t_3 = PyTuple_Pack(3, __pyx_t_1, __pyx_t_4, __pyx_t_5); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1809, __pyx_L9_except_error)
+          __pyx_t_3 = PyTuple_Pack(3, __pyx_t_1, __pyx_t_4, __pyx_t_5); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1816, __pyx_L9_except_error)
           __Pyx_GOTREF(__pyx_t_3);
           __pyx_t_12 = __Pyx_PyObject_Call(__pyx_t_6, __pyx_t_3, NULL);
           __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
           __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-          if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 1809, __pyx_L9_except_error)
+          if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 1816, __pyx_L9_except_error)
           __Pyx_GOTREF(__pyx_t_12);
           __pyx_t_11 = __Pyx_PyObject_IsTrue(__pyx_t_12);
           __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;
-          if (__pyx_t_11 < 0) __PYX_ERR(0, 1809, __pyx_L9_except_error)
+          if (__pyx_t_11 < 0) __PYX_ERR(0, 1816, __pyx_L9_except_error)
           __pyx_t_13 = (!__pyx_t_11);
           if (unlikely(__pyx_t_13)) {
             __Pyx_GIVEREF(__pyx_t_1);
             __Pyx_GIVEREF(__pyx_t_4);
             __Pyx_XGIVEREF(__pyx_t_5);
             __Pyx_ErrRestoreWithState(__pyx_t_1, __pyx_t_4, __pyx_t_5);
             __pyx_t_1 = 0; __pyx_t_4 = 0; __pyx_t_5 = 0; 
-            __PYX_ERR(0, 1809, __pyx_L9_except_error)
+            __PYX_ERR(0, 1816, __pyx_L9_except_error)
           }
           __Pyx_XDECREF(__pyx_t_1); __pyx_t_1 = 0;
           __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
           __Pyx_XDECREF(__pyx_t_5); __pyx_t_5 = 0;
           goto __pyx_L8_exception_handled;
         }
         __pyx_L9_except_error:;
@@ -53726,27 +53863,27 @@
       }
     }
     /*finally:*/ {
       /*normal exit:*/{
         if (__pyx_t_6) {
           __pyx_t_10 = __Pyx_PyObject_Call(__pyx_t_6, __pyx_tuple__35, NULL);
           __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-          if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1809, __pyx_L1_error)
+          if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1816, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_10);
           __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
         }
         goto __pyx_L6;
       }
       __pyx_L4_return: {
         __pyx_t_14 = __pyx_r;
         __pyx_r = 0;
         if (__pyx_t_6) {
           __pyx_t_10 = __Pyx_PyObject_Call(__pyx_t_6, __pyx_tuple__35, NULL);
           __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-          if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1809, __pyx_L1_error)
+          if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1816, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_10);
           __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
         }
         __pyx_r = __pyx_t_14;
         __pyx_t_14 = 0;
         goto __pyx_L0;
       }
@@ -53755,15 +53892,15 @@
     goto __pyx_L17;
     __pyx_L3_error:;
     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
     goto __pyx_L1_error;
     __pyx_L17:;
   }
 
-  /* "sat_toolkit/formula.pyx":1797
+  /* "sat_toolkit/formula.pyx":1804
  *         return True
  * 
  *     def to_cnf(self, espresso_args: List[str] = []) -> CNF:             # <<<<<<<<<<<<<<
  *         """
  *         Uses espresso to convert the Truthtable to a minimized CNF.
  */
 
@@ -53783,15 +53920,15 @@
   __Pyx_XDECREF(__pyx_v_cnf);
   __Pyx_XDECREF(__pyx_v_ret_code);
   __Pyx_XGIVEREF((PyObject *)__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "sat_toolkit/formula.pyx":1666
+/* "sat_toolkit/formula.pyx":1673
  *     The OFF set is the complement of the two sets.
  *     """
  *     cdef public on_set             # <<<<<<<<<<<<<<
  *     cdef public dc_set
  *     cdef public uint64_t numbits
  */
 
@@ -53884,15 +54021,15 @@
 
   /* function exit code */
   __pyx_r = 0;
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "sat_toolkit/formula.pyx":1667
+/* "sat_toolkit/formula.pyx":1674
  *     """
  *     cdef public on_set
  *     cdef public dc_set             # <<<<<<<<<<<<<<
  *     cdef public uint64_t numbits
  * 
  */
 
@@ -53985,15 +54122,15 @@
 
   /* function exit code */
   __pyx_r = 0;
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "sat_toolkit/formula.pyx":1668
+/* "sat_toolkit/formula.pyx":1675
  *     cdef public on_set
  *     cdef public dc_set
  *     cdef public uint64_t numbits             # <<<<<<<<<<<<<<
  * 
  *     INIT_INDEX_SET = object()
  */
 
@@ -54017,15 +54154,15 @@
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("__get__", 1);
   __Pyx_XDECREF(__pyx_r);
-  __pyx_t_1 = __Pyx_PyInt_From_unsigned_long(__pyx_v_self->numbits); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1668, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyInt_From_unsigned_long(__pyx_v_self->numbits); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1675, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_r = __pyx_t_1;
   __pyx_t_1 = 0;
   goto __pyx_L0;
 
   /* function exit code */
   __pyx_L1_error:;
@@ -54055,15 +54192,15 @@
 
 static int __pyx_pf_11sat_toolkit_7formula_10Truthtable_7numbits_2__set__(struct __pyx_obj_11sat_toolkit_7formula_Truthtable *__pyx_v_self, PyObject *__pyx_v_value) {
   int __pyx_r;
   __pyx_t_11sat_toolkit_5types_uint64_t __pyx_t_1;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
-  __pyx_t_1 = __Pyx_PyInt_As_unsigned_long(__pyx_v_value); if (unlikely((__pyx_t_1 == (unsigned long)-1) && PyErr_Occurred())) __PYX_ERR(0, 1668, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyInt_As_unsigned_long(__pyx_v_value); if (unlikely((__pyx_t_1 == (unsigned long)-1) && PyErr_Occurred())) __PYX_ERR(0, 1675, __pyx_L1_error)
   __pyx_v_self->numbits = __pyx_t_1;
 
   /* function exit code */
   __pyx_r = 0;
   goto __pyx_L0;
   __pyx_L1_error:;
   __Pyx_AddTraceback("sat_toolkit.formula.Truthtable.numbits.__set__", __pyx_clineno, __pyx_lineno, __pyx_filename);
@@ -57983,24 +58120,26 @@
   #endif
   #if CYTHON_COMPILING_IN_PYPY && PY_VERSION_HEX >= 0x03090000 && PY_VERSION_HEX < 0x030a0000
   0, /*tp_pypy_flags*/
   #endif
 };
 #endif
 
+#if CYTHON_USE_FREELISTS
 static struct __pyx_obj_11sat_toolkit_7formula___pyx_scope_struct____iter__ *__pyx_freelist_11sat_toolkit_7formula___pyx_scope_struct____iter__[8];
 static int __pyx_freecount_11sat_toolkit_7formula___pyx_scope_struct____iter__ = 0;
+#endif
 
 static PyObject *__pyx_tp_new_11sat_toolkit_7formula___pyx_scope_struct____iter__(PyTypeObject *t, CYTHON_UNUSED PyObject *a, CYTHON_UNUSED PyObject *k) {
   PyObject *o;
   #if CYTHON_COMPILING_IN_LIMITED_API
   allocfunc alloc_func = (allocfunc)PyType_GetSlot(t, Py_tp_alloc);
   o = alloc_func(t, 0);
   #else
-  #if CYTHON_COMPILING_IN_CPYTHON
+  #if CYTHON_USE_FREELISTS
   if (likely((int)(__pyx_freecount_11sat_toolkit_7formula___pyx_scope_struct____iter__ > 0) & (int)(t->tp_basicsize == sizeof(struct __pyx_obj_11sat_toolkit_7formula___pyx_scope_struct____iter__)))) {
     o = (PyObject*)__pyx_freelist_11sat_toolkit_7formula___pyx_scope_struct____iter__[--__pyx_freecount_11sat_toolkit_7formula___pyx_scope_struct____iter__];
     memset(o, 0, sizeof(struct __pyx_obj_11sat_toolkit_7formula___pyx_scope_struct____iter__));
     (void) PyObject_INIT(o, t);
     PyObject_GC_Track(o);
   } else
   #endif
@@ -58019,15 +58158,15 @@
     if (__Pyx_PyObject_GetSlot(o, tp_dealloc, destructor) == __pyx_tp_dealloc_11sat_toolkit_7formula___pyx_scope_struct____iter__) {
       if (PyObject_CallFinalizerFromDealloc(o)) return;
     }
   }
   #endif
   PyObject_GC_UnTrack(o);
   Py_CLEAR(p->__pyx_v_self);
-  #if CYTHON_COMPILING_IN_CPYTHON
+  #if CYTHON_USE_FREELISTS
   if (((int)(__pyx_freecount_11sat_toolkit_7formula___pyx_scope_struct____iter__ < 8) & (int)(Py_TYPE(o)->tp_basicsize == sizeof(struct __pyx_obj_11sat_toolkit_7formula___pyx_scope_struct____iter__)))) {
     __pyx_freelist_11sat_toolkit_7formula___pyx_scope_struct____iter__[__pyx_freecount_11sat_toolkit_7formula___pyx_scope_struct____iter__++] = ((struct __pyx_obj_11sat_toolkit_7formula___pyx_scope_struct____iter__ *)o);
   } else
   #endif
   {
     #if CYTHON_USE_TYPE_SLOTS || CYTHON_COMPILING_IN_PYPY
     (*Py_TYPE(o)->tp_free)(o);
@@ -58142,24 +58281,26 @@
   #endif
   #if CYTHON_COMPILING_IN_PYPY && PY_VERSION_HEX >= 0x03090000 && PY_VERSION_HEX < 0x030a0000
   0, /*tp_pypy_flags*/
   #endif
 };
 #endif
 
+#if CYTHON_USE_FREELISTS
 static struct __pyx_obj_11sat_toolkit_7formula___pyx_scope_struct_1___reversed__ *__pyx_freelist_11sat_toolkit_7formula___pyx_scope_struct_1___reversed__[8];
 static int __pyx_freecount_11sat_toolkit_7formula___pyx_scope_struct_1___reversed__ = 0;
+#endif
 
 static PyObject *__pyx_tp_new_11sat_toolkit_7formula___pyx_scope_struct_1___reversed__(PyTypeObject *t, CYTHON_UNUSED PyObject *a, CYTHON_UNUSED PyObject *k) {
   PyObject *o;
   #if CYTHON_COMPILING_IN_LIMITED_API
   allocfunc alloc_func = (allocfunc)PyType_GetSlot(t, Py_tp_alloc);
   o = alloc_func(t, 0);
   #else
-  #if CYTHON_COMPILING_IN_CPYTHON
+  #if CYTHON_USE_FREELISTS
   if (likely((int)(__pyx_freecount_11sat_toolkit_7formula___pyx_scope_struct_1___reversed__ > 0) & (int)(t->tp_basicsize == sizeof(struct __pyx_obj_11sat_toolkit_7formula___pyx_scope_struct_1___reversed__)))) {
     o = (PyObject*)__pyx_freelist_11sat_toolkit_7formula___pyx_scope_struct_1___reversed__[--__pyx_freecount_11sat_toolkit_7formula___pyx_scope_struct_1___reversed__];
     memset(o, 0, sizeof(struct __pyx_obj_11sat_toolkit_7formula___pyx_scope_struct_1___reversed__));
     (void) PyObject_INIT(o, t);
     PyObject_GC_Track(o);
   } else
   #endif
@@ -58178,15 +58319,15 @@
     if (__Pyx_PyObject_GetSlot(o, tp_dealloc, destructor) == __pyx_tp_dealloc_11sat_toolkit_7formula___pyx_scope_struct_1___reversed__) {
       if (PyObject_CallFinalizerFromDealloc(o)) return;
     }
   }
   #endif
   PyObject_GC_UnTrack(o);
   Py_CLEAR(p->__pyx_v_self);
-  #if CYTHON_COMPILING_IN_CPYTHON
+  #if CYTHON_USE_FREELISTS
   if (((int)(__pyx_freecount_11sat_toolkit_7formula___pyx_scope_struct_1___reversed__ < 8) & (int)(Py_TYPE(o)->tp_basicsize == sizeof(struct __pyx_obj_11sat_toolkit_7formula___pyx_scope_struct_1___reversed__)))) {
     __pyx_freelist_11sat_toolkit_7formula___pyx_scope_struct_1___reversed__[__pyx_freecount_11sat_toolkit_7formula___pyx_scope_struct_1___reversed__++] = ((struct __pyx_obj_11sat_toolkit_7formula___pyx_scope_struct_1___reversed__ *)o);
   } else
   #endif
   {
     #if CYTHON_USE_TYPE_SLOTS || CYTHON_COMPILING_IN_PYPY
     (*Py_TYPE(o)->tp_free)(o);
@@ -58301,24 +58442,26 @@
   #endif
   #if CYTHON_COMPILING_IN_PYPY && PY_VERSION_HEX >= 0x03090000 && PY_VERSION_HEX < 0x030a0000
   0, /*tp_pypy_flags*/
   #endif
 };
 #endif
 
+#if CYTHON_USE_FREELISTS
 static struct __pyx_obj_11sat_toolkit_7formula___pyx_scope_struct_2___iter__ *__pyx_freelist_11sat_toolkit_7formula___pyx_scope_struct_2___iter__[8];
 static int __pyx_freecount_11sat_toolkit_7formula___pyx_scope_struct_2___iter__ = 0;
+#endif
 
 static PyObject *__pyx_tp_new_11sat_toolkit_7formula___pyx_scope_struct_2___iter__(PyTypeObject *t, CYTHON_UNUSED PyObject *a, CYTHON_UNUSED PyObject *k) {
   PyObject *o;
   #if CYTHON_COMPILING_IN_LIMITED_API
   allocfunc alloc_func = (allocfunc)PyType_GetSlot(t, Py_tp_alloc);
   o = alloc_func(t, 0);
   #else
-  #if CYTHON_COMPILING_IN_CPYTHON
+  #if CYTHON_USE_FREELISTS
   if (likely((int)(__pyx_freecount_11sat_toolkit_7formula___pyx_scope_struct_2___iter__ > 0) & (int)(t->tp_basicsize == sizeof(struct __pyx_obj_11sat_toolkit_7formula___pyx_scope_struct_2___iter__)))) {
     o = (PyObject*)__pyx_freelist_11sat_toolkit_7formula___pyx_scope_struct_2___iter__[--__pyx_freecount_11sat_toolkit_7formula___pyx_scope_struct_2___iter__];
     memset(o, 0, sizeof(struct __pyx_obj_11sat_toolkit_7formula___pyx_scope_struct_2___iter__));
     (void) PyObject_INIT(o, t);
     PyObject_GC_Track(o);
   } else
   #endif
@@ -58337,15 +58480,15 @@
     if (__Pyx_PyObject_GetSlot(o, tp_dealloc, destructor) == __pyx_tp_dealloc_11sat_toolkit_7formula___pyx_scope_struct_2___iter__) {
       if (PyObject_CallFinalizerFromDealloc(o)) return;
     }
   }
   #endif
   PyObject_GC_UnTrack(o);
   Py_CLEAR(p->__pyx_v_self);
-  #if CYTHON_COMPILING_IN_CPYTHON
+  #if CYTHON_USE_FREELISTS
   if (((int)(__pyx_freecount_11sat_toolkit_7formula___pyx_scope_struct_2___iter__ < 8) & (int)(Py_TYPE(o)->tp_basicsize == sizeof(struct __pyx_obj_11sat_toolkit_7formula___pyx_scope_struct_2___iter__)))) {
     __pyx_freelist_11sat_toolkit_7formula___pyx_scope_struct_2___iter__[__pyx_freecount_11sat_toolkit_7formula___pyx_scope_struct_2___iter__++] = ((struct __pyx_obj_11sat_toolkit_7formula___pyx_scope_struct_2___iter__ *)o);
   } else
   #endif
   {
     #if CYTHON_USE_TYPE_SLOTS || CYTHON_COMPILING_IN_PYPY
     (*Py_TYPE(o)->tp_free)(o);
@@ -58460,24 +58603,26 @@
   #endif
   #if CYTHON_COMPILING_IN_PYPY && PY_VERSION_HEX >= 0x03090000 && PY_VERSION_HEX < 0x030a0000
   0, /*tp_pypy_flags*/
   #endif
 };
 #endif
 
+#if CYTHON_USE_FREELISTS
 static struct __pyx_obj_11sat_toolkit_7formula___pyx_scope_struct_3___reversed__ *__pyx_freelist_11sat_toolkit_7formula___pyx_scope_struct_3___reversed__[8];
 static int __pyx_freecount_11sat_toolkit_7formula___pyx_scope_struct_3___reversed__ = 0;
+#endif
 
 static PyObject *__pyx_tp_new_11sat_toolkit_7formula___pyx_scope_struct_3___reversed__(PyTypeObject *t, CYTHON_UNUSED PyObject *a, CYTHON_UNUSED PyObject *k) {
   PyObject *o;
   #if CYTHON_COMPILING_IN_LIMITED_API
   allocfunc alloc_func = (allocfunc)PyType_GetSlot(t, Py_tp_alloc);
   o = alloc_func(t, 0);
   #else
-  #if CYTHON_COMPILING_IN_CPYTHON
+  #if CYTHON_USE_FREELISTS
   if (likely((int)(__pyx_freecount_11sat_toolkit_7formula___pyx_scope_struct_3___reversed__ > 0) & (int)(t->tp_basicsize == sizeof(struct __pyx_obj_11sat_toolkit_7formula___pyx_scope_struct_3___reversed__)))) {
     o = (PyObject*)__pyx_freelist_11sat_toolkit_7formula___pyx_scope_struct_3___reversed__[--__pyx_freecount_11sat_toolkit_7formula___pyx_scope_struct_3___reversed__];
     memset(o, 0, sizeof(struct __pyx_obj_11sat_toolkit_7formula___pyx_scope_struct_3___reversed__));
     (void) PyObject_INIT(o, t);
     PyObject_GC_Track(o);
   } else
   #endif
@@ -58496,15 +58641,15 @@
     if (__Pyx_PyObject_GetSlot(o, tp_dealloc, destructor) == __pyx_tp_dealloc_11sat_toolkit_7formula___pyx_scope_struct_3___reversed__) {
       if (PyObject_CallFinalizerFromDealloc(o)) return;
     }
   }
   #endif
   PyObject_GC_UnTrack(o);
   Py_CLEAR(p->__pyx_v_self);
-  #if CYTHON_COMPILING_IN_CPYTHON
+  #if CYTHON_USE_FREELISTS
   if (((int)(__pyx_freecount_11sat_toolkit_7formula___pyx_scope_struct_3___reversed__ < 8) & (int)(Py_TYPE(o)->tp_basicsize == sizeof(struct __pyx_obj_11sat_toolkit_7formula___pyx_scope_struct_3___reversed__)))) {
     __pyx_freelist_11sat_toolkit_7formula___pyx_scope_struct_3___reversed__[__pyx_freecount_11sat_toolkit_7formula___pyx_scope_struct_3___reversed__++] = ((struct __pyx_obj_11sat_toolkit_7formula___pyx_scope_struct_3___reversed__ *)o);
   } else
   #endif
   {
     #if CYTHON_USE_TYPE_SLOTS || CYTHON_COMPILING_IN_PYPY
     (*Py_TYPE(o)->tp_free)(o);
@@ -59613,18 +59758,18 @@
     {&__pyx_n_s_CNF_create_all_equal, __pyx_k_CNF_create_all_equal, sizeof(__pyx_k_CNF_create_all_equal), 0, 0, 1, 1},
     {&__pyx_n_s_CNF_create_all_zero, __pyx_k_CNF_create_all_zero, sizeof(__pyx_k_CNF_create_all_zero), 0, 0, 1, 1},
     {&__pyx_n_s_CNF_create_xor, __pyx_k_CNF_create_xor, sizeof(__pyx_k_CNF_create_xor), 0, 0, 1, 1},
     {&__pyx_n_s_CNF_equiv, __pyx_k_CNF_equiv, sizeof(__pyx_k_CNF_equiv), 0, 0, 1, 1},
     {&__pyx_n_s_CNF_from_dimacs, __pyx_k_CNF_from_dimacs, sizeof(__pyx_k_CNF_from_dimacs), 0, 0, 1, 1},
     {&__pyx_n_s_CNF_from_espresso, __pyx_k_CNF_from_espresso, sizeof(__pyx_k_CNF_from_espresso), 0, 0, 1, 1},
     {&__pyx_n_s_CNF_get_units, __pyx_k_CNF_get_units, sizeof(__pyx_k_CNF_get_units), 0, 0, 1, 1},
-    {&__pyx_kp_u_CNF_get_units_line_967, __pyx_k_CNF_get_units_line_967, sizeof(__pyx_k_CNF_get_units_line_967), 0, 1, 0, 0},
+    {&__pyx_kp_u_CNF_get_units_line_974, __pyx_k_CNF_get_units_line_974, sizeof(__pyx_k_CNF_get_units_line_974), 0, 1, 0, 0},
     {&__pyx_n_s_CNF_implied_by, __pyx_k_CNF_implied_by, sizeof(__pyx_k_CNF_implied_by), 0, 0, 1, 1},
     {&__pyx_n_s_CNF_logical_or, __pyx_k_CNF_logical_or, sizeof(__pyx_k_CNF_logical_or), 0, 0, 1, 1},
-    {&__pyx_kp_u_CNF_logical_or_line_904, __pyx_k_CNF_logical_or_line_904, sizeof(__pyx_k_CNF_logical_or_line_904), 0, 1, 0, 0},
+    {&__pyx_kp_u_CNF_logical_or_line_911, __pyx_k_CNF_logical_or_line_911, sizeof(__pyx_k_CNF_logical_or_line_911), 0, 1, 0, 0},
     {&__pyx_n_s_CNF_minimize_espresso, __pyx_k_CNF_minimize_espresso, sizeof(__pyx_k_CNF_minimize_espresso), 0, 0, 1, 1},
     {&__pyx_n_s_CNF_minimize_lingeling, __pyx_k_CNF_minimize_lingeling, sizeof(__pyx_k_CNF_minimize_lingeling), 0, 0, 1, 1},
     {&__pyx_kp_u_CNF_must_not_contain_xor_clauses, __pyx_k_CNF_must_not_contain_xor_clauses, sizeof(__pyx_k_CNF_must_not_contain_xor_clauses), 0, 1, 0, 0},
     {&__pyx_kp_u_CNF_over, __pyx_k_CNF_over, sizeof(__pyx_k_CNF_over), 0, 1, 0, 0},
     {&__pyx_n_s_CNF_solve_dimacs, __pyx_k_CNF_solve_dimacs, sizeof(__pyx_k_CNF_solve_dimacs), 0, 0, 1, 1},
     {&__pyx_n_s_CNF_to_dimacs, __pyx_k_CNF_to_dimacs, sizeof(__pyx_k_CNF_to_dimacs), 0, 0, 1, 1},
     {&__pyx_n_s_CNF_to_espresso, __pyx_k_CNF_to_espresso, sizeof(__pyx_k_CNF_to_espresso), 0, 0, 1, 1},
@@ -60076,14 +60221,15 @@
     {&__pyx_n_s_translate, __pyx_k_translate, sizeof(__pyx_k_translate), 0, 0, 1, 1},
     {&__pyx_n_s_truthtable, __pyx_k_truthtable, sizeof(__pyx_k_truthtable), 0, 0, 1, 1},
     {&__pyx_n_s_truthtable_view, __pyx_k_truthtable_view, sizeof(__pyx_k_truthtable_view), 0, 0, 1, 1},
     {&__pyx_kp_s_tuple_list_CNF_list_XorClauseLis, __pyx_k_tuple_list_CNF_list_XorClauseLis, sizeof(__pyx_k_tuple_list_CNF_list_XorClauseLis), 0, 0, 1, 0},
     {&__pyx_n_s_uint8, __pyx_k_uint8, sizeof(__pyx_k_uint8), 0, 0, 1, 1},
     {&__pyx_kp_s_unable_to_allocate_array_data, __pyx_k_unable_to_allocate_array_data, sizeof(__pyx_k_unable_to_allocate_array_data), 0, 0, 1, 0},
     {&__pyx_kp_s_unable_to_allocate_shape_and_str, __pyx_k_unable_to_allocate_shape_and_str, sizeof(__pyx_k_unable_to_allocate_shape_and_str), 0, 0, 1, 0},
+    {&__pyx_n_s_union, __pyx_k_union, sizeof(__pyx_k_union), 0, 0, 1, 1},
     {&__pyx_kp_u_unknown_status, __pyx_k_unknown_status, sizeof(__pyx_k_unknown_status), 0, 1, 0, 0},
     {&__pyx_n_s_unpack, __pyx_k_unpack, sizeof(__pyx_k_unpack), 0, 0, 1, 1},
     {&__pyx_n_s_update, __pyx_k_update, sizeof(__pyx_k_update), 0, 0, 1, 1},
     {&__pyx_kp_u_use_from_lut_or_from_indices, __pyx_k_use_from_lut_or_from_indices, sizeof(__pyx_k_use_from_lut_or_from_indices), 0, 1, 0, 0},
     {&__pyx_n_s_use_setstate, __pyx_k_use_setstate, sizeof(__pyx_k_use_setstate), 0, 0, 1, 1},
     {&__pyx_kp_u_v, __pyx_k_v, sizeof(__pyx_k_v), 0, 1, 0, 0},
     {&__pyx_n_s_v_2, __pyx_k_v_2, sizeof(__pyx_k_v_2), 0, 0, 1, 1},
@@ -60093,14 +60239,15 @@
     {&__pyx_kp_u_var_must_not_be_zero, __pyx_k_var_must_not_be_zero, sizeof(__pyx_k_var_must_not_be_zero), 0, 1, 0, 0},
     {&__pyx_n_s_var_view, __pyx_k_var_view, sizeof(__pyx_k_var_view), 0, 0, 1, 1},
     {&__pyx_kp_u_variable_0_must_map_to_0_again, __pyx_k_variable_0_must_map_to_0_again, sizeof(__pyx_k_variable_0_must_map_to_0_again), 0, 1, 0, 0},
     {&__pyx_kp_u_variable_must_not_be_mapped_to_0, __pyx_k_variable_must_not_be_mapped_to_0, sizeof(__pyx_k_variable_must_not_be_mapped_to_0), 0, 1, 0, 0},
     {&__pyx_n_s_variables, __pyx_k_variables, sizeof(__pyx_k_variables), 0, 0, 1, 1},
     {&__pyx_kp_u_variables_2, __pyx_k_variables_2, sizeof(__pyx_k_variables_2), 0, 1, 0, 0},
     {&__pyx_kp_u_variables_with, __pyx_k_variables_with, sizeof(__pyx_k_variables_with), 0, 1, 0, 0},
+    {&__pyx_n_s_vars_to_update, __pyx_k_vars_to_update, sizeof(__pyx_k_vars_to_update), 0, 0, 1, 1},
     {&__pyx_n_s_vec_result, __pyx_k_vec_result, sizeof(__pyx_k_vec_result), 0, 0, 1, 1},
     {&__pyx_n_s_verbose, __pyx_k_verbose, sizeof(__pyx_k_verbose), 0, 0, 1, 1},
     {&__pyx_n_s_version_info, __pyx_k_version_info, sizeof(__pyx_k_version_info), 0, 0, 1, 1},
     {&__pyx_n_u_w, __pyx_k_w, sizeof(__pyx_k_w), 0, 1, 0, 1},
     {&__pyx_n_s_wait, __pyx_k_wait, sizeof(__pyx_k_wait), 0, 0, 1, 1},
     {&__pyx_n_s_where, __pyx_k_where, sizeof(__pyx_k_where), 0, 0, 1, 1},
     {&__pyx_n_s_write, __pyx_k_write, sizeof(__pyx_k_write), 0, 0, 1, 1},
@@ -60115,26 +60262,26 @@
     {&__pyx_n_s_zeros, __pyx_k_zeros, sizeof(__pyx_k_zeros), 0, 0, 1, 1},
     {0, 0, 0, 0, 0, 0, 0}
   };
   return __Pyx_InitStrings(__pyx_string_tab);
 }
 /* #### Code section: cached_builtins ### */
 static CYTHON_SMALL_CODE int __Pyx_InitCachedBuiltins(void) {
-  __pyx_builtin_staticmethod = __Pyx_GetBuiltinName(__pyx_n_s_staticmethod); if (!__pyx_builtin_staticmethod) __PYX_ERR(0, 684, __pyx_L1_error)
-  __pyx_builtin_object = __Pyx_GetBuiltinName(__pyx_n_s_object); if (!__pyx_builtin_object) __PYX_ERR(0, 1670, __pyx_L1_error)
+  __pyx_builtin_staticmethod = __Pyx_GetBuiltinName(__pyx_n_s_staticmethod); if (!__pyx_builtin_staticmethod) __PYX_ERR(0, 691, __pyx_L1_error)
+  __pyx_builtin_object = __Pyx_GetBuiltinName(__pyx_n_s_object); if (!__pyx_builtin_object) __PYX_ERR(0, 1677, __pyx_L1_error)
   __pyx_builtin_ValueError = __Pyx_GetBuiltinName(__pyx_n_s_ValueError); if (!__pyx_builtin_ValueError) __PYX_ERR(0, 70, __pyx_L1_error)
   __pyx_builtin_IndexError = __Pyx_GetBuiltinName(__pyx_n_s_IndexError); if (!__pyx_builtin_IndexError) __PYX_ERR(0, 91, __pyx_L1_error)
   __pyx_builtin_range = __Pyx_GetBuiltinName(__pyx_n_s_range); if (!__pyx_builtin_range) __PYX_ERR(0, 93, __pyx_L1_error)
   __pyx_builtin_reversed = __Pyx_GetBuiltinName(__pyx_n_s_reversed); if (!__pyx_builtin_reversed) __PYX_ERR(0, 160, __pyx_L1_error)
   __pyx_builtin_TypeError = __Pyx_GetBuiltinName(__pyx_n_s_TypeError); if (!__pyx_builtin_TypeError) __PYX_ERR(0, 205, __pyx_L1_error)
-  __pyx_builtin_AssertionError = __Pyx_GetBuiltinName(__pyx_n_s_AssertionError); if (!__pyx_builtin_AssertionError) __PYX_ERR(0, 414, __pyx_L1_error)
-  __pyx_builtin_NotImplementedError = __Pyx_GetBuiltinName(__pyx_n_s_NotImplementedError); if (!__pyx_builtin_NotImplementedError) __PYX_ERR(0, 504, __pyx_L1_error)
-  __pyx_builtin_enumerate = __Pyx_GetBuiltinName(__pyx_n_s_enumerate); if (!__pyx_builtin_enumerate) __PYX_ERR(0, 895, __pyx_L1_error)
-  __pyx_builtin_open = __Pyx_GetBuiltinName(__pyx_n_s_open); if (!__pyx_builtin_open) __PYX_ERR(0, 1112, __pyx_L1_error)
-  __pyx_builtin_print = __Pyx_GetBuiltinName(__pyx_n_s_print); if (!__pyx_builtin_print) __PYX_ERR(0, 1170, __pyx_L1_error)
+  __pyx_builtin_AssertionError = __Pyx_GetBuiltinName(__pyx_n_s_AssertionError); if (!__pyx_builtin_AssertionError) __PYX_ERR(0, 351, __pyx_L1_error)
+  __pyx_builtin_NotImplementedError = __Pyx_GetBuiltinName(__pyx_n_s_NotImplementedError); if (!__pyx_builtin_NotImplementedError) __PYX_ERR(0, 511, __pyx_L1_error)
+  __pyx_builtin_enumerate = __Pyx_GetBuiltinName(__pyx_n_s_enumerate); if (!__pyx_builtin_enumerate) __PYX_ERR(0, 902, __pyx_L1_error)
+  __pyx_builtin_open = __Pyx_GetBuiltinName(__pyx_n_s_open); if (!__pyx_builtin_open) __PYX_ERR(0, 1119, __pyx_L1_error)
+  __pyx_builtin_print = __Pyx_GetBuiltinName(__pyx_n_s_print); if (!__pyx_builtin_print) __PYX_ERR(0, 1177, __pyx_L1_error)
   __pyx_builtin_MemoryError = __Pyx_GetBuiltinName(__pyx_n_s_MemoryError); if (!__pyx_builtin_MemoryError) __PYX_ERR(1, 68, __pyx_L1_error)
   __pyx_builtin___import__ = __Pyx_GetBuiltinName(__pyx_n_s_import); if (!__pyx_builtin___import__) __PYX_ERR(1, 100, __pyx_L1_error)
   __pyx_builtin_Ellipsis = __Pyx_GetBuiltinName(__pyx_n_s_Ellipsis); if (!__pyx_builtin_Ellipsis) __PYX_ERR(1, 408, __pyx_L1_error)
   __pyx_builtin_id = __Pyx_GetBuiltinName(__pyx_n_s_id); if (!__pyx_builtin_id) __PYX_ERR(1, 618, __pyx_L1_error)
   return 0;
   __pyx_L1_error:;
   return -1;
@@ -60221,353 +60368,353 @@
  * 
  *         if val >= self.nvars:
  */
   __pyx_tuple__20 = PyTuple_Pack(1, __pyx_kp_u_nvars_must_be_nonnegative); if (unlikely(!__pyx_tuple__20)) __PYX_ERR(0, 271, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_tuple__20);
   __Pyx_GIVEREF(__pyx_tuple__20);
 
-  /* "sat_toolkit/formula.pyx":375
+  /* "sat_toolkit/formula.pyx":382
  * 
  *         if self.view_count > 0:
  *             raise ValueError('cannot alter while referenced by buffer')             # <<<<<<<<<<<<<<
  * 
  *         if length > 0 and clauses[length - 1] != 0:
  */
-  __pyx_tuple__21 = PyTuple_Pack(1, __pyx_kp_u_cannot_alter_while_referenced_by); if (unlikely(!__pyx_tuple__21)) __PYX_ERR(0, 375, __pyx_L1_error)
+  __pyx_tuple__21 = PyTuple_Pack(1, __pyx_kp_u_cannot_alter_while_referenced_by); if (unlikely(!__pyx_tuple__21)) __PYX_ERR(0, 382, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_tuple__21);
   __Pyx_GIVEREF(__pyx_tuple__21);
 
-  /* "sat_toolkit/formula.pyx":378
+  /* "sat_toolkit/formula.pyx":385
  * 
  *         if length > 0 and clauses[length - 1] != 0:
  *             raise ValueError('last clause not terminated with 0')             # <<<<<<<<<<<<<<
  * 
  *         old_len = self._clauses.size()
  */
-  __pyx_tuple__22 = PyTuple_Pack(1, __pyx_kp_u_last_clause_not_terminated_with); if (unlikely(!__pyx_tuple__22)) __PYX_ERR(0, 378, __pyx_L1_error)
+  __pyx_tuple__22 = PyTuple_Pack(1, __pyx_kp_u_last_clause_not_terminated_with); if (unlikely(!__pyx_tuple__22)) __PYX_ERR(0, 385, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_tuple__22);
   __Pyx_GIVEREF(__pyx_tuple__22);
 
-  /* "sat_toolkit/formula.pyx":473
+  /* "sat_toolkit/formula.pyx":480
  *         np_clause[:clause_len] = clause
  *         if np.count_nonzero(np_clause) != clause_len:
  *             raise ValueError('cannot use 0 in clause')             # <<<<<<<<<<<<<<
  *         self._add_clauses(np_clause)
  * 
  */
-  __pyx_tuple__23 = PyTuple_Pack(1, __pyx_kp_u_cannot_use_0_in_clause); if (unlikely(!__pyx_tuple__23)) __PYX_ERR(0, 473, __pyx_L1_error)
+  __pyx_tuple__23 = PyTuple_Pack(1, __pyx_kp_u_cannot_use_0_in_clause); if (unlikely(!__pyx_tuple__23)) __PYX_ERR(0, 480, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_tuple__23);
   __Pyx_GIVEREF(__pyx_tuple__23);
 
-  /* "sat_toolkit/formula.pyx":504
+  /* "sat_toolkit/formula.pyx":511
  * 
  *     cdef _BaseClause get_clause(self, ssize_t idx):
  *         raise NotImplementedError('should be implemented by subclass')             # <<<<<<<<<<<<<<
  * 
  *     def __getitem__(self, ssize_t idx) -> Clause:
  */
-  __pyx_tuple__24 = PyTuple_Pack(1, __pyx_kp_u_should_be_implemented_by_subclas); if (unlikely(!__pyx_tuple__24)) __PYX_ERR(0, 504, __pyx_L1_error)
+  __pyx_tuple__24 = PyTuple_Pack(1, __pyx_kp_u_should_be_implemented_by_subclas); if (unlikely(!__pyx_tuple__24)) __PYX_ERR(0, 511, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_tuple__24);
   __Pyx_GIVEREF(__pyx_tuple__24);
 
-  /* "sat_toolkit/formula.pyx":688
+  /* "sat_toolkit/formula.pyx":695
  *         cdef XorCNF tmp = XorCNF.from_dimacs(dimacs)
  *         if len(tmp._xor_clauses) > 0:
  *             raise ValueError('CNF must not contain xor clauses')             # <<<<<<<<<<<<<<
  * 
  *         return tmp._clauses
  */
-  __pyx_tuple__26 = PyTuple_Pack(1, __pyx_kp_u_CNF_must_not_contain_xor_clauses); if (unlikely(!__pyx_tuple__26)) __PYX_ERR(0, 688, __pyx_L1_error)
+  __pyx_tuple__26 = PyTuple_Pack(1, __pyx_kp_u_CNF_must_not_contain_xor_clauses); if (unlikely(!__pyx_tuple__26)) __PYX_ERR(0, 695, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_tuple__26);
   __Pyx_GIVEREF(__pyx_tuple__26);
 
-  /* "sat_toolkit/formula.pyx":716
+  /* "sat_toolkit/formula.pyx":723
  *             val = line[line.shape[0] - 1]
  *             if line.shape[0] != numbits + 2 or line[line.shape[0] - 2] != b' ':
  *                 raise ValueError('file format error')             # <<<<<<<<<<<<<<
  * 
  *             #espresso_mask, val = line.split()
  */
-  __pyx_tuple__27 = PyTuple_Pack(1, __pyx_kp_u_file_format_error); if (unlikely(!__pyx_tuple__27)) __PYX_ERR(0, 716, __pyx_L1_error)
+  __pyx_tuple__27 = PyTuple_Pack(1, __pyx_kp_u_file_format_error); if (unlikely(!__pyx_tuple__27)) __PYX_ERR(0, 723, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_tuple__27);
   __Pyx_GIVEREF(__pyx_tuple__27);
 
-  /* "sat_toolkit/formula.pyx":765
+  /* "sat_toolkit/formula.pyx":772
  *             val = indices[i]
  *             if val == 0:
  *                 raise ValueError('all indices must be nonzero')             # <<<<<<<<<<<<<<
  *             clauses[2*i] = -val
  * 
  */
-  __pyx_tuple__28 = PyTuple_Pack(1, __pyx_kp_u_all_indices_must_be_nonzero); if (unlikely(!__pyx_tuple__28)) __PYX_ERR(0, 765, __pyx_L1_error)
+  __pyx_tuple__28 = PyTuple_Pack(1, __pyx_kp_u_all_indices_must_be_nonzero); if (unlikely(!__pyx_tuple__28)) __PYX_ERR(0, 772, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_tuple__28);
   __Pyx_GIVEREF(__pyx_tuple__28);
 
-  /* "sat_toolkit/formula.pyx":789
+  /* "sat_toolkit/formula.pyx":796
  *         length = lhs.shape[0]
  *         if rhs.shape[0] != length:
  *             raise ValueError('lhs and rhs must have the same length')             # <<<<<<<<<<<<<<
  * 
  *         clauses.resize(length * 6)
  */
-  __pyx_tuple__29 = PyTuple_Pack(1, __pyx_kp_u_lhs_and_rhs_must_have_the_same_l); if (unlikely(!__pyx_tuple__29)) __PYX_ERR(0, 789, __pyx_L1_error)
+  __pyx_tuple__29 = PyTuple_Pack(1, __pyx_kp_u_lhs_and_rhs_must_have_the_same_l); if (unlikely(!__pyx_tuple__29)) __PYX_ERR(0, 796, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_tuple__29);
   __Pyx_GIVEREF(__pyx_tuple__29);
 
-  /* "sat_toolkit/formula.pyx":889
+  /* "sat_toolkit/formula.pyx":896
  * 
  *         if num_args < 1:
  *             raise ValueError('must provide at least one argument')             # <<<<<<<<<<<<<<
  * 
  *         num_xors = len(args[0])
  */
-  __pyx_tuple__30 = PyTuple_Pack(1, __pyx_kp_u_must_provide_at_least_one_argume); if (unlikely(!__pyx_tuple__30)) __PYX_ERR(0, 889, __pyx_L1_error)
+  __pyx_tuple__30 = PyTuple_Pack(1, __pyx_kp_u_must_provide_at_least_one_argume); if (unlikely(!__pyx_tuple__30)) __PYX_ERR(0, 896, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_tuple__30);
   __Pyx_GIVEREF(__pyx_tuple__30);
 
-  /* "sat_toolkit/formula.pyx":923
+  /* "sat_toolkit/formula.pyx":930
  *         """
  *         if var == 0:
  *             raise ValueError("var must not be zero")             # <<<<<<<<<<<<<<
  * 
  *         cdef vector[int] new_clauses
  */
-  __pyx_tuple__31 = PyTuple_Pack(1, __pyx_kp_u_var_must_not_be_zero); if (unlikely(!__pyx_tuple__31)) __PYX_ERR(0, 923, __pyx_L1_error)
+  __pyx_tuple__31 = PyTuple_Pack(1, __pyx_kp_u_var_must_not_be_zero); if (unlikely(!__pyx_tuple__31)) __PYX_ERR(0, 930, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_tuple__31);
   __Pyx_GIVEREF(__pyx_tuple__31);
 
-  /* "sat_toolkit/formula.pyx":1080
+  /* "sat_toolkit/formula.pyx":1087
  *         cdef int ret_code
  * 
  *         with sp.Popen(['espresso'] + espresso_args, stdin=sp.PIPE, stdout=sp.PIPE, text=True) as espresso:             # <<<<<<<<<<<<<<
  *             espresso.stdin.write(self.to_espresso())
  *             espresso.stdin.close()
  */
-  __pyx_tuple__35 = PyTuple_Pack(3, Py_None, Py_None, Py_None); if (unlikely(!__pyx_tuple__35)) __PYX_ERR(0, 1080, __pyx_L1_error)
+  __pyx_tuple__35 = PyTuple_Pack(3, Py_None, Py_None, Py_None); if (unlikely(!__pyx_tuple__35)) __PYX_ERR(0, 1087, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_tuple__35);
   __Pyx_GIVEREF(__pyx_tuple__35);
 
-  /* "sat_toolkit/formula.pyx":1161
+  /* "sat_toolkit/formula.pyx":1168
  * 
  * 
  *         with NamedTemporaryFile('w', prefix='sat_toolkit_', suffix='.cnf') as f:             # <<<<<<<<<<<<<<
  *             f.write(self.to_dimacs())
  *             f.flush()
  */
-  __pyx_tuple__37 = PyTuple_Pack(1, __pyx_n_u_w); if (unlikely(!__pyx_tuple__37)) __PYX_ERR(0, 1161, __pyx_L1_error)
+  __pyx_tuple__37 = PyTuple_Pack(1, __pyx_n_u_w); if (unlikely(!__pyx_tuple__37)) __PYX_ERR(0, 1168, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_tuple__37);
   __Pyx_GIVEREF(__pyx_tuple__37);
 
-  /* "sat_toolkit/formula.pyx":1176
+  /* "sat_toolkit/formula.pyx":1183
  * 
  *                     if line.startswith('s '):
  *                         line = line[2:].strip()             # <<<<<<<<<<<<<<
  *                         if line == 'SATISFIABLE':
  *                             is_sat = True
  */
-  __pyx_slice__38 = PySlice_New(__pyx_int_2, Py_None, Py_None); if (unlikely(!__pyx_slice__38)) __PYX_ERR(0, 1176, __pyx_L1_error)
+  __pyx_slice__38 = PySlice_New(__pyx_int_2, Py_None, Py_None); if (unlikely(!__pyx_slice__38)) __PYX_ERR(0, 1183, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_slice__38);
   __Pyx_GIVEREF(__pyx_slice__38);
 
-  /* "sat_toolkit/formula.pyx":1189
+  /* "sat_toolkit/formula.pyx":1196
  *                             lit = buf[i]
  *                             if abs(lit) >= result_view.shape[0]:
  *                                 raise IndexError('solver returned model index that is out of bounds')             # <<<<<<<<<<<<<<
  *                             result_view[abs(lit)] = lit > 0
  * 
  */
-  __pyx_tuple__39 = PyTuple_Pack(1, __pyx_kp_u_solver_returned_model_index_that); if (unlikely(!__pyx_tuple__39)) __PYX_ERR(0, 1189, __pyx_L1_error)
+  __pyx_tuple__39 = PyTuple_Pack(1, __pyx_kp_u_solver_returned_model_index_that); if (unlikely(!__pyx_tuple__39)) __PYX_ERR(0, 1196, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_tuple__39);
   __Pyx_GIVEREF(__pyx_tuple__39);
 
-  /* "sat_toolkit/formula.pyx":1205
+  /* "sat_toolkit/formula.pyx":1212
  *                 return True, result
  *             else:
  *                 return False, None             # <<<<<<<<<<<<<<
  * 
  * 
  */
-  __pyx_tuple__40 = PyTuple_Pack(2, Py_False, Py_None); if (unlikely(!__pyx_tuple__40)) __PYX_ERR(0, 1205, __pyx_L1_error)
+  __pyx_tuple__40 = PyTuple_Pack(2, Py_False, Py_None); if (unlikely(!__pyx_tuple__40)) __PYX_ERR(0, 1212, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_tuple__40);
   __Pyx_GIVEREF(__pyx_tuple__40);
 
-  /* "sat_toolkit/formula.pyx":1213
+  /* "sat_toolkit/formula.pyx":1220
  *         for i in range(solution.shape[0]):
  *            if solution[i] not in [0, 1]:
  *                raise ValueError(f'all elements in solution must be in [0, 1]')             # <<<<<<<<<<<<<<
  * 
  *         return self._check_solution(solution)
  */
-  __pyx_tuple__41 = PyTuple_Pack(1, __pyx_kp_u_all_elements_in_solution_must_be); if (unlikely(!__pyx_tuple__41)) __PYX_ERR(0, 1213, __pyx_L1_error)
+  __pyx_tuple__41 = PyTuple_Pack(1, __pyx_kp_u_all_elements_in_solution_must_be); if (unlikely(!__pyx_tuple__41)) __PYX_ERR(0, 1220, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_tuple__41);
   __Pyx_GIVEREF(__pyx_tuple__41);
 
-  /* "sat_toolkit/formula.pyx":1260
+  /* "sat_toolkit/formula.pyx":1267
  * 
  *         if self.nvars > 32:
  *             raise ValueError('cannot find all solutions for CNF with more than 32 variables')             # <<<<<<<<<<<<<<
  * 
  *         truthtable = np.empty((<uint64_t> 1) << self.nvars, np.uint8)
  */
-  __pyx_tuple__42 = PyTuple_Pack(1, __pyx_kp_u_cannot_find_all_solutions_for_CN); if (unlikely(!__pyx_tuple__42)) __PYX_ERR(0, 1260, __pyx_L1_error)
+  __pyx_tuple__42 = PyTuple_Pack(1, __pyx_kp_u_cannot_find_all_solutions_for_CN); if (unlikely(!__pyx_tuple__42)) __PYX_ERR(0, 1267, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_tuple__42);
   __Pyx_GIVEREF(__pyx_tuple__42);
 
-  /* "sat_toolkit/formula.pyx":1329
+  /* "sat_toolkit/formula.pyx":1336
  *             raise ValueError(f'need to provide translation for all 1+{self.nvars} variables')
  *         if var_view[0] != 0:
  *             raise ValueError('variable 0 must map to 0 again')             # <<<<<<<<<<<<<<
  * 
  *         for i in range(1, <size_t> var_view.shape[0]):
  */
-  __pyx_tuple__43 = PyTuple_Pack(1, __pyx_kp_u_variable_0_must_map_to_0_again); if (unlikely(!__pyx_tuple__43)) __PYX_ERR(0, 1329, __pyx_L1_error)
+  __pyx_tuple__43 = PyTuple_Pack(1, __pyx_kp_u_variable_0_must_map_to_0_again); if (unlikely(!__pyx_tuple__43)) __PYX_ERR(0, 1336, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_tuple__43);
   __Pyx_GIVEREF(__pyx_tuple__43);
 
-  /* "sat_toolkit/formula.pyx":1333
+  /* "sat_toolkit/formula.pyx":1340
  *         for i in range(1, <size_t> var_view.shape[0]):
  *             if var_view[i] == 0:
  *                 raise ValueError('variable must not be mapped to 0')             # <<<<<<<<<<<<<<
  * 
  *         cdef vector[int] new_clauses
  */
-  __pyx_tuple__44 = PyTuple_Pack(1, __pyx_kp_u_variable_must_not_be_mapped_to_0); if (unlikely(!__pyx_tuple__44)) __PYX_ERR(0, 1333, __pyx_L1_error)
+  __pyx_tuple__44 = PyTuple_Pack(1, __pyx_kp_u_variable_must_not_be_mapped_to_0); if (unlikely(!__pyx_tuple__44)) __PYX_ERR(0, 1340, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_tuple__44);
   __Pyx_GIVEREF(__pyx_tuple__44);
 
-  /* "sat_toolkit/formula.pyx":1394
+  /* "sat_toolkit/formula.pyx":1401
  *             if line.startswith('p cnf '):
  *                 if nvars != -1:
  *                     raise ValueError('multiple p cnf lines in dimacs')             # <<<<<<<<<<<<<<
  * 
  *                 tmp_nvars, tmp_nclauses = line[len('p cnf '):].split()
  */
-  __pyx_tuple__45 = PyTuple_Pack(1, __pyx_kp_u_multiple_p_cnf_lines_in_dimacs); if (unlikely(!__pyx_tuple__45)) __PYX_ERR(0, 1394, __pyx_L1_error)
+  __pyx_tuple__45 = PyTuple_Pack(1, __pyx_kp_u_multiple_p_cnf_lines_in_dimacs); if (unlikely(!__pyx_tuple__45)) __PYX_ERR(0, 1401, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_tuple__45);
   __Pyx_GIVEREF(__pyx_tuple__45);
 
-  /* "sat_toolkit/formula.pyx":1401
+  /* "sat_toolkit/formula.pyx":1408
  * 
  *             elif line.startswith('x'):
  *                 xors.add_clauses([int(x) for x in line[1:].split()])             # <<<<<<<<<<<<<<
  *             else:
  *                 clauses.add_clauses([int(x) for x in line.split()])
  */
-  __pyx_slice__46 = PySlice_New(__pyx_int_1, Py_None, Py_None); if (unlikely(!__pyx_slice__46)) __PYX_ERR(0, 1401, __pyx_L1_error)
+  __pyx_slice__46 = PySlice_New(__pyx_int_1, Py_None, Py_None); if (unlikely(!__pyx_slice__46)) __PYX_ERR(0, 1408, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_slice__46);
   __Pyx_GIVEREF(__pyx_slice__46);
 
-  /* "sat_toolkit/formula.pyx":1406
+  /* "sat_toolkit/formula.pyx":1413
  * 
  *         if nvars == -1:
  *             raise ValueError('no \'p cnf ...\' line in dimacs')             # <<<<<<<<<<<<<<
  * 
  *         if nvars < max(clauses.nvars, xors.nvars):
  */
-  __pyx_tuple__47 = PyTuple_Pack(1, __pyx_kp_u_no_p_cnf_line_in_dimacs); if (unlikely(!__pyx_tuple__47)) __PYX_ERR(0, 1406, __pyx_L1_error)
+  __pyx_tuple__47 = PyTuple_Pack(1, __pyx_kp_u_no_p_cnf_line_in_dimacs); if (unlikely(!__pyx_tuple__47)) __PYX_ERR(0, 1413, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_tuple__47);
   __Pyx_GIVEREF(__pyx_tuple__47);
 
-  /* "sat_toolkit/formula.pyx":1409
+  /* "sat_toolkit/formula.pyx":1416
  * 
  *         if nvars < max(clauses.nvars, xors.nvars):
  *             raise ValueError('nvars in p cnf line is smaller than the biggest encountered variable')             # <<<<<<<<<<<<<<
  * 
  *         clauses.nvars = nvars
  */
-  __pyx_tuple__48 = PyTuple_Pack(1, __pyx_kp_u_nvars_in_p_cnf_line_is_smaller_t); if (unlikely(!__pyx_tuple__48)) __PYX_ERR(0, 1409, __pyx_L1_error)
+  __pyx_tuple__48 = PyTuple_Pack(1, __pyx_kp_u_nvars_in_p_cnf_line_is_smaller_t); if (unlikely(!__pyx_tuple__48)) __PYX_ERR(0, 1416, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_tuple__48);
   __Pyx_GIVEREF(__pyx_tuple__48);
 
-  /* "sat_toolkit/formula.pyx":1444
+  /* "sat_toolkit/formula.pyx":1451
  * 
  *         if rhs_view is not None and len(rhs_view) != num_xors:
  *             raise ValueError('rhs must have the same length as the arguments')             # <<<<<<<<<<<<<<
  * 
  *         packed_args = np.zeros((num_xors, num_args + 1), np.int32)
  */
-  __pyx_tuple__49 = PyTuple_Pack(1, __pyx_kp_u_rhs_must_have_the_same_length_as); if (unlikely(!__pyx_tuple__49)) __PYX_ERR(0, 1444, __pyx_L1_error)
+  __pyx_tuple__49 = PyTuple_Pack(1, __pyx_kp_u_rhs_must_have_the_same_length_as); if (unlikely(!__pyx_tuple__49)) __PYX_ERR(0, 1451, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_tuple__49);
   __Pyx_GIVEREF(__pyx_tuple__49);
 
-  /* "sat_toolkit/formula.pyx":1674
+  /* "sat_toolkit/formula.pyx":1681
  *     def __init__(self, init_key, numbits, on_set, dc_set):
  *         if init_key is not self.INIT_INDEX_SET:
  *             raise ValueError('use .from_lut or .from_indices')             # <<<<<<<<<<<<<<
  * 
  *         if len(on_set.shape) != 1 or (dc_set is not None and len(dc_set.shape) != 1):
  */
-  __pyx_tuple__51 = PyTuple_Pack(1, __pyx_kp_u_use_from_lut_or_from_indices); if (unlikely(!__pyx_tuple__51)) __PYX_ERR(0, 1674, __pyx_L1_error)
+  __pyx_tuple__51 = PyTuple_Pack(1, __pyx_kp_u_use_from_lut_or_from_indices); if (unlikely(!__pyx_tuple__51)) __PYX_ERR(0, 1681, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_tuple__51);
   __Pyx_GIVEREF(__pyx_tuple__51);
 
-  /* "sat_toolkit/formula.pyx":1677
+  /* "sat_toolkit/formula.pyx":1684
  * 
  *         if len(on_set.shape) != 1 or (dc_set is not None and len(dc_set.shape) != 1):
  *             raise ValueError('parameters must be one dimensional')             # <<<<<<<<<<<<<<
  * 
  *         self.numbits = numbits
  */
-  __pyx_tuple__52 = PyTuple_Pack(1, __pyx_kp_u_parameters_must_be_one_dimension); if (unlikely(!__pyx_tuple__52)) __PYX_ERR(0, 1677, __pyx_L1_error)
+  __pyx_tuple__52 = PyTuple_Pack(1, __pyx_kp_u_parameters_must_be_one_dimension); if (unlikely(!__pyx_tuple__52)) __PYX_ERR(0, 1684, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_tuple__52);
   __Pyx_GIVEREF(__pyx_tuple__52);
 
-  /* "sat_toolkit/formula.pyx":1699
+  /* "sat_toolkit/formula.pyx":1706
  * 
  *         if dc_lut is not None and on_lut.shape != dc_lut.shape:
  *             raise ValueError('parameters must have the same shape')             # <<<<<<<<<<<<<<
  * 
  *         numvals = on_lut.shape[0]
  */
-  __pyx_tuple__53 = PyTuple_Pack(1, __pyx_kp_u_parameters_must_have_the_same_sh); if (unlikely(!__pyx_tuple__53)) __PYX_ERR(0, 1699, __pyx_L1_error)
+  __pyx_tuple__53 = PyTuple_Pack(1, __pyx_kp_u_parameters_must_have_the_same_sh); if (unlikely(!__pyx_tuple__53)) __PYX_ERR(0, 1706, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_tuple__53);
   __Pyx_GIVEREF(__pyx_tuple__53);
 
-  /* "sat_toolkit/formula.pyx":1703
+  /* "sat_toolkit/formula.pyx":1710
  *         numvals = on_lut.shape[0]
  *         if (numvals & (numvals - 1)) != 0 or numvals == 0:
  *             raise ValueError('length parameter must be a power of 2')             # <<<<<<<<<<<<<<
  * 
  *         numbits = numvals.bit_length() - 1
  */
-  __pyx_tuple__54 = PyTuple_Pack(1, __pyx_kp_u_length_parameter_must_be_a_power); if (unlikely(!__pyx_tuple__54)) __PYX_ERR(0, 1703, __pyx_L1_error)
+  __pyx_tuple__54 = PyTuple_Pack(1, __pyx_kp_u_length_parameter_must_be_a_power); if (unlikely(!__pyx_tuple__54)) __PYX_ERR(0, 1710, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_tuple__54);
   __Pyx_GIVEREF(__pyx_tuple__54);
 
-  /* "sat_toolkit/formula.pyx":1708
+  /* "sat_toolkit/formula.pyx":1715
  * 
  *         if dc_lut is not None and np.any(on_lut & dc_lut):
  *             raise ValueError('on_lut and dc_lut must be distinct')             # <<<<<<<<<<<<<<
  * 
  *         on_set, = np.where(on_lut)
  */
-  __pyx_tuple__55 = PyTuple_Pack(1, __pyx_kp_u_on_lut_and_dc_lut_must_be_distin); if (unlikely(!__pyx_tuple__55)) __PYX_ERR(0, 1708, __pyx_L1_error)
+  __pyx_tuple__55 = PyTuple_Pack(1, __pyx_kp_u_on_lut_and_dc_lut_must_be_distin); if (unlikely(!__pyx_tuple__55)) __PYX_ERR(0, 1715, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_tuple__55);
   __Pyx_GIVEREF(__pyx_tuple__55);
 
-  /* "sat_toolkit/formula.pyx":1742
+  /* "sat_toolkit/formula.pyx":1749
  *             io.write(f'.phase {not invert:b}\n')
  * 
  *         def sorted_contains(a, v):             # <<<<<<<<<<<<<<
  *             idx = np.searchsorted(a, v)
  *             return idx < len(a) and a[idx] == v
  */
-  __pyx_tuple__57 = PyTuple_Pack(3, __pyx_n_s_a, __pyx_n_s_v_2, __pyx_n_s_idx); if (unlikely(!__pyx_tuple__57)) __PYX_ERR(0, 1742, __pyx_L1_error)
+  __pyx_tuple__57 = PyTuple_Pack(3, __pyx_n_s_a, __pyx_n_s_v_2, __pyx_n_s_idx); if (unlikely(!__pyx_tuple__57)) __PYX_ERR(0, 1749, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_tuple__57);
   __Pyx_GIVEREF(__pyx_tuple__57);
-  __pyx_codeobj__58 = (PyObject*)__Pyx_PyCode_New(2, 0, 0, 3, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__57, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_sat_toolkit_formula_pyx, __pyx_n_s_sorted_contains, 1742, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__58)) __PYX_ERR(0, 1742, __pyx_L1_error)
+  __pyx_codeobj__58 = (PyObject*)__Pyx_PyCode_New(2, 0, 0, 3, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__57, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_sat_toolkit_formula_pyx, __pyx_n_s_sorted_contains, 1749, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__58)) __PYX_ERR(0, 1749, __pyx_L1_error)
 
-  /* "sat_toolkit/formula.pyx":1772
+  /* "sat_toolkit/formula.pyx":1779
  *             invert = False
  *         else:
  *             raise ValueError('invalid value for `phase`')             # <<<<<<<<<<<<<<
  * 
  *         res = io.StringIO()
  */
-  __pyx_tuple__60 = PyTuple_Pack(1, __pyx_kp_u_invalid_value_for_phase); if (unlikely(!__pyx_tuple__60)) __PYX_ERR(0, 1772, __pyx_L1_error)
+  __pyx_tuple__60 = PyTuple_Pack(1, __pyx_kp_u_invalid_value_for_phase); if (unlikely(!__pyx_tuple__60)) __PYX_ERR(0, 1779, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_tuple__60);
   __Pyx_GIVEREF(__pyx_tuple__60);
 
   /* "(tree fragment)":4
  *     cdef object __pyx_PickleError
  *     cdef object __pyx_result
  *     if __pyx_checksum not in (0xa84091e, 0x12d81c9, 0xbecc035):             # <<<<<<<<<<<<<<
@@ -60808,495 +60955,495 @@
   /* "sat_toolkit/formula.pyx":309
  *         self.nvars = 0
  * 
  *     def partition(self) -> list[Self]:             # <<<<<<<<<<<<<<
  *         """
  *         partition the CNF/XorClauseList into a list of CNF/XorClauseLists with disjoints variables.
  */
-  __pyx_tuple__94 = PyTuple_Pack(9, __pyx_n_s_self, __pyx_n_s_res, __pyx_n_s_clause, __pyx_n_s_dst, __pyx_n_s_tmp, __pyx_n_s_var, __pyx_n_s_result_list, __pyx_n_s_seen_keys, __pyx_n_s_val); if (unlikely(!__pyx_tuple__94)) __PYX_ERR(0, 309, __pyx_L1_error)
+  __pyx_tuple__94 = PyTuple_Pack(10, __pyx_n_s_self, __pyx_n_s_res, __pyx_n_s_vars_to_update, __pyx_n_s_clause, __pyx_n_s_dst, __pyx_n_s_tmp, __pyx_n_s_var, __pyx_n_s_result_list, __pyx_n_s_seen_keys, __pyx_n_s_val); if (unlikely(!__pyx_tuple__94)) __PYX_ERR(0, 309, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_tuple__94);
   __Pyx_GIVEREF(__pyx_tuple__94);
-  __pyx_codeobj__95 = (PyObject*)__Pyx_PyCode_New(1, 0, 0, 9, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__94, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_sat_toolkit_formula_pyx, __pyx_n_s_partition, 309, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__95)) __PYX_ERR(0, 309, __pyx_L1_error)
+  __pyx_codeobj__95 = (PyObject*)__Pyx_PyCode_New(1, 0, 0, 10, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__94, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_sat_toolkit_formula_pyx, __pyx_n_s_partition, 309, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__95)) __PYX_ERR(0, 309, __pyx_L1_error)
 
-  /* "sat_toolkit/formula.pyx":438
+  /* "sat_toolkit/formula.pyx":445
  * 
  * 
  *     def add_clauses(self, clauses) -> None:             # <<<<<<<<<<<<<<
  *         cdef _ClauseList c_clauses = None
  * 
  */
-  __pyx_tuple__96 = PyTuple_Pack(5, __pyx_n_s_self, __pyx_n_s_clauses, __pyx_n_s_c_clauses, __pyx_n_s_clauses_view, __pyx_n_s_np_clauses); if (unlikely(!__pyx_tuple__96)) __PYX_ERR(0, 438, __pyx_L1_error)
+  __pyx_tuple__96 = PyTuple_Pack(5, __pyx_n_s_self, __pyx_n_s_clauses, __pyx_n_s_c_clauses, __pyx_n_s_clauses_view, __pyx_n_s_np_clauses); if (unlikely(!__pyx_tuple__96)) __PYX_ERR(0, 445, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_tuple__96);
   __Pyx_GIVEREF(__pyx_tuple__96);
-  __pyx_codeobj__97 = (PyObject*)__Pyx_PyCode_New(2, 0, 0, 5, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__96, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_sat_toolkit_formula_pyx, __pyx_n_s_add_clauses, 438, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__97)) __PYX_ERR(0, 438, __pyx_L1_error)
+  __pyx_codeobj__97 = (PyObject*)__Pyx_PyCode_New(2, 0, 0, 5, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__96, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_sat_toolkit_formula_pyx, __pyx_n_s_add_clauses, 445, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__97)) __PYX_ERR(0, 445, __pyx_L1_error)
 
-  /* "sat_toolkit/formula.pyx":463
+  /* "sat_toolkit/formula.pyx":470
  *                 self.nvars = c_clauses.nvars
  * 
  *     def add_clause(self, clause) -> None:             # <<<<<<<<<<<<<<
  *         """Add a single clause to CNF formula. Specify the clause without trailing 0."""
  * 
  */
-  __pyx_tuple__98 = PyTuple_Pack(4, __pyx_n_s_self, __pyx_n_s_clause, __pyx_n_s_clause_len, __pyx_n_s_np_clause); if (unlikely(!__pyx_tuple__98)) __PYX_ERR(0, 463, __pyx_L1_error)
+  __pyx_tuple__98 = PyTuple_Pack(4, __pyx_n_s_self, __pyx_n_s_clause, __pyx_n_s_clause_len, __pyx_n_s_np_clause); if (unlikely(!__pyx_tuple__98)) __PYX_ERR(0, 470, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_tuple__98);
   __Pyx_GIVEREF(__pyx_tuple__98);
-  __pyx_codeobj__99 = (PyObject*)__Pyx_PyCode_New(2, 0, 0, 4, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__98, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_sat_toolkit_formula_pyx, __pyx_n_s_add_clause, 463, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__99)) __PYX_ERR(0, 463, __pyx_L1_error)
+  __pyx_codeobj__99 = (PyObject*)__Pyx_PyCode_New(2, 0, 0, 4, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__98, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_sat_toolkit_formula_pyx, __pyx_n_s_add_clause, 470, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__99)) __PYX_ERR(0, 470, __pyx_L1_error)
 
-  /* "sat_toolkit/formula.pyx":519
+  /* "sat_toolkit/formula.pyx":526
  * 
  * 
  *     def __reversed__(self) -> Iterable[Clause]:             # <<<<<<<<<<<<<<
  *         cdef size_t i
  *         for i in reversed(range(self._start_indices.size())):
  */
-  __pyx_codeobj__25 = (PyObject*)__Pyx_PyCode_New(1, 0, 0, 2, 0, CO_OPTIMIZED|CO_NEWLOCALS|CO_GENERATOR, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__77, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_sat_toolkit_formula_pyx, __pyx_n_s_reversed_2, 519, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__25)) __PYX_ERR(0, 519, __pyx_L1_error)
+  __pyx_codeobj__25 = (PyObject*)__Pyx_PyCode_New(1, 0, 0, 2, 0, CO_OPTIMIZED|CO_NEWLOCALS|CO_GENERATOR, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__77, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_sat_toolkit_formula_pyx, __pyx_n_s_reversed_2, 526, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__25)) __PYX_ERR(0, 526, __pyx_L1_error)
 
-  /* "sat_toolkit/formula.pyx":576
+  /* "sat_toolkit/formula.pyx":583
  *                     return True
  * 
  *     def count(self, needle) -> bool:             # <<<<<<<<<<<<<<
  *         if not self._check_clause_type(needle):
  *             return False
  */
-  __pyx_tuple__100 = PyTuple_Pack(5, __pyx_n_s_self, __pyx_n_s_needle, __pyx_n_s_i_2, __pyx_n_s_count, __pyx_n_s_c_needle); if (unlikely(!__pyx_tuple__100)) __PYX_ERR(0, 576, __pyx_L1_error)
+  __pyx_tuple__100 = PyTuple_Pack(5, __pyx_n_s_self, __pyx_n_s_needle, __pyx_n_s_i_2, __pyx_n_s_count, __pyx_n_s_c_needle); if (unlikely(!__pyx_tuple__100)) __PYX_ERR(0, 583, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_tuple__100);
   __Pyx_GIVEREF(__pyx_tuple__100);
-  __pyx_codeobj__101 = (PyObject*)__Pyx_PyCode_New(2, 0, 0, 5, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__100, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_sat_toolkit_formula_pyx, __pyx_n_s_count, 576, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__101)) __PYX_ERR(0, 576, __pyx_L1_error)
+  __pyx_codeobj__101 = (PyObject*)__Pyx_PyCode_New(2, 0, 0, 5, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__100, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_sat_toolkit_formula_pyx, __pyx_n_s_count, 583, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__101)) __PYX_ERR(0, 583, __pyx_L1_error)
 
-  /* "sat_toolkit/formula.pyx":600
+  /* "sat_toolkit/formula.pyx":607
  *         return <size_t> idx
  * 
  *     def index(self, needle, start=None, end=None) -> int:             # <<<<<<<<<<<<<<
  *         """
  *         Return zero-based index in the list of the first item whose value is
  */
-  __pyx_tuple__102 = PyTuple_Pack(8, __pyx_n_s_self, __pyx_n_s_needle, __pyx_n_s_start, __pyx_n_s_end, __pyx_n_s_i_2, __pyx_n_s_start_idx, __pyx_n_s_end_idx, __pyx_n_s_c_needle); if (unlikely(!__pyx_tuple__102)) __PYX_ERR(0, 600, __pyx_L1_error)
+  __pyx_tuple__102 = PyTuple_Pack(8, __pyx_n_s_self, __pyx_n_s_needle, __pyx_n_s_start, __pyx_n_s_end, __pyx_n_s_i_2, __pyx_n_s_start_idx, __pyx_n_s_end_idx, __pyx_n_s_c_needle); if (unlikely(!__pyx_tuple__102)) __PYX_ERR(0, 607, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_tuple__102);
   __Pyx_GIVEREF(__pyx_tuple__102);
-  __pyx_codeobj__103 = (PyObject*)__Pyx_PyCode_New(4, 0, 0, 8, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__102, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_sat_toolkit_formula_pyx, __pyx_n_s_index, 600, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__103)) __PYX_ERR(0, 600, __pyx_L1_error)
+  __pyx_codeobj__103 = (PyObject*)__Pyx_PyCode_New(4, 0, 0, 8, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__102, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_sat_toolkit_formula_pyx, __pyx_n_s_index, 607, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__103)) __PYX_ERR(0, 607, __pyx_L1_error)
 
-  /* "sat_toolkit/formula.pyx":628
+  /* "sat_toolkit/formula.pyx":635
  * 
  *     # pickle support
  *     def __reduce__(self):             # <<<<<<<<<<<<<<
  *         return type(self), (np.array(self), self.nvars)
  * 
  */
-  __pyx_codeobj__104 = (PyObject*)__Pyx_PyCode_New(1, 0, 0, 1, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__91, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_sat_toolkit_formula_pyx, __pyx_n_s_reduce, 628, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__104)) __PYX_ERR(0, 628, __pyx_L1_error)
+  __pyx_codeobj__104 = (PyObject*)__Pyx_PyCode_New(1, 0, 0, 1, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__91, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_sat_toolkit_formula_pyx, __pyx_n_s_reduce, 635, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__104)) __PYX_ERR(0, 635, __pyx_L1_error)
 
-  /* "sat_toolkit/formula.pyx":684
+  /* "sat_toolkit/formula.pyx":691
  *     """
  * 
  *     @staticmethod             # <<<<<<<<<<<<<<
  *     def from_dimacs(dimacs: str) -> CNF:
  *         cdef XorCNF tmp = XorCNF.from_dimacs(dimacs)
  */
-  __pyx_tuple__105 = PyTuple_Pack(2, __pyx_n_s_dimacs, __pyx_n_s_tmp); if (unlikely(!__pyx_tuple__105)) __PYX_ERR(0, 684, __pyx_L1_error)
+  __pyx_tuple__105 = PyTuple_Pack(2, __pyx_n_s_dimacs, __pyx_n_s_tmp); if (unlikely(!__pyx_tuple__105)) __PYX_ERR(0, 691, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_tuple__105);
   __Pyx_GIVEREF(__pyx_tuple__105);
-  __pyx_codeobj__106 = (PyObject*)__Pyx_PyCode_New(1, 0, 0, 2, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__105, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_sat_toolkit_formula_pyx, __pyx_n_s_from_dimacs, 684, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__106)) __PYX_ERR(0, 684, __pyx_L1_error)
+  __pyx_codeobj__106 = (PyObject*)__Pyx_PyCode_New(1, 0, 0, 2, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__105, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_sat_toolkit_formula_pyx, __pyx_n_s_from_dimacs, 691, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__106)) __PYX_ERR(0, 691, __pyx_L1_error)
 
-  /* "sat_toolkit/formula.pyx":692
+  /* "sat_toolkit/formula.pyx":699
  *         return tmp._clauses
  * 
  *     @staticmethod             # <<<<<<<<<<<<<<
  *     def from_espresso(espresso: str) -> CNF:
  *         cdef vector[int] clauses
  */
-  __pyx_tuple__108 = PyTuple_Pack(14, __pyx_n_s_espresso, __pyx_n_s_clauses, __pyx_n_s_start_indices, __pyx_n_s_line, __pyx_n_s_val, __pyx_n_s_mask, __pyx_n_s_sign, __pyx_n_s_numbits, __pyx_n_s_i_2, __pyx_n_s_f, __pyx_n_s_line_py, __pyx_n_s__107, __pyx_n_s_bits, __pyx_n_s_res); if (unlikely(!__pyx_tuple__108)) __PYX_ERR(0, 692, __pyx_L1_error)
+  __pyx_tuple__108 = PyTuple_Pack(14, __pyx_n_s_espresso, __pyx_n_s_clauses, __pyx_n_s_start_indices, __pyx_n_s_line, __pyx_n_s_val, __pyx_n_s_mask, __pyx_n_s_sign, __pyx_n_s_numbits, __pyx_n_s_i_2, __pyx_n_s_f, __pyx_n_s_line_py, __pyx_n_s__107, __pyx_n_s_bits, __pyx_n_s_res); if (unlikely(!__pyx_tuple__108)) __PYX_ERR(0, 699, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_tuple__108);
   __Pyx_GIVEREF(__pyx_tuple__108);
-  __pyx_codeobj__109 = (PyObject*)__Pyx_PyCode_New(1, 0, 0, 14, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__108, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_sat_toolkit_formula_pyx, __pyx_n_s_from_espresso, 692, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__109)) __PYX_ERR(0, 692, __pyx_L1_error)
+  __pyx_codeobj__109 = (PyObject*)__Pyx_PyCode_New(1, 0, 0, 14, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__108, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_sat_toolkit_formula_pyx, __pyx_n_s_from_espresso, 699, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__109)) __PYX_ERR(0, 699, __pyx_L1_error)
 
-  /* "sat_toolkit/formula.pyx":744
+  /* "sat_toolkit/formula.pyx":751
  *         return res
  * 
  *     @staticmethod             # <<<<<<<<<<<<<<
  *     def create_all_zero(indices) -> CNF:
  *         """
  */
-  __pyx_tuple__110 = PyTuple_Pack(1, __pyx_n_s_indices); if (unlikely(!__pyx_tuple__110)) __PYX_ERR(0, 744, __pyx_L1_error)
+  __pyx_tuple__110 = PyTuple_Pack(1, __pyx_n_s_indices); if (unlikely(!__pyx_tuple__110)) __PYX_ERR(0, 751, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_tuple__110);
   __Pyx_GIVEREF(__pyx_tuple__110);
-  __pyx_codeobj__111 = (PyObject*)__Pyx_PyCode_New(1, 0, 0, 1, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__110, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_sat_toolkit_formula_pyx, __pyx_n_s_create_all_zero_2, 744, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__111)) __PYX_ERR(0, 744, __pyx_L1_error)
+  __pyx_codeobj__111 = (PyObject*)__Pyx_PyCode_New(1, 0, 0, 1, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__110, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_sat_toolkit_formula_pyx, __pyx_n_s_create_all_zero_2, 751, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__111)) __PYX_ERR(0, 751, __pyx_L1_error)
 
-  /* "sat_toolkit/formula.pyx":753
+  /* "sat_toolkit/formula.pyx":760
  *         return CNF._create_all_zero(indices)
  * 
  *     @staticmethod             # <<<<<<<<<<<<<<
  *     def _create_all_zero(const int[:] indices not None) -> CNF:
  *         cdef vector[int] clauses
  */
-  __pyx_tuple__112 = PyTuple_Pack(6, __pyx_n_s_indices, __pyx_n_s_clauses, __pyx_n_s_i_2, __pyx_n_s_l, __pyx_n_s_val, __pyx_n_s_res); if (unlikely(!__pyx_tuple__112)) __PYX_ERR(0, 753, __pyx_L1_error)
+  __pyx_tuple__112 = PyTuple_Pack(6, __pyx_n_s_indices, __pyx_n_s_clauses, __pyx_n_s_i_2, __pyx_n_s_l, __pyx_n_s_val, __pyx_n_s_res); if (unlikely(!__pyx_tuple__112)) __PYX_ERR(0, 760, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_tuple__112);
   __Pyx_GIVEREF(__pyx_tuple__112);
-  __pyx_codeobj__113 = (PyObject*)__Pyx_PyCode_New(1, 0, 0, 6, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__112, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_sat_toolkit_formula_pyx, __pyx_n_s_create_all_zero, 753, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__113)) __PYX_ERR(0, 753, __pyx_L1_error)
+  __pyx_codeobj__113 = (PyObject*)__Pyx_PyCode_New(1, 0, 0, 6, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__112, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_sat_toolkit_formula_pyx, __pyx_n_s_create_all_zero, 760, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__113)) __PYX_ERR(0, 760, __pyx_L1_error)
 
-  /* "sat_toolkit/formula.pyx":774
+  /* "sat_toolkit/formula.pyx":781
  *         return res
  * 
  *     @staticmethod             # <<<<<<<<<<<<<<
  *     def create_all_equal(lhs, rhs) -> CNF:
  *         "creates a CNF that asserts lhs[i] == rhs[i] for all i."
  */
-  __pyx_tuple__114 = PyTuple_Pack(2, __pyx_n_s_lhs, __pyx_n_s_rhs); if (unlikely(!__pyx_tuple__114)) __PYX_ERR(0, 774, __pyx_L1_error)
+  __pyx_tuple__114 = PyTuple_Pack(2, __pyx_n_s_lhs, __pyx_n_s_rhs); if (unlikely(!__pyx_tuple__114)) __PYX_ERR(0, 781, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_tuple__114);
   __Pyx_GIVEREF(__pyx_tuple__114);
-  __pyx_codeobj__115 = (PyObject*)__Pyx_PyCode_New(2, 0, 0, 2, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__114, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_sat_toolkit_formula_pyx, __pyx_n_s_create_all_equal_2, 774, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__115)) __PYX_ERR(0, 774, __pyx_L1_error)
+  __pyx_codeobj__115 = (PyObject*)__Pyx_PyCode_New(2, 0, 0, 2, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__114, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_sat_toolkit_formula_pyx, __pyx_n_s_create_all_equal_2, 781, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__115)) __PYX_ERR(0, 781, __pyx_L1_error)
 
-  /* "sat_toolkit/formula.pyx":781
+  /* "sat_toolkit/formula.pyx":788
  *         return CNF._create_all_equal(lhs, rhs)
  * 
  *     @staticmethod             # <<<<<<<<<<<<<<
  *     def _create_all_equal(const int[:] lhs not None, const int[:] rhs not None) -> CNF:
  *         cdef vector[int] clauses
  */
-  __pyx_tuple__116 = PyTuple_Pack(8, __pyx_n_s_lhs, __pyx_n_s_rhs, __pyx_n_s_clauses, __pyx_n_s_i_2, __pyx_n_s_length, __pyx_n_s_l, __pyx_n_s_r, __pyx_n_s_res); if (unlikely(!__pyx_tuple__116)) __PYX_ERR(0, 781, __pyx_L1_error)
+  __pyx_tuple__116 = PyTuple_Pack(8, __pyx_n_s_lhs, __pyx_n_s_rhs, __pyx_n_s_clauses, __pyx_n_s_i_2, __pyx_n_s_length, __pyx_n_s_l, __pyx_n_s_r, __pyx_n_s_res); if (unlikely(!__pyx_tuple__116)) __PYX_ERR(0, 788, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_tuple__116);
   __Pyx_GIVEREF(__pyx_tuple__116);
-  __pyx_codeobj__117 = (PyObject*)__Pyx_PyCode_New(2, 0, 0, 8, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__116, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_sat_toolkit_formula_pyx, __pyx_n_s_create_all_equal, 781, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__117)) __PYX_ERR(0, 781, __pyx_L1_error)
+  __pyx_codeobj__117 = (PyObject*)__Pyx_PyCode_New(2, 0, 0, 8, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__116, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_sat_toolkit_formula_pyx, __pyx_n_s_create_all_equal, 788, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__117)) __PYX_ERR(0, 788, __pyx_L1_error)
 
-  /* "sat_toolkit/formula.pyx":873
+  /* "sat_toolkit/formula.pyx":880
  *         return res
  * 
  *     @staticmethod             # <<<<<<<<<<<<<<
  *     def create_xor(*args, rhs=None) -> CNF:
  *         """
  */
-  __pyx_tuple__118 = PyTuple_Pack(7, __pyx_n_s_rhs, __pyx_n_s_args, __pyx_n_s_num_args, __pyx_n_s_num_xors, __pyx_n_s_i_2, __pyx_n_s_packed_args, __pyx_n_s_arg); if (unlikely(!__pyx_tuple__118)) __PYX_ERR(0, 873, __pyx_L1_error)
+  __pyx_tuple__118 = PyTuple_Pack(7, __pyx_n_s_rhs, __pyx_n_s_args, __pyx_n_s_num_args, __pyx_n_s_num_xors, __pyx_n_s_i_2, __pyx_n_s_packed_args, __pyx_n_s_arg); if (unlikely(!__pyx_tuple__118)) __PYX_ERR(0, 880, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_tuple__118);
   __Pyx_GIVEREF(__pyx_tuple__118);
-  __pyx_codeobj__119 = (PyObject*)__Pyx_PyCode_New(0, 0, 1, 7, 0, CO_OPTIMIZED|CO_NEWLOCALS|CO_VARARGS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__118, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_sat_toolkit_formula_pyx, __pyx_n_s_create_xor, 873, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__119)) __PYX_ERR(0, 873, __pyx_L1_error)
+  __pyx_codeobj__119 = (PyObject*)__Pyx_PyCode_New(0, 0, 1, 7, 0, CO_OPTIMIZED|CO_NEWLOCALS|CO_VARARGS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__118, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_sat_toolkit_formula_pyx, __pyx_n_s_create_xor, 880, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__119)) __PYX_ERR(0, 880, __pyx_L1_error)
 
-  /* "sat_toolkit/formula.pyx":904
+  /* "sat_toolkit/formula.pyx":911
  * 
  * 
  *     def logical_or(self, int var) -> CNF:             # <<<<<<<<<<<<<<
  *         """
  *         return a new CNF corresponding to (var or self). I.e., the new CNF is
  */
-  __pyx_tuple__120 = PyTuple_Pack(6, __pyx_n_s_self, __pyx_n_s_var, __pyx_n_s_new_clauses, __pyx_n_s_src, __pyx_n_s_dst, __pyx_n_s_res); if (unlikely(!__pyx_tuple__120)) __PYX_ERR(0, 904, __pyx_L1_error)
+  __pyx_tuple__120 = PyTuple_Pack(6, __pyx_n_s_self, __pyx_n_s_var, __pyx_n_s_new_clauses, __pyx_n_s_src, __pyx_n_s_dst, __pyx_n_s_res); if (unlikely(!__pyx_tuple__120)) __PYX_ERR(0, 911, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_tuple__120);
   __Pyx_GIVEREF(__pyx_tuple__120);
-  __pyx_codeobj__121 = (PyObject*)__Pyx_PyCode_New(2, 0, 0, 6, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__120, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_sat_toolkit_formula_pyx, __pyx_n_s_logical_or, 904, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__121)) __PYX_ERR(0, 904, __pyx_L1_error)
+  __pyx_codeobj__121 = (PyObject*)__Pyx_PyCode_New(2, 0, 0, 6, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__120, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_sat_toolkit_formula_pyx, __pyx_n_s_logical_or, 911, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__121)) __PYX_ERR(0, 911, __pyx_L1_error)
 
-  /* "sat_toolkit/formula.pyx":940
+  /* "sat_toolkit/formula.pyx":947
  *         return res
  * 
  *     def implied_by(self, int var) -> CNF:             # <<<<<<<<<<<<<<
  *         """
  *         return a new CNF corresponding to (var -> self). I.e., the new CNF is
  */
-  __pyx_tuple__122 = PyTuple_Pack(2, __pyx_n_s_self, __pyx_n_s_var); if (unlikely(!__pyx_tuple__122)) __PYX_ERR(0, 940, __pyx_L1_error)
+  __pyx_tuple__122 = PyTuple_Pack(2, __pyx_n_s_self, __pyx_n_s_var); if (unlikely(!__pyx_tuple__122)) __PYX_ERR(0, 947, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_tuple__122);
   __Pyx_GIVEREF(__pyx_tuple__122);
-  __pyx_codeobj__123 = (PyObject*)__Pyx_PyCode_New(2, 0, 0, 2, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__122, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_sat_toolkit_formula_pyx, __pyx_n_s_implied_by, 940, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__123)) __PYX_ERR(0, 940, __pyx_L1_error)
+  __pyx_codeobj__123 = (PyObject*)__Pyx_PyCode_New(2, 0, 0, 2, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__122, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_sat_toolkit_formula_pyx, __pyx_n_s_implied_by, 947, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__123)) __PYX_ERR(0, 947, __pyx_L1_error)
 
-  /* "sat_toolkit/formula.pyx":967
+  /* "sat_toolkit/formula.pyx":974
  *         return units
  * 
  *     def get_units(self) -> np.ndarray:             # <<<<<<<<<<<<<<
  *         """
  *         Returns all unit clauses in the CNF. The unit clauses are returned as
  */
-  __pyx_tuple__124 = PyTuple_Pack(5, __pyx_n_s_self, __pyx_n_s_vec_result, __pyx_n_s_result_view, __pyx_n_s_idx, __pyx_n_s_result); if (unlikely(!__pyx_tuple__124)) __PYX_ERR(0, 967, __pyx_L1_error)
+  __pyx_tuple__124 = PyTuple_Pack(5, __pyx_n_s_self, __pyx_n_s_vec_result, __pyx_n_s_result_view, __pyx_n_s_idx, __pyx_n_s_result); if (unlikely(!__pyx_tuple__124)) __PYX_ERR(0, 974, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_tuple__124);
   __Pyx_GIVEREF(__pyx_tuple__124);
-  __pyx_codeobj__125 = (PyObject*)__Pyx_PyCode_New(1, 0, 0, 5, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__124, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_sat_toolkit_formula_pyx, __pyx_n_s_get_units, 967, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__125)) __PYX_ERR(0, 967, __pyx_L1_error)
+  __pyx_codeobj__125 = (PyObject*)__Pyx_PyCode_New(1, 0, 0, 5, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__124, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_sat_toolkit_formula_pyx, __pyx_n_s_get_units, 974, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__125)) __PYX_ERR(0, 974, __pyx_L1_error)
 
-  /* "sat_toolkit/formula.pyx":990
+  /* "sat_toolkit/formula.pyx":997
  * 
  * 
  *     def to_dimacs(self) -> str:             # <<<<<<<<<<<<<<
  *         '''
  *         return the CNF formatted in the DIMACS file format
  */
-  __pyx_tuple__126 = PyTuple_Pack(9, __pyx_n_s_self, __pyx_n_s_max_len, __pyx_n_s_nclauses, __pyx_n_s_buf_size, __pyx_n_s_buf, __pyx_n_s_buf_idx, __pyx_n_s_written, __pyx_n_s_i_2, __pyx_n_s_py_str); if (unlikely(!__pyx_tuple__126)) __PYX_ERR(0, 990, __pyx_L1_error)
+  __pyx_tuple__126 = PyTuple_Pack(9, __pyx_n_s_self, __pyx_n_s_max_len, __pyx_n_s_nclauses, __pyx_n_s_buf_size, __pyx_n_s_buf, __pyx_n_s_buf_idx, __pyx_n_s_written, __pyx_n_s_i_2, __pyx_n_s_py_str); if (unlikely(!__pyx_tuple__126)) __PYX_ERR(0, 997, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_tuple__126);
   __Pyx_GIVEREF(__pyx_tuple__126);
-  __pyx_codeobj__127 = (PyObject*)__Pyx_PyCode_New(1, 0, 0, 9, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__126, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_sat_toolkit_formula_pyx, __pyx_n_s_to_dimacs, 990, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__127)) __PYX_ERR(0, 990, __pyx_L1_error)
+  __pyx_codeobj__127 = (PyObject*)__Pyx_PyCode_New(1, 0, 0, 9, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__126, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_sat_toolkit_formula_pyx, __pyx_n_s_to_dimacs, 997, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__127)) __PYX_ERR(0, 997, __pyx_L1_error)
 
-  /* "sat_toolkit/formula.pyx":1021
+  /* "sat_toolkit/formula.pyx":1028
  *         return 'p cnf ' + str(self.nvars) + ' ' + str(nclauses) + '\n' + py_str.decode()
  * 
  *     def to_espresso(self, print_numvars: bool = True) -> str:             # <<<<<<<<<<<<<<
  *         '''
  *         return the CNF formatted in the espresso file format
  */
-  __pyx_tuple__128 = PyTuple_Pack(9, __pyx_n_s_self, __pyx_n_s_print_numvars, __pyx_n_s_i_2, __pyx_n_s_j, __pyx_n_s_lit, __pyx_n_s_target_char, __pyx_n_s_line_buf, __pyx_n_s_buf, __pyx_n_s_py_bytes); if (unlikely(!__pyx_tuple__128)) __PYX_ERR(0, 1021, __pyx_L1_error)
+  __pyx_tuple__128 = PyTuple_Pack(9, __pyx_n_s_self, __pyx_n_s_print_numvars, __pyx_n_s_i_2, __pyx_n_s_j, __pyx_n_s_lit, __pyx_n_s_target_char, __pyx_n_s_line_buf, __pyx_n_s_buf, __pyx_n_s_py_bytes); if (unlikely(!__pyx_tuple__128)) __PYX_ERR(0, 1028, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_tuple__128);
   __Pyx_GIVEREF(__pyx_tuple__128);
-  __pyx_codeobj__129 = (PyObject*)__Pyx_PyCode_New(2, 0, 0, 9, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__128, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_sat_toolkit_formula_pyx, __pyx_n_s_to_espresso, 1021, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__129)) __PYX_ERR(0, 1021, __pyx_L1_error)
-  __pyx_tuple__130 = PyTuple_Pack(1, Py_True); if (unlikely(!__pyx_tuple__130)) __PYX_ERR(0, 1021, __pyx_L1_error)
+  __pyx_codeobj__129 = (PyObject*)__Pyx_PyCode_New(2, 0, 0, 9, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__128, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_sat_toolkit_formula_pyx, __pyx_n_s_to_espresso, 1028, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__129)) __PYX_ERR(0, 1028, __pyx_L1_error)
+  __pyx_tuple__130 = PyTuple_Pack(1, Py_True); if (unlikely(!__pyx_tuple__130)) __PYX_ERR(0, 1028, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_tuple__130);
   __Pyx_GIVEREF(__pyx_tuple__130);
 
-  /* "sat_toolkit/formula.pyx":1069
+  /* "sat_toolkit/formula.pyx":1076
  *         return py_bytes.decode()
  * 
  *     def minimize_espresso(self, espresso_args: List[str] = []) -> CNF:             # <<<<<<<<<<<<<<
  *         """
  *         Uses espresso to minimize the given CNF.
  */
-  __pyx_tuple__131 = PyTuple_Pack(5, __pyx_n_s_self, __pyx_n_s_espresso_args, __pyx_n_s_ret_code, __pyx_n_s_espresso, __pyx_n_s_cnf_2); if (unlikely(!__pyx_tuple__131)) __PYX_ERR(0, 1069, __pyx_L1_error)
+  __pyx_tuple__131 = PyTuple_Pack(5, __pyx_n_s_self, __pyx_n_s_espresso_args, __pyx_n_s_ret_code, __pyx_n_s_espresso, __pyx_n_s_cnf_2); if (unlikely(!__pyx_tuple__131)) __PYX_ERR(0, 1076, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_tuple__131);
   __Pyx_GIVEREF(__pyx_tuple__131);
-  __pyx_codeobj__132 = (PyObject*)__Pyx_PyCode_New(2, 0, 0, 5, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__131, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_sat_toolkit_formula_pyx, __pyx_n_s_minimize_espresso, 1069, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__132)) __PYX_ERR(0, 1069, __pyx_L1_error)
+  __pyx_codeobj__132 = (PyObject*)__Pyx_PyCode_New(2, 0, 0, 5, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__131, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_sat_toolkit_formula_pyx, __pyx_n_s_minimize_espresso, 1076, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__132)) __PYX_ERR(0, 1076, __pyx_L1_error)
 
-  /* "sat_toolkit/formula.pyx":1092
+  /* "sat_toolkit/formula.pyx":1099
  *             return cnf
  * 
  *     def _minimize_dimacs(self, args: List[str], outfile: str) -> CNF:             # <<<<<<<<<<<<<<
  *         """
  *         calls args with self.to_dimacs() as stdin, waits for the command to
  */
-  __pyx_tuple__133 = PyTuple_Pack(6, __pyx_n_s_self, __pyx_n_s_args, __pyx_n_s_outfile, __pyx_n_s_ret_code, __pyx_n_s_minimizer, __pyx_n_s_f); if (unlikely(!__pyx_tuple__133)) __PYX_ERR(0, 1092, __pyx_L1_error)
+  __pyx_tuple__133 = PyTuple_Pack(6, __pyx_n_s_self, __pyx_n_s_args, __pyx_n_s_outfile, __pyx_n_s_ret_code, __pyx_n_s_minimizer, __pyx_n_s_f); if (unlikely(!__pyx_tuple__133)) __PYX_ERR(0, 1099, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_tuple__133);
   __Pyx_GIVEREF(__pyx_tuple__133);
-  __pyx_codeobj__134 = (PyObject*)__Pyx_PyCode_New(3, 0, 0, 6, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__133, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_sat_toolkit_formula_pyx, __pyx_n_s_minimize_dimacs, 1092, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__134)) __PYX_ERR(0, 1092, __pyx_L1_error)
+  __pyx_codeobj__134 = (PyObject*)__Pyx_PyCode_New(3, 0, 0, 6, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__133, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_sat_toolkit_formula_pyx, __pyx_n_s_minimize_dimacs, 1099, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__134)) __PYX_ERR(0, 1099, __pyx_L1_error)
 
-  /* "sat_toolkit/formula.pyx":1115
+  /* "sat_toolkit/formula.pyx":1122
  *             return CNF.from_dimacs(f.read())
  * 
  *     def minimize_lingeling(self, optlevel=None, timeout=0, extra_args: List[str] = []) -> CNF:             # <<<<<<<<<<<<<<
  *         """
  *         Uses Lingeling to minimize the given CNF.
  */
-  __pyx_tuple__135 = PyTuple_Pack(7, __pyx_n_s_self, __pyx_n_s_optlevel, __pyx_n_s_timeout, __pyx_n_s_extra_args, __pyx_n_s_ret_code, __pyx_n_s_args, __pyx_n_s_f); if (unlikely(!__pyx_tuple__135)) __PYX_ERR(0, 1115, __pyx_L1_error)
+  __pyx_tuple__135 = PyTuple_Pack(7, __pyx_n_s_self, __pyx_n_s_optlevel, __pyx_n_s_timeout, __pyx_n_s_extra_args, __pyx_n_s_ret_code, __pyx_n_s_args, __pyx_n_s_f); if (unlikely(!__pyx_tuple__135)) __PYX_ERR(0, 1122, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_tuple__135);
   __Pyx_GIVEREF(__pyx_tuple__135);
-  __pyx_codeobj__136 = (PyObject*)__Pyx_PyCode_New(4, 0, 0, 7, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__135, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_sat_toolkit_formula_pyx, __pyx_n_s_minimize_lingeling, 1115, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__136)) __PYX_ERR(0, 1115, __pyx_L1_error)
+  __pyx_codeobj__136 = (PyObject*)__Pyx_PyCode_New(4, 0, 0, 7, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__135, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_sat_toolkit_formula_pyx, __pyx_n_s_minimize_lingeling, 1122, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__136)) __PYX_ERR(0, 1122, __pyx_L1_error)
 
-  /* "sat_toolkit/formula.pyx":1141
+  /* "sat_toolkit/formula.pyx":1148
  * 
  * 
  *     def solve_dimacs(self, command: List[str], verbose=False) -> Tuple[bool, np.array|None]:             # <<<<<<<<<<<<<<
  *         """
  *         solves the SAT by calling a DIMACS the compliant sat solver given by command.
  */
-  __pyx_tuple__137 = PyTuple_Pack(15, __pyx_n_s_self, __pyx_n_s_command, __pyx_n_s_verbose, __pyx_n_s_echo_comments, __pyx_n_s_ret_code, __pyx_n_s_result_view, __pyx_n_s_result, __pyx_n_s_buf, __pyx_n_s_lit, __pyx_n_s_i_2, __pyx_n_s_is_sat, __pyx_n_s_f, __pyx_n_s_args, __pyx_n_s_solver, __pyx_n_s_line); if (unlikely(!__pyx_tuple__137)) __PYX_ERR(0, 1141, __pyx_L1_error)
+  __pyx_tuple__137 = PyTuple_Pack(15, __pyx_n_s_self, __pyx_n_s_command, __pyx_n_s_verbose, __pyx_n_s_echo_comments, __pyx_n_s_ret_code, __pyx_n_s_result_view, __pyx_n_s_result, __pyx_n_s_buf, __pyx_n_s_lit, __pyx_n_s_i_2, __pyx_n_s_is_sat, __pyx_n_s_f, __pyx_n_s_args, __pyx_n_s_solver, __pyx_n_s_line); if (unlikely(!__pyx_tuple__137)) __PYX_ERR(0, 1148, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_tuple__137);
   __Pyx_GIVEREF(__pyx_tuple__137);
-  __pyx_codeobj__138 = (PyObject*)__Pyx_PyCode_New(3, 0, 0, 15, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__137, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_sat_toolkit_formula_pyx, __pyx_n_s_solve_dimacs, 1141, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__138)) __PYX_ERR(0, 1141, __pyx_L1_error)
-  __pyx_tuple__139 = PyTuple_Pack(1, Py_False); if (unlikely(!__pyx_tuple__139)) __PYX_ERR(0, 1141, __pyx_L1_error)
+  __pyx_codeobj__138 = (PyObject*)__Pyx_PyCode_New(3, 0, 0, 15, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__137, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_sat_toolkit_formula_pyx, __pyx_n_s_solve_dimacs, 1148, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__138)) __PYX_ERR(0, 1148, __pyx_L1_error)
+  __pyx_tuple__139 = PyTuple_Pack(1, Py_False); if (unlikely(!__pyx_tuple__139)) __PYX_ERR(0, 1148, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_tuple__139);
   __Pyx_GIVEREF(__pyx_tuple__139);
 
-  /* "sat_toolkit/formula.pyx":1209
+  /* "sat_toolkit/formula.pyx":1216
  * 
  * 
  *     def check_solution(self, uint8_t[:] solution) -> bool:             # <<<<<<<<<<<<<<
  *         cdef size_t i
  *         for i in range(solution.shape[0]):
  */
-  __pyx_tuple__140 = PyTuple_Pack(3, __pyx_n_s_self, __pyx_n_s_solution, __pyx_n_s_i_2); if (unlikely(!__pyx_tuple__140)) __PYX_ERR(0, 1209, __pyx_L1_error)
+  __pyx_tuple__140 = PyTuple_Pack(3, __pyx_n_s_self, __pyx_n_s_solution, __pyx_n_s_i_2); if (unlikely(!__pyx_tuple__140)) __PYX_ERR(0, 1216, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_tuple__140);
   __Pyx_GIVEREF(__pyx_tuple__140);
-  __pyx_codeobj__141 = (PyObject*)__Pyx_PyCode_New(2, 0, 0, 3, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__140, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_sat_toolkit_formula_pyx, __pyx_n_s_check_solution, 1209, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__141)) __PYX_ERR(0, 1209, __pyx_L1_error)
+  __pyx_codeobj__141 = (PyObject*)__Pyx_PyCode_New(2, 0, 0, 3, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__140, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_sat_toolkit_formula_pyx, __pyx_n_s_check_solution, 1216, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__141)) __PYX_ERR(0, 1216, __pyx_L1_error)
 
-  /* "sat_toolkit/formula.pyx":1250
+  /* "sat_toolkit/formula.pyx":1257
  *         return False
  * 
  *     def to_truthtable(self) -> Truthtable:             # <<<<<<<<<<<<<<
  *         """
  *         Return the current CNF as a Truthtable by iterating over all possible
  */
-  __pyx_tuple__142 = PyTuple_Pack(7, __pyx_n_s_self, __pyx_n_s_i_2, __pyx_n_s_j, __pyx_n_s_truthtable_view, __pyx_n_s_current_sol_view, __pyx_n_s_truthtable, __pyx_n_s_current_sol); if (unlikely(!__pyx_tuple__142)) __PYX_ERR(0, 1250, __pyx_L1_error)
+  __pyx_tuple__142 = PyTuple_Pack(7, __pyx_n_s_self, __pyx_n_s_i_2, __pyx_n_s_j, __pyx_n_s_truthtable_view, __pyx_n_s_current_sol_view, __pyx_n_s_truthtable, __pyx_n_s_current_sol); if (unlikely(!__pyx_tuple__142)) __PYX_ERR(0, 1257, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_tuple__142);
   __Pyx_GIVEREF(__pyx_tuple__142);
-  __pyx_codeobj__143 = (PyObject*)__Pyx_PyCode_New(1, 0, 0, 7, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__142, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_sat_toolkit_formula_pyx, __pyx_n_s_to_truthtable, 1250, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__143)) __PYX_ERR(0, 1250, __pyx_L1_error)
+  __pyx_codeobj__143 = (PyObject*)__Pyx_PyCode_New(1, 0, 0, 7, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__142, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_sat_toolkit_formula_pyx, __pyx_n_s_to_truthtable, 1257, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__143)) __PYX_ERR(0, 1257, __pyx_L1_error)
 
-  /* "sat_toolkit/formula.pyx":1292
+  /* "sat_toolkit/formula.pyx":1299
  *         return self.to_dimacs().rstrip()
  * 
  *     def equiv(self, CNF other) -> bool:             # <<<<<<<<<<<<<<
  *         """
  *         Check for logical eqivalence between self and other.
  */
-  __pyx_tuple__144 = PyTuple_Pack(4, __pyx_n_s_self, __pyx_n_s_other, __pyx_n_s_ret_code, __pyx_n_s_espresso); if (unlikely(!__pyx_tuple__144)) __PYX_ERR(0, 1292, __pyx_L1_error)
+  __pyx_tuple__144 = PyTuple_Pack(4, __pyx_n_s_self, __pyx_n_s_other, __pyx_n_s_ret_code, __pyx_n_s_espresso); if (unlikely(!__pyx_tuple__144)) __PYX_ERR(0, 1299, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_tuple__144);
   __Pyx_GIVEREF(__pyx_tuple__144);
-  __pyx_codeobj__145 = (PyObject*)__Pyx_PyCode_New(2, 0, 0, 4, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__144, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_sat_toolkit_formula_pyx, __pyx_n_s_equiv, 1292, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__145)) __PYX_ERR(0, 1292, __pyx_L1_error)
+  __pyx_codeobj__145 = (PyObject*)__Pyx_PyCode_New(2, 0, 0, 4, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__144, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_sat_toolkit_formula_pyx, __pyx_n_s_equiv, 1299, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__145)) __PYX_ERR(0, 1299, __pyx_L1_error)
 
-  /* "sat_toolkit/formula.pyx":1313
+  /* "sat_toolkit/formula.pyx":1320
  *             return ret_code == 0
  * 
  *     def translate(self, mapping) -> CNF:             # <<<<<<<<<<<<<<
  *         """
  *         Translate all variables in the CNF to a new index.
  */
-  __pyx_tuple__146 = PyTuple_Pack(8, __pyx_n_s_self, __pyx_n_s_mapping, __pyx_n_s_np_vars, __pyx_n_s_var_view, __pyx_n_s_i_2, __pyx_n_s_new_clauses, __pyx_n_s_var, __pyx_n_s_res); if (unlikely(!__pyx_tuple__146)) __PYX_ERR(0, 1313, __pyx_L1_error)
+  __pyx_tuple__146 = PyTuple_Pack(8, __pyx_n_s_self, __pyx_n_s_mapping, __pyx_n_s_np_vars, __pyx_n_s_var_view, __pyx_n_s_i_2, __pyx_n_s_new_clauses, __pyx_n_s_var, __pyx_n_s_res); if (unlikely(!__pyx_tuple__146)) __PYX_ERR(0, 1320, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_tuple__146);
   __Pyx_GIVEREF(__pyx_tuple__146);
-  __pyx_codeobj__147 = (PyObject*)__Pyx_PyCode_New(2, 0, 0, 8, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__146, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_sat_toolkit_formula_pyx, __pyx_n_s_translate, 1313, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__147)) __PYX_ERR(0, 1313, __pyx_L1_error)
+  __pyx_codeobj__147 = (PyObject*)__Pyx_PyCode_New(2, 0, 0, 8, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__146, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_sat_toolkit_formula_pyx, __pyx_n_s_translate, 1320, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__147)) __PYX_ERR(0, 1320, __pyx_L1_error)
 
-  /* "sat_toolkit/formula.pyx":1379
+  /* "sat_toolkit/formula.pyx":1386
  * 
  * 
  *     @staticmethod             # <<<<<<<<<<<<<<
  *     def from_dimacs(dimacs: str) -> XorCNF:
  *         cdef CNF clauses = CNF.__new__(CNF)
  */
-  __pyx_tuple__148 = PyTuple_Pack(12, __pyx_n_s_dimacs, __pyx_n_s_clauses, __pyx_n_s_xors, __pyx_n_s_nvars, __pyx_n_s_nclauses, __pyx_n_s_lines, __pyx_n_s_line, __pyx_n_s_tmp_nvars, __pyx_n_s_tmp_nclauses, __pyx_n_s_nclaues, __pyx_n_s_x, __pyx_n_s_x); if (unlikely(!__pyx_tuple__148)) __PYX_ERR(0, 1379, __pyx_L1_error)
+  __pyx_tuple__148 = PyTuple_Pack(12, __pyx_n_s_dimacs, __pyx_n_s_clauses, __pyx_n_s_xors, __pyx_n_s_nvars, __pyx_n_s_nclauses, __pyx_n_s_lines, __pyx_n_s_line, __pyx_n_s_tmp_nvars, __pyx_n_s_tmp_nclauses, __pyx_n_s_nclaues, __pyx_n_s_x, __pyx_n_s_x); if (unlikely(!__pyx_tuple__148)) __PYX_ERR(0, 1386, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_tuple__148);
   __Pyx_GIVEREF(__pyx_tuple__148);
-  __pyx_codeobj__149 = (PyObject*)__Pyx_PyCode_New(1, 0, 0, 12, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__148, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_sat_toolkit_formula_pyx, __pyx_n_s_from_dimacs, 1379, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__149)) __PYX_ERR(0, 1379, __pyx_L1_error)
+  __pyx_codeobj__149 = (PyObject*)__Pyx_PyCode_New(1, 0, 0, 12, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__148, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_sat_toolkit_formula_pyx, __pyx_n_s_from_dimacs, 1386, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__149)) __PYX_ERR(0, 1386, __pyx_L1_error)
 
-  /* "sat_toolkit/formula.pyx":1416
+  /* "sat_toolkit/formula.pyx":1423
  *         return XorCNF(clauses=clauses, xor_clauses=xors)
  * 
  *     @staticmethod             # <<<<<<<<<<<<<<
  *     def create_xor(*args, rhs=None) -> XorCNF:
  *         """
  */
-  __pyx_tuple__150 = PyTuple_Pack(11, __pyx_n_s_rhs, __pyx_n_s_args, __pyx_n_s_num_args, __pyx_n_s_num_xors, __pyx_n_s_i_2, __pyx_n_s_j, __pyx_n_s_rhs_view, __pyx_n_s_packed_args, __pyx_n_s_arg, __pyx_n_s_packed_args_view, __pyx_n_s_res); if (unlikely(!__pyx_tuple__150)) __PYX_ERR(0, 1416, __pyx_L1_error)
+  __pyx_tuple__150 = PyTuple_Pack(11, __pyx_n_s_rhs, __pyx_n_s_args, __pyx_n_s_num_args, __pyx_n_s_num_xors, __pyx_n_s_i_2, __pyx_n_s_j, __pyx_n_s_rhs_view, __pyx_n_s_packed_args, __pyx_n_s_arg, __pyx_n_s_packed_args_view, __pyx_n_s_res); if (unlikely(!__pyx_tuple__150)) __PYX_ERR(0, 1423, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_tuple__150);
   __Pyx_GIVEREF(__pyx_tuple__150);
-  __pyx_codeobj__151 = (PyObject*)__Pyx_PyCode_New(0, 0, 1, 11, 0, CO_OPTIMIZED|CO_NEWLOCALS|CO_VARARGS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__150, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_sat_toolkit_formula_pyx, __pyx_n_s_create_xor, 1416, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__151)) __PYX_ERR(0, 1416, __pyx_L1_error)
+  __pyx_codeobj__151 = (PyObject*)__Pyx_PyCode_New(0, 0, 1, 11, 0, CO_OPTIMIZED|CO_NEWLOCALS|CO_VARARGS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__150, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_sat_toolkit_formula_pyx, __pyx_n_s_create_xor, 1423, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__151)) __PYX_ERR(0, 1423, __pyx_L1_error)
 
-  /* "sat_toolkit/formula.pyx":1472
+  /* "sat_toolkit/formula.pyx":1479
  *         return res
  * 
  *     def partition(self) -> tuple[list[CNF], list[XorClauseList]]:             # <<<<<<<<<<<<<<
  *         """
  *         Separately partition the CNF and XorClauseList into a lists of CNFs and
  */
-  __pyx_codeobj__152 = (PyObject*)__Pyx_PyCode_New(1, 0, 0, 1, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__91, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_sat_toolkit_formula_pyx, __pyx_n_s_partition, 1472, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__152)) __PYX_ERR(0, 1472, __pyx_L1_error)
+  __pyx_codeobj__152 = (PyObject*)__Pyx_PyCode_New(1, 0, 0, 1, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__91, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_sat_toolkit_formula_pyx, __pyx_n_s_partition, 1479, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__152)) __PYX_ERR(0, 1479, __pyx_L1_error)
 
-  /* "sat_toolkit/formula.pyx":1482
+  /* "sat_toolkit/formula.pyx":1489
  *         return (self._clauses.partition(), self._xor_clauses.partition())
  * 
  *     def to_cnf(self) -> CNF:             # <<<<<<<<<<<<<<
  *         cdef CNF res = CNF.__new__(CNF)
  *         cdef size_t idx
  */
-  __pyx_tuple__153 = PyTuple_Pack(3, __pyx_n_s_self, __pyx_n_s_res, __pyx_n_s_idx); if (unlikely(!__pyx_tuple__153)) __PYX_ERR(0, 1482, __pyx_L1_error)
+  __pyx_tuple__153 = PyTuple_Pack(3, __pyx_n_s_self, __pyx_n_s_res, __pyx_n_s_idx); if (unlikely(!__pyx_tuple__153)) __PYX_ERR(0, 1489, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_tuple__153);
   __Pyx_GIVEREF(__pyx_tuple__153);
-  __pyx_codeobj__154 = (PyObject*)__Pyx_PyCode_New(1, 0, 0, 3, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__153, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_sat_toolkit_formula_pyx, __pyx_n_s_to_cnf, 1482, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__154)) __PYX_ERR(0, 1482, __pyx_L1_error)
+  __pyx_codeobj__154 = (PyObject*)__Pyx_PyCode_New(1, 0, 0, 3, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__153, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_sat_toolkit_formula_pyx, __pyx_n_s_to_cnf, 1489, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__154)) __PYX_ERR(0, 1489, __pyx_L1_error)
 
-  /* "sat_toolkit/formula.pyx":1494
+  /* "sat_toolkit/formula.pyx":1501
  *         return res
  * 
  *     def add_clauses(self, clauses):             # <<<<<<<<<<<<<<
  *         self._clauses.add_clauses(clauses)
  * 
  */
-  __pyx_tuple__155 = PyTuple_Pack(2, __pyx_n_s_self, __pyx_n_s_clauses); if (unlikely(!__pyx_tuple__155)) __PYX_ERR(0, 1494, __pyx_L1_error)
+  __pyx_tuple__155 = PyTuple_Pack(2, __pyx_n_s_self, __pyx_n_s_clauses); if (unlikely(!__pyx_tuple__155)) __PYX_ERR(0, 1501, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_tuple__155);
   __Pyx_GIVEREF(__pyx_tuple__155);
-  __pyx_codeobj__156 = (PyObject*)__Pyx_PyCode_New(2, 0, 0, 2, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__155, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_sat_toolkit_formula_pyx, __pyx_n_s_add_clauses, 1494, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__156)) __PYX_ERR(0, 1494, __pyx_L1_error)
+  __pyx_codeobj__156 = (PyObject*)__Pyx_PyCode_New(2, 0, 0, 2, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__155, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_sat_toolkit_formula_pyx, __pyx_n_s_add_clauses, 1501, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__156)) __PYX_ERR(0, 1501, __pyx_L1_error)
 
-  /* "sat_toolkit/formula.pyx":1497
+  /* "sat_toolkit/formula.pyx":1504
  *         self._clauses.add_clauses(clauses)
  * 
  *     def add_xor_clauses(self, xor_clauses):             # <<<<<<<<<<<<<<
  *         self._xor_clauses.add_clauses(xor_clauses)
  * 
  */
-  __pyx_tuple__157 = PyTuple_Pack(2, __pyx_n_s_self, __pyx_n_s_xor_clauses); if (unlikely(!__pyx_tuple__157)) __PYX_ERR(0, 1497, __pyx_L1_error)
+  __pyx_tuple__157 = PyTuple_Pack(2, __pyx_n_s_self, __pyx_n_s_xor_clauses); if (unlikely(!__pyx_tuple__157)) __PYX_ERR(0, 1504, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_tuple__157);
   __Pyx_GIVEREF(__pyx_tuple__157);
-  __pyx_codeobj__158 = (PyObject*)__Pyx_PyCode_New(2, 0, 0, 2, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__157, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_sat_toolkit_formula_pyx, __pyx_n_s_add_xor_clauses, 1497, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__158)) __PYX_ERR(0, 1497, __pyx_L1_error)
+  __pyx_codeobj__158 = (PyObject*)__Pyx_PyCode_New(2, 0, 0, 2, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__157, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_sat_toolkit_formula_pyx, __pyx_n_s_add_xor_clauses, 1504, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__158)) __PYX_ERR(0, 1504, __pyx_L1_error)
 
-  /* "sat_toolkit/formula.pyx":1565
+  /* "sat_toolkit/formula.pyx":1572
  * 
  * 
  *     def to_dimacs(self) -> str:             # <<<<<<<<<<<<<<
  *         '''
  *         return the XorCNF formatted in the extended DIMACS file format
  */
-  __pyx_codeobj__159 = (PyObject*)__Pyx_PyCode_New(1, 0, 0, 1, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__91, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_sat_toolkit_formula_pyx, __pyx_n_s_to_dimacs, 1565, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__159)) __PYX_ERR(0, 1565, __pyx_L1_error)
+  __pyx_codeobj__159 = (PyObject*)__Pyx_PyCode_New(1, 0, 0, 1, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__91, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_sat_toolkit_formula_pyx, __pyx_n_s_to_dimacs, 1572, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__159)) __PYX_ERR(0, 1572, __pyx_L1_error)
 
-  /* "sat_toolkit/formula.pyx":1571
+  /* "sat_toolkit/formula.pyx":1578
  *         return f'p cnf {self._nvars()} {len(self._clauses) + len(self._xor_clauses)}\n{self._clauses._to_dimacs("")}{self._xor_clauses._to_dimacs("x")}'
  * 
  *     def __reduce__(self):             # <<<<<<<<<<<<<<
  *         return type(self), (self._clauses, self._xor_clauses)
  * 
  */
-  __pyx_codeobj__160 = (PyObject*)__Pyx_PyCode_New(1, 0, 0, 1, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__91, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_sat_toolkit_formula_pyx, __pyx_n_s_reduce, 1571, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__160)) __PYX_ERR(0, 1571, __pyx_L1_error)
+  __pyx_codeobj__160 = (PyObject*)__Pyx_PyCode_New(1, 0, 0, 1, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__91, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_sat_toolkit_formula_pyx, __pyx_n_s_reduce, 1578, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__160)) __PYX_ERR(0, 1578, __pyx_L1_error)
 
-  /* "sat_toolkit/formula.pyx":1587
+  /* "sat_toolkit/formula.pyx":1594
  *         return self._clauses._clauses == c_other._clauses._clauses and self._xor_clauses._clauses == c_other._xor_clauses._clauses
  * 
  *     def solve_dimacs(self, command: List[str]=['cryptominisat5'], verbose=False) -> Tuple[bool, np.array|None]:             # <<<<<<<<<<<<<<
  *         """
  *         solves the SAT by calling a DIMACS compliant sat solver that also
  */
-  __pyx_codeobj__161 = (PyObject*)__Pyx_PyCode_New(3, 0, 0, 15, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__137, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_sat_toolkit_formula_pyx, __pyx_n_s_solve_dimacs, 1587, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__161)) __PYX_ERR(0, 1587, __pyx_L1_error)
+  __pyx_codeobj__161 = (PyObject*)__Pyx_PyCode_New(3, 0, 0, 15, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__137, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_sat_toolkit_formula_pyx, __pyx_n_s_solve_dimacs, 1594, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__161)) __PYX_ERR(0, 1594, __pyx_L1_error)
 
-  /* "sat_toolkit/formula.pyx":1684
+  /* "sat_toolkit/formula.pyx":1691
  * 
  * 
  *     @classmethod             # <<<<<<<<<<<<<<
  *     def from_lut(cls, on_lut: np.ndarray, dc_lut: Optional[np.ndarray] = None) -> Truthtable:
  *         """
  */
-  __pyx_tuple__162 = PyTuple_Pack(7, __pyx_n_s_cls, __pyx_n_s_on_lut, __pyx_n_s_dc_lut, __pyx_n_s_numvals, __pyx_n_s_numbits, __pyx_n_s_on_set, __pyx_n_s_dc_set); if (unlikely(!__pyx_tuple__162)) __PYX_ERR(0, 1684, __pyx_L1_error)
+  __pyx_tuple__162 = PyTuple_Pack(7, __pyx_n_s_cls, __pyx_n_s_on_lut, __pyx_n_s_dc_lut, __pyx_n_s_numvals, __pyx_n_s_numbits, __pyx_n_s_on_set, __pyx_n_s_dc_set); if (unlikely(!__pyx_tuple__162)) __PYX_ERR(0, 1691, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_tuple__162);
   __Pyx_GIVEREF(__pyx_tuple__162);
-  __pyx_codeobj__163 = (PyObject*)__Pyx_PyCode_New(3, 0, 0, 7, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__162, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_sat_toolkit_formula_pyx, __pyx_n_s_from_lut, 1684, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__163)) __PYX_ERR(0, 1684, __pyx_L1_error)
-  __pyx_tuple__164 = PyTuple_Pack(1, Py_None); if (unlikely(!__pyx_tuple__164)) __PYX_ERR(0, 1684, __pyx_L1_error)
+  __pyx_codeobj__163 = (PyObject*)__Pyx_PyCode_New(3, 0, 0, 7, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__162, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_sat_toolkit_formula_pyx, __pyx_n_s_from_lut, 1691, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__163)) __PYX_ERR(0, 1691, __pyx_L1_error)
+  __pyx_tuple__164 = PyTuple_Pack(1, Py_None); if (unlikely(!__pyx_tuple__164)) __PYX_ERR(0, 1691, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_tuple__164);
   __Pyx_GIVEREF(__pyx_tuple__164);
 
-  /* "sat_toolkit/formula.pyx":1714
+  /* "sat_toolkit/formula.pyx":1721
  *         return cls(cls.INIT_INDEX_SET, numbits, on_set, dc_set)
  * 
  *     @classmethod             # <<<<<<<<<<<<<<
  *     def from_indices(cls, numbits: int, on_indices: np.array, dc_indices = np.array([], dtype=int)) -> Truthtable:
  *         """
  */
-  __pyx_tuple__165 = PyTuple_Pack(4, __pyx_n_s_cls, __pyx_n_s_numbits, __pyx_n_s_on_indices, __pyx_n_s_dc_indices); if (unlikely(!__pyx_tuple__165)) __PYX_ERR(0, 1714, __pyx_L1_error)
+  __pyx_tuple__165 = PyTuple_Pack(4, __pyx_n_s_cls, __pyx_n_s_numbits, __pyx_n_s_on_indices, __pyx_n_s_dc_indices); if (unlikely(!__pyx_tuple__165)) __PYX_ERR(0, 1721, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_tuple__165);
   __Pyx_GIVEREF(__pyx_tuple__165);
-  __pyx_codeobj__166 = (PyObject*)__Pyx_PyCode_New(4, 0, 0, 4, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__165, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_sat_toolkit_formula_pyx, __pyx_n_s_from_indices, 1714, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__166)) __PYX_ERR(0, 1714, __pyx_L1_error)
+  __pyx_codeobj__166 = (PyObject*)__Pyx_PyCode_New(4, 0, 0, 4, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__165, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_sat_toolkit_formula_pyx, __pyx_n_s_from_indices, 1721, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__166)) __PYX_ERR(0, 1721, __pyx_L1_error)
 
-  /* "sat_toolkit/formula.pyx":1729
+  /* "sat_toolkit/formula.pyx":1736
  * 
  * 
  *     def _write(self, io: io.TextIOBase, espresso: bool = False, invert: bool = False) -> None:             # <<<<<<<<<<<<<<
  *         i_list = range(1 << self.numbits)
  * 
  */
-  __pyx_tuple__167 = PyTuple_Pack(11, __pyx_n_s_self, __pyx_n_s_io, __pyx_n_s_espresso, __pyx_n_s_invert, __pyx_n_s_i_list, __pyx_n_s_sorted_contains, __pyx_n_s_sorted_contains, __pyx_n_s_i_2, __pyx_n_s_on, __pyx_n_s_dc, __pyx_n_s_desc); if (unlikely(!__pyx_tuple__167)) __PYX_ERR(0, 1729, __pyx_L1_error)
+  __pyx_tuple__167 = PyTuple_Pack(11, __pyx_n_s_self, __pyx_n_s_io, __pyx_n_s_espresso, __pyx_n_s_invert, __pyx_n_s_i_list, __pyx_n_s_sorted_contains, __pyx_n_s_sorted_contains, __pyx_n_s_i_2, __pyx_n_s_on, __pyx_n_s_dc, __pyx_n_s_desc); if (unlikely(!__pyx_tuple__167)) __PYX_ERR(0, 1736, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_tuple__167);
   __Pyx_GIVEREF(__pyx_tuple__167);
-  __pyx_codeobj__168 = (PyObject*)__Pyx_PyCode_New(4, 0, 0, 11, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__167, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_sat_toolkit_formula_pyx, __pyx_n_s_write_2, 1729, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__168)) __PYX_ERR(0, 1729, __pyx_L1_error)
-  __pyx_tuple__169 = PyTuple_Pack(2, Py_False, Py_False); if (unlikely(!__pyx_tuple__169)) __PYX_ERR(0, 1729, __pyx_L1_error)
+  __pyx_codeobj__168 = (PyObject*)__Pyx_PyCode_New(4, 0, 0, 11, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__167, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_sat_toolkit_formula_pyx, __pyx_n_s_write_2, 1736, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__168)) __PYX_ERR(0, 1736, __pyx_L1_error)
+  __pyx_tuple__169 = PyTuple_Pack(2, Py_False, Py_False); if (unlikely(!__pyx_tuple__169)) __PYX_ERR(0, 1736, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_tuple__169);
   __Pyx_GIVEREF(__pyx_tuple__169);
 
-  /* "sat_toolkit/formula.pyx":1758
+  /* "sat_toolkit/formula.pyx":1765
  *             io.write(f'.end\n')
  * 
  *     def to_espresso(self, phase='cnf') -> str:             # <<<<<<<<<<<<<<
  *         """
  *         return the truthtable in espresso format
  */
-  __pyx_tuple__170 = PyTuple_Pack(4, __pyx_n_s_self, __pyx_n_s_phase_2, __pyx_n_s_invert, __pyx_n_s_res); if (unlikely(!__pyx_tuple__170)) __PYX_ERR(0, 1758, __pyx_L1_error)
+  __pyx_tuple__170 = PyTuple_Pack(4, __pyx_n_s_self, __pyx_n_s_phase_2, __pyx_n_s_invert, __pyx_n_s_res); if (unlikely(!__pyx_tuple__170)) __PYX_ERR(0, 1765, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_tuple__170);
   __Pyx_GIVEREF(__pyx_tuple__170);
-  __pyx_codeobj__171 = (PyObject*)__Pyx_PyCode_New(2, 0, 0, 4, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__170, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_sat_toolkit_formula_pyx, __pyx_n_s_to_espresso, 1758, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__171)) __PYX_ERR(0, 1758, __pyx_L1_error)
-  __pyx_tuple__172 = PyTuple_Pack(1, __pyx_n_u_cnf_2); if (unlikely(!__pyx_tuple__172)) __PYX_ERR(0, 1758, __pyx_L1_error)
+  __pyx_codeobj__171 = (PyObject*)__Pyx_PyCode_New(2, 0, 0, 4, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__170, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_sat_toolkit_formula_pyx, __pyx_n_s_to_espresso, 1765, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__171)) __PYX_ERR(0, 1765, __pyx_L1_error)
+  __pyx_tuple__172 = PyTuple_Pack(1, __pyx_n_u_cnf_2); if (unlikely(!__pyx_tuple__172)) __PYX_ERR(0, 1765, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_tuple__172);
   __Pyx_GIVEREF(__pyx_tuple__172);
 
-  /* "sat_toolkit/formula.pyx":1797
+  /* "sat_toolkit/formula.pyx":1804
  *         return True
  * 
  *     def to_cnf(self, espresso_args: List[str] = []) -> CNF:             # <<<<<<<<<<<<<<
  *         """
  *         Uses espresso to convert the Truthtable to a minimized CNF.
  */
-  __pyx_tuple__173 = PyTuple_Pack(5, __pyx_n_s_self, __pyx_n_s_espresso_args, __pyx_n_s_espresso, __pyx_n_s_cnf_2, __pyx_n_s_ret_code); if (unlikely(!__pyx_tuple__173)) __PYX_ERR(0, 1797, __pyx_L1_error)
+  __pyx_tuple__173 = PyTuple_Pack(5, __pyx_n_s_self, __pyx_n_s_espresso_args, __pyx_n_s_espresso, __pyx_n_s_cnf_2, __pyx_n_s_ret_code); if (unlikely(!__pyx_tuple__173)) __PYX_ERR(0, 1804, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_tuple__173);
   __Pyx_GIVEREF(__pyx_tuple__173);
-  __pyx_codeobj__174 = (PyObject*)__Pyx_PyCode_New(2, 0, 0, 5, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__173, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_sat_toolkit_formula_pyx, __pyx_n_s_to_cnf, 1797, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__174)) __PYX_ERR(0, 1797, __pyx_L1_error)
+  __pyx_codeobj__174 = (PyObject*)__Pyx_PyCode_New(2, 0, 0, 5, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__173, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_sat_toolkit_formula_pyx, __pyx_n_s_to_cnf, 1804, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__174)) __PYX_ERR(0, 1804, __pyx_L1_error)
 
   /* "(tree fragment)":1
  * def __reduce_cython__(self):             # <<<<<<<<<<<<<<
  *     cdef tuple state
  *     cdef object _dict
  */
   __pyx_codeobj__175 = (PyObject*)__Pyx_PyCode_New(1, 0, 0, 4, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__83, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_stringsource, __pyx_n_s_reduce_cython, 1, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__175)) __PYX_ERR(1, 1, __pyx_L1_error)
@@ -61323,14 +61470,16 @@
   __pyx_L1_error:;
   __Pyx_RefNannyFinishContext();
   return -1;
 }
 /* #### Code section: init_constants ### */
 
 static CYTHON_SMALL_CODE int __Pyx_InitConstants(void) {
+  __pyx_umethod_PySet_Type_union.type = (PyObject*)&PySet_Type;
+  __pyx_umethod_PySet_Type_union.method_name = &__pyx_n_s_union;
   if (__Pyx_CreateStringTabAndInitStrings() < 0) __PYX_ERR(0, 1, __pyx_L1_error);
   __pyx_int_0 = PyInt_FromLong(0); if (unlikely(!__pyx_int_0)) __PYX_ERR(0, 1, __pyx_L1_error)
   __pyx_int_1 = PyInt_FromLong(1); if (unlikely(!__pyx_int_1)) __PYX_ERR(0, 1, __pyx_L1_error)
   __pyx_int_2 = PyInt_FromLong(2); if (unlikely(!__pyx_int_2)) __PYX_ERR(0, 1, __pyx_L1_error)
   __pyx_int_3 = PyInt_FromLong(3); if (unlikely(!__pyx_int_3)) __PYX_ERR(0, 1, __pyx_L1_error)
   __pyx_int_255 = PyInt_FromLong(255); if (unlikely(!__pyx_int_255)) __PYX_ERR(0, 1, __pyx_L1_error)
   __pyx_int_19759561 = PyInt_FromLong(19759561L); if (unlikely(!__pyx_int_19759561)) __PYX_ERR(0, 1, __pyx_L1_error)
@@ -61558,124 +61707,124 @@
   __pyx_vtable_11sat_toolkit_7formula_CNF._add_xor_clause = (int (*)(struct __pyx_obj_11sat_toolkit_7formula_CNF *, __Pyx_memviewslice, struct __pyx_opt_args_11sat_toolkit_7formula_3CNF__add_xor_clause *__pyx_optional_args))__pyx_f_11sat_toolkit_7formula_3CNF__add_xor_clause;
   __pyx_vtable_11sat_toolkit_7formula_CNF._create_xor = (struct __pyx_obj_11sat_toolkit_7formula_CNF *(*)(__Pyx_memviewslice))__pyx_f_11sat_toolkit_7formula_3CNF__create_xor;
   __pyx_vtable_11sat_toolkit_7formula_CNF._get_units = (std::vector<int>  (*)(struct __pyx_obj_11sat_toolkit_7formula_CNF *))__pyx_f_11sat_toolkit_7formula_3CNF__get_units;
   __pyx_vtable_11sat_toolkit_7formula_CNF._check_solution = (int (*)(struct __pyx_obj_11sat_toolkit_7formula_CNF *, __Pyx_memviewslice))__pyx_f_11sat_toolkit_7formula_3CNF__check_solution;
   __pyx_vtable_11sat_toolkit_7formula_CNF._check_solution_for_single_clause = (int (*)(struct __pyx_obj_11sat_toolkit_7formula_CNF *, size_t, __Pyx_memviewslice))__pyx_f_11sat_toolkit_7formula_3CNF__check_solution_for_single_clause;
   __pyx_vtable_11sat_toolkit_7formula_CNF.get_clause = (struct __pyx_obj_11sat_toolkit_7formula_Clause *(*)(struct __pyx_obj_11sat_toolkit_7formula_CNF *, Py_ssize_t))__pyx_f_11sat_toolkit_7formula_3CNF_get_clause;
   #if CYTHON_USE_TYPE_SPECS
-  __pyx_t_1 = PyTuple_Pack(1, (PyObject *)__pyx_ptype_11sat_toolkit_7formula__ClauseList); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 669, __pyx_L1_error)
+  __pyx_t_1 = PyTuple_Pack(1, (PyObject *)__pyx_ptype_11sat_toolkit_7formula__ClauseList); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 676, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_ptype_11sat_toolkit_7formula_CNF = (PyTypeObject *) __Pyx_PyType_FromModuleAndSpec(__pyx_m, &__pyx_type_11sat_toolkit_7formula_CNF_spec, __pyx_t_1);
   __Pyx_XDECREF(__pyx_t_1); __pyx_t_1 = 0;
-  if (unlikely(!__pyx_ptype_11sat_toolkit_7formula_CNF)) __PYX_ERR(0, 669, __pyx_L1_error)
-  if (__Pyx_fix_up_extension_type_from_spec(&__pyx_type_11sat_toolkit_7formula_CNF_spec, __pyx_ptype_11sat_toolkit_7formula_CNF) < 0) __PYX_ERR(0, 669, __pyx_L1_error)
+  if (unlikely(!__pyx_ptype_11sat_toolkit_7formula_CNF)) __PYX_ERR(0, 676, __pyx_L1_error)
+  if (__Pyx_fix_up_extension_type_from_spec(&__pyx_type_11sat_toolkit_7formula_CNF_spec, __pyx_ptype_11sat_toolkit_7formula_CNF) < 0) __PYX_ERR(0, 676, __pyx_L1_error)
   #else
   __pyx_ptype_11sat_toolkit_7formula_CNF = &__pyx_type_11sat_toolkit_7formula_CNF;
   #endif
   #if !CYTHON_COMPILING_IN_LIMITED_API
   __pyx_ptype_11sat_toolkit_7formula_CNF->tp_base = __pyx_ptype_11sat_toolkit_7formula__ClauseList;
   #endif
   #if !CYTHON_USE_TYPE_SPECS
-  if (__Pyx_PyType_Ready(__pyx_ptype_11sat_toolkit_7formula_CNF) < 0) __PYX_ERR(0, 669, __pyx_L1_error)
+  if (__Pyx_PyType_Ready(__pyx_ptype_11sat_toolkit_7formula_CNF) < 0) __PYX_ERR(0, 676, __pyx_L1_error)
   #endif
   #if PY_MAJOR_VERSION < 3
   __pyx_ptype_11sat_toolkit_7formula_CNF->tp_print = 0;
   #endif
   #if !CYTHON_COMPILING_IN_LIMITED_API
   if ((CYTHON_USE_TYPE_SLOTS && CYTHON_USE_PYTYPE_LOOKUP) && likely(!__pyx_ptype_11sat_toolkit_7formula_CNF->tp_dictoffset && __pyx_ptype_11sat_toolkit_7formula_CNF->tp_getattro == PyObject_GenericGetAttr)) {
     __pyx_ptype_11sat_toolkit_7formula_CNF->tp_getattro = __Pyx_PyObject_GenericGetAttr;
   }
   #endif
-  if (__Pyx_SetVtable(__pyx_ptype_11sat_toolkit_7formula_CNF, __pyx_vtabptr_11sat_toolkit_7formula_CNF) < 0) __PYX_ERR(0, 669, __pyx_L1_error)
+  if (__Pyx_SetVtable(__pyx_ptype_11sat_toolkit_7formula_CNF, __pyx_vtabptr_11sat_toolkit_7formula_CNF) < 0) __PYX_ERR(0, 676, __pyx_L1_error)
   #if !CYTHON_COMPILING_IN_LIMITED_API
-  if (__Pyx_MergeVtables(__pyx_ptype_11sat_toolkit_7formula_CNF) < 0) __PYX_ERR(0, 669, __pyx_L1_error)
+  if (__Pyx_MergeVtables(__pyx_ptype_11sat_toolkit_7formula_CNF) < 0) __PYX_ERR(0, 676, __pyx_L1_error)
   #endif
-  if (PyObject_SetAttr(__pyx_m, __pyx_n_s_CNF, (PyObject *) __pyx_ptype_11sat_toolkit_7formula_CNF) < 0) __PYX_ERR(0, 669, __pyx_L1_error)
+  if (PyObject_SetAttr(__pyx_m, __pyx_n_s_CNF, (PyObject *) __pyx_ptype_11sat_toolkit_7formula_CNF) < 0) __PYX_ERR(0, 676, __pyx_L1_error)
   __pyx_vtabptr_11sat_toolkit_7formula_XorClauseList = &__pyx_vtable_11sat_toolkit_7formula_XorClauseList;
   __pyx_vtable_11sat_toolkit_7formula_XorClauseList.__pyx_base = *__pyx_vtabptr_11sat_toolkit_7formula__ClauseList;
   __pyx_vtable_11sat_toolkit_7formula_XorClauseList.__pyx_base.get_clause = (struct __pyx_obj_11sat_toolkit_7formula__BaseClause *(*)(struct __pyx_obj_11sat_toolkit_7formula__ClauseList *, Py_ssize_t))__pyx_f_11sat_toolkit_7formula_13XorClauseList_get_clause__pyx_wrap_1;
   __pyx_vtable_11sat_toolkit_7formula_XorClauseList.__pyx_base._check_clause_type = (int (*)(struct __pyx_obj_11sat_toolkit_7formula__ClauseList *, struct __pyx_obj_11sat_toolkit_7formula__BaseClause *))__pyx_f_11sat_toolkit_7formula_13XorClauseList__check_clause_type;
   __pyx_vtable_11sat_toolkit_7formula_XorClauseList.get_clause = (struct __pyx_obj_11sat_toolkit_7formula_XorClause *(*)(struct __pyx_obj_11sat_toolkit_7formula_XorClauseList *, Py_ssize_t))__pyx_f_11sat_toolkit_7formula_13XorClauseList_get_clause;
   #if CYTHON_USE_TYPE_SPECS
-  __pyx_t_1 = PyTuple_Pack(1, (PyObject *)__pyx_ptype_11sat_toolkit_7formula__ClauseList); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1350, __pyx_L1_error)
+  __pyx_t_1 = PyTuple_Pack(1, (PyObject *)__pyx_ptype_11sat_toolkit_7formula__ClauseList); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1357, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_ptype_11sat_toolkit_7formula_XorClauseList = (PyTypeObject *) __Pyx_PyType_FromModuleAndSpec(__pyx_m, &__pyx_type_11sat_toolkit_7formula_XorClauseList_spec, __pyx_t_1);
   __Pyx_XDECREF(__pyx_t_1); __pyx_t_1 = 0;
-  if (unlikely(!__pyx_ptype_11sat_toolkit_7formula_XorClauseList)) __PYX_ERR(0, 1350, __pyx_L1_error)
-  if (__Pyx_fix_up_extension_type_from_spec(&__pyx_type_11sat_toolkit_7formula_XorClauseList_spec, __pyx_ptype_11sat_toolkit_7formula_XorClauseList) < 0) __PYX_ERR(0, 1350, __pyx_L1_error)
+  if (unlikely(!__pyx_ptype_11sat_toolkit_7formula_XorClauseList)) __PYX_ERR(0, 1357, __pyx_L1_error)
+  if (__Pyx_fix_up_extension_type_from_spec(&__pyx_type_11sat_toolkit_7formula_XorClauseList_spec, __pyx_ptype_11sat_toolkit_7formula_XorClauseList) < 0) __PYX_ERR(0, 1357, __pyx_L1_error)
   #else
   __pyx_ptype_11sat_toolkit_7formula_XorClauseList = &__pyx_type_11sat_toolkit_7formula_XorClauseList;
   #endif
   #if !CYTHON_COMPILING_IN_LIMITED_API
   __pyx_ptype_11sat_toolkit_7formula_XorClauseList->tp_base = __pyx_ptype_11sat_toolkit_7formula__ClauseList;
   #endif
   #if !CYTHON_USE_TYPE_SPECS
-  if (__Pyx_PyType_Ready(__pyx_ptype_11sat_toolkit_7formula_XorClauseList) < 0) __PYX_ERR(0, 1350, __pyx_L1_error)
+  if (__Pyx_PyType_Ready(__pyx_ptype_11sat_toolkit_7formula_XorClauseList) < 0) __PYX_ERR(0, 1357, __pyx_L1_error)
   #endif
   #if PY_MAJOR_VERSION < 3
   __pyx_ptype_11sat_toolkit_7formula_XorClauseList->tp_print = 0;
   #endif
   #if !CYTHON_COMPILING_IN_LIMITED_API
   if ((CYTHON_USE_TYPE_SLOTS && CYTHON_USE_PYTYPE_LOOKUP) && likely(!__pyx_ptype_11sat_toolkit_7formula_XorClauseList->tp_dictoffset && __pyx_ptype_11sat_toolkit_7formula_XorClauseList->tp_getattro == PyObject_GenericGetAttr)) {
     __pyx_ptype_11sat_toolkit_7formula_XorClauseList->tp_getattro = __Pyx_PyObject_GenericGetAttr;
   }
   #endif
-  if (__Pyx_SetVtable(__pyx_ptype_11sat_toolkit_7formula_XorClauseList, __pyx_vtabptr_11sat_toolkit_7formula_XorClauseList) < 0) __PYX_ERR(0, 1350, __pyx_L1_error)
+  if (__Pyx_SetVtable(__pyx_ptype_11sat_toolkit_7formula_XorClauseList, __pyx_vtabptr_11sat_toolkit_7formula_XorClauseList) < 0) __PYX_ERR(0, 1357, __pyx_L1_error)
   #if !CYTHON_COMPILING_IN_LIMITED_API
-  if (__Pyx_MergeVtables(__pyx_ptype_11sat_toolkit_7formula_XorClauseList) < 0) __PYX_ERR(0, 1350, __pyx_L1_error)
+  if (__Pyx_MergeVtables(__pyx_ptype_11sat_toolkit_7formula_XorClauseList) < 0) __PYX_ERR(0, 1357, __pyx_L1_error)
   #endif
-  if (PyObject_SetAttr(__pyx_m, __pyx_n_s_XorClauseList, (PyObject *) __pyx_ptype_11sat_toolkit_7formula_XorClauseList) < 0) __PYX_ERR(0, 1350, __pyx_L1_error)
+  if (PyObject_SetAttr(__pyx_m, __pyx_n_s_XorClauseList, (PyObject *) __pyx_ptype_11sat_toolkit_7formula_XorClauseList) < 0) __PYX_ERR(0, 1357, __pyx_L1_error)
   __pyx_vtabptr_11sat_toolkit_7formula_XorCNF = &__pyx_vtable_11sat_toolkit_7formula_XorCNF;
   __pyx_vtable_11sat_toolkit_7formula_XorCNF._nvars = (int (*)(struct __pyx_obj_11sat_toolkit_7formula_XorCNF *))__pyx_f_11sat_toolkit_7formula_6XorCNF__nvars;
   #if CYTHON_USE_TYPE_SPECS
-  __pyx_ptype_11sat_toolkit_7formula_XorCNF = (PyTypeObject *) __Pyx_PyType_FromModuleAndSpec(__pyx_m, &__pyx_type_11sat_toolkit_7formula_XorCNF_spec, NULL); if (unlikely(!__pyx_ptype_11sat_toolkit_7formula_XorCNF)) __PYX_ERR(0, 1364, __pyx_L1_error)
-  if (__Pyx_fix_up_extension_type_from_spec(&__pyx_type_11sat_toolkit_7formula_XorCNF_spec, __pyx_ptype_11sat_toolkit_7formula_XorCNF) < 0) __PYX_ERR(0, 1364, __pyx_L1_error)
+  __pyx_ptype_11sat_toolkit_7formula_XorCNF = (PyTypeObject *) __Pyx_PyType_FromModuleAndSpec(__pyx_m, &__pyx_type_11sat_toolkit_7formula_XorCNF_spec, NULL); if (unlikely(!__pyx_ptype_11sat_toolkit_7formula_XorCNF)) __PYX_ERR(0, 1371, __pyx_L1_error)
+  if (__Pyx_fix_up_extension_type_from_spec(&__pyx_type_11sat_toolkit_7formula_XorCNF_spec, __pyx_ptype_11sat_toolkit_7formula_XorCNF) < 0) __PYX_ERR(0, 1371, __pyx_L1_error)
   #else
   __pyx_ptype_11sat_toolkit_7formula_XorCNF = &__pyx_type_11sat_toolkit_7formula_XorCNF;
   #endif
   #if !CYTHON_COMPILING_IN_LIMITED_API
   #endif
   #if !CYTHON_USE_TYPE_SPECS
-  if (__Pyx_PyType_Ready(__pyx_ptype_11sat_toolkit_7formula_XorCNF) < 0) __PYX_ERR(0, 1364, __pyx_L1_error)
+  if (__Pyx_PyType_Ready(__pyx_ptype_11sat_toolkit_7formula_XorCNF) < 0) __PYX_ERR(0, 1371, __pyx_L1_error)
   #endif
   #if PY_MAJOR_VERSION < 3
   __pyx_ptype_11sat_toolkit_7formula_XorCNF->tp_print = 0;
   #endif
   #if !CYTHON_COMPILING_IN_LIMITED_API
   if ((CYTHON_USE_TYPE_SLOTS && CYTHON_USE_PYTYPE_LOOKUP) && likely(!__pyx_ptype_11sat_toolkit_7formula_XorCNF->tp_dictoffset && __pyx_ptype_11sat_toolkit_7formula_XorCNF->tp_getattro == PyObject_GenericGetAttr)) {
     __pyx_ptype_11sat_toolkit_7formula_XorCNF->tp_getattro = __Pyx_PyObject_GenericGetAttr;
   }
   #endif
-  if (__Pyx_SetVtable(__pyx_ptype_11sat_toolkit_7formula_XorCNF, __pyx_vtabptr_11sat_toolkit_7formula_XorCNF) < 0) __PYX_ERR(0, 1364, __pyx_L1_error)
+  if (__Pyx_SetVtable(__pyx_ptype_11sat_toolkit_7formula_XorCNF, __pyx_vtabptr_11sat_toolkit_7formula_XorCNF) < 0) __PYX_ERR(0, 1371, __pyx_L1_error)
   #if !CYTHON_COMPILING_IN_LIMITED_API
-  if (__Pyx_MergeVtables(__pyx_ptype_11sat_toolkit_7formula_XorCNF) < 0) __PYX_ERR(0, 1364, __pyx_L1_error)
+  if (__Pyx_MergeVtables(__pyx_ptype_11sat_toolkit_7formula_XorCNF) < 0) __PYX_ERR(0, 1371, __pyx_L1_error)
   #endif
-  if (PyObject_SetAttr(__pyx_m, __pyx_n_s_XorCNF, (PyObject *) __pyx_ptype_11sat_toolkit_7formula_XorCNF) < 0) __PYX_ERR(0, 1364, __pyx_L1_error)
+  if (PyObject_SetAttr(__pyx_m, __pyx_n_s_XorCNF, (PyObject *) __pyx_ptype_11sat_toolkit_7formula_XorCNF) < 0) __PYX_ERR(0, 1371, __pyx_L1_error)
   #if CYTHON_USE_TYPE_SPECS
-  __pyx_ptype_11sat_toolkit_7formula_Truthtable = (PyTypeObject *) __Pyx_PyType_FromModuleAndSpec(__pyx_m, &__pyx_type_11sat_toolkit_7formula_Truthtable_spec, NULL); if (unlikely(!__pyx_ptype_11sat_toolkit_7formula_Truthtable)) __PYX_ERR(0, 1657, __pyx_L1_error)
-  if (__Pyx_fix_up_extension_type_from_spec(&__pyx_type_11sat_toolkit_7formula_Truthtable_spec, __pyx_ptype_11sat_toolkit_7formula_Truthtable) < 0) __PYX_ERR(0, 1657, __pyx_L1_error)
+  __pyx_ptype_11sat_toolkit_7formula_Truthtable = (PyTypeObject *) __Pyx_PyType_FromModuleAndSpec(__pyx_m, &__pyx_type_11sat_toolkit_7formula_Truthtable_spec, NULL); if (unlikely(!__pyx_ptype_11sat_toolkit_7formula_Truthtable)) __PYX_ERR(0, 1664, __pyx_L1_error)
+  if (__Pyx_fix_up_extension_type_from_spec(&__pyx_type_11sat_toolkit_7formula_Truthtable_spec, __pyx_ptype_11sat_toolkit_7formula_Truthtable) < 0) __PYX_ERR(0, 1664, __pyx_L1_error)
   #else
   __pyx_ptype_11sat_toolkit_7formula_Truthtable = &__pyx_type_11sat_toolkit_7formula_Truthtable;
   #endif
   #if !CYTHON_COMPILING_IN_LIMITED_API
   #endif
   #if !CYTHON_USE_TYPE_SPECS
-  if (__Pyx_PyType_Ready(__pyx_ptype_11sat_toolkit_7formula_Truthtable) < 0) __PYX_ERR(0, 1657, __pyx_L1_error)
+  if (__Pyx_PyType_Ready(__pyx_ptype_11sat_toolkit_7formula_Truthtable) < 0) __PYX_ERR(0, 1664, __pyx_L1_error)
   #endif
   #if PY_MAJOR_VERSION < 3
   __pyx_ptype_11sat_toolkit_7formula_Truthtable->tp_print = 0;
   #endif
   #if !CYTHON_COMPILING_IN_LIMITED_API
   if ((CYTHON_USE_TYPE_SLOTS && CYTHON_USE_PYTYPE_LOOKUP) && likely(!__pyx_ptype_11sat_toolkit_7formula_Truthtable->tp_dictoffset && __pyx_ptype_11sat_toolkit_7formula_Truthtable->tp_getattro == PyObject_GenericGetAttr)) {
     __pyx_ptype_11sat_toolkit_7formula_Truthtable->tp_getattro = __Pyx_PyObject_GenericGetAttr;
   }
   #endif
-  if (PyObject_SetAttr(__pyx_m, __pyx_n_s_Truthtable_2, (PyObject *) __pyx_ptype_11sat_toolkit_7formula_Truthtable) < 0) __PYX_ERR(0, 1657, __pyx_L1_error)
+  if (PyObject_SetAttr(__pyx_m, __pyx_n_s_Truthtable_2, (PyObject *) __pyx_ptype_11sat_toolkit_7formula_Truthtable) < 0) __PYX_ERR(0, 1664, __pyx_L1_error)
   #if !CYTHON_COMPILING_IN_LIMITED_API
-  if (__Pyx_setup_reduce((PyObject *) __pyx_ptype_11sat_toolkit_7formula_Truthtable) < 0) __PYX_ERR(0, 1657, __pyx_L1_error)
+  if (__Pyx_setup_reduce((PyObject *) __pyx_ptype_11sat_toolkit_7formula_Truthtable) < 0) __PYX_ERR(0, 1664, __pyx_L1_error)
   #endif
   #if CYTHON_USE_TYPE_SPECS
   __pyx_ptype_11sat_toolkit_7formula___pyx_scope_struct____iter__ = (PyTypeObject *) __Pyx_PyType_FromModuleAndSpec(__pyx_m, &__pyx_type_11sat_toolkit_7formula___pyx_scope_struct____iter___spec, NULL); if (unlikely(!__pyx_ptype_11sat_toolkit_7formula___pyx_scope_struct____iter__)) __PYX_ERR(0, 153, __pyx_L1_error)
   if (__Pyx_fix_up_extension_type_from_spec(&__pyx_type_11sat_toolkit_7formula___pyx_scope_struct____iter___spec, __pyx_ptype_11sat_toolkit_7formula___pyx_scope_struct____iter__) < 0) __PYX_ERR(0, 153, __pyx_L1_error)
   #else
   __pyx_ptype_11sat_toolkit_7formula___pyx_scope_struct____iter__ = &__pyx_type_11sat_toolkit_7formula___pyx_scope_struct____iter__;
   #endif
@@ -61708,42 +61857,42 @@
   #endif
   #if !CYTHON_COMPILING_IN_LIMITED_API
   if ((CYTHON_USE_TYPE_SLOTS && CYTHON_USE_PYTYPE_LOOKUP) && likely(!__pyx_ptype_11sat_toolkit_7formula___pyx_scope_struct_1___reversed__->tp_dictoffset && __pyx_ptype_11sat_toolkit_7formula___pyx_scope_struct_1___reversed__->tp_getattro == PyObject_GenericGetAttr)) {
     __pyx_ptype_11sat_toolkit_7formula___pyx_scope_struct_1___reversed__->tp_getattro = __Pyx_PyObject_GenericGetAttrNoDict;
   }
   #endif
   #if CYTHON_USE_TYPE_SPECS
-  __pyx_ptype_11sat_toolkit_7formula___pyx_scope_struct_2___iter__ = (PyTypeObject *) __Pyx_PyType_FromModuleAndSpec(__pyx_m, &__pyx_type_11sat_toolkit_7formula___pyx_scope_struct_2___iter___spec, NULL); if (unlikely(!__pyx_ptype_11sat_toolkit_7formula___pyx_scope_struct_2___iter__)) __PYX_ERR(0, 512, __pyx_L1_error)
-  if (__Pyx_fix_up_extension_type_from_spec(&__pyx_type_11sat_toolkit_7formula___pyx_scope_struct_2___iter___spec, __pyx_ptype_11sat_toolkit_7formula___pyx_scope_struct_2___iter__) < 0) __PYX_ERR(0, 512, __pyx_L1_error)
+  __pyx_ptype_11sat_toolkit_7formula___pyx_scope_struct_2___iter__ = (PyTypeObject *) __Pyx_PyType_FromModuleAndSpec(__pyx_m, &__pyx_type_11sat_toolkit_7formula___pyx_scope_struct_2___iter___spec, NULL); if (unlikely(!__pyx_ptype_11sat_toolkit_7formula___pyx_scope_struct_2___iter__)) __PYX_ERR(0, 519, __pyx_L1_error)
+  if (__Pyx_fix_up_extension_type_from_spec(&__pyx_type_11sat_toolkit_7formula___pyx_scope_struct_2___iter___spec, __pyx_ptype_11sat_toolkit_7formula___pyx_scope_struct_2___iter__) < 0) __PYX_ERR(0, 519, __pyx_L1_error)
   #else
   __pyx_ptype_11sat_toolkit_7formula___pyx_scope_struct_2___iter__ = &__pyx_type_11sat_toolkit_7formula___pyx_scope_struct_2___iter__;
   #endif
   #if !CYTHON_COMPILING_IN_LIMITED_API
   #endif
   #if !CYTHON_USE_TYPE_SPECS
-  if (__Pyx_PyType_Ready(__pyx_ptype_11sat_toolkit_7formula___pyx_scope_struct_2___iter__) < 0) __PYX_ERR(0, 512, __pyx_L1_error)
+  if (__Pyx_PyType_Ready(__pyx_ptype_11sat_toolkit_7formula___pyx_scope_struct_2___iter__) < 0) __PYX_ERR(0, 519, __pyx_L1_error)
   #endif
   #if PY_MAJOR_VERSION < 3
   __pyx_ptype_11sat_toolkit_7formula___pyx_scope_struct_2___iter__->tp_print = 0;
   #endif
   #if !CYTHON_COMPILING_IN_LIMITED_API
   if ((CYTHON_USE_TYPE_SLOTS && CYTHON_USE_PYTYPE_LOOKUP) && likely(!__pyx_ptype_11sat_toolkit_7formula___pyx_scope_struct_2___iter__->tp_dictoffset && __pyx_ptype_11sat_toolkit_7formula___pyx_scope_struct_2___iter__->tp_getattro == PyObject_GenericGetAttr)) {
     __pyx_ptype_11sat_toolkit_7formula___pyx_scope_struct_2___iter__->tp_getattro = __Pyx_PyObject_GenericGetAttrNoDict;
   }
   #endif
   #if CYTHON_USE_TYPE_SPECS
-  __pyx_ptype_11sat_toolkit_7formula___pyx_scope_struct_3___reversed__ = (PyTypeObject *) __Pyx_PyType_FromModuleAndSpec(__pyx_m, &__pyx_type_11sat_toolkit_7formula___pyx_scope_struct_3___reversed___spec, NULL); if (unlikely(!__pyx_ptype_11sat_toolkit_7formula___pyx_scope_struct_3___reversed__)) __PYX_ERR(0, 519, __pyx_L1_error)
-  if (__Pyx_fix_up_extension_type_from_spec(&__pyx_type_11sat_toolkit_7formula___pyx_scope_struct_3___reversed___spec, __pyx_ptype_11sat_toolkit_7formula___pyx_scope_struct_3___reversed__) < 0) __PYX_ERR(0, 519, __pyx_L1_error)
+  __pyx_ptype_11sat_toolkit_7formula___pyx_scope_struct_3___reversed__ = (PyTypeObject *) __Pyx_PyType_FromModuleAndSpec(__pyx_m, &__pyx_type_11sat_toolkit_7formula___pyx_scope_struct_3___reversed___spec, NULL); if (unlikely(!__pyx_ptype_11sat_toolkit_7formula___pyx_scope_struct_3___reversed__)) __PYX_ERR(0, 526, __pyx_L1_error)
+  if (__Pyx_fix_up_extension_type_from_spec(&__pyx_type_11sat_toolkit_7formula___pyx_scope_struct_3___reversed___spec, __pyx_ptype_11sat_toolkit_7formula___pyx_scope_struct_3___reversed__) < 0) __PYX_ERR(0, 526, __pyx_L1_error)
   #else
   __pyx_ptype_11sat_toolkit_7formula___pyx_scope_struct_3___reversed__ = &__pyx_type_11sat_toolkit_7formula___pyx_scope_struct_3___reversed__;
   #endif
   #if !CYTHON_COMPILING_IN_LIMITED_API
   #endif
   #if !CYTHON_USE_TYPE_SPECS
-  if (__Pyx_PyType_Ready(__pyx_ptype_11sat_toolkit_7formula___pyx_scope_struct_3___reversed__) < 0) __PYX_ERR(0, 519, __pyx_L1_error)
+  if (__Pyx_PyType_Ready(__pyx_ptype_11sat_toolkit_7formula___pyx_scope_struct_3___reversed__) < 0) __PYX_ERR(0, 526, __pyx_L1_error)
   #endif
   #if PY_MAJOR_VERSION < 3
   __pyx_ptype_11sat_toolkit_7formula___pyx_scope_struct_3___reversed__->tp_print = 0;
   #endif
   #if !CYTHON_COMPILING_IN_LIMITED_API
   if ((CYTHON_USE_TYPE_SLOTS && CYTHON_USE_PYTYPE_LOOKUP) && likely(!__pyx_ptype_11sat_toolkit_7formula___pyx_scope_struct_3___reversed__->tp_dictoffset && __pyx_ptype_11sat_toolkit_7formula___pyx_scope_struct_3___reversed__->tp_getattro == PyObject_GenericGetAttr)) {
     __pyx_ptype_11sat_toolkit_7formula___pyx_scope_struct_3___reversed__->tp_getattro = __Pyx_PyObject_GenericGetAttrNoDict;
@@ -61903,31 +62052,31 @@
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("__Pyx_modinit_type_import_code", 0);
   /*--- Type import code ---*/
   __pyx_t_1 = PyImport_ImportModule(__Pyx_BUILTIN_MODULE_NAME); if (unlikely(!__pyx_t_1)) __PYX_ERR(3, 9, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_ptype_7cpython_4type_type = __Pyx_ImportType_3_0_9(__pyx_t_1, __Pyx_BUILTIN_MODULE_NAME, "type", 
+  __pyx_ptype_7cpython_4type_type = __Pyx_ImportType_3_0_10(__pyx_t_1, __Pyx_BUILTIN_MODULE_NAME, "type", 
   #if defined(PYPY_VERSION_NUM) && PYPY_VERSION_NUM < 0x050B0000
-  sizeof(PyTypeObject), __PYX_GET_STRUCT_ALIGNMENT_3_0_9(PyTypeObject),
+  sizeof(PyTypeObject), __PYX_GET_STRUCT_ALIGNMENT_3_0_10(PyTypeObject),
   #elif CYTHON_COMPILING_IN_LIMITED_API
-  sizeof(PyTypeObject), __PYX_GET_STRUCT_ALIGNMENT_3_0_9(PyTypeObject),
+  sizeof(PyTypeObject), __PYX_GET_STRUCT_ALIGNMENT_3_0_10(PyTypeObject),
   #else
-  sizeof(PyHeapTypeObject), __PYX_GET_STRUCT_ALIGNMENT_3_0_9(PyHeapTypeObject),
+  sizeof(PyHeapTypeObject), __PYX_GET_STRUCT_ALIGNMENT_3_0_10(PyHeapTypeObject),
   #endif
-  __Pyx_ImportType_CheckSize_Warn_3_0_9); if (!__pyx_ptype_7cpython_4type_type) __PYX_ERR(3, 9, __pyx_L1_error)
+  __Pyx_ImportType_CheckSize_Warn_3_0_10); if (!__pyx_ptype_7cpython_4type_type) __PYX_ERR(3, 9, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __pyx_t_1 = PyImport_ImportModule(__Pyx_BUILTIN_MODULE_NAME); if (unlikely(!__pyx_t_1)) __PYX_ERR(4, 8, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_ptype_7cpython_4bool_bool = __Pyx_ImportType_3_0_9(__pyx_t_1, __Pyx_BUILTIN_MODULE_NAME, "bool", sizeof(PyBoolObject), __PYX_GET_STRUCT_ALIGNMENT_3_0_9(PyBoolObject),__Pyx_ImportType_CheckSize_Warn_3_0_9); if (!__pyx_ptype_7cpython_4bool_bool) __PYX_ERR(4, 8, __pyx_L1_error)
+  __pyx_ptype_7cpython_4bool_bool = __Pyx_ImportType_3_0_10(__pyx_t_1, __Pyx_BUILTIN_MODULE_NAME, "bool", sizeof(PyBoolObject), __PYX_GET_STRUCT_ALIGNMENT_3_0_10(PyBoolObject),__Pyx_ImportType_CheckSize_Warn_3_0_10); if (!__pyx_ptype_7cpython_4bool_bool) __PYX_ERR(4, 8, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __pyx_t_1 = PyImport_ImportModule(__Pyx_BUILTIN_MODULE_NAME); if (unlikely(!__pyx_t_1)) __PYX_ERR(5, 15, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_ptype_7cpython_7complex_complex = __Pyx_ImportType_3_0_9(__pyx_t_1, __Pyx_BUILTIN_MODULE_NAME, "complex", sizeof(PyComplexObject), __PYX_GET_STRUCT_ALIGNMENT_3_0_9(PyComplexObject),__Pyx_ImportType_CheckSize_Warn_3_0_9); if (!__pyx_ptype_7cpython_7complex_complex) __PYX_ERR(5, 15, __pyx_L1_error)
+  __pyx_ptype_7cpython_7complex_complex = __Pyx_ImportType_3_0_10(__pyx_t_1, __Pyx_BUILTIN_MODULE_NAME, "complex", sizeof(PyComplexObject), __PYX_GET_STRUCT_ALIGNMENT_3_0_10(PyComplexObject),__Pyx_ImportType_CheckSize_Warn_3_0_10); if (!__pyx_ptype_7cpython_7complex_complex) __PYX_ERR(5, 15, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __Pyx_RefNannyFinishContext();
   return 0;
   __pyx_L1_error:;
   __Pyx_XDECREF(__pyx_t_1);
   __Pyx_RefNannyFinishContext();
   return -1;
@@ -63048,1059 +63197,1059 @@
   __Pyx_GOTREF(__pyx_t_7);
   __Pyx_CyFunction_SetAnnotationsDict(__pyx_t_7, __pyx_t_4);
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
   if (__Pyx_SetItemOnTypeDict((PyObject *)__pyx_ptype_11sat_toolkit_7formula__ClauseList, __pyx_n_s_partition, __pyx_t_7) < 0) __PYX_ERR(0, 309, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
   PyType_Modified(__pyx_ptype_11sat_toolkit_7formula__ClauseList);
 
-  /* "sat_toolkit/formula.pyx":438
+  /* "sat_toolkit/formula.pyx":445
  * 
  * 
  *     def add_clauses(self, clauses) -> None:             # <<<<<<<<<<<<<<
  *         cdef _ClauseList c_clauses = None
  * 
  */
-  __pyx_t_7 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 438, __pyx_L1_error)
+  __pyx_t_7 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 445, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_7);
-  if (PyDict_SetItem(__pyx_t_7, __pyx_n_s_return, __pyx_n_s_None) < 0) __PYX_ERR(0, 438, __pyx_L1_error)
-  __pyx_t_4 = __Pyx_CyFunction_New(&__pyx_mdef_11sat_toolkit_7formula_11_ClauseList_11add_clauses, __Pyx_CYFUNCTION_CCLASS, __pyx_n_s_ClauseList_add_clauses, NULL, __pyx_n_s_sat_toolkit_formula, __pyx_d, ((PyObject *)__pyx_codeobj__97)); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 438, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_7, __pyx_n_s_return, __pyx_n_s_None) < 0) __PYX_ERR(0, 445, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_CyFunction_New(&__pyx_mdef_11sat_toolkit_7formula_11_ClauseList_11add_clauses, __Pyx_CYFUNCTION_CCLASS, __pyx_n_s_ClauseList_add_clauses, NULL, __pyx_n_s_sat_toolkit_formula, __pyx_d, ((PyObject *)__pyx_codeobj__97)); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 445, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __Pyx_CyFunction_SetAnnotationsDict(__pyx_t_4, __pyx_t_7);
   __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-  if (__Pyx_SetItemOnTypeDict((PyObject *)__pyx_ptype_11sat_toolkit_7formula__ClauseList, __pyx_n_s_add_clauses, __pyx_t_4) < 0) __PYX_ERR(0, 438, __pyx_L1_error)
+  if (__Pyx_SetItemOnTypeDict((PyObject *)__pyx_ptype_11sat_toolkit_7formula__ClauseList, __pyx_n_s_add_clauses, __pyx_t_4) < 0) __PYX_ERR(0, 445, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
   PyType_Modified(__pyx_ptype_11sat_toolkit_7formula__ClauseList);
 
-  /* "sat_toolkit/formula.pyx":463
+  /* "sat_toolkit/formula.pyx":470
  *                 self.nvars = c_clauses.nvars
  * 
  *     def add_clause(self, clause) -> None:             # <<<<<<<<<<<<<<
  *         """Add a single clause to CNF formula. Specify the clause without trailing 0."""
  * 
  */
-  __pyx_t_4 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 463, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 470, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
-  if (PyDict_SetItem(__pyx_t_4, __pyx_n_s_return, __pyx_n_s_None) < 0) __PYX_ERR(0, 463, __pyx_L1_error)
-  __pyx_t_7 = __Pyx_CyFunction_New(&__pyx_mdef_11sat_toolkit_7formula_11_ClauseList_13add_clause, __Pyx_CYFUNCTION_CCLASS, __pyx_n_s_ClauseList_add_clause, NULL, __pyx_n_s_sat_toolkit_formula, __pyx_d, ((PyObject *)__pyx_codeobj__99)); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 463, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_4, __pyx_n_s_return, __pyx_n_s_None) < 0) __PYX_ERR(0, 470, __pyx_L1_error)
+  __pyx_t_7 = __Pyx_CyFunction_New(&__pyx_mdef_11sat_toolkit_7formula_11_ClauseList_13add_clause, __Pyx_CYFUNCTION_CCLASS, __pyx_n_s_ClauseList_add_clause, NULL, __pyx_n_s_sat_toolkit_formula, __pyx_d, ((PyObject *)__pyx_codeobj__99)); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 470, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_7);
   __Pyx_CyFunction_SetAnnotationsDict(__pyx_t_7, __pyx_t_4);
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-  if (__Pyx_SetItemOnTypeDict((PyObject *)__pyx_ptype_11sat_toolkit_7formula__ClauseList, __pyx_n_s_add_clause, __pyx_t_7) < 0) __PYX_ERR(0, 463, __pyx_L1_error)
+  if (__Pyx_SetItemOnTypeDict((PyObject *)__pyx_ptype_11sat_toolkit_7formula__ClauseList, __pyx_n_s_add_clause, __pyx_t_7) < 0) __PYX_ERR(0, 470, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
   PyType_Modified(__pyx_ptype_11sat_toolkit_7formula__ClauseList);
 
-  /* "sat_toolkit/formula.pyx":476
+  /* "sat_toolkit/formula.pyx":483
  *         self._add_clauses(np_clause)
  * 
  *     append = add_clause             # <<<<<<<<<<<<<<
  * 
  *     def __iadd__(self, clauses) -> Self:
  */
-  __Pyx_GetNameInClass(__pyx_t_7, (PyObject *)__pyx_ptype_11sat_toolkit_7formula__ClauseList, __pyx_n_s_add_clause); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 476, __pyx_L1_error)
+  __Pyx_GetNameInClass(__pyx_t_7, (PyObject *)__pyx_ptype_11sat_toolkit_7formula__ClauseList, __pyx_n_s_add_clause); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 483, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_7);
-  if (__Pyx_SetItemOnTypeDict((PyObject *)__pyx_ptype_11sat_toolkit_7formula__ClauseList, __pyx_n_s_append, __pyx_t_7) < 0) __PYX_ERR(0, 476, __pyx_L1_error)
+  if (__Pyx_SetItemOnTypeDict((PyObject *)__pyx_ptype_11sat_toolkit_7formula__ClauseList, __pyx_n_s_append, __pyx_t_7) < 0) __PYX_ERR(0, 483, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
   PyType_Modified(__pyx_ptype_11sat_toolkit_7formula__ClauseList);
 
-  /* "sat_toolkit/formula.pyx":519
+  /* "sat_toolkit/formula.pyx":526
  * 
  * 
  *     def __reversed__(self) -> Iterable[Clause]:             # <<<<<<<<<<<<<<
  *         cdef size_t i
  *         for i in reversed(range(self._start_indices.size())):
  */
-  __pyx_t_7 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 519, __pyx_L1_error)
+  __pyx_t_7 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 526, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_7);
-  if (PyDict_SetItem(__pyx_t_7, __pyx_n_s_return, __pyx_kp_s_Iterable_Clause) < 0) __PYX_ERR(0, 519, __pyx_L1_error)
-  __pyx_t_4 = __Pyx_CyFunction_New(&__pyx_mdef_11sat_toolkit_7formula_11_ClauseList_26__reversed__, __Pyx_CYFUNCTION_CCLASS, __pyx_n_s_ClauseList___reversed, NULL, __pyx_n_s_sat_toolkit_formula, __pyx_d, ((PyObject *)__pyx_codeobj__25)); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 519, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_7, __pyx_n_s_return, __pyx_kp_s_Iterable_Clause) < 0) __PYX_ERR(0, 526, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_CyFunction_New(&__pyx_mdef_11sat_toolkit_7formula_11_ClauseList_26__reversed__, __Pyx_CYFUNCTION_CCLASS, __pyx_n_s_ClauseList___reversed, NULL, __pyx_n_s_sat_toolkit_formula, __pyx_d, ((PyObject *)__pyx_codeobj__25)); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 526, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __Pyx_CyFunction_SetAnnotationsDict(__pyx_t_4, __pyx_t_7);
   __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-  if (__Pyx_SetItemOnTypeDict((PyObject *)__pyx_ptype_11sat_toolkit_7formula__ClauseList, __pyx_n_s_reversed_2, __pyx_t_4) < 0) __PYX_ERR(0, 519, __pyx_L1_error)
+  if (__Pyx_SetItemOnTypeDict((PyObject *)__pyx_ptype_11sat_toolkit_7formula__ClauseList, __pyx_n_s_reversed_2, __pyx_t_4) < 0) __PYX_ERR(0, 526, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
   PyType_Modified(__pyx_ptype_11sat_toolkit_7formula__ClauseList);
 
-  /* "sat_toolkit/formula.pyx":576
+  /* "sat_toolkit/formula.pyx":583
  *                     return True
  * 
  *     def count(self, needle) -> bool:             # <<<<<<<<<<<<<<
  *         if not self._check_clause_type(needle):
  *             return False
  */
-  __pyx_t_4 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 576, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 583, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
-  if (PyDict_SetItem(__pyx_t_4, __pyx_n_s_return, __pyx_n_s_bool) < 0) __PYX_ERR(0, 576, __pyx_L1_error)
-  __pyx_t_7 = __Pyx_CyFunction_New(&__pyx_mdef_11sat_toolkit_7formula_11_ClauseList_33count, __Pyx_CYFUNCTION_CCLASS, __pyx_n_s_ClauseList_count, NULL, __pyx_n_s_sat_toolkit_formula, __pyx_d, ((PyObject *)__pyx_codeobj__101)); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 576, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_4, __pyx_n_s_return, __pyx_n_s_bool) < 0) __PYX_ERR(0, 583, __pyx_L1_error)
+  __pyx_t_7 = __Pyx_CyFunction_New(&__pyx_mdef_11sat_toolkit_7formula_11_ClauseList_33count, __Pyx_CYFUNCTION_CCLASS, __pyx_n_s_ClauseList_count, NULL, __pyx_n_s_sat_toolkit_formula, __pyx_d, ((PyObject *)__pyx_codeobj__101)); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 583, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_7);
   __Pyx_CyFunction_SetAnnotationsDict(__pyx_t_7, __pyx_t_4);
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-  if (__Pyx_SetItemOnTypeDict((PyObject *)__pyx_ptype_11sat_toolkit_7formula__ClauseList, __pyx_n_s_count, __pyx_t_7) < 0) __PYX_ERR(0, 576, __pyx_L1_error)
+  if (__Pyx_SetItemOnTypeDict((PyObject *)__pyx_ptype_11sat_toolkit_7formula__ClauseList, __pyx_n_s_count, __pyx_t_7) < 0) __PYX_ERR(0, 583, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
   PyType_Modified(__pyx_ptype_11sat_toolkit_7formula__ClauseList);
 
-  /* "sat_toolkit/formula.pyx":600
+  /* "sat_toolkit/formula.pyx":607
  *         return <size_t> idx
  * 
  *     def index(self, needle, start=None, end=None) -> int:             # <<<<<<<<<<<<<<
  *         """
  *         Return zero-based index in the list of the first item whose value is
  */
-  __pyx_t_7 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 600, __pyx_L1_error)
+  __pyx_t_7 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 607, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_7);
-  if (PyDict_SetItem(__pyx_t_7, __pyx_n_s_return, __pyx_n_s_int) < 0) __PYX_ERR(0, 600, __pyx_L1_error)
-  __pyx_t_4 = __Pyx_CyFunction_New(&__pyx_mdef_11sat_toolkit_7formula_11_ClauseList_35index, __Pyx_CYFUNCTION_CCLASS, __pyx_n_s_ClauseList_index, NULL, __pyx_n_s_sat_toolkit_formula, __pyx_d, ((PyObject *)__pyx_codeobj__103)); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 600, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_7, __pyx_n_s_return, __pyx_n_s_int) < 0) __PYX_ERR(0, 607, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_CyFunction_New(&__pyx_mdef_11sat_toolkit_7formula_11_ClauseList_35index, __Pyx_CYFUNCTION_CCLASS, __pyx_n_s_ClauseList_index, NULL, __pyx_n_s_sat_toolkit_formula, __pyx_d, ((PyObject *)__pyx_codeobj__103)); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 607, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __Pyx_CyFunction_SetDefaultsTuple(__pyx_t_4, __pyx_tuple__82);
   __Pyx_CyFunction_SetAnnotationsDict(__pyx_t_4, __pyx_t_7);
   __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-  if (__Pyx_SetItemOnTypeDict((PyObject *)__pyx_ptype_11sat_toolkit_7formula__ClauseList, __pyx_n_s_index, __pyx_t_4) < 0) __PYX_ERR(0, 600, __pyx_L1_error)
+  if (__Pyx_SetItemOnTypeDict((PyObject *)__pyx_ptype_11sat_toolkit_7formula__ClauseList, __pyx_n_s_index, __pyx_t_4) < 0) __PYX_ERR(0, 607, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
   PyType_Modified(__pyx_ptype_11sat_toolkit_7formula__ClauseList);
 
-  /* "sat_toolkit/formula.pyx":628
+  /* "sat_toolkit/formula.pyx":635
  * 
  *     # pickle support
  *     def __reduce__(self):             # <<<<<<<<<<<<<<
  *         return type(self), (np.array(self), self.nvars)
  * 
  */
-  __pyx_t_4 = __Pyx_CyFunction_New(&__pyx_mdef_11sat_toolkit_7formula_11_ClauseList_37__reduce__, __Pyx_CYFUNCTION_CCLASS, __pyx_n_s_ClauseList___reduce, NULL, __pyx_n_s_sat_toolkit_formula, __pyx_d, ((PyObject *)__pyx_codeobj__104)); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 628, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_CyFunction_New(&__pyx_mdef_11sat_toolkit_7formula_11_ClauseList_37__reduce__, __Pyx_CYFUNCTION_CCLASS, __pyx_n_s_ClauseList___reduce, NULL, __pyx_n_s_sat_toolkit_formula, __pyx_d, ((PyObject *)__pyx_codeobj__104)); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 635, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
-  if (__Pyx_SetItemOnTypeDict((PyObject *)__pyx_ptype_11sat_toolkit_7formula__ClauseList, __pyx_n_s_reduce, __pyx_t_4) < 0) __PYX_ERR(0, 628, __pyx_L1_error)
+  if (__Pyx_SetItemOnTypeDict((PyObject *)__pyx_ptype_11sat_toolkit_7formula__ClauseList, __pyx_n_s_reduce, __pyx_t_4) < 0) __PYX_ERR(0, 635, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
   PyType_Modified(__pyx_ptype_11sat_toolkit_7formula__ClauseList);
 
-  /* "sat_toolkit/formula.pyx":684
+  /* "sat_toolkit/formula.pyx":691
  *     """
  * 
  *     @staticmethod             # <<<<<<<<<<<<<<
  *     def from_dimacs(dimacs: str) -> CNF:
  *         cdef XorCNF tmp = XorCNF.from_dimacs(dimacs)
  */
-  __pyx_t_4 = __Pyx_PyDict_NewPresized(2); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 684, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyDict_NewPresized(2); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 691, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
-  if (PyDict_SetItem(__pyx_t_4, __pyx_n_s_dimacs, __pyx_n_s_str) < 0) __PYX_ERR(0, 684, __pyx_L1_error)
-  if (PyDict_SetItem(__pyx_t_4, __pyx_n_s_return, __pyx_n_s_CNF) < 0) __PYX_ERR(0, 684, __pyx_L1_error)
-  __pyx_t_7 = __Pyx_CyFunction_New(&__pyx_mdef_11sat_toolkit_7formula_3CNF_1from_dimacs, __Pyx_CYFUNCTION_STATICMETHOD | __Pyx_CYFUNCTION_CCLASS, __pyx_n_s_CNF_from_dimacs, NULL, __pyx_n_s_sat_toolkit_formula, __pyx_d, ((PyObject *)__pyx_codeobj__106)); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 684, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_4, __pyx_n_s_dimacs, __pyx_n_s_str) < 0) __PYX_ERR(0, 691, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_4, __pyx_n_s_return, __pyx_n_s_CNF) < 0) __PYX_ERR(0, 691, __pyx_L1_error)
+  __pyx_t_7 = __Pyx_CyFunction_New(&__pyx_mdef_11sat_toolkit_7formula_3CNF_1from_dimacs, __Pyx_CYFUNCTION_STATICMETHOD | __Pyx_CYFUNCTION_CCLASS, __pyx_n_s_CNF_from_dimacs, NULL, __pyx_n_s_sat_toolkit_formula, __pyx_d, ((PyObject *)__pyx_codeobj__106)); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 691, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_7);
   __Pyx_CyFunction_SetAnnotationsDict(__pyx_t_7, __pyx_t_4);
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-  if (__Pyx_SetItemOnTypeDict((PyObject *)__pyx_ptype_11sat_toolkit_7formula_CNF, __pyx_n_s_from_dimacs, __pyx_t_7) < 0) __PYX_ERR(0, 684, __pyx_L1_error)
+  if (__Pyx_SetItemOnTypeDict((PyObject *)__pyx_ptype_11sat_toolkit_7formula_CNF, __pyx_n_s_from_dimacs, __pyx_t_7) < 0) __PYX_ERR(0, 691, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
   PyType_Modified(__pyx_ptype_11sat_toolkit_7formula_CNF);
-  __Pyx_GetNameInClass(__pyx_t_7, (PyObject *)__pyx_ptype_11sat_toolkit_7formula_CNF, __pyx_n_s_from_dimacs); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 684, __pyx_L1_error)
+  __Pyx_GetNameInClass(__pyx_t_7, (PyObject *)__pyx_ptype_11sat_toolkit_7formula_CNF, __pyx_n_s_from_dimacs); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 691, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_7);
-  __pyx_t_4 = __Pyx_PyObject_CallOneArg(__pyx_builtin_staticmethod, __pyx_t_7); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 684, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyObject_CallOneArg(__pyx_builtin_staticmethod, __pyx_t_7); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 691, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-  if (__Pyx_SetItemOnTypeDict((PyObject *)__pyx_ptype_11sat_toolkit_7formula_CNF, __pyx_n_s_from_dimacs, __pyx_t_4) < 0) __PYX_ERR(0, 684, __pyx_L1_error)
+  if (__Pyx_SetItemOnTypeDict((PyObject *)__pyx_ptype_11sat_toolkit_7formula_CNF, __pyx_n_s_from_dimacs, __pyx_t_4) < 0) __PYX_ERR(0, 691, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
   PyType_Modified(__pyx_ptype_11sat_toolkit_7formula_CNF);
 
-  /* "sat_toolkit/formula.pyx":692
+  /* "sat_toolkit/formula.pyx":699
  *         return tmp._clauses
  * 
  *     @staticmethod             # <<<<<<<<<<<<<<
  *     def from_espresso(espresso: str) -> CNF:
  *         cdef vector[int] clauses
  */
-  __pyx_t_4 = __Pyx_PyDict_NewPresized(2); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 692, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyDict_NewPresized(2); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 699, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
-  if (PyDict_SetItem(__pyx_t_4, __pyx_n_s_espresso, __pyx_n_s_str) < 0) __PYX_ERR(0, 692, __pyx_L1_error)
-  if (PyDict_SetItem(__pyx_t_4, __pyx_n_s_return, __pyx_n_s_CNF) < 0) __PYX_ERR(0, 692, __pyx_L1_error)
-  __pyx_t_7 = __Pyx_CyFunction_New(&__pyx_mdef_11sat_toolkit_7formula_3CNF_3from_espresso, __Pyx_CYFUNCTION_STATICMETHOD | __Pyx_CYFUNCTION_CCLASS, __pyx_n_s_CNF_from_espresso, NULL, __pyx_n_s_sat_toolkit_formula, __pyx_d, ((PyObject *)__pyx_codeobj__109)); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 692, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_4, __pyx_n_s_espresso, __pyx_n_s_str) < 0) __PYX_ERR(0, 699, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_4, __pyx_n_s_return, __pyx_n_s_CNF) < 0) __PYX_ERR(0, 699, __pyx_L1_error)
+  __pyx_t_7 = __Pyx_CyFunction_New(&__pyx_mdef_11sat_toolkit_7formula_3CNF_3from_espresso, __Pyx_CYFUNCTION_STATICMETHOD | __Pyx_CYFUNCTION_CCLASS, __pyx_n_s_CNF_from_espresso, NULL, __pyx_n_s_sat_toolkit_formula, __pyx_d, ((PyObject *)__pyx_codeobj__109)); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 699, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_7);
   __Pyx_CyFunction_SetAnnotationsDict(__pyx_t_7, __pyx_t_4);
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-  if (__Pyx_SetItemOnTypeDict((PyObject *)__pyx_ptype_11sat_toolkit_7formula_CNF, __pyx_n_s_from_espresso, __pyx_t_7) < 0) __PYX_ERR(0, 692, __pyx_L1_error)
+  if (__Pyx_SetItemOnTypeDict((PyObject *)__pyx_ptype_11sat_toolkit_7formula_CNF, __pyx_n_s_from_espresso, __pyx_t_7) < 0) __PYX_ERR(0, 699, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
   PyType_Modified(__pyx_ptype_11sat_toolkit_7formula_CNF);
-  __Pyx_GetNameInClass(__pyx_t_7, (PyObject *)__pyx_ptype_11sat_toolkit_7formula_CNF, __pyx_n_s_from_espresso); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 692, __pyx_L1_error)
+  __Pyx_GetNameInClass(__pyx_t_7, (PyObject *)__pyx_ptype_11sat_toolkit_7formula_CNF, __pyx_n_s_from_espresso); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 699, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_7);
-  __pyx_t_4 = __Pyx_PyObject_CallOneArg(__pyx_builtin_staticmethod, __pyx_t_7); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 692, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyObject_CallOneArg(__pyx_builtin_staticmethod, __pyx_t_7); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 699, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-  if (__Pyx_SetItemOnTypeDict((PyObject *)__pyx_ptype_11sat_toolkit_7formula_CNF, __pyx_n_s_from_espresso, __pyx_t_4) < 0) __PYX_ERR(0, 692, __pyx_L1_error)
+  if (__Pyx_SetItemOnTypeDict((PyObject *)__pyx_ptype_11sat_toolkit_7formula_CNF, __pyx_n_s_from_espresso, __pyx_t_4) < 0) __PYX_ERR(0, 699, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
   PyType_Modified(__pyx_ptype_11sat_toolkit_7formula_CNF);
 
-  /* "sat_toolkit/formula.pyx":744
+  /* "sat_toolkit/formula.pyx":751
  *         return res
  * 
  *     @staticmethod             # <<<<<<<<<<<<<<
  *     def create_all_zero(indices) -> CNF:
  *         """
  */
-  __pyx_t_4 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 744, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 751, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
-  if (PyDict_SetItem(__pyx_t_4, __pyx_n_s_return, __pyx_n_s_CNF) < 0) __PYX_ERR(0, 744, __pyx_L1_error)
-  __pyx_t_7 = __Pyx_CyFunction_New(&__pyx_mdef_11sat_toolkit_7formula_3CNF_5create_all_zero, __Pyx_CYFUNCTION_STATICMETHOD | __Pyx_CYFUNCTION_CCLASS, __pyx_n_s_CNF_create_all_zero, NULL, __pyx_n_s_sat_toolkit_formula, __pyx_d, ((PyObject *)__pyx_codeobj__111)); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 744, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_4, __pyx_n_s_return, __pyx_n_s_CNF) < 0) __PYX_ERR(0, 751, __pyx_L1_error)
+  __pyx_t_7 = __Pyx_CyFunction_New(&__pyx_mdef_11sat_toolkit_7formula_3CNF_5create_all_zero, __Pyx_CYFUNCTION_STATICMETHOD | __Pyx_CYFUNCTION_CCLASS, __pyx_n_s_CNF_create_all_zero, NULL, __pyx_n_s_sat_toolkit_formula, __pyx_d, ((PyObject *)__pyx_codeobj__111)); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 751, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_7);
   __Pyx_CyFunction_SetAnnotationsDict(__pyx_t_7, __pyx_t_4);
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-  if (__Pyx_SetItemOnTypeDict((PyObject *)__pyx_ptype_11sat_toolkit_7formula_CNF, __pyx_n_s_create_all_zero_2, __pyx_t_7) < 0) __PYX_ERR(0, 744, __pyx_L1_error)
+  if (__Pyx_SetItemOnTypeDict((PyObject *)__pyx_ptype_11sat_toolkit_7formula_CNF, __pyx_n_s_create_all_zero_2, __pyx_t_7) < 0) __PYX_ERR(0, 751, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
   PyType_Modified(__pyx_ptype_11sat_toolkit_7formula_CNF);
-  __Pyx_GetNameInClass(__pyx_t_7, (PyObject *)__pyx_ptype_11sat_toolkit_7formula_CNF, __pyx_n_s_create_all_zero_2); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 744, __pyx_L1_error)
+  __Pyx_GetNameInClass(__pyx_t_7, (PyObject *)__pyx_ptype_11sat_toolkit_7formula_CNF, __pyx_n_s_create_all_zero_2); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 751, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_7);
-  __pyx_t_4 = __Pyx_PyObject_CallOneArg(__pyx_builtin_staticmethod, __pyx_t_7); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 744, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyObject_CallOneArg(__pyx_builtin_staticmethod, __pyx_t_7); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 751, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-  if (__Pyx_SetItemOnTypeDict((PyObject *)__pyx_ptype_11sat_toolkit_7formula_CNF, __pyx_n_s_create_all_zero_2, __pyx_t_4) < 0) __PYX_ERR(0, 744, __pyx_L1_error)
+  if (__Pyx_SetItemOnTypeDict((PyObject *)__pyx_ptype_11sat_toolkit_7formula_CNF, __pyx_n_s_create_all_zero_2, __pyx_t_4) < 0) __PYX_ERR(0, 751, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
   PyType_Modified(__pyx_ptype_11sat_toolkit_7formula_CNF);
 
-  /* "sat_toolkit/formula.pyx":753
+  /* "sat_toolkit/formula.pyx":760
  *         return CNF._create_all_zero(indices)
  * 
  *     @staticmethod             # <<<<<<<<<<<<<<
  *     def _create_all_zero(const int[:] indices not None) -> CNF:
  *         cdef vector[int] clauses
  */
-  __pyx_t_4 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 753, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 760, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
-  if (PyDict_SetItem(__pyx_t_4, __pyx_n_s_return, __pyx_n_s_CNF) < 0) __PYX_ERR(0, 753, __pyx_L1_error)
-  __pyx_t_7 = __Pyx_CyFunction_New(&__pyx_mdef_11sat_toolkit_7formula_3CNF_7_create_all_zero, __Pyx_CYFUNCTION_STATICMETHOD | __Pyx_CYFUNCTION_CCLASS, __pyx_n_s_CNF__create_all_zero, NULL, __pyx_n_s_sat_toolkit_formula, __pyx_d, ((PyObject *)__pyx_codeobj__113)); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 753, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_4, __pyx_n_s_return, __pyx_n_s_CNF) < 0) __PYX_ERR(0, 760, __pyx_L1_error)
+  __pyx_t_7 = __Pyx_CyFunction_New(&__pyx_mdef_11sat_toolkit_7formula_3CNF_7_create_all_zero, __Pyx_CYFUNCTION_STATICMETHOD | __Pyx_CYFUNCTION_CCLASS, __pyx_n_s_CNF__create_all_zero, NULL, __pyx_n_s_sat_toolkit_formula, __pyx_d, ((PyObject *)__pyx_codeobj__113)); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 760, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_7);
   __Pyx_CyFunction_SetAnnotationsDict(__pyx_t_7, __pyx_t_4);
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-  if (__Pyx_SetItemOnTypeDict((PyObject *)__pyx_ptype_11sat_toolkit_7formula_CNF, __pyx_n_s_create_all_zero, __pyx_t_7) < 0) __PYX_ERR(0, 753, __pyx_L1_error)
+  if (__Pyx_SetItemOnTypeDict((PyObject *)__pyx_ptype_11sat_toolkit_7formula_CNF, __pyx_n_s_create_all_zero, __pyx_t_7) < 0) __PYX_ERR(0, 760, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
   PyType_Modified(__pyx_ptype_11sat_toolkit_7formula_CNF);
-  __Pyx_GetNameInClass(__pyx_t_7, (PyObject *)__pyx_ptype_11sat_toolkit_7formula_CNF, __pyx_n_s_create_all_zero); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 753, __pyx_L1_error)
+  __Pyx_GetNameInClass(__pyx_t_7, (PyObject *)__pyx_ptype_11sat_toolkit_7formula_CNF, __pyx_n_s_create_all_zero); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 760, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_7);
-  __pyx_t_4 = __Pyx_PyObject_CallOneArg(__pyx_builtin_staticmethod, __pyx_t_7); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 753, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyObject_CallOneArg(__pyx_builtin_staticmethod, __pyx_t_7); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 760, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-  if (__Pyx_SetItemOnTypeDict((PyObject *)__pyx_ptype_11sat_toolkit_7formula_CNF, __pyx_n_s_create_all_zero, __pyx_t_4) < 0) __PYX_ERR(0, 753, __pyx_L1_error)
+  if (__Pyx_SetItemOnTypeDict((PyObject *)__pyx_ptype_11sat_toolkit_7formula_CNF, __pyx_n_s_create_all_zero, __pyx_t_4) < 0) __PYX_ERR(0, 760, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
   PyType_Modified(__pyx_ptype_11sat_toolkit_7formula_CNF);
 
-  /* "sat_toolkit/formula.pyx":774
+  /* "sat_toolkit/formula.pyx":781
  *         return res
  * 
  *     @staticmethod             # <<<<<<<<<<<<<<
  *     def create_all_equal(lhs, rhs) -> CNF:
  *         "creates a CNF that asserts lhs[i] == rhs[i] for all i."
  */
-  __pyx_t_4 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 774, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 781, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
-  if (PyDict_SetItem(__pyx_t_4, __pyx_n_s_return, __pyx_n_s_CNF) < 0) __PYX_ERR(0, 774, __pyx_L1_error)
-  __pyx_t_7 = __Pyx_CyFunction_New(&__pyx_mdef_11sat_toolkit_7formula_3CNF_9create_all_equal, __Pyx_CYFUNCTION_STATICMETHOD | __Pyx_CYFUNCTION_CCLASS, __pyx_n_s_CNF_create_all_equal, NULL, __pyx_n_s_sat_toolkit_formula, __pyx_d, ((PyObject *)__pyx_codeobj__115)); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 774, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_4, __pyx_n_s_return, __pyx_n_s_CNF) < 0) __PYX_ERR(0, 781, __pyx_L1_error)
+  __pyx_t_7 = __Pyx_CyFunction_New(&__pyx_mdef_11sat_toolkit_7formula_3CNF_9create_all_equal, __Pyx_CYFUNCTION_STATICMETHOD | __Pyx_CYFUNCTION_CCLASS, __pyx_n_s_CNF_create_all_equal, NULL, __pyx_n_s_sat_toolkit_formula, __pyx_d, ((PyObject *)__pyx_codeobj__115)); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 781, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_7);
   __Pyx_CyFunction_SetAnnotationsDict(__pyx_t_7, __pyx_t_4);
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-  if (__Pyx_SetItemOnTypeDict((PyObject *)__pyx_ptype_11sat_toolkit_7formula_CNF, __pyx_n_s_create_all_equal_2, __pyx_t_7) < 0) __PYX_ERR(0, 774, __pyx_L1_error)
+  if (__Pyx_SetItemOnTypeDict((PyObject *)__pyx_ptype_11sat_toolkit_7formula_CNF, __pyx_n_s_create_all_equal_2, __pyx_t_7) < 0) __PYX_ERR(0, 781, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
   PyType_Modified(__pyx_ptype_11sat_toolkit_7formula_CNF);
-  __Pyx_GetNameInClass(__pyx_t_7, (PyObject *)__pyx_ptype_11sat_toolkit_7formula_CNF, __pyx_n_s_create_all_equal_2); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 774, __pyx_L1_error)
+  __Pyx_GetNameInClass(__pyx_t_7, (PyObject *)__pyx_ptype_11sat_toolkit_7formula_CNF, __pyx_n_s_create_all_equal_2); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 781, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_7);
-  __pyx_t_4 = __Pyx_PyObject_CallOneArg(__pyx_builtin_staticmethod, __pyx_t_7); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 774, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyObject_CallOneArg(__pyx_builtin_staticmethod, __pyx_t_7); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 781, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-  if (__Pyx_SetItemOnTypeDict((PyObject *)__pyx_ptype_11sat_toolkit_7formula_CNF, __pyx_n_s_create_all_equal_2, __pyx_t_4) < 0) __PYX_ERR(0, 774, __pyx_L1_error)
+  if (__Pyx_SetItemOnTypeDict((PyObject *)__pyx_ptype_11sat_toolkit_7formula_CNF, __pyx_n_s_create_all_equal_2, __pyx_t_4) < 0) __PYX_ERR(0, 781, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
   PyType_Modified(__pyx_ptype_11sat_toolkit_7formula_CNF);
 
-  /* "sat_toolkit/formula.pyx":781
+  /* "sat_toolkit/formula.pyx":788
  *         return CNF._create_all_equal(lhs, rhs)
  * 
  *     @staticmethod             # <<<<<<<<<<<<<<
  *     def _create_all_equal(const int[:] lhs not None, const int[:] rhs not None) -> CNF:
  *         cdef vector[int] clauses
  */
-  __pyx_t_4 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 781, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 788, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
-  if (PyDict_SetItem(__pyx_t_4, __pyx_n_s_return, __pyx_n_s_CNF) < 0) __PYX_ERR(0, 781, __pyx_L1_error)
-  __pyx_t_7 = __Pyx_CyFunction_New(&__pyx_mdef_11sat_toolkit_7formula_3CNF_11_create_all_equal, __Pyx_CYFUNCTION_STATICMETHOD | __Pyx_CYFUNCTION_CCLASS, __pyx_n_s_CNF__create_all_equal, NULL, __pyx_n_s_sat_toolkit_formula, __pyx_d, ((PyObject *)__pyx_codeobj__117)); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 781, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_4, __pyx_n_s_return, __pyx_n_s_CNF) < 0) __PYX_ERR(0, 788, __pyx_L1_error)
+  __pyx_t_7 = __Pyx_CyFunction_New(&__pyx_mdef_11sat_toolkit_7formula_3CNF_11_create_all_equal, __Pyx_CYFUNCTION_STATICMETHOD | __Pyx_CYFUNCTION_CCLASS, __pyx_n_s_CNF__create_all_equal, NULL, __pyx_n_s_sat_toolkit_formula, __pyx_d, ((PyObject *)__pyx_codeobj__117)); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 788, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_7);
   __Pyx_CyFunction_SetAnnotationsDict(__pyx_t_7, __pyx_t_4);
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-  if (__Pyx_SetItemOnTypeDict((PyObject *)__pyx_ptype_11sat_toolkit_7formula_CNF, __pyx_n_s_create_all_equal, __pyx_t_7) < 0) __PYX_ERR(0, 781, __pyx_L1_error)
+  if (__Pyx_SetItemOnTypeDict((PyObject *)__pyx_ptype_11sat_toolkit_7formula_CNF, __pyx_n_s_create_all_equal, __pyx_t_7) < 0) __PYX_ERR(0, 788, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
   PyType_Modified(__pyx_ptype_11sat_toolkit_7formula_CNF);
-  __Pyx_GetNameInClass(__pyx_t_7, (PyObject *)__pyx_ptype_11sat_toolkit_7formula_CNF, __pyx_n_s_create_all_equal); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 781, __pyx_L1_error)
+  __Pyx_GetNameInClass(__pyx_t_7, (PyObject *)__pyx_ptype_11sat_toolkit_7formula_CNF, __pyx_n_s_create_all_equal); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 788, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_7);
-  __pyx_t_4 = __Pyx_PyObject_CallOneArg(__pyx_builtin_staticmethod, __pyx_t_7); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 781, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyObject_CallOneArg(__pyx_builtin_staticmethod, __pyx_t_7); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 788, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-  if (__Pyx_SetItemOnTypeDict((PyObject *)__pyx_ptype_11sat_toolkit_7formula_CNF, __pyx_n_s_create_all_equal, __pyx_t_4) < 0) __PYX_ERR(0, 781, __pyx_L1_error)
+  if (__Pyx_SetItemOnTypeDict((PyObject *)__pyx_ptype_11sat_toolkit_7formula_CNF, __pyx_n_s_create_all_equal, __pyx_t_4) < 0) __PYX_ERR(0, 788, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
   PyType_Modified(__pyx_ptype_11sat_toolkit_7formula_CNF);
 
-  /* "sat_toolkit/formula.pyx":873
+  /* "sat_toolkit/formula.pyx":880
  *         return res
  * 
  *     @staticmethod             # <<<<<<<<<<<<<<
  *     def create_xor(*args, rhs=None) -> CNF:
  *         """
  */
-  __pyx_t_4 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 873, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 880, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
 
-  /* "sat_toolkit/formula.pyx":874
+  /* "sat_toolkit/formula.pyx":881
  * 
  *     @staticmethod
  *     def create_xor(*args, rhs=None) -> CNF:             # <<<<<<<<<<<<<<
  *         """
  *         creates a CNF specifying the xor of the arguments is equal to the right
  */
-  if (PyDict_SetItem(__pyx_t_4, __pyx_n_s_rhs, Py_None) < 0) __PYX_ERR(0, 873, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_4, __pyx_n_s_rhs, Py_None) < 0) __PYX_ERR(0, 880, __pyx_L1_error)
 
-  /* "sat_toolkit/formula.pyx":873
+  /* "sat_toolkit/formula.pyx":880
  *         return res
  * 
  *     @staticmethod             # <<<<<<<<<<<<<<
  *     def create_xor(*args, rhs=None) -> CNF:
  *         """
  */
-  __pyx_t_7 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 873, __pyx_L1_error)
+  __pyx_t_7 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 880, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_7);
-  if (PyDict_SetItem(__pyx_t_7, __pyx_n_s_return, __pyx_n_s_CNF) < 0) __PYX_ERR(0, 873, __pyx_L1_error)
-  __pyx_t_5 = __Pyx_CyFunction_New(&__pyx_mdef_11sat_toolkit_7formula_3CNF_13create_xor, __Pyx_CYFUNCTION_STATICMETHOD | __Pyx_CYFUNCTION_CCLASS, __pyx_n_s_CNF_create_xor, NULL, __pyx_n_s_sat_toolkit_formula, __pyx_d, ((PyObject *)__pyx_codeobj__119)); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 873, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_7, __pyx_n_s_return, __pyx_n_s_CNF) < 0) __PYX_ERR(0, 880, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_CyFunction_New(&__pyx_mdef_11sat_toolkit_7formula_3CNF_13create_xor, __Pyx_CYFUNCTION_STATICMETHOD | __Pyx_CYFUNCTION_CCLASS, __pyx_n_s_CNF_create_xor, NULL, __pyx_n_s_sat_toolkit_formula, __pyx_d, ((PyObject *)__pyx_codeobj__119)); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 880, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_CyFunction_SetDefaultsKwDict(__pyx_t_5, __pyx_t_4);
   __Pyx_CyFunction_SetAnnotationsDict(__pyx_t_5, __pyx_t_7);
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
   __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-  if (__Pyx_SetItemOnTypeDict((PyObject *)__pyx_ptype_11sat_toolkit_7formula_CNF, __pyx_n_s_create_xor, __pyx_t_5) < 0) __PYX_ERR(0, 873, __pyx_L1_error)
+  if (__Pyx_SetItemOnTypeDict((PyObject *)__pyx_ptype_11sat_toolkit_7formula_CNF, __pyx_n_s_create_xor, __pyx_t_5) < 0) __PYX_ERR(0, 880, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
   PyType_Modified(__pyx_ptype_11sat_toolkit_7formula_CNF);
-  __Pyx_GetNameInClass(__pyx_t_5, (PyObject *)__pyx_ptype_11sat_toolkit_7formula_CNF, __pyx_n_s_create_xor); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 873, __pyx_L1_error)
+  __Pyx_GetNameInClass(__pyx_t_5, (PyObject *)__pyx_ptype_11sat_toolkit_7formula_CNF, __pyx_n_s_create_xor); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 880, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
-  __pyx_t_7 = __Pyx_PyObject_CallOneArg(__pyx_builtin_staticmethod, __pyx_t_5); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 873, __pyx_L1_error)
+  __pyx_t_7 = __Pyx_PyObject_CallOneArg(__pyx_builtin_staticmethod, __pyx_t_5); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 880, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_7);
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-  if (__Pyx_SetItemOnTypeDict((PyObject *)__pyx_ptype_11sat_toolkit_7formula_CNF, __pyx_n_s_create_xor, __pyx_t_7) < 0) __PYX_ERR(0, 873, __pyx_L1_error)
+  if (__Pyx_SetItemOnTypeDict((PyObject *)__pyx_ptype_11sat_toolkit_7formula_CNF, __pyx_n_s_create_xor, __pyx_t_7) < 0) __PYX_ERR(0, 880, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
   PyType_Modified(__pyx_ptype_11sat_toolkit_7formula_CNF);
 
-  /* "sat_toolkit/formula.pyx":904
+  /* "sat_toolkit/formula.pyx":911
  * 
  * 
  *     def logical_or(self, int var) -> CNF:             # <<<<<<<<<<<<<<
  *         """
  *         return a new CNF corresponding to (var or self). I.e., the new CNF is
  */
-  __pyx_t_7 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 904, __pyx_L1_error)
+  __pyx_t_7 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 911, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_7);
-  if (PyDict_SetItem(__pyx_t_7, __pyx_n_s_return, __pyx_n_s_CNF) < 0) __PYX_ERR(0, 904, __pyx_L1_error)
-  __pyx_t_5 = __Pyx_CyFunction_New(&__pyx_mdef_11sat_toolkit_7formula_3CNF_15logical_or, __Pyx_CYFUNCTION_CCLASS, __pyx_n_s_CNF_logical_or, NULL, __pyx_n_s_sat_toolkit_formula, __pyx_d, ((PyObject *)__pyx_codeobj__121)); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 904, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_7, __pyx_n_s_return, __pyx_n_s_CNF) < 0) __PYX_ERR(0, 911, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_CyFunction_New(&__pyx_mdef_11sat_toolkit_7formula_3CNF_15logical_or, __Pyx_CYFUNCTION_CCLASS, __pyx_n_s_CNF_logical_or, NULL, __pyx_n_s_sat_toolkit_formula, __pyx_d, ((PyObject *)__pyx_codeobj__121)); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 911, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_CyFunction_SetAnnotationsDict(__pyx_t_5, __pyx_t_7);
   __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-  if (__Pyx_SetItemOnTypeDict((PyObject *)__pyx_ptype_11sat_toolkit_7formula_CNF, __pyx_n_s_logical_or, __pyx_t_5) < 0) __PYX_ERR(0, 904, __pyx_L1_error)
+  if (__Pyx_SetItemOnTypeDict((PyObject *)__pyx_ptype_11sat_toolkit_7formula_CNF, __pyx_n_s_logical_or, __pyx_t_5) < 0) __PYX_ERR(0, 911, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
   PyType_Modified(__pyx_ptype_11sat_toolkit_7formula_CNF);
 
-  /* "sat_toolkit/formula.pyx":940
+  /* "sat_toolkit/formula.pyx":947
  *         return res
  * 
  *     def implied_by(self, int var) -> CNF:             # <<<<<<<<<<<<<<
  *         """
  *         return a new CNF corresponding to (var -> self). I.e., the new CNF is
  */
-  __pyx_t_5 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 940, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 947, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
-  if (PyDict_SetItem(__pyx_t_5, __pyx_n_s_return, __pyx_n_s_CNF) < 0) __PYX_ERR(0, 940, __pyx_L1_error)
-  __pyx_t_7 = __Pyx_CyFunction_New(&__pyx_mdef_11sat_toolkit_7formula_3CNF_17implied_by, __Pyx_CYFUNCTION_CCLASS, __pyx_n_s_CNF_implied_by, NULL, __pyx_n_s_sat_toolkit_formula, __pyx_d, ((PyObject *)__pyx_codeobj__123)); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 940, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_5, __pyx_n_s_return, __pyx_n_s_CNF) < 0) __PYX_ERR(0, 947, __pyx_L1_error)
+  __pyx_t_7 = __Pyx_CyFunction_New(&__pyx_mdef_11sat_toolkit_7formula_3CNF_17implied_by, __Pyx_CYFUNCTION_CCLASS, __pyx_n_s_CNF_implied_by, NULL, __pyx_n_s_sat_toolkit_formula, __pyx_d, ((PyObject *)__pyx_codeobj__123)); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 947, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_7);
   __Pyx_CyFunction_SetAnnotationsDict(__pyx_t_7, __pyx_t_5);
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-  if (__Pyx_SetItemOnTypeDict((PyObject *)__pyx_ptype_11sat_toolkit_7formula_CNF, __pyx_n_s_implied_by, __pyx_t_7) < 0) __PYX_ERR(0, 940, __pyx_L1_error)
+  if (__Pyx_SetItemOnTypeDict((PyObject *)__pyx_ptype_11sat_toolkit_7formula_CNF, __pyx_n_s_implied_by, __pyx_t_7) < 0) __PYX_ERR(0, 947, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
   PyType_Modified(__pyx_ptype_11sat_toolkit_7formula_CNF);
 
-  /* "sat_toolkit/formula.pyx":967
+  /* "sat_toolkit/formula.pyx":974
  *         return units
  * 
  *     def get_units(self) -> np.ndarray:             # <<<<<<<<<<<<<<
  *         """
  *         Returns all unit clauses in the CNF. The unit clauses are returned as
  */
-  __pyx_t_7 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 967, __pyx_L1_error)
+  __pyx_t_7 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 974, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_7);
-  if (PyDict_SetItem(__pyx_t_7, __pyx_n_s_return, __pyx_kp_s_np_ndarray) < 0) __PYX_ERR(0, 967, __pyx_L1_error)
-  __pyx_t_5 = __Pyx_CyFunction_New(&__pyx_mdef_11sat_toolkit_7formula_3CNF_19get_units, __Pyx_CYFUNCTION_CCLASS, __pyx_n_s_CNF_get_units, NULL, __pyx_n_s_sat_toolkit_formula, __pyx_d, ((PyObject *)__pyx_codeobj__125)); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 967, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_7, __pyx_n_s_return, __pyx_kp_s_np_ndarray) < 0) __PYX_ERR(0, 974, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_CyFunction_New(&__pyx_mdef_11sat_toolkit_7formula_3CNF_19get_units, __Pyx_CYFUNCTION_CCLASS, __pyx_n_s_CNF_get_units, NULL, __pyx_n_s_sat_toolkit_formula, __pyx_d, ((PyObject *)__pyx_codeobj__125)); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 974, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_CyFunction_SetAnnotationsDict(__pyx_t_5, __pyx_t_7);
   __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-  if (__Pyx_SetItemOnTypeDict((PyObject *)__pyx_ptype_11sat_toolkit_7formula_CNF, __pyx_n_s_get_units, __pyx_t_5) < 0) __PYX_ERR(0, 967, __pyx_L1_error)
+  if (__Pyx_SetItemOnTypeDict((PyObject *)__pyx_ptype_11sat_toolkit_7formula_CNF, __pyx_n_s_get_units, __pyx_t_5) < 0) __PYX_ERR(0, 974, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
   PyType_Modified(__pyx_ptype_11sat_toolkit_7formula_CNF);
 
-  /* "sat_toolkit/formula.pyx":990
+  /* "sat_toolkit/formula.pyx":997
  * 
  * 
  *     def to_dimacs(self) -> str:             # <<<<<<<<<<<<<<
  *         '''
  *         return the CNF formatted in the DIMACS file format
  */
-  __pyx_t_5 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 990, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 997, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
-  if (PyDict_SetItem(__pyx_t_5, __pyx_n_s_return, __pyx_n_s_str) < 0) __PYX_ERR(0, 990, __pyx_L1_error)
-  __pyx_t_7 = __Pyx_CyFunction_New(&__pyx_mdef_11sat_toolkit_7formula_3CNF_21to_dimacs, __Pyx_CYFUNCTION_CCLASS, __pyx_n_s_CNF_to_dimacs, NULL, __pyx_n_s_sat_toolkit_formula, __pyx_d, ((PyObject *)__pyx_codeobj__127)); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 990, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_5, __pyx_n_s_return, __pyx_n_s_str) < 0) __PYX_ERR(0, 997, __pyx_L1_error)
+  __pyx_t_7 = __Pyx_CyFunction_New(&__pyx_mdef_11sat_toolkit_7formula_3CNF_21to_dimacs, __Pyx_CYFUNCTION_CCLASS, __pyx_n_s_CNF_to_dimacs, NULL, __pyx_n_s_sat_toolkit_formula, __pyx_d, ((PyObject *)__pyx_codeobj__127)); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 997, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_7);
   __Pyx_CyFunction_SetAnnotationsDict(__pyx_t_7, __pyx_t_5);
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-  if (__Pyx_SetItemOnTypeDict((PyObject *)__pyx_ptype_11sat_toolkit_7formula_CNF, __pyx_n_s_to_dimacs, __pyx_t_7) < 0) __PYX_ERR(0, 990, __pyx_L1_error)
+  if (__Pyx_SetItemOnTypeDict((PyObject *)__pyx_ptype_11sat_toolkit_7formula_CNF, __pyx_n_s_to_dimacs, __pyx_t_7) < 0) __PYX_ERR(0, 997, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
   PyType_Modified(__pyx_ptype_11sat_toolkit_7formula_CNF);
 
-  /* "sat_toolkit/formula.pyx":1021
+  /* "sat_toolkit/formula.pyx":1028
  *         return 'p cnf ' + str(self.nvars) + ' ' + str(nclauses) + '\n' + py_str.decode()
  * 
  *     def to_espresso(self, print_numvars: bool = True) -> str:             # <<<<<<<<<<<<<<
  *         '''
  *         return the CNF formatted in the espresso file format
  */
-  __pyx_t_7 = __Pyx_PyDict_NewPresized(2); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1021, __pyx_L1_error)
+  __pyx_t_7 = __Pyx_PyDict_NewPresized(2); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1028, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_7);
-  if (PyDict_SetItem(__pyx_t_7, __pyx_n_s_print_numvars, __pyx_n_s_bool) < 0) __PYX_ERR(0, 1021, __pyx_L1_error)
-  if (PyDict_SetItem(__pyx_t_7, __pyx_n_s_return, __pyx_n_s_str) < 0) __PYX_ERR(0, 1021, __pyx_L1_error)
-  __pyx_t_5 = __Pyx_CyFunction_New(&__pyx_mdef_11sat_toolkit_7formula_3CNF_23to_espresso, __Pyx_CYFUNCTION_CCLASS, __pyx_n_s_CNF_to_espresso, NULL, __pyx_n_s_sat_toolkit_formula, __pyx_d, ((PyObject *)__pyx_codeobj__129)); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1021, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_7, __pyx_n_s_print_numvars, __pyx_n_s_bool) < 0) __PYX_ERR(0, 1028, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_7, __pyx_n_s_return, __pyx_n_s_str) < 0) __PYX_ERR(0, 1028, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_CyFunction_New(&__pyx_mdef_11sat_toolkit_7formula_3CNF_23to_espresso, __Pyx_CYFUNCTION_CCLASS, __pyx_n_s_CNF_to_espresso, NULL, __pyx_n_s_sat_toolkit_formula, __pyx_d, ((PyObject *)__pyx_codeobj__129)); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1028, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_CyFunction_SetDefaultsTuple(__pyx_t_5, __pyx_tuple__130);
   __Pyx_CyFunction_SetAnnotationsDict(__pyx_t_5, __pyx_t_7);
   __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-  if (__Pyx_SetItemOnTypeDict((PyObject *)__pyx_ptype_11sat_toolkit_7formula_CNF, __pyx_n_s_to_espresso, __pyx_t_5) < 0) __PYX_ERR(0, 1021, __pyx_L1_error)
+  if (__Pyx_SetItemOnTypeDict((PyObject *)__pyx_ptype_11sat_toolkit_7formula_CNF, __pyx_n_s_to_espresso, __pyx_t_5) < 0) __PYX_ERR(0, 1028, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
   PyType_Modified(__pyx_ptype_11sat_toolkit_7formula_CNF);
 
-  /* "sat_toolkit/formula.pyx":1069
+  /* "sat_toolkit/formula.pyx":1076
  *         return py_bytes.decode()
  * 
  *     def minimize_espresso(self, espresso_args: List[str] = []) -> CNF:             # <<<<<<<<<<<<<<
  *         """
  *         Uses espresso to minimize the given CNF.
  */
-  __pyx_t_5 = PyList_New(0); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1069, __pyx_L1_error)
+  __pyx_t_5 = PyList_New(0); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1076, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
   __pyx_k__34 = __pyx_t_5;
   __Pyx_GIVEREF(__pyx_t_5);
   __pyx_t_5 = 0;
-  __pyx_t_5 = PyList_New(0); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1069, __pyx_L1_error)
+  __pyx_t_5 = PyList_New(0); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1076, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
-  __pyx_t_7 = PyTuple_New(1); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1069, __pyx_L1_error)
+  __pyx_t_7 = PyTuple_New(1); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1076, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_7);
   __Pyx_GIVEREF(__pyx_t_5);
-  if (__Pyx_PyTuple_SET_ITEM(__pyx_t_7, 0, __pyx_t_5)) __PYX_ERR(0, 1069, __pyx_L1_error);
+  if (__Pyx_PyTuple_SET_ITEM(__pyx_t_7, 0, __pyx_t_5)) __PYX_ERR(0, 1076, __pyx_L1_error);
   __pyx_t_5 = 0;
-  __pyx_t_5 = __Pyx_PyDict_NewPresized(2); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1069, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyDict_NewPresized(2); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1076, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
-  if (PyDict_SetItem(__pyx_t_5, __pyx_n_s_espresso_args, __pyx_kp_s_List_str) < 0) __PYX_ERR(0, 1069, __pyx_L1_error)
-  if (PyDict_SetItem(__pyx_t_5, __pyx_n_s_return, __pyx_n_s_CNF) < 0) __PYX_ERR(0, 1069, __pyx_L1_error)
-  __pyx_t_4 = __Pyx_CyFunction_New(&__pyx_mdef_11sat_toolkit_7formula_3CNF_25minimize_espresso, __Pyx_CYFUNCTION_CCLASS, __pyx_n_s_CNF_minimize_espresso, NULL, __pyx_n_s_sat_toolkit_formula, __pyx_d, ((PyObject *)__pyx_codeobj__132)); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1069, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_5, __pyx_n_s_espresso_args, __pyx_kp_s_List_str) < 0) __PYX_ERR(0, 1076, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_5, __pyx_n_s_return, __pyx_n_s_CNF) < 0) __PYX_ERR(0, 1076, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_CyFunction_New(&__pyx_mdef_11sat_toolkit_7formula_3CNF_25minimize_espresso, __Pyx_CYFUNCTION_CCLASS, __pyx_n_s_CNF_minimize_espresso, NULL, __pyx_n_s_sat_toolkit_formula, __pyx_d, ((PyObject *)__pyx_codeobj__132)); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1076, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __Pyx_CyFunction_SetDefaultsTuple(__pyx_t_4, __pyx_t_7);
   __Pyx_CyFunction_SetAnnotationsDict(__pyx_t_4, __pyx_t_5);
   __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-  if (__Pyx_SetItemOnTypeDict((PyObject *)__pyx_ptype_11sat_toolkit_7formula_CNF, __pyx_n_s_minimize_espresso, __pyx_t_4) < 0) __PYX_ERR(0, 1069, __pyx_L1_error)
+  if (__Pyx_SetItemOnTypeDict((PyObject *)__pyx_ptype_11sat_toolkit_7formula_CNF, __pyx_n_s_minimize_espresso, __pyx_t_4) < 0) __PYX_ERR(0, 1076, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
   PyType_Modified(__pyx_ptype_11sat_toolkit_7formula_CNF);
 
-  /* "sat_toolkit/formula.pyx":1092
+  /* "sat_toolkit/formula.pyx":1099
  *             return cnf
  * 
  *     def _minimize_dimacs(self, args: List[str], outfile: str) -> CNF:             # <<<<<<<<<<<<<<
  *         """
  *         calls args with self.to_dimacs() as stdin, waits for the command to
  */
-  __pyx_t_4 = __Pyx_PyDict_NewPresized(3); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1092, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyDict_NewPresized(3); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1099, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
-  if (PyDict_SetItem(__pyx_t_4, __pyx_n_s_args, __pyx_kp_s_List_str) < 0) __PYX_ERR(0, 1092, __pyx_L1_error)
-  if (PyDict_SetItem(__pyx_t_4, __pyx_n_s_outfile, __pyx_n_s_str) < 0) __PYX_ERR(0, 1092, __pyx_L1_error)
-  if (PyDict_SetItem(__pyx_t_4, __pyx_n_s_return, __pyx_n_s_CNF) < 0) __PYX_ERR(0, 1092, __pyx_L1_error)
-  __pyx_t_5 = __Pyx_CyFunction_New(&__pyx_mdef_11sat_toolkit_7formula_3CNF_27_minimize_dimacs, __Pyx_CYFUNCTION_CCLASS, __pyx_n_s_CNF__minimize_dimacs, NULL, __pyx_n_s_sat_toolkit_formula, __pyx_d, ((PyObject *)__pyx_codeobj__134)); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1092, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_4, __pyx_n_s_args, __pyx_kp_s_List_str) < 0) __PYX_ERR(0, 1099, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_4, __pyx_n_s_outfile, __pyx_n_s_str) < 0) __PYX_ERR(0, 1099, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_4, __pyx_n_s_return, __pyx_n_s_CNF) < 0) __PYX_ERR(0, 1099, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_CyFunction_New(&__pyx_mdef_11sat_toolkit_7formula_3CNF_27_minimize_dimacs, __Pyx_CYFUNCTION_CCLASS, __pyx_n_s_CNF__minimize_dimacs, NULL, __pyx_n_s_sat_toolkit_formula, __pyx_d, ((PyObject *)__pyx_codeobj__134)); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1099, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_CyFunction_SetAnnotationsDict(__pyx_t_5, __pyx_t_4);
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-  if (__Pyx_SetItemOnTypeDict((PyObject *)__pyx_ptype_11sat_toolkit_7formula_CNF, __pyx_n_s_minimize_dimacs, __pyx_t_5) < 0) __PYX_ERR(0, 1092, __pyx_L1_error)
+  if (__Pyx_SetItemOnTypeDict((PyObject *)__pyx_ptype_11sat_toolkit_7formula_CNF, __pyx_n_s_minimize_dimacs, __pyx_t_5) < 0) __PYX_ERR(0, 1099, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
   PyType_Modified(__pyx_ptype_11sat_toolkit_7formula_CNF);
 
-  /* "sat_toolkit/formula.pyx":1115
+  /* "sat_toolkit/formula.pyx":1122
  *             return CNF.from_dimacs(f.read())
  * 
  *     def minimize_lingeling(self, optlevel=None, timeout=0, extra_args: List[str] = []) -> CNF:             # <<<<<<<<<<<<<<
  *         """
  *         Uses Lingeling to minimize the given CNF.
  */
-  __pyx_t_5 = PyList_New(0); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1115, __pyx_L1_error)
+  __pyx_t_5 = PyList_New(0); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1122, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
   __pyx_k__36 = __pyx_t_5;
   __Pyx_GIVEREF(__pyx_t_5);
   __pyx_t_5 = 0;
-  __pyx_t_5 = PyList_New(0); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1115, __pyx_L1_error)
+  __pyx_t_5 = PyList_New(0); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1122, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
-  __pyx_t_4 = PyTuple_New(3); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1115, __pyx_L1_error)
+  __pyx_t_4 = PyTuple_New(3); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1122, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __Pyx_INCREF(Py_None);
   __Pyx_GIVEREF(Py_None);
-  if (__Pyx_PyTuple_SET_ITEM(__pyx_t_4, 0, Py_None)) __PYX_ERR(0, 1115, __pyx_L1_error);
+  if (__Pyx_PyTuple_SET_ITEM(__pyx_t_4, 0, Py_None)) __PYX_ERR(0, 1122, __pyx_L1_error);
   __Pyx_INCREF(__pyx_int_0);
   __Pyx_GIVEREF(__pyx_int_0);
-  if (__Pyx_PyTuple_SET_ITEM(__pyx_t_4, 1, __pyx_int_0)) __PYX_ERR(0, 1115, __pyx_L1_error);
+  if (__Pyx_PyTuple_SET_ITEM(__pyx_t_4, 1, __pyx_int_0)) __PYX_ERR(0, 1122, __pyx_L1_error);
   __Pyx_GIVEREF(__pyx_t_5);
-  if (__Pyx_PyTuple_SET_ITEM(__pyx_t_4, 2, __pyx_t_5)) __PYX_ERR(0, 1115, __pyx_L1_error);
+  if (__Pyx_PyTuple_SET_ITEM(__pyx_t_4, 2, __pyx_t_5)) __PYX_ERR(0, 1122, __pyx_L1_error);
   __pyx_t_5 = 0;
-  __pyx_t_5 = __Pyx_PyDict_NewPresized(2); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1115, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyDict_NewPresized(2); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1122, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
-  if (PyDict_SetItem(__pyx_t_5, __pyx_n_s_extra_args, __pyx_kp_s_List_str) < 0) __PYX_ERR(0, 1115, __pyx_L1_error)
-  if (PyDict_SetItem(__pyx_t_5, __pyx_n_s_return, __pyx_n_s_CNF) < 0) __PYX_ERR(0, 1115, __pyx_L1_error)
-  __pyx_t_7 = __Pyx_CyFunction_New(&__pyx_mdef_11sat_toolkit_7formula_3CNF_29minimize_lingeling, __Pyx_CYFUNCTION_CCLASS, __pyx_n_s_CNF_minimize_lingeling, NULL, __pyx_n_s_sat_toolkit_formula, __pyx_d, ((PyObject *)__pyx_codeobj__136)); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1115, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_5, __pyx_n_s_extra_args, __pyx_kp_s_List_str) < 0) __PYX_ERR(0, 1122, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_5, __pyx_n_s_return, __pyx_n_s_CNF) < 0) __PYX_ERR(0, 1122, __pyx_L1_error)
+  __pyx_t_7 = __Pyx_CyFunction_New(&__pyx_mdef_11sat_toolkit_7formula_3CNF_29minimize_lingeling, __Pyx_CYFUNCTION_CCLASS, __pyx_n_s_CNF_minimize_lingeling, NULL, __pyx_n_s_sat_toolkit_formula, __pyx_d, ((PyObject *)__pyx_codeobj__136)); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1122, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_7);
   __Pyx_CyFunction_SetDefaultsTuple(__pyx_t_7, __pyx_t_4);
   __Pyx_CyFunction_SetAnnotationsDict(__pyx_t_7, __pyx_t_5);
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-  if (__Pyx_SetItemOnTypeDict((PyObject *)__pyx_ptype_11sat_toolkit_7formula_CNF, __pyx_n_s_minimize_lingeling, __pyx_t_7) < 0) __PYX_ERR(0, 1115, __pyx_L1_error)
+  if (__Pyx_SetItemOnTypeDict((PyObject *)__pyx_ptype_11sat_toolkit_7formula_CNF, __pyx_n_s_minimize_lingeling, __pyx_t_7) < 0) __PYX_ERR(0, 1122, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
   PyType_Modified(__pyx_ptype_11sat_toolkit_7formula_CNF);
 
-  /* "sat_toolkit/formula.pyx":1141
+  /* "sat_toolkit/formula.pyx":1148
  * 
  * 
  *     def solve_dimacs(self, command: List[str], verbose=False) -> Tuple[bool, np.array|None]:             # <<<<<<<<<<<<<<
  *         """
  *         solves the SAT by calling a DIMACS the compliant sat solver given by command.
  */
-  __pyx_t_7 = __Pyx_PyDict_NewPresized(2); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1141, __pyx_L1_error)
+  __pyx_t_7 = __Pyx_PyDict_NewPresized(2); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1148, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_7);
-  if (PyDict_SetItem(__pyx_t_7, __pyx_n_s_command, __pyx_kp_s_List_str) < 0) __PYX_ERR(0, 1141, __pyx_L1_error)
-  if (PyDict_SetItem(__pyx_t_7, __pyx_n_s_return, __pyx_kp_s_Tuple_bool_np_array_None) < 0) __PYX_ERR(0, 1141, __pyx_L1_error)
-  __pyx_t_5 = __Pyx_CyFunction_New(&__pyx_mdef_11sat_toolkit_7formula_3CNF_31solve_dimacs, __Pyx_CYFUNCTION_CCLASS, __pyx_n_s_CNF_solve_dimacs, NULL, __pyx_n_s_sat_toolkit_formula, __pyx_d, ((PyObject *)__pyx_codeobj__138)); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1141, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_7, __pyx_n_s_command, __pyx_kp_s_List_str) < 0) __PYX_ERR(0, 1148, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_7, __pyx_n_s_return, __pyx_kp_s_Tuple_bool_np_array_None) < 0) __PYX_ERR(0, 1148, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_CyFunction_New(&__pyx_mdef_11sat_toolkit_7formula_3CNF_31solve_dimacs, __Pyx_CYFUNCTION_CCLASS, __pyx_n_s_CNF_solve_dimacs, NULL, __pyx_n_s_sat_toolkit_formula, __pyx_d, ((PyObject *)__pyx_codeobj__138)); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1148, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_CyFunction_SetDefaultsTuple(__pyx_t_5, __pyx_tuple__139);
   __Pyx_CyFunction_SetAnnotationsDict(__pyx_t_5, __pyx_t_7);
   __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-  if (__Pyx_SetItemOnTypeDict((PyObject *)__pyx_ptype_11sat_toolkit_7formula_CNF, __pyx_n_s_solve_dimacs, __pyx_t_5) < 0) __PYX_ERR(0, 1141, __pyx_L1_error)
+  if (__Pyx_SetItemOnTypeDict((PyObject *)__pyx_ptype_11sat_toolkit_7formula_CNF, __pyx_n_s_solve_dimacs, __pyx_t_5) < 0) __PYX_ERR(0, 1148, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
   PyType_Modified(__pyx_ptype_11sat_toolkit_7formula_CNF);
 
-  /* "sat_toolkit/formula.pyx":1209
+  /* "sat_toolkit/formula.pyx":1216
  * 
  * 
  *     def check_solution(self, uint8_t[:] solution) -> bool:             # <<<<<<<<<<<<<<
  *         cdef size_t i
  *         for i in range(solution.shape[0]):
  */
-  __pyx_t_5 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1209, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1216, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
-  if (PyDict_SetItem(__pyx_t_5, __pyx_n_s_return, __pyx_n_s_bool) < 0) __PYX_ERR(0, 1209, __pyx_L1_error)
-  __pyx_t_7 = __Pyx_CyFunction_New(&__pyx_mdef_11sat_toolkit_7formula_3CNF_33check_solution, __Pyx_CYFUNCTION_CCLASS, __pyx_n_s_CNF_check_solution, NULL, __pyx_n_s_sat_toolkit_formula, __pyx_d, ((PyObject *)__pyx_codeobj__141)); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1209, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_5, __pyx_n_s_return, __pyx_n_s_bool) < 0) __PYX_ERR(0, 1216, __pyx_L1_error)
+  __pyx_t_7 = __Pyx_CyFunction_New(&__pyx_mdef_11sat_toolkit_7formula_3CNF_33check_solution, __Pyx_CYFUNCTION_CCLASS, __pyx_n_s_CNF_check_solution, NULL, __pyx_n_s_sat_toolkit_formula, __pyx_d, ((PyObject *)__pyx_codeobj__141)); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1216, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_7);
   __Pyx_CyFunction_SetAnnotationsDict(__pyx_t_7, __pyx_t_5);
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-  if (__Pyx_SetItemOnTypeDict((PyObject *)__pyx_ptype_11sat_toolkit_7formula_CNF, __pyx_n_s_check_solution, __pyx_t_7) < 0) __PYX_ERR(0, 1209, __pyx_L1_error)
+  if (__Pyx_SetItemOnTypeDict((PyObject *)__pyx_ptype_11sat_toolkit_7formula_CNF, __pyx_n_s_check_solution, __pyx_t_7) < 0) __PYX_ERR(0, 1216, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
   PyType_Modified(__pyx_ptype_11sat_toolkit_7formula_CNF);
 
-  /* "sat_toolkit/formula.pyx":1250
+  /* "sat_toolkit/formula.pyx":1257
  *         return False
  * 
  *     def to_truthtable(self) -> Truthtable:             # <<<<<<<<<<<<<<
  *         """
  *         Return the current CNF as a Truthtable by iterating over all possible
  */
-  __pyx_t_7 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1250, __pyx_L1_error)
+  __pyx_t_7 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1257, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_7);
-  if (PyDict_SetItem(__pyx_t_7, __pyx_n_s_return, __pyx_n_s_Truthtable_2) < 0) __PYX_ERR(0, 1250, __pyx_L1_error)
-  __pyx_t_5 = __Pyx_CyFunction_New(&__pyx_mdef_11sat_toolkit_7formula_3CNF_35to_truthtable, __Pyx_CYFUNCTION_CCLASS, __pyx_n_s_CNF_to_truthtable, NULL, __pyx_n_s_sat_toolkit_formula, __pyx_d, ((PyObject *)__pyx_codeobj__143)); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1250, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_7, __pyx_n_s_return, __pyx_n_s_Truthtable_2) < 0) __PYX_ERR(0, 1257, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_CyFunction_New(&__pyx_mdef_11sat_toolkit_7formula_3CNF_35to_truthtable, __Pyx_CYFUNCTION_CCLASS, __pyx_n_s_CNF_to_truthtable, NULL, __pyx_n_s_sat_toolkit_formula, __pyx_d, ((PyObject *)__pyx_codeobj__143)); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1257, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_CyFunction_SetAnnotationsDict(__pyx_t_5, __pyx_t_7);
   __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-  if (__Pyx_SetItemOnTypeDict((PyObject *)__pyx_ptype_11sat_toolkit_7formula_CNF, __pyx_n_s_to_truthtable, __pyx_t_5) < 0) __PYX_ERR(0, 1250, __pyx_L1_error)
+  if (__Pyx_SetItemOnTypeDict((PyObject *)__pyx_ptype_11sat_toolkit_7formula_CNF, __pyx_n_s_to_truthtable, __pyx_t_5) < 0) __PYX_ERR(0, 1257, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
   PyType_Modified(__pyx_ptype_11sat_toolkit_7formula_CNF);
 
-  /* "sat_toolkit/formula.pyx":1292
+  /* "sat_toolkit/formula.pyx":1299
  *         return self.to_dimacs().rstrip()
  * 
  *     def equiv(self, CNF other) -> bool:             # <<<<<<<<<<<<<<
  *         """
  *         Check for logical eqivalence between self and other.
  */
-  __pyx_t_5 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1292, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1299, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
-  if (PyDict_SetItem(__pyx_t_5, __pyx_n_s_return, __pyx_n_s_bool) < 0) __PYX_ERR(0, 1292, __pyx_L1_error)
-  __pyx_t_7 = __Pyx_CyFunction_New(&__pyx_mdef_11sat_toolkit_7formula_3CNF_41equiv, __Pyx_CYFUNCTION_CCLASS, __pyx_n_s_CNF_equiv, NULL, __pyx_n_s_sat_toolkit_formula, __pyx_d, ((PyObject *)__pyx_codeobj__145)); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1292, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_5, __pyx_n_s_return, __pyx_n_s_bool) < 0) __PYX_ERR(0, 1299, __pyx_L1_error)
+  __pyx_t_7 = __Pyx_CyFunction_New(&__pyx_mdef_11sat_toolkit_7formula_3CNF_41equiv, __Pyx_CYFUNCTION_CCLASS, __pyx_n_s_CNF_equiv, NULL, __pyx_n_s_sat_toolkit_formula, __pyx_d, ((PyObject *)__pyx_codeobj__145)); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1299, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_7);
   __Pyx_CyFunction_SetAnnotationsDict(__pyx_t_7, __pyx_t_5);
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-  if (__Pyx_SetItemOnTypeDict((PyObject *)__pyx_ptype_11sat_toolkit_7formula_CNF, __pyx_n_s_equiv, __pyx_t_7) < 0) __PYX_ERR(0, 1292, __pyx_L1_error)
+  if (__Pyx_SetItemOnTypeDict((PyObject *)__pyx_ptype_11sat_toolkit_7formula_CNF, __pyx_n_s_equiv, __pyx_t_7) < 0) __PYX_ERR(0, 1299, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
   PyType_Modified(__pyx_ptype_11sat_toolkit_7formula_CNF);
 
-  /* "sat_toolkit/formula.pyx":1313
+  /* "sat_toolkit/formula.pyx":1320
  *             return ret_code == 0
  * 
  *     def translate(self, mapping) -> CNF:             # <<<<<<<<<<<<<<
  *         """
  *         Translate all variables in the CNF to a new index.
  */
-  __pyx_t_7 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1313, __pyx_L1_error)
+  __pyx_t_7 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1320, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_7);
-  if (PyDict_SetItem(__pyx_t_7, __pyx_n_s_return, __pyx_n_s_CNF) < 0) __PYX_ERR(0, 1313, __pyx_L1_error)
-  __pyx_t_5 = __Pyx_CyFunction_New(&__pyx_mdef_11sat_toolkit_7formula_3CNF_43translate, __Pyx_CYFUNCTION_CCLASS, __pyx_n_s_CNF_translate, NULL, __pyx_n_s_sat_toolkit_formula, __pyx_d, ((PyObject *)__pyx_codeobj__147)); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1313, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_7, __pyx_n_s_return, __pyx_n_s_CNF) < 0) __PYX_ERR(0, 1320, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_CyFunction_New(&__pyx_mdef_11sat_toolkit_7formula_3CNF_43translate, __Pyx_CYFUNCTION_CCLASS, __pyx_n_s_CNF_translate, NULL, __pyx_n_s_sat_toolkit_formula, __pyx_d, ((PyObject *)__pyx_codeobj__147)); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1320, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_CyFunction_SetAnnotationsDict(__pyx_t_5, __pyx_t_7);
   __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-  if (__Pyx_SetItemOnTypeDict((PyObject *)__pyx_ptype_11sat_toolkit_7formula_CNF, __pyx_n_s_translate, __pyx_t_5) < 0) __PYX_ERR(0, 1313, __pyx_L1_error)
+  if (__Pyx_SetItemOnTypeDict((PyObject *)__pyx_ptype_11sat_toolkit_7formula_CNF, __pyx_n_s_translate, __pyx_t_5) < 0) __PYX_ERR(0, 1320, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
   PyType_Modified(__pyx_ptype_11sat_toolkit_7formula_CNF);
 
-  /* "sat_toolkit/formula.pyx":1347
+  /* "sat_toolkit/formula.pyx":1354
  *         return res
  * 
  * collections.abc.Sequence.register(_ClauseList)             # <<<<<<<<<<<<<<
  * 
  * 
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_collections); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1347, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_collections); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1354, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
-  __pyx_t_7 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_abc); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1347, __pyx_L1_error)
+  __pyx_t_7 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_abc); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1354, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_7);
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_7, __pyx_n_s_Sequence); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1347, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_7, __pyx_n_s_Sequence); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1354, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-  __pyx_t_7 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_register); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1347, __pyx_L1_error)
+  __pyx_t_7 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_register); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1354, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_7);
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-  __pyx_t_5 = __Pyx_PyObject_CallOneArg(__pyx_t_7, ((PyObject *)__pyx_ptype_11sat_toolkit_7formula__ClauseList)); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1347, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyObject_CallOneArg(__pyx_t_7, ((PyObject *)__pyx_ptype_11sat_toolkit_7formula__ClauseList)); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1354, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
 
-  /* "sat_toolkit/formula.pyx":1379
+  /* "sat_toolkit/formula.pyx":1386
  * 
  * 
  *     @staticmethod             # <<<<<<<<<<<<<<
  *     def from_dimacs(dimacs: str) -> XorCNF:
  *         cdef CNF clauses = CNF.__new__(CNF)
  */
-  __pyx_t_5 = __Pyx_PyDict_NewPresized(2); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1379, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyDict_NewPresized(2); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1386, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
-  if (PyDict_SetItem(__pyx_t_5, __pyx_n_s_dimacs, __pyx_n_s_str) < 0) __PYX_ERR(0, 1379, __pyx_L1_error)
-  if (PyDict_SetItem(__pyx_t_5, __pyx_n_s_return, __pyx_n_s_XorCNF) < 0) __PYX_ERR(0, 1379, __pyx_L1_error)
-  __pyx_t_7 = __Pyx_CyFunction_New(&__pyx_mdef_11sat_toolkit_7formula_6XorCNF_5from_dimacs, __Pyx_CYFUNCTION_STATICMETHOD | __Pyx_CYFUNCTION_CCLASS, __pyx_n_s_XorCNF_from_dimacs, NULL, __pyx_n_s_sat_toolkit_formula, __pyx_d, ((PyObject *)__pyx_codeobj__149)); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1379, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_5, __pyx_n_s_dimacs, __pyx_n_s_str) < 0) __PYX_ERR(0, 1386, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_5, __pyx_n_s_return, __pyx_n_s_XorCNF) < 0) __PYX_ERR(0, 1386, __pyx_L1_error)
+  __pyx_t_7 = __Pyx_CyFunction_New(&__pyx_mdef_11sat_toolkit_7formula_6XorCNF_5from_dimacs, __Pyx_CYFUNCTION_STATICMETHOD | __Pyx_CYFUNCTION_CCLASS, __pyx_n_s_XorCNF_from_dimacs, NULL, __pyx_n_s_sat_toolkit_formula, __pyx_d, ((PyObject *)__pyx_codeobj__149)); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1386, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_7);
   __Pyx_CyFunction_SetAnnotationsDict(__pyx_t_7, __pyx_t_5);
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-  if (__Pyx_SetItemOnTypeDict((PyObject *)__pyx_ptype_11sat_toolkit_7formula_XorCNF, __pyx_n_s_from_dimacs, __pyx_t_7) < 0) __PYX_ERR(0, 1379, __pyx_L1_error)
+  if (__Pyx_SetItemOnTypeDict((PyObject *)__pyx_ptype_11sat_toolkit_7formula_XorCNF, __pyx_n_s_from_dimacs, __pyx_t_7) < 0) __PYX_ERR(0, 1386, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
   PyType_Modified(__pyx_ptype_11sat_toolkit_7formula_XorCNF);
-  __Pyx_GetNameInClass(__pyx_t_7, (PyObject *)__pyx_ptype_11sat_toolkit_7formula_XorCNF, __pyx_n_s_from_dimacs); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1379, __pyx_L1_error)
+  __Pyx_GetNameInClass(__pyx_t_7, (PyObject *)__pyx_ptype_11sat_toolkit_7formula_XorCNF, __pyx_n_s_from_dimacs); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1386, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_7);
-  __pyx_t_5 = __Pyx_PyObject_CallOneArg(__pyx_builtin_staticmethod, __pyx_t_7); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1379, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyObject_CallOneArg(__pyx_builtin_staticmethod, __pyx_t_7); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1386, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-  if (__Pyx_SetItemOnTypeDict((PyObject *)__pyx_ptype_11sat_toolkit_7formula_XorCNF, __pyx_n_s_from_dimacs, __pyx_t_5) < 0) __PYX_ERR(0, 1379, __pyx_L1_error)
+  if (__Pyx_SetItemOnTypeDict((PyObject *)__pyx_ptype_11sat_toolkit_7formula_XorCNF, __pyx_n_s_from_dimacs, __pyx_t_5) < 0) __PYX_ERR(0, 1386, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
   PyType_Modified(__pyx_ptype_11sat_toolkit_7formula_XorCNF);
 
-  /* "sat_toolkit/formula.pyx":1416
+  /* "sat_toolkit/formula.pyx":1423
  *         return XorCNF(clauses=clauses, xor_clauses=xors)
  * 
  *     @staticmethod             # <<<<<<<<<<<<<<
  *     def create_xor(*args, rhs=None) -> XorCNF:
  *         """
  */
-  __pyx_t_5 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1416, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1423, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
 
-  /* "sat_toolkit/formula.pyx":1417
+  /* "sat_toolkit/formula.pyx":1424
  * 
  *     @staticmethod
  *     def create_xor(*args, rhs=None) -> XorCNF:             # <<<<<<<<<<<<<<
  *         """
  *         creates an XorCNF specifying the xor of the arguments is equal to the right
  */
-  if (PyDict_SetItem(__pyx_t_5, __pyx_n_s_rhs, Py_None) < 0) __PYX_ERR(0, 1416, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_5, __pyx_n_s_rhs, Py_None) < 0) __PYX_ERR(0, 1423, __pyx_L1_error)
 
-  /* "sat_toolkit/formula.pyx":1416
+  /* "sat_toolkit/formula.pyx":1423
  *         return XorCNF(clauses=clauses, xor_clauses=xors)
  * 
  *     @staticmethod             # <<<<<<<<<<<<<<
  *     def create_xor(*args, rhs=None) -> XorCNF:
  *         """
  */
-  __pyx_t_7 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1416, __pyx_L1_error)
+  __pyx_t_7 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1423, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_7);
-  if (PyDict_SetItem(__pyx_t_7, __pyx_n_s_return, __pyx_n_s_XorCNF) < 0) __PYX_ERR(0, 1416, __pyx_L1_error)
-  __pyx_t_4 = __Pyx_CyFunction_New(&__pyx_mdef_11sat_toolkit_7formula_6XorCNF_7create_xor, __Pyx_CYFUNCTION_STATICMETHOD | __Pyx_CYFUNCTION_CCLASS, __pyx_n_s_XorCNF_create_xor, NULL, __pyx_n_s_sat_toolkit_formula, __pyx_d, ((PyObject *)__pyx_codeobj__151)); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1416, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_7, __pyx_n_s_return, __pyx_n_s_XorCNF) < 0) __PYX_ERR(0, 1423, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_CyFunction_New(&__pyx_mdef_11sat_toolkit_7formula_6XorCNF_7create_xor, __Pyx_CYFUNCTION_STATICMETHOD | __Pyx_CYFUNCTION_CCLASS, __pyx_n_s_XorCNF_create_xor, NULL, __pyx_n_s_sat_toolkit_formula, __pyx_d, ((PyObject *)__pyx_codeobj__151)); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1423, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __Pyx_CyFunction_SetDefaultsKwDict(__pyx_t_4, __pyx_t_5);
   __Pyx_CyFunction_SetAnnotationsDict(__pyx_t_4, __pyx_t_7);
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
   __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-  if (__Pyx_SetItemOnTypeDict((PyObject *)__pyx_ptype_11sat_toolkit_7formula_XorCNF, __pyx_n_s_create_xor, __pyx_t_4) < 0) __PYX_ERR(0, 1416, __pyx_L1_error)
+  if (__Pyx_SetItemOnTypeDict((PyObject *)__pyx_ptype_11sat_toolkit_7formula_XorCNF, __pyx_n_s_create_xor, __pyx_t_4) < 0) __PYX_ERR(0, 1423, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
   PyType_Modified(__pyx_ptype_11sat_toolkit_7formula_XorCNF);
-  __Pyx_GetNameInClass(__pyx_t_4, (PyObject *)__pyx_ptype_11sat_toolkit_7formula_XorCNF, __pyx_n_s_create_xor); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1416, __pyx_L1_error)
+  __Pyx_GetNameInClass(__pyx_t_4, (PyObject *)__pyx_ptype_11sat_toolkit_7formula_XorCNF, __pyx_n_s_create_xor); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1423, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
-  __pyx_t_7 = __Pyx_PyObject_CallOneArg(__pyx_builtin_staticmethod, __pyx_t_4); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1416, __pyx_L1_error)
+  __pyx_t_7 = __Pyx_PyObject_CallOneArg(__pyx_builtin_staticmethod, __pyx_t_4); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1423, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_7);
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-  if (__Pyx_SetItemOnTypeDict((PyObject *)__pyx_ptype_11sat_toolkit_7formula_XorCNF, __pyx_n_s_create_xor, __pyx_t_7) < 0) __PYX_ERR(0, 1416, __pyx_L1_error)
+  if (__Pyx_SetItemOnTypeDict((PyObject *)__pyx_ptype_11sat_toolkit_7formula_XorCNF, __pyx_n_s_create_xor, __pyx_t_7) < 0) __PYX_ERR(0, 1423, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
   PyType_Modified(__pyx_ptype_11sat_toolkit_7formula_XorCNF);
 
-  /* "sat_toolkit/formula.pyx":1472
+  /* "sat_toolkit/formula.pyx":1479
  *         return res
  * 
  *     def partition(self) -> tuple[list[CNF], list[XorClauseList]]:             # <<<<<<<<<<<<<<
  *         """
  *         Separately partition the CNF and XorClauseList into a lists of CNFs and
  */
-  __pyx_t_7 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1472, __pyx_L1_error)
+  __pyx_t_7 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1479, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_7);
-  if (PyDict_SetItem(__pyx_t_7, __pyx_n_s_return, __pyx_kp_s_tuple_list_CNF_list_XorClauseLis) < 0) __PYX_ERR(0, 1472, __pyx_L1_error)
-  __pyx_t_4 = __Pyx_CyFunction_New(&__pyx_mdef_11sat_toolkit_7formula_6XorCNF_9partition, __Pyx_CYFUNCTION_CCLASS, __pyx_n_s_XorCNF_partition, NULL, __pyx_n_s_sat_toolkit_formula, __pyx_d, ((PyObject *)__pyx_codeobj__152)); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1472, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_7, __pyx_n_s_return, __pyx_kp_s_tuple_list_CNF_list_XorClauseLis) < 0) __PYX_ERR(0, 1479, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_CyFunction_New(&__pyx_mdef_11sat_toolkit_7formula_6XorCNF_9partition, __Pyx_CYFUNCTION_CCLASS, __pyx_n_s_XorCNF_partition, NULL, __pyx_n_s_sat_toolkit_formula, __pyx_d, ((PyObject *)__pyx_codeobj__152)); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1479, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __Pyx_CyFunction_SetAnnotationsDict(__pyx_t_4, __pyx_t_7);
   __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-  if (__Pyx_SetItemOnTypeDict((PyObject *)__pyx_ptype_11sat_toolkit_7formula_XorCNF, __pyx_n_s_partition, __pyx_t_4) < 0) __PYX_ERR(0, 1472, __pyx_L1_error)
+  if (__Pyx_SetItemOnTypeDict((PyObject *)__pyx_ptype_11sat_toolkit_7formula_XorCNF, __pyx_n_s_partition, __pyx_t_4) < 0) __PYX_ERR(0, 1479, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
   PyType_Modified(__pyx_ptype_11sat_toolkit_7formula_XorCNF);
 
-  /* "sat_toolkit/formula.pyx":1482
+  /* "sat_toolkit/formula.pyx":1489
  *         return (self._clauses.partition(), self._xor_clauses.partition())
  * 
  *     def to_cnf(self) -> CNF:             # <<<<<<<<<<<<<<
  *         cdef CNF res = CNF.__new__(CNF)
  *         cdef size_t idx
  */
-  __pyx_t_4 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1482, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1489, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
-  if (PyDict_SetItem(__pyx_t_4, __pyx_n_s_return, __pyx_n_s_CNF) < 0) __PYX_ERR(0, 1482, __pyx_L1_error)
-  __pyx_t_7 = __Pyx_CyFunction_New(&__pyx_mdef_11sat_toolkit_7formula_6XorCNF_11to_cnf, __Pyx_CYFUNCTION_CCLASS, __pyx_n_s_XorCNF_to_cnf, NULL, __pyx_n_s_sat_toolkit_formula, __pyx_d, ((PyObject *)__pyx_codeobj__154)); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1482, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_4, __pyx_n_s_return, __pyx_n_s_CNF) < 0) __PYX_ERR(0, 1489, __pyx_L1_error)
+  __pyx_t_7 = __Pyx_CyFunction_New(&__pyx_mdef_11sat_toolkit_7formula_6XorCNF_11to_cnf, __Pyx_CYFUNCTION_CCLASS, __pyx_n_s_XorCNF_to_cnf, NULL, __pyx_n_s_sat_toolkit_formula, __pyx_d, ((PyObject *)__pyx_codeobj__154)); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1489, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_7);
   __Pyx_CyFunction_SetAnnotationsDict(__pyx_t_7, __pyx_t_4);
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-  if (__Pyx_SetItemOnTypeDict((PyObject *)__pyx_ptype_11sat_toolkit_7formula_XorCNF, __pyx_n_s_to_cnf, __pyx_t_7) < 0) __PYX_ERR(0, 1482, __pyx_L1_error)
+  if (__Pyx_SetItemOnTypeDict((PyObject *)__pyx_ptype_11sat_toolkit_7formula_XorCNF, __pyx_n_s_to_cnf, __pyx_t_7) < 0) __PYX_ERR(0, 1489, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
   PyType_Modified(__pyx_ptype_11sat_toolkit_7formula_XorCNF);
 
-  /* "sat_toolkit/formula.pyx":1494
+  /* "sat_toolkit/formula.pyx":1501
  *         return res
  * 
  *     def add_clauses(self, clauses):             # <<<<<<<<<<<<<<
  *         self._clauses.add_clauses(clauses)
  * 
  */
-  __pyx_t_7 = __Pyx_CyFunction_New(&__pyx_mdef_11sat_toolkit_7formula_6XorCNF_13add_clauses, __Pyx_CYFUNCTION_CCLASS, __pyx_n_s_XorCNF_add_clauses, NULL, __pyx_n_s_sat_toolkit_formula, __pyx_d, ((PyObject *)__pyx_codeobj__156)); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1494, __pyx_L1_error)
+  __pyx_t_7 = __Pyx_CyFunction_New(&__pyx_mdef_11sat_toolkit_7formula_6XorCNF_13add_clauses, __Pyx_CYFUNCTION_CCLASS, __pyx_n_s_XorCNF_add_clauses, NULL, __pyx_n_s_sat_toolkit_formula, __pyx_d, ((PyObject *)__pyx_codeobj__156)); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1501, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_7);
-  if (__Pyx_SetItemOnTypeDict((PyObject *)__pyx_ptype_11sat_toolkit_7formula_XorCNF, __pyx_n_s_add_clauses, __pyx_t_7) < 0) __PYX_ERR(0, 1494, __pyx_L1_error)
+  if (__Pyx_SetItemOnTypeDict((PyObject *)__pyx_ptype_11sat_toolkit_7formula_XorCNF, __pyx_n_s_add_clauses, __pyx_t_7) < 0) __PYX_ERR(0, 1501, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
   PyType_Modified(__pyx_ptype_11sat_toolkit_7formula_XorCNF);
 
-  /* "sat_toolkit/formula.pyx":1497
+  /* "sat_toolkit/formula.pyx":1504
  *         self._clauses.add_clauses(clauses)
  * 
  *     def add_xor_clauses(self, xor_clauses):             # <<<<<<<<<<<<<<
  *         self._xor_clauses.add_clauses(xor_clauses)
  * 
  */
-  __pyx_t_7 = __Pyx_CyFunction_New(&__pyx_mdef_11sat_toolkit_7formula_6XorCNF_15add_xor_clauses, __Pyx_CYFUNCTION_CCLASS, __pyx_n_s_XorCNF_add_xor_clauses, NULL, __pyx_n_s_sat_toolkit_formula, __pyx_d, ((PyObject *)__pyx_codeobj__158)); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1497, __pyx_L1_error)
+  __pyx_t_7 = __Pyx_CyFunction_New(&__pyx_mdef_11sat_toolkit_7formula_6XorCNF_15add_xor_clauses, __Pyx_CYFUNCTION_CCLASS, __pyx_n_s_XorCNF_add_xor_clauses, NULL, __pyx_n_s_sat_toolkit_formula, __pyx_d, ((PyObject *)__pyx_codeobj__158)); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1504, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_7);
-  if (__Pyx_SetItemOnTypeDict((PyObject *)__pyx_ptype_11sat_toolkit_7formula_XorCNF, __pyx_n_s_add_xor_clauses, __pyx_t_7) < 0) __PYX_ERR(0, 1497, __pyx_L1_error)
+  if (__Pyx_SetItemOnTypeDict((PyObject *)__pyx_ptype_11sat_toolkit_7formula_XorCNF, __pyx_n_s_add_xor_clauses, __pyx_t_7) < 0) __PYX_ERR(0, 1504, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
   PyType_Modified(__pyx_ptype_11sat_toolkit_7formula_XorCNF);
 
-  /* "sat_toolkit/formula.pyx":1565
+  /* "sat_toolkit/formula.pyx":1572
  * 
  * 
  *     def to_dimacs(self) -> str:             # <<<<<<<<<<<<<<
  *         '''
  *         return the XorCNF formatted in the extended DIMACS file format
  */
-  __pyx_t_7 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1565, __pyx_L1_error)
+  __pyx_t_7 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1572, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_7);
-  if (PyDict_SetItem(__pyx_t_7, __pyx_n_s_return, __pyx_n_s_str) < 0) __PYX_ERR(0, 1565, __pyx_L1_error)
-  __pyx_t_4 = __Pyx_CyFunction_New(&__pyx_mdef_11sat_toolkit_7formula_6XorCNF_25to_dimacs, __Pyx_CYFUNCTION_CCLASS, __pyx_n_s_XorCNF_to_dimacs, NULL, __pyx_n_s_sat_toolkit_formula, __pyx_d, ((PyObject *)__pyx_codeobj__159)); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1565, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_7, __pyx_n_s_return, __pyx_n_s_str) < 0) __PYX_ERR(0, 1572, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_CyFunction_New(&__pyx_mdef_11sat_toolkit_7formula_6XorCNF_25to_dimacs, __Pyx_CYFUNCTION_CCLASS, __pyx_n_s_XorCNF_to_dimacs, NULL, __pyx_n_s_sat_toolkit_formula, __pyx_d, ((PyObject *)__pyx_codeobj__159)); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1572, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __Pyx_CyFunction_SetAnnotationsDict(__pyx_t_4, __pyx_t_7);
   __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-  if (__Pyx_SetItemOnTypeDict((PyObject *)__pyx_ptype_11sat_toolkit_7formula_XorCNF, __pyx_n_s_to_dimacs, __pyx_t_4) < 0) __PYX_ERR(0, 1565, __pyx_L1_error)
+  if (__Pyx_SetItemOnTypeDict((PyObject *)__pyx_ptype_11sat_toolkit_7formula_XorCNF, __pyx_n_s_to_dimacs, __pyx_t_4) < 0) __PYX_ERR(0, 1572, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
   PyType_Modified(__pyx_ptype_11sat_toolkit_7formula_XorCNF);
 
-  /* "sat_toolkit/formula.pyx":1571
+  /* "sat_toolkit/formula.pyx":1578
  *         return f'p cnf {self._nvars()} {len(self._clauses) + len(self._xor_clauses)}\n{self._clauses._to_dimacs("")}{self._xor_clauses._to_dimacs("x")}'
  * 
  *     def __reduce__(self):             # <<<<<<<<<<<<<<
  *         return type(self), (self._clauses, self._xor_clauses)
  * 
  */
-  __pyx_t_4 = __Pyx_CyFunction_New(&__pyx_mdef_11sat_toolkit_7formula_6XorCNF_27__reduce__, __Pyx_CYFUNCTION_CCLASS, __pyx_n_s_XorCNF___reduce, NULL, __pyx_n_s_sat_toolkit_formula, __pyx_d, ((PyObject *)__pyx_codeobj__160)); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1571, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_CyFunction_New(&__pyx_mdef_11sat_toolkit_7formula_6XorCNF_27__reduce__, __Pyx_CYFUNCTION_CCLASS, __pyx_n_s_XorCNF___reduce, NULL, __pyx_n_s_sat_toolkit_formula, __pyx_d, ((PyObject *)__pyx_codeobj__160)); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1578, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
-  if (__Pyx_SetItemOnTypeDict((PyObject *)__pyx_ptype_11sat_toolkit_7formula_XorCNF, __pyx_n_s_reduce, __pyx_t_4) < 0) __PYX_ERR(0, 1571, __pyx_L1_error)
+  if (__Pyx_SetItemOnTypeDict((PyObject *)__pyx_ptype_11sat_toolkit_7formula_XorCNF, __pyx_n_s_reduce, __pyx_t_4) < 0) __PYX_ERR(0, 1578, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
   PyType_Modified(__pyx_ptype_11sat_toolkit_7formula_XorCNF);
 
-  /* "sat_toolkit/formula.pyx":1587
+  /* "sat_toolkit/formula.pyx":1594
  *         return self._clauses._clauses == c_other._clauses._clauses and self._xor_clauses._clauses == c_other._xor_clauses._clauses
  * 
  *     def solve_dimacs(self, command: List[str]=['cryptominisat5'], verbose=False) -> Tuple[bool, np.array|None]:             # <<<<<<<<<<<<<<
  *         """
  *         solves the SAT by calling a DIMACS compliant sat solver that also
  */
-  __pyx_t_4 = PyList_New(1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1587, __pyx_L1_error)
+  __pyx_t_4 = PyList_New(1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1594, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __Pyx_INCREF(__pyx_n_u_cryptominisat5);
   __Pyx_GIVEREF(__pyx_n_u_cryptominisat5);
-  if (__Pyx_PyList_SET_ITEM(__pyx_t_4, 0, __pyx_n_u_cryptominisat5)) __PYX_ERR(0, 1587, __pyx_L1_error);
+  if (__Pyx_PyList_SET_ITEM(__pyx_t_4, 0, __pyx_n_u_cryptominisat5)) __PYX_ERR(0, 1594, __pyx_L1_error);
   __pyx_k__50 = __pyx_t_4;
   __Pyx_GIVEREF(__pyx_t_4);
   __pyx_t_4 = 0;
-  __pyx_t_4 = PyList_New(1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1587, __pyx_L1_error)
+  __pyx_t_4 = PyList_New(1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1594, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __Pyx_INCREF(__pyx_n_u_cryptominisat5);
   __Pyx_GIVEREF(__pyx_n_u_cryptominisat5);
-  if (__Pyx_PyList_SET_ITEM(__pyx_t_4, 0, __pyx_n_u_cryptominisat5)) __PYX_ERR(0, 1587, __pyx_L1_error);
-  __pyx_t_7 = PyTuple_New(2); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1587, __pyx_L1_error)
+  if (__Pyx_PyList_SET_ITEM(__pyx_t_4, 0, __pyx_n_u_cryptominisat5)) __PYX_ERR(0, 1594, __pyx_L1_error);
+  __pyx_t_7 = PyTuple_New(2); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1594, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_7);
   __Pyx_GIVEREF(__pyx_t_4);
-  if (__Pyx_PyTuple_SET_ITEM(__pyx_t_7, 0, __pyx_t_4)) __PYX_ERR(0, 1587, __pyx_L1_error);
+  if (__Pyx_PyTuple_SET_ITEM(__pyx_t_7, 0, __pyx_t_4)) __PYX_ERR(0, 1594, __pyx_L1_error);
   __Pyx_INCREF(Py_False);
   __Pyx_GIVEREF(Py_False);
-  if (__Pyx_PyTuple_SET_ITEM(__pyx_t_7, 1, Py_False)) __PYX_ERR(0, 1587, __pyx_L1_error);
+  if (__Pyx_PyTuple_SET_ITEM(__pyx_t_7, 1, Py_False)) __PYX_ERR(0, 1594, __pyx_L1_error);
   __pyx_t_4 = 0;
-  __pyx_t_4 = __Pyx_PyDict_NewPresized(2); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1587, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyDict_NewPresized(2); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1594, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
-  if (PyDict_SetItem(__pyx_t_4, __pyx_n_s_command, __pyx_kp_s_List_str) < 0) __PYX_ERR(0, 1587, __pyx_L1_error)
-  if (PyDict_SetItem(__pyx_t_4, __pyx_n_s_return, __pyx_kp_s_Tuple_bool_np_array_None) < 0) __PYX_ERR(0, 1587, __pyx_L1_error)
-  __pyx_t_5 = __Pyx_CyFunction_New(&__pyx_mdef_11sat_toolkit_7formula_6XorCNF_31solve_dimacs, __Pyx_CYFUNCTION_CCLASS, __pyx_n_s_XorCNF_solve_dimacs, NULL, __pyx_n_s_sat_toolkit_formula, __pyx_d, ((PyObject *)__pyx_codeobj__161)); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1587, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_4, __pyx_n_s_command, __pyx_kp_s_List_str) < 0) __PYX_ERR(0, 1594, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_4, __pyx_n_s_return, __pyx_kp_s_Tuple_bool_np_array_None) < 0) __PYX_ERR(0, 1594, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_CyFunction_New(&__pyx_mdef_11sat_toolkit_7formula_6XorCNF_31solve_dimacs, __Pyx_CYFUNCTION_CCLASS, __pyx_n_s_XorCNF_solve_dimacs, NULL, __pyx_n_s_sat_toolkit_formula, __pyx_d, ((PyObject *)__pyx_codeobj__161)); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1594, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_CyFunction_SetDefaultsTuple(__pyx_t_5, __pyx_t_7);
   __Pyx_CyFunction_SetAnnotationsDict(__pyx_t_5, __pyx_t_4);
   __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-  if (__Pyx_SetItemOnTypeDict((PyObject *)__pyx_ptype_11sat_toolkit_7formula_XorCNF, __pyx_n_s_solve_dimacs, __pyx_t_5) < 0) __PYX_ERR(0, 1587, __pyx_L1_error)
+  if (__Pyx_SetItemOnTypeDict((PyObject *)__pyx_ptype_11sat_toolkit_7formula_XorCNF, __pyx_n_s_solve_dimacs, __pyx_t_5) < 0) __PYX_ERR(0, 1594, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
   PyType_Modified(__pyx_ptype_11sat_toolkit_7formula_XorCNF);
 
-  /* "sat_toolkit/formula.pyx":1670
+  /* "sat_toolkit/formula.pyx":1677
  *     cdef public uint64_t numbits
  * 
  *     INIT_INDEX_SET = object()             # <<<<<<<<<<<<<<
  * 
  *     def __init__(self, init_key, numbits, on_set, dc_set):
  */
-  __pyx_t_5 = __Pyx_PyObject_CallNoArg(__pyx_builtin_object); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1670, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyObject_CallNoArg(__pyx_builtin_object); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1677, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
-  if (__Pyx_SetItemOnTypeDict((PyObject *)__pyx_ptype_11sat_toolkit_7formula_Truthtable, __pyx_n_s_INIT_INDEX_SET, __pyx_t_5) < 0) __PYX_ERR(0, 1670, __pyx_L1_error)
+  if (__Pyx_SetItemOnTypeDict((PyObject *)__pyx_ptype_11sat_toolkit_7formula_Truthtable, __pyx_n_s_INIT_INDEX_SET, __pyx_t_5) < 0) __PYX_ERR(0, 1677, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
   PyType_Modified(__pyx_ptype_11sat_toolkit_7formula_Truthtable);
 
-  /* "sat_toolkit/formula.pyx":1684
+  /* "sat_toolkit/formula.pyx":1691
  * 
  * 
  *     @classmethod             # <<<<<<<<<<<<<<
  *     def from_lut(cls, on_lut: np.ndarray, dc_lut: Optional[np.ndarray] = None) -> Truthtable:
  *         """
  */
-  __pyx_t_5 = __Pyx_PyDict_NewPresized(3); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1684, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyDict_NewPresized(3); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1691, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
-  if (PyDict_SetItem(__pyx_t_5, __pyx_n_s_on_lut, __pyx_kp_s_np_ndarray) < 0) __PYX_ERR(0, 1684, __pyx_L1_error)
-  if (PyDict_SetItem(__pyx_t_5, __pyx_n_s_dc_lut, __pyx_kp_s_Optional_np_ndarray) < 0) __PYX_ERR(0, 1684, __pyx_L1_error)
-  if (PyDict_SetItem(__pyx_t_5, __pyx_n_s_return, __pyx_n_s_Truthtable_2) < 0) __PYX_ERR(0, 1684, __pyx_L1_error)
-  __pyx_t_4 = __Pyx_CyFunction_New(&__pyx_mdef_11sat_toolkit_7formula_10Truthtable_3from_lut, __Pyx_CYFUNCTION_CLASSMETHOD | __Pyx_CYFUNCTION_CCLASS, __pyx_n_s_Truthtable_from_lut, NULL, __pyx_n_s_sat_toolkit_formula, __pyx_d, ((PyObject *)__pyx_codeobj__163)); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1684, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_5, __pyx_n_s_on_lut, __pyx_kp_s_np_ndarray) < 0) __PYX_ERR(0, 1691, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_5, __pyx_n_s_dc_lut, __pyx_kp_s_Optional_np_ndarray) < 0) __PYX_ERR(0, 1691, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_5, __pyx_n_s_return, __pyx_n_s_Truthtable_2) < 0) __PYX_ERR(0, 1691, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_CyFunction_New(&__pyx_mdef_11sat_toolkit_7formula_10Truthtable_3from_lut, __Pyx_CYFUNCTION_CLASSMETHOD | __Pyx_CYFUNCTION_CCLASS, __pyx_n_s_Truthtable_from_lut, NULL, __pyx_n_s_sat_toolkit_formula, __pyx_d, ((PyObject *)__pyx_codeobj__163)); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1691, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __Pyx_CyFunction_SetDefaultsTuple(__pyx_t_4, __pyx_tuple__164);
   __Pyx_CyFunction_SetAnnotationsDict(__pyx_t_4, __pyx_t_5);
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-  if (__Pyx_SetItemOnTypeDict((PyObject *)__pyx_ptype_11sat_toolkit_7formula_Truthtable, __pyx_n_s_from_lut, __pyx_t_4) < 0) __PYX_ERR(0, 1684, __pyx_L1_error)
+  if (__Pyx_SetItemOnTypeDict((PyObject *)__pyx_ptype_11sat_toolkit_7formula_Truthtable, __pyx_n_s_from_lut, __pyx_t_4) < 0) __PYX_ERR(0, 1691, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
   PyType_Modified(__pyx_ptype_11sat_toolkit_7formula_Truthtable);
-  __Pyx_GetNameInClass(__pyx_t_4, (PyObject *)__pyx_ptype_11sat_toolkit_7formula_Truthtable, __pyx_n_s_from_lut); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1684, __pyx_L1_error)
+  __Pyx_GetNameInClass(__pyx_t_4, (PyObject *)__pyx_ptype_11sat_toolkit_7formula_Truthtable, __pyx_n_s_from_lut); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1691, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
-  __pyx_t_5 = __Pyx_Method_ClassMethod(__pyx_t_4); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1684, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_Method_ClassMethod(__pyx_t_4); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1691, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-  if (__Pyx_SetItemOnTypeDict((PyObject *)__pyx_ptype_11sat_toolkit_7formula_Truthtable, __pyx_n_s_from_lut, __pyx_t_5) < 0) __PYX_ERR(0, 1684, __pyx_L1_error)
+  if (__Pyx_SetItemOnTypeDict((PyObject *)__pyx_ptype_11sat_toolkit_7formula_Truthtable, __pyx_n_s_from_lut, __pyx_t_5) < 0) __PYX_ERR(0, 1691, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
   PyType_Modified(__pyx_ptype_11sat_toolkit_7formula_Truthtable);
 
-  /* "sat_toolkit/formula.pyx":1715
+  /* "sat_toolkit/formula.pyx":1722
  * 
  *     @classmethod
  *     def from_indices(cls, numbits: int, on_indices: np.array, dc_indices = np.array([], dtype=int)) -> Truthtable:             # <<<<<<<<<<<<<<
  *         """
  *         Creates a Truthtable from the set of indices with value 1 and optionally indices where the value can be ignored.
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_np); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1715, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_np); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1722, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
-  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_array); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1715, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_array); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1722, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-  __pyx_t_5 = PyList_New(0); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1715, __pyx_L1_error)
+  __pyx_t_5 = PyList_New(0); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1722, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
-  __pyx_t_7 = PyTuple_New(1); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1715, __pyx_L1_error)
+  __pyx_t_7 = PyTuple_New(1); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1722, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_7);
   __Pyx_GIVEREF(__pyx_t_5);
-  if (__Pyx_PyTuple_SET_ITEM(__pyx_t_7, 0, __pyx_t_5)) __PYX_ERR(0, 1715, __pyx_L1_error);
+  if (__Pyx_PyTuple_SET_ITEM(__pyx_t_7, 0, __pyx_t_5)) __PYX_ERR(0, 1722, __pyx_L1_error);
   __pyx_t_5 = 0;
-  __pyx_t_5 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1715, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1722, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
-  if (PyDict_SetItem(__pyx_t_5, __pyx_n_s_dtype, ((PyObject *)(&PyInt_Type))) < 0) __PYX_ERR(0, 1715, __pyx_L1_error)
-  __pyx_t_9 = __Pyx_PyObject_Call(__pyx_t_4, __pyx_t_7, __pyx_t_5); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1715, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_5, __pyx_n_s_dtype, ((PyObject *)(&PyInt_Type))) < 0) __PYX_ERR(0, 1722, __pyx_L1_error)
+  __pyx_t_9 = __Pyx_PyObject_Call(__pyx_t_4, __pyx_t_7, __pyx_t_5); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1722, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_9);
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
   __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
   __pyx_k__56 = __pyx_t_9;
   __Pyx_GIVEREF(__pyx_t_9);
   __pyx_t_9 = 0;
 
-  /* "sat_toolkit/formula.pyx":1714
+  /* "sat_toolkit/formula.pyx":1721
  *         return cls(cls.INIT_INDEX_SET, numbits, on_set, dc_set)
  * 
  *     @classmethod             # <<<<<<<<<<<<<<
  *     def from_indices(cls, numbits: int, on_indices: np.array, dc_indices = np.array([], dtype=int)) -> Truthtable:
  *         """
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_9, __pyx_n_s_np); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1715, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_9, __pyx_n_s_np); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1722, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_9);
 
-  /* "sat_toolkit/formula.pyx":1715
+  /* "sat_toolkit/formula.pyx":1722
  * 
  *     @classmethod
  *     def from_indices(cls, numbits: int, on_indices: np.array, dc_indices = np.array([], dtype=int)) -> Truthtable:             # <<<<<<<<<<<<<<
  *         """
  *         Creates a Truthtable from the set of indices with value 1 and optionally indices where the value can be ignored.
  */
-  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_9, __pyx_n_s_array); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1715, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_9, __pyx_n_s_array); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1722, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
-  __pyx_t_9 = PyList_New(0); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1715, __pyx_L1_error)
+  __pyx_t_9 = PyList_New(0); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1722, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_9);
-  __pyx_t_7 = PyTuple_New(1); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1715, __pyx_L1_error)
+  __pyx_t_7 = PyTuple_New(1); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1722, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_7);
   __Pyx_GIVEREF(__pyx_t_9);
-  if (__Pyx_PyTuple_SET_ITEM(__pyx_t_7, 0, __pyx_t_9)) __PYX_ERR(0, 1715, __pyx_L1_error);
+  if (__Pyx_PyTuple_SET_ITEM(__pyx_t_7, 0, __pyx_t_9)) __PYX_ERR(0, 1722, __pyx_L1_error);
   __pyx_t_9 = 0;
-  __pyx_t_9 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1715, __pyx_L1_error)
+  __pyx_t_9 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1722, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_9);
-  if (PyDict_SetItem(__pyx_t_9, __pyx_n_s_dtype, ((PyObject *)(&PyInt_Type))) < 0) __PYX_ERR(0, 1715, __pyx_L1_error)
-  __pyx_t_4 = __Pyx_PyObject_Call(__pyx_t_5, __pyx_t_7, __pyx_t_9); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1715, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_9, __pyx_n_s_dtype, ((PyObject *)(&PyInt_Type))) < 0) __PYX_ERR(0, 1722, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyObject_Call(__pyx_t_5, __pyx_t_7, __pyx_t_9); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1722, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
   __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
   __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
 
-  /* "sat_toolkit/formula.pyx":1714
+  /* "sat_toolkit/formula.pyx":1721
  *         return cls(cls.INIT_INDEX_SET, numbits, on_set, dc_set)
  * 
  *     @classmethod             # <<<<<<<<<<<<<<
  *     def from_indices(cls, numbits: int, on_indices: np.array, dc_indices = np.array([], dtype=int)) -> Truthtable:
  *         """
  */
-  __pyx_t_9 = PyTuple_New(1); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1714, __pyx_L1_error)
+  __pyx_t_9 = PyTuple_New(1); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1721, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_9);
   __Pyx_GIVEREF(__pyx_t_4);
-  if (__Pyx_PyTuple_SET_ITEM(__pyx_t_9, 0, __pyx_t_4)) __PYX_ERR(0, 1714, __pyx_L1_error);
+  if (__Pyx_PyTuple_SET_ITEM(__pyx_t_9, 0, __pyx_t_4)) __PYX_ERR(0, 1721, __pyx_L1_error);
   __pyx_t_4 = 0;
-  __pyx_t_4 = __Pyx_PyDict_NewPresized(3); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1714, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyDict_NewPresized(3); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1721, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
-  if (PyDict_SetItem(__pyx_t_4, __pyx_n_s_numbits, __pyx_n_s_int) < 0) __PYX_ERR(0, 1714, __pyx_L1_error)
-  if (PyDict_SetItem(__pyx_t_4, __pyx_n_s_on_indices, __pyx_kp_s_np_array) < 0) __PYX_ERR(0, 1714, __pyx_L1_error)
-  if (PyDict_SetItem(__pyx_t_4, __pyx_n_s_return, __pyx_n_s_Truthtable_2) < 0) __PYX_ERR(0, 1714, __pyx_L1_error)
-  __pyx_t_7 = __Pyx_CyFunction_New(&__pyx_mdef_11sat_toolkit_7formula_10Truthtable_5from_indices, __Pyx_CYFUNCTION_CLASSMETHOD | __Pyx_CYFUNCTION_CCLASS, __pyx_n_s_Truthtable_from_indices, NULL, __pyx_n_s_sat_toolkit_formula, __pyx_d, ((PyObject *)__pyx_codeobj__166)); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1714, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_4, __pyx_n_s_numbits, __pyx_n_s_int) < 0) __PYX_ERR(0, 1721, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_4, __pyx_n_s_on_indices, __pyx_kp_s_np_array) < 0) __PYX_ERR(0, 1721, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_4, __pyx_n_s_return, __pyx_n_s_Truthtable_2) < 0) __PYX_ERR(0, 1721, __pyx_L1_error)
+  __pyx_t_7 = __Pyx_CyFunction_New(&__pyx_mdef_11sat_toolkit_7formula_10Truthtable_5from_indices, __Pyx_CYFUNCTION_CLASSMETHOD | __Pyx_CYFUNCTION_CCLASS, __pyx_n_s_Truthtable_from_indices, NULL, __pyx_n_s_sat_toolkit_formula, __pyx_d, ((PyObject *)__pyx_codeobj__166)); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1721, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_7);
   __Pyx_CyFunction_SetDefaultsTuple(__pyx_t_7, __pyx_t_9);
   __Pyx_CyFunction_SetAnnotationsDict(__pyx_t_7, __pyx_t_4);
   __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-  if (__Pyx_SetItemOnTypeDict((PyObject *)__pyx_ptype_11sat_toolkit_7formula_Truthtable, __pyx_n_s_from_indices, __pyx_t_7) < 0) __PYX_ERR(0, 1714, __pyx_L1_error)
+  if (__Pyx_SetItemOnTypeDict((PyObject *)__pyx_ptype_11sat_toolkit_7formula_Truthtable, __pyx_n_s_from_indices, __pyx_t_7) < 0) __PYX_ERR(0, 1721, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
   PyType_Modified(__pyx_ptype_11sat_toolkit_7formula_Truthtable);
-  __Pyx_GetNameInClass(__pyx_t_7, (PyObject *)__pyx_ptype_11sat_toolkit_7formula_Truthtable, __pyx_n_s_from_indices); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1714, __pyx_L1_error)
+  __Pyx_GetNameInClass(__pyx_t_7, (PyObject *)__pyx_ptype_11sat_toolkit_7formula_Truthtable, __pyx_n_s_from_indices); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1721, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_7);
-  __pyx_t_4 = __Pyx_Method_ClassMethod(__pyx_t_7); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1714, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_Method_ClassMethod(__pyx_t_7); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1721, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-  if (__Pyx_SetItemOnTypeDict((PyObject *)__pyx_ptype_11sat_toolkit_7formula_Truthtable, __pyx_n_s_from_indices, __pyx_t_4) < 0) __PYX_ERR(0, 1714, __pyx_L1_error)
+  if (__Pyx_SetItemOnTypeDict((PyObject *)__pyx_ptype_11sat_toolkit_7formula_Truthtable, __pyx_n_s_from_indices, __pyx_t_4) < 0) __PYX_ERR(0, 1721, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
   PyType_Modified(__pyx_ptype_11sat_toolkit_7formula_Truthtable);
 
-  /* "sat_toolkit/formula.pyx":1729
+  /* "sat_toolkit/formula.pyx":1736
  * 
  * 
  *     def _write(self, io: io.TextIOBase, espresso: bool = False, invert: bool = False) -> None:             # <<<<<<<<<<<<<<
  *         i_list = range(1 << self.numbits)
  * 
  */
-  __pyx_t_4 = __Pyx_PyDict_NewPresized(4); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1729, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyDict_NewPresized(4); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1736, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
-  if (PyDict_SetItem(__pyx_t_4, __pyx_n_s_io, __pyx_kp_s_io_TextIOBase) < 0) __PYX_ERR(0, 1729, __pyx_L1_error)
-  if (PyDict_SetItem(__pyx_t_4, __pyx_n_s_espresso, __pyx_n_s_bool) < 0) __PYX_ERR(0, 1729, __pyx_L1_error)
-  if (PyDict_SetItem(__pyx_t_4, __pyx_n_s_invert, __pyx_n_s_bool) < 0) __PYX_ERR(0, 1729, __pyx_L1_error)
-  if (PyDict_SetItem(__pyx_t_4, __pyx_n_s_return, __pyx_n_s_None) < 0) __PYX_ERR(0, 1729, __pyx_L1_error)
-  __pyx_t_7 = __Pyx_CyFunction_New(&__pyx_mdef_11sat_toolkit_7formula_10Truthtable_7_write, __Pyx_CYFUNCTION_CCLASS, __pyx_n_s_Truthtable__write, NULL, __pyx_n_s_sat_toolkit_formula, __pyx_d, ((PyObject *)__pyx_codeobj__168)); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1729, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_4, __pyx_n_s_io, __pyx_kp_s_io_TextIOBase) < 0) __PYX_ERR(0, 1736, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_4, __pyx_n_s_espresso, __pyx_n_s_bool) < 0) __PYX_ERR(0, 1736, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_4, __pyx_n_s_invert, __pyx_n_s_bool) < 0) __PYX_ERR(0, 1736, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_4, __pyx_n_s_return, __pyx_n_s_None) < 0) __PYX_ERR(0, 1736, __pyx_L1_error)
+  __pyx_t_7 = __Pyx_CyFunction_New(&__pyx_mdef_11sat_toolkit_7formula_10Truthtable_7_write, __Pyx_CYFUNCTION_CCLASS, __pyx_n_s_Truthtable__write, NULL, __pyx_n_s_sat_toolkit_formula, __pyx_d, ((PyObject *)__pyx_codeobj__168)); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1736, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_7);
   __Pyx_CyFunction_SetDefaultsTuple(__pyx_t_7, __pyx_tuple__169);
   __Pyx_CyFunction_SetAnnotationsDict(__pyx_t_7, __pyx_t_4);
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-  if (__Pyx_SetItemOnTypeDict((PyObject *)__pyx_ptype_11sat_toolkit_7formula_Truthtable, __pyx_n_s_write_2, __pyx_t_7) < 0) __PYX_ERR(0, 1729, __pyx_L1_error)
+  if (__Pyx_SetItemOnTypeDict((PyObject *)__pyx_ptype_11sat_toolkit_7formula_Truthtable, __pyx_n_s_write_2, __pyx_t_7) < 0) __PYX_ERR(0, 1736, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
   PyType_Modified(__pyx_ptype_11sat_toolkit_7formula_Truthtable);
 
-  /* "sat_toolkit/formula.pyx":1758
+  /* "sat_toolkit/formula.pyx":1765
  *             io.write(f'.end\n')
  * 
  *     def to_espresso(self, phase='cnf') -> str:             # <<<<<<<<<<<<<<
  *         """
  *         return the truthtable in espresso format
  */
-  __pyx_t_7 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1758, __pyx_L1_error)
+  __pyx_t_7 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1765, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_7);
-  if (PyDict_SetItem(__pyx_t_7, __pyx_n_s_return, __pyx_n_s_str) < 0) __PYX_ERR(0, 1758, __pyx_L1_error)
-  __pyx_t_4 = __Pyx_CyFunction_New(&__pyx_mdef_11sat_toolkit_7formula_10Truthtable_9to_espresso, __Pyx_CYFUNCTION_CCLASS, __pyx_n_s_Truthtable_to_espresso, NULL, __pyx_n_s_sat_toolkit_formula, __pyx_d, ((PyObject *)__pyx_codeobj__171)); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1758, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_7, __pyx_n_s_return, __pyx_n_s_str) < 0) __PYX_ERR(0, 1765, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_CyFunction_New(&__pyx_mdef_11sat_toolkit_7formula_10Truthtable_9to_espresso, __Pyx_CYFUNCTION_CCLASS, __pyx_n_s_Truthtable_to_espresso, NULL, __pyx_n_s_sat_toolkit_formula, __pyx_d, ((PyObject *)__pyx_codeobj__171)); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1765, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __Pyx_CyFunction_SetDefaultsTuple(__pyx_t_4, __pyx_tuple__172);
   __Pyx_CyFunction_SetAnnotationsDict(__pyx_t_4, __pyx_t_7);
   __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-  if (__Pyx_SetItemOnTypeDict((PyObject *)__pyx_ptype_11sat_toolkit_7formula_Truthtable, __pyx_n_s_to_espresso, __pyx_t_4) < 0) __PYX_ERR(0, 1758, __pyx_L1_error)
+  if (__Pyx_SetItemOnTypeDict((PyObject *)__pyx_ptype_11sat_toolkit_7formula_Truthtable, __pyx_n_s_to_espresso, __pyx_t_4) < 0) __PYX_ERR(0, 1765, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
   PyType_Modified(__pyx_ptype_11sat_toolkit_7formula_Truthtable);
 
-  /* "sat_toolkit/formula.pyx":1797
+  /* "sat_toolkit/formula.pyx":1804
  *         return True
  * 
  *     def to_cnf(self, espresso_args: List[str] = []) -> CNF:             # <<<<<<<<<<<<<<
  *         """
  *         Uses espresso to convert the Truthtable to a minimized CNF.
  */
-  __pyx_t_4 = PyList_New(0); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1797, __pyx_L1_error)
+  __pyx_t_4 = PyList_New(0); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1804, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __pyx_k__61 = __pyx_t_4;
   __Pyx_GIVEREF(__pyx_t_4);
   __pyx_t_4 = 0;
-  __pyx_t_4 = PyList_New(0); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1797, __pyx_L1_error)
+  __pyx_t_4 = PyList_New(0); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1804, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
-  __pyx_t_7 = PyTuple_New(1); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1797, __pyx_L1_error)
+  __pyx_t_7 = PyTuple_New(1); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1804, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_7);
   __Pyx_GIVEREF(__pyx_t_4);
-  if (__Pyx_PyTuple_SET_ITEM(__pyx_t_7, 0, __pyx_t_4)) __PYX_ERR(0, 1797, __pyx_L1_error);
+  if (__Pyx_PyTuple_SET_ITEM(__pyx_t_7, 0, __pyx_t_4)) __PYX_ERR(0, 1804, __pyx_L1_error);
   __pyx_t_4 = 0;
-  __pyx_t_4 = __Pyx_PyDict_NewPresized(2); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1797, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyDict_NewPresized(2); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1804, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
-  if (PyDict_SetItem(__pyx_t_4, __pyx_n_s_espresso_args, __pyx_kp_s_List_str) < 0) __PYX_ERR(0, 1797, __pyx_L1_error)
-  if (PyDict_SetItem(__pyx_t_4, __pyx_n_s_return, __pyx_n_s_CNF) < 0) __PYX_ERR(0, 1797, __pyx_L1_error)
-  __pyx_t_9 = __Pyx_CyFunction_New(&__pyx_mdef_11sat_toolkit_7formula_10Truthtable_15to_cnf, __Pyx_CYFUNCTION_CCLASS, __pyx_n_s_Truthtable_to_cnf, NULL, __pyx_n_s_sat_toolkit_formula, __pyx_d, ((PyObject *)__pyx_codeobj__174)); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1797, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_4, __pyx_n_s_espresso_args, __pyx_kp_s_List_str) < 0) __PYX_ERR(0, 1804, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_4, __pyx_n_s_return, __pyx_n_s_CNF) < 0) __PYX_ERR(0, 1804, __pyx_L1_error)
+  __pyx_t_9 = __Pyx_CyFunction_New(&__pyx_mdef_11sat_toolkit_7formula_10Truthtable_15to_cnf, __Pyx_CYFUNCTION_CCLASS, __pyx_n_s_Truthtable_to_cnf, NULL, __pyx_n_s_sat_toolkit_formula, __pyx_d, ((PyObject *)__pyx_codeobj__174)); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1804, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_9);
   __Pyx_CyFunction_SetDefaultsTuple(__pyx_t_9, __pyx_t_7);
   __Pyx_CyFunction_SetAnnotationsDict(__pyx_t_9, __pyx_t_4);
   __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-  if (__Pyx_SetItemOnTypeDict((PyObject *)__pyx_ptype_11sat_toolkit_7formula_Truthtable, __pyx_n_s_to_cnf, __pyx_t_9) < 0) __PYX_ERR(0, 1797, __pyx_L1_error)
+  if (__Pyx_SetItemOnTypeDict((PyObject *)__pyx_ptype_11sat_toolkit_7formula_Truthtable, __pyx_n_s_to_cnf, __pyx_t_9) < 0) __PYX_ERR(0, 1804, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
   PyType_Modified(__pyx_ptype_11sat_toolkit_7formula_Truthtable);
 
   /* "(tree fragment)":1
  * def __reduce_cython__(self):             # <<<<<<<<<<<<<<
  *     cdef tuple state
  *     cdef object _dict
@@ -64170,16 +64319,16 @@
   /* "sat_toolkit/formula.pyx":1
  * #cython: language_level=3, annotation_typing=True, embedsignature=True, boundscheck=False, wraparound=False, cdivision=True             # <<<<<<<<<<<<<<
  * #distutils: language = c++
  * cimport cython
  */
   __pyx_t_9 = __Pyx_PyDict_NewPresized(2); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_9);
-  if (PyDict_SetItem(__pyx_t_9, __pyx_kp_u_CNF_logical_or_line_904, __pyx_kp_u_return_a_new_CNF_corresponding) < 0) __PYX_ERR(0, 1, __pyx_L1_error)
-  if (PyDict_SetItem(__pyx_t_9, __pyx_kp_u_CNF_get_units_line_967, __pyx_kp_u_Returns_all_unit_clauses_in_the) < 0) __PYX_ERR(0, 1, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_9, __pyx_kp_u_CNF_logical_or_line_911, __pyx_kp_u_return_a_new_CNF_corresponding) < 0) __PYX_ERR(0, 1, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_9, __pyx_kp_u_CNF_get_units_line_974, __pyx_kp_u_Returns_all_unit_clauses_in_the) < 0) __PYX_ERR(0, 1, __pyx_L1_error)
   if (PyDict_SetItem(__pyx_d, __pyx_n_s_test, __pyx_t_9) < 0) __PYX_ERR(0, 1, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
 
   /*--- Wrapped vars code ---*/
 
   goto __pyx_L0;
   __pyx_L1_error:;
@@ -67021,14 +67170,128 @@
         if (unlikely(!retval))
             return -1;
         Py_DECREF(retval);
     }
     return 0;
 }
 
+/* UnpackUnboundCMethod */
+static PyObject *__Pyx_SelflessCall(PyObject *method, PyObject *args, PyObject *kwargs) {
+    PyObject *result;
+    PyObject *selfless_args = PyTuple_GetSlice(args, 1, PyTuple_Size(args));
+    if (unlikely(!selfless_args)) return NULL;
+    result = PyObject_Call(method, selfless_args, kwargs);
+    Py_DECREF(selfless_args);
+    return result;
+}
+static PyMethodDef __Pyx_UnboundCMethod_Def = {
+     "CythonUnboundCMethod",
+     __PYX_REINTERPRET_FUNCION(PyCFunction, __Pyx_SelflessCall),
+     METH_VARARGS | METH_KEYWORDS,
+     NULL
+};
+static int __Pyx_TryUnpackUnboundCMethod(__Pyx_CachedCFunction* target) {
+    PyObject *method;
+    method = __Pyx_PyObject_GetAttrStr(target->type, *target->method_name);
+    if (unlikely(!method))
+        return -1;
+    target->method = method;
+#if CYTHON_COMPILING_IN_CPYTHON
+    #if PY_MAJOR_VERSION >= 3
+    if (likely(__Pyx_TypeCheck(method, &PyMethodDescr_Type)))
+    #else
+    if (likely(!__Pyx_CyOrPyCFunction_Check(method)))
+    #endif
+    {
+        PyMethodDescrObject *descr = (PyMethodDescrObject*) method;
+        target->func = descr->d_method->ml_meth;
+        target->flag = descr->d_method->ml_flags & ~(METH_CLASS | METH_STATIC | METH_COEXIST | METH_STACKLESS);
+    } else
+#endif
+#if CYTHON_COMPILING_IN_PYPY
+#else
+    if (PyCFunction_Check(method))
+#endif
+    {
+        PyObject *self;
+        int self_found;
+#if CYTHON_COMPILING_IN_LIMITED_API || CYTHON_COMPILING_IN_PYPY
+        self = PyObject_GetAttrString(method, "__self__");
+        if (!self) {
+            PyErr_Clear();
+        }
+#else
+        self = PyCFunction_GET_SELF(method);
+#endif
+        self_found = (self && self != Py_None);
+#if CYTHON_COMPILING_IN_LIMITED_API || CYTHON_COMPILING_IN_PYPY
+        Py_XDECREF(self);
+#endif
+        if (self_found) {
+            PyObject *unbound_method = PyCFunction_New(&__Pyx_UnboundCMethod_Def, method);
+            if (unlikely(!unbound_method)) return -1;
+            Py_DECREF(method);
+            target->method = unbound_method;
+        }
+    }
+    return 0;
+}
+
+/* CallUnboundCMethod1 */
+#if CYTHON_COMPILING_IN_CPYTHON
+static CYTHON_INLINE PyObject* __Pyx_CallUnboundCMethod1(__Pyx_CachedCFunction* cfunc, PyObject* self, PyObject* arg) {
+    if (likely(cfunc->func)) {
+        int flag = cfunc->flag;
+        if (flag == METH_O) {
+            return (*(cfunc->func))(self, arg);
+        } else if ((PY_VERSION_HEX >= 0x030600B1) && flag == METH_FASTCALL) {
+            #if PY_VERSION_HEX >= 0x030700A0
+                return (*(__Pyx_PyCFunctionFast)(void*)(PyCFunction)cfunc->func)(self, &arg, 1);
+            #else
+                return (*(__Pyx_PyCFunctionFastWithKeywords)(void*)(PyCFunction)cfunc->func)(self, &arg, 1, NULL);
+            #endif
+        } else if ((PY_VERSION_HEX >= 0x030700A0) && flag == (METH_FASTCALL | METH_KEYWORDS)) {
+            return (*(__Pyx_PyCFunctionFastWithKeywords)(void*)(PyCFunction)cfunc->func)(self, &arg, 1, NULL);
+        }
+    }
+    return __Pyx__CallUnboundCMethod1(cfunc, self, arg);
+}
+#endif
+static PyObject* __Pyx__CallUnboundCMethod1(__Pyx_CachedCFunction* cfunc, PyObject* self, PyObject* arg){
+    PyObject *args, *result = NULL;
+    if (unlikely(!cfunc->func && !cfunc->method) && unlikely(__Pyx_TryUnpackUnboundCMethod(cfunc) < 0)) return NULL;
+#if CYTHON_COMPILING_IN_CPYTHON
+    if (cfunc->func && (cfunc->flag & METH_VARARGS)) {
+        args = PyTuple_New(1);
+        if (unlikely(!args)) goto bad;
+        Py_INCREF(arg);
+        PyTuple_SET_ITEM(args, 0, arg);
+        if (cfunc->flag & METH_KEYWORDS)
+            result = (*(PyCFunctionWithKeywords)(void*)(PyCFunction)cfunc->func)(self, args, NULL);
+        else
+            result = (*cfunc->func)(self, args);
+    } else {
+        args = PyTuple_New(2);
+        if (unlikely(!args)) goto bad;
+        Py_INCREF(self);
+        PyTuple_SET_ITEM(args, 0, self);
+        Py_INCREF(arg);
+        PyTuple_SET_ITEM(args, 1, arg);
+        result = __Pyx_PyObject_Call(cfunc->method, args, NULL);
+    }
+#else
+    args = PyTuple_Pack(2, self, arg);
+    if (unlikely(!args)) goto bad;
+    result = __Pyx_PyObject_Call(cfunc->method, args, NULL);
+#endif
+bad:
+    Py_XDECREF(args);
+    return result;
+}
+
 /* IterFinish */
 static CYTHON_INLINE int __Pyx_IterFinish(void) {
     PyObject* exc_type;
     __Pyx_PyThreadState_declare
     __Pyx_PyThreadState_assign
     exc_type = __Pyx_PyErr_CurrentExceptionType();
     if (unlikely(exc_type)) {
@@ -67036,14 +67299,65 @@
             return -1;
         __Pyx_PyErr_Clear();
         return 0;
     }
     return 0;
 }
 
+/* set_iter */
+static CYTHON_INLINE PyObject* __Pyx_set_iterator(PyObject* iterable, int is_set,
+                                                  Py_ssize_t* p_orig_length, int* p_source_is_set) {
+#if CYTHON_COMPILING_IN_CPYTHON && PY_VERSION_HEX < 0x030d0000
+    is_set = is_set || likely(PySet_CheckExact(iterable) || PyFrozenSet_CheckExact(iterable));
+    *p_source_is_set = is_set;
+    if (likely(is_set)) {
+        *p_orig_length = PySet_Size(iterable);
+        Py_INCREF(iterable);
+        return iterable;
+    }
+#else
+    CYTHON_UNUSED_VAR(is_set);
+    *p_source_is_set = 0;
+#endif
+    *p_orig_length = 0;
+    return PyObject_GetIter(iterable);
+}
+static CYTHON_INLINE int __Pyx_set_iter_next(
+        PyObject* iter_obj, Py_ssize_t orig_length,
+        Py_ssize_t* ppos, PyObject **value,
+        int source_is_set) {
+    if (!CYTHON_COMPILING_IN_CPYTHON || PY_VERSION_HEX >= 0x030d0000 || unlikely(!source_is_set)) {
+        *value = PyIter_Next(iter_obj);
+        if (unlikely(!*value)) {
+            return __Pyx_IterFinish();
+        }
+        CYTHON_UNUSED_VAR(orig_length);
+        CYTHON_UNUSED_VAR(ppos);
+        return 1;
+    }
+#if CYTHON_COMPILING_IN_CPYTHON && PY_VERSION_HEX < 0x030d0000
+    if (unlikely(PySet_GET_SIZE(iter_obj) != orig_length)) {
+        PyErr_SetString(
+            PyExc_RuntimeError,
+            "set changed size during iteration");
+        return -1;
+    }
+    {
+        Py_hash_t hash;
+        int ret = _PySet_NextEntry(iter_obj, ppos, value, &hash);
+        assert (ret != -1);
+        if (likely(ret)) {
+            Py_INCREF(*value);
+            return 1;
+        }
+    }
+#endif
+    return 0;
+}
+
 /* PyObjectCallNoArg */
 static CYTHON_INLINE PyObject* __Pyx_PyObject_CallNoArg(PyObject *func) {
     PyObject *arg[2] = {NULL, NULL};
     return __Pyx_PyObject_FastCall(func, arg + 1, 0 | __Pyx_PY_VECTORCALL_ARGUMENTS_OFFSET);
 }
 
 /* PyObjectCallMethod0 */
@@ -69711,18 +70025,18 @@
     Py_XDECREF(setstate);
     Py_XDECREF(setstate_cython);
     return ret;
 }
 #endif
 
 /* TypeImport */
-#ifndef __PYX_HAVE_RT_ImportType_3_0_9
-#define __PYX_HAVE_RT_ImportType_3_0_9
-static PyTypeObject *__Pyx_ImportType_3_0_9(PyObject *module, const char *module_name, const char *class_name,
-    size_t size, size_t alignment, enum __Pyx_ImportType_CheckSize_3_0_9 check_size)
+#ifndef __PYX_HAVE_RT_ImportType_3_0_10
+#define __PYX_HAVE_RT_ImportType_3_0_10
+static PyTypeObject *__Pyx_ImportType_3_0_10(PyObject *module, const char *module_name, const char *class_name,
+    size_t size, size_t alignment, enum __Pyx_ImportType_CheckSize_3_0_10 check_size)
 {
     PyObject *result = 0;
     char warning[200];
     Py_ssize_t basicsize;
     Py_ssize_t itemsize;
 #if CYTHON_COMPILING_IN_LIMITED_API
     PyObject *py_basicsize;
@@ -69768,23 +70082,23 @@
     if ((size_t)(basicsize + itemsize) < size) {
         PyErr_Format(PyExc_ValueError,
             "%.200s.%.200s size changed, may indicate binary incompatibility. "
             "Expected %zd from C header, got %zd from PyObject",
             module_name, class_name, size, basicsize+itemsize);
         goto bad;
     }
-    if (check_size == __Pyx_ImportType_CheckSize_Error_3_0_9 &&
+    if (check_size == __Pyx_ImportType_CheckSize_Error_3_0_10 &&
             ((size_t)basicsize > size || (size_t)(basicsize + itemsize) < size)) {
         PyErr_Format(PyExc_ValueError,
             "%.200s.%.200s size changed, may indicate binary incompatibility. "
             "Expected %zd from C header, got %zd-%zd from PyObject",
             module_name, class_name, size, basicsize, basicsize+itemsize);
         goto bad;
     }
-    else if (check_size == __Pyx_ImportType_CheckSize_Warn_3_0_9 && (size_t)basicsize > size) {
+    else if (check_size == __Pyx_ImportType_CheckSize_Warn_3_0_10 && (size_t)basicsize > size) {
         PyOS_snprintf(warning, sizeof(warning),
             "%s.%s size changed, may indicate binary incompatibility. "
             "Expected %zd from C header, got %zd from PyObject",
             module_name, class_name, size, basicsize);
         if (PyErr_WarnEx(NULL, warning, 0) < 0) goto bad;
     }
     return (PyTypeObject *)result;
```

### Comparing `sat-toolkit-0.4.1/sat_toolkit/formula.pyx` & `sat-toolkit-0.4.2/sat_toolkit/formula.pyx`

 * *Files 1% similar despite different names*

```diff
@@ -3,15 +3,15 @@
 cimport cython
 from cpython cimport buffer
 from libc.stdlib cimport malloc, free
 
 from cpython.buffer cimport PyBUF_FORMAT, PyBUF_ND, PyBUF_STRIDES, PyBUF_WRITABLE
 from cpython.exc cimport PyErr_CheckSignals
 from libcpp.vector cimport vector
-from libcpp.set cimport set
+from libcpp.set cimport set as cpp_set
 from libc.stdio cimport printf, snprintf, sscanf
 from libc.stdlib cimport malloc, free, abort
 from libc.string cimport strcpy, memset, strncmp, strlen, memcmp
 from sat_toolkit.types cimport *
 
 cdef extern from "fmt.h":
     ctypedef struct fmt_buf:
@@ -277,16 +277,16 @@
         cdef size_t i
         for i in range(self._clauses.size()):
             if abs(self._clauses[i]) > val:
                 raise ValueError(f'cannot set nvars to {val} as it is too small')
 
         self.nvars = val
 
-    cdef set[int] _get_vars(self) nogil:
-        cdef set[int] res
+    cdef cpp_set[int] _get_vars(self) nogil:
+        cdef cpp_set[int] res
         cdef size_t i
         cdef int val
 
         for i in range(self._clauses.size()):
             val = self._clauses[i]
             if val != 0:
                 res.insert(abs(val))
@@ -306,15 +306,16 @@
         self._start_indices.clear()
         self.nvars = 0
 
     def partition(self) -> list[Self]:
         """
         partition the CNF/XorClauseList into a list of CNF/XorClauseLists with disjoints variables.
         """
-        cdef dict res = {}
+        cdef dict[int, _ClauseList] res = {}
+        cdef set[int] vars_to_update = set()
         cdef _BaseClause clause = None
         cdef _ClauseList dst = None, tmp = None
         cdef int var
 
         for clause in self:
             if len(clause) == 0:
                 if 0 not in res:
@@ -322,45 +323,51 @@
                     dst.nvars = self.nvars
                     res[0] = dst
                 else:
                     dst = res[0]
                 dst.append(clause)
 
             dst = None
+            vars_to_update.clear()
+
             for var in clause:
                 var = abs(var)
+                vars_to_update.add(var)
 
                 if var not in res:
                     continue
 
                 if dst is None:
                     dst = res[var]
                     continue
 
                 tmp = res[var]
                 if dst is tmp:
                     continue
 
+                vars_to_update = vars_to_update.union(tmp.get_vars())
                 dst += tmp
                 tmp.clear()
 
+            assert dst is None or len(dst) > 0
+
             if dst is None:
                 dst = type(self).__new__(type(self))
                 dst.nvars = self.nvars
 
-            for var in clause:
-                var = abs(var)
+            for var in vars_to_update:
+                assert var > 0
                 res[var] = dst
 
             dst.append(clause)
 
         # iterate over res dictionary values and find all unique
         # and non-empty partitions
         cdef list result_list = []
-        cdef set[void *] seen_keys
+        cdef cpp_set[void *] seen_keys
         cdef object val
 
         for val in res.values():
             if seen_keys.count(<void *> val) > 0:
                 continue
             seen_keys.insert(<void *> val)
             if len(val) > 0:
```

### Comparing `sat-toolkit-0.4.1/sat_toolkit/util.py` & `sat-toolkit-0.4.2/sat_toolkit/util.py`

 * *Files identical despite different names*

### Comparing `sat-toolkit-0.4.1/sat_toolkit.egg-info/PKG-INFO` & `sat-toolkit-0.4.2/sat_toolkit.egg-info/PKG-INFO`

 * *Files 1% similar despite different names*

```diff
@@ -1,10 +1,10 @@
 Metadata-Version: 2.1
 Name: sat-toolkit
-Version: 0.4.1
+Version: 0.4.2
 Summary: Tool for manipulating CNF formulas
 Home-page: https://github.com/fanosta/sat_toolkit
 Author: Marcel Nageler
 Author-email: marcel.nageler@iaik.tugraz.at
 Classifier: Programming Language :: Python :: 3
 Classifier: License :: OSI Approved :: MIT License
 Classifier: Operating System :: POSIX :: Linux
```

### Comparing `sat-toolkit-0.4.1/setup.py` & `sat-toolkit-0.4.2/setup.py`

 * *Files 0% similar despite different names*

```diff
@@ -17,15 +17,15 @@
 ]
 
 if USE_CYTHON:
     extensions = cythonize(extensions)
 
 setup(
     name="sat-toolkit",
-    version="0.4.1",
+    version="0.4.2",
     author="Marcel Nageler",
     author_email="marcel.nageler@iaik.tugraz.at",
     description="Tool for manipulating CNF formulas",
     long_description=long_description,
     long_description_content_type="text/markdown",
     url="https://github.com/fanosta/sat_toolkit",
     packages=find_packages(),
```

### Comparing `sat-toolkit-0.4.1/tests/test_cnf.py` & `sat-toolkit-0.4.2/tests/test_cnf.py`

 * *Files identical despite different names*

### Comparing `sat-toolkit-0.4.1/tests/test_xor_cnf.py` & `sat-toolkit-0.4.2/tests/test_xor_cnf.py`

 * *Files 0% similar despite different names*

```diff
@@ -349,15 +349,15 @@
 
 def test_solve_dimacs():
     cnf = XorCNF.create_xor([1], [2], [3])
     cnf += XorCNF([], [1, 3, 0])
     cnf += CNF([1, 2, 3, 0])
     cnf += CNF([1, -2, 0])
 
-    for seed in range(100):
+    for seed in range(10):
         args = ['cryptominisat5', f'--random={seed}', '--polar=rnd']
         is_sat, result = cnf.solve_dimacs(args)
         assert is_sat
 
         assert result[1] ^ result[2] ^ result[3] == 0
         assert result[1] ^ result[3] == 1
```

