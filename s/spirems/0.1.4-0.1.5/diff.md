# Comparing `tmp/spirems-0.1.4-py3-none-any.whl.zip` & `tmp/spirems-0.1.5-py3-none-any.whl.zip`

## zipinfo {}

```diff
@@ -1,20 +1,22 @@
-Zip file size: 560526 bytes, number of entries: 42
--rw-rw-rw-  2.0 fat      546 b- defN 24-Apr-06 11:20 spirems/__init__.py
+Zip file size: 562698 bytes, number of entries: 44
+-rw-rw-rw-  2.0 fat      546 b- defN 24-Apr-08 06:18 spirems/__init__.py
 -rw-rw-rw-  2.0 fat      878 b- defN 24-Mar-31 06:11 spirems/error_code.py
 -rw-rw-rw-  2.0 fat     1009 b- defN 24-Apr-04 14:11 spirems/log.py
 -rw-rw-rw-  2.0 fat     4807 b- defN 24-Mar-31 09:46 spirems/msg_helper.py
--rw-rw-rw-  2.0 fat     8809 b- defN 24-Apr-06 10:32 spirems/publisher.py
--rw-rw-rw-  2.0 fat    16136 b- defN 24-Apr-06 11:04 spirems/server.py
+-rw-rw-rw-  2.0 fat     8866 b- defN 24-Apr-08 05:55 spirems/publisher.py
+-rw-rw-rw-  2.0 fat    16403 b- defN 24-Apr-08 05:56 spirems/server.py
 -rw-rw-rw-  2.0 fat     5255 b- defN 24-Mar-31 18:32 spirems/sms.py
--rw-rw-rw-  2.0 fat     6818 b- defN 24-Apr-06 10:29 spirems/subscriber.py
+-rw-rw-rw-  2.0 fat     6924 b- defN 24-Apr-08 05:56 spirems/subscriber.py
 -rw-rw-rw-  2.0 fat       48 b- defN 24-Apr-04 14:27 spirems/image_io/__init__.py
--rw-rw-rw-  2.0 fat     6990 b- defN 24-Apr-06 11:17 spirems/image_io/a2rl_gs.py
+-rw-rw-rw-  2.0 fat     7252 b- defN 24-Apr-06 11:36 spirems/image_io/a2rl_gs.py
+-rw-rw-rw-  2.0 fat     3851 b- defN 24-Apr-07 09:34 spirems/image_io/a2rl_live.py
 -rw-rw-rw-  2.0 fat     1440 b- defN 24-Apr-06 11:25 spirems/image_io/adaptor.py
 -rw-rw-rw-  2.0 fat      551 b- defN 24-Apr-04 14:49 spirems/image_io/recv_testcase.py
+-rw-rw-rw-  2.0 fat     2257 b- defN 24-Apr-07 07:17 spirems/image_io/visual_helper.py
 -rw-rw-rw-  2.0 fat       17 b- defN 24-Mar-31 07:05 spirems/logs/README.md
 -rw-rw-rw-  2.0 fat       54 b- defN 24-Mar-25 14:45 spirems/msgs/_sys_msgs/HeartBeat.json
 -rw-rw-rw-  2.0 fat       99 b- defN 24-Mar-25 17:12 spirems/msgs/_sys_msgs/Publisher.json
 -rw-rw-rw-  2.0 fat       92 b- defN 24-Apr-05 16:23 spirems/msgs/_sys_msgs/Result.json
 -rw-rw-rw-  2.0 fat       57 b- defN 24-Mar-27 09:42 spirems/msgs/_sys_msgs/SmsTopicList.json
 -rw-rw-rw-  2.0 fat      100 b- defN 24-Mar-25 17:13 spirems/msgs/_sys_msgs/Subscriber.json
 -rw-rw-rw-  2.0 fat       52 b- defN 24-Mar-27 15:25 spirems/msgs/_sys_msgs/Suspend.json
@@ -31,14 +33,14 @@
 -rw-rw-rw-  2.0 fat       75 b- defN 24-Mar-24 10:30 spirems/msgs/std_msgs/StringMultiArray.json
 -rw-rw-rw-  2.0 fat   116940 b- defN 24-Mar-12 14:41 spirems/res/fradmcn.ttf
 -rw-rw-rw-  2.0 fat   175292 b- defN 22-May-07 05:20 spirems/res/msyh_boot.ttf
 -rw-rw-rw-  2.0 fat   353153 b- defN 24-Apr-06 11:11 spirems/res/racecar.jpg
 -rw-rw-rw-  2.0 fat       48 b- defN 24-Apr-04 14:27 spirems/sys_monit/__init__.py
 -rw-rw-rw-  2.0 fat     2271 b- defN 24-Apr-05 09:09 spirems/sys_monit/a2rl_sys_monit.py
 -rw-rw-rw-  2.0 fat     3487 b- defN 24-Apr-03 02:38 spirems/sys_monit/psutil_pub.py
--rw-rw-rw-  2.0 fat     5241 b- defN 24-Apr-06 11:29 spirems-0.1.4.data/scripts/sms.py
--rw-rw-rw-  2.0 fat    11558 b- defN 24-Apr-06 11:29 spirems-0.1.4.dist-info/LICENSE
--rw-rw-rw-  2.0 fat     1248 b- defN 24-Apr-06 11:29 spirems-0.1.4.dist-info/METADATA
--rw-rw-rw-  2.0 fat       92 b- defN 24-Apr-06 11:29 spirems-0.1.4.dist-info/WHEEL
--rw-rw-rw-  2.0 fat        8 b- defN 24-Apr-06 11:29 spirems-0.1.4.dist-info/top_level.txt
--rw-rw-r--  2.0 fat     3574 b- defN 24-Apr-06 11:29 spirems-0.1.4.dist-info/RECORD
-42 files, 727463 bytes uncompressed, 554768 bytes compressed:  23.7%
+-rw-rw-rw-  2.0 fat     5241 b- defN 24-Apr-08 06:23 spirems-0.1.5.data/scripts/sms.py
+-rw-rw-rw-  2.0 fat    11558 b- defN 24-Apr-08 06:23 spirems-0.1.5.dist-info/LICENSE
+-rw-rw-rw-  2.0 fat     1248 b- defN 24-Apr-08 06:23 spirems-0.1.5.dist-info/METADATA
+-rw-rw-rw-  2.0 fat       92 b- defN 24-Apr-08 06:23 spirems-0.1.5.dist-info/WHEEL
+-rw-rw-rw-  2.0 fat        8 b- defN 24-Apr-08 06:23 spirems-0.1.5.dist-info/top_level.txt
+-rw-rw-r--  2.0 fat     3750 b- defN 24-Apr-08 06:23 spirems-0.1.5.dist-info/RECORD
+44 files, 734439 bytes uncompressed, 556664 bytes compressed:  24.2%
```

## zipnote {}

```diff
@@ -24,20 +24,26 @@
 
 Filename: spirems/image_io/__init__.py
 Comment: 
 
 Filename: spirems/image_io/a2rl_gs.py
 Comment: 
 
+Filename: spirems/image_io/a2rl_live.py
+Comment: 
+
 Filename: spirems/image_io/adaptor.py
 Comment: 
 
 Filename: spirems/image_io/recv_testcase.py
 Comment: 
 
+Filename: spirems/image_io/visual_helper.py
+Comment: 
+
 Filename: spirems/logs/README.md
 Comment: 
 
 Filename: spirems/msgs/_sys_msgs/HeartBeat.json
 Comment: 
 
 Filename: spirems/msgs/_sys_msgs/Publisher.json
@@ -102,26 +108,26 @@
 
 Filename: spirems/sys_monit/a2rl_sys_monit.py
 Comment: 
 
 Filename: spirems/sys_monit/psutil_pub.py
 Comment: 
 
-Filename: spirems-0.1.4.data/scripts/sms.py
+Filename: spirems-0.1.5.data/scripts/sms.py
 Comment: 
 
-Filename: spirems-0.1.4.dist-info/LICENSE
+Filename: spirems-0.1.5.dist-info/LICENSE
 Comment: 
 
-Filename: spirems-0.1.4.dist-info/METADATA
+Filename: spirems-0.1.5.dist-info/METADATA
 Comment: 
 
-Filename: spirems-0.1.4.dist-info/WHEEL
+Filename: spirems-0.1.5.dist-info/WHEEL
 Comment: 
 
-Filename: spirems-0.1.4.dist-info/top_level.txt
+Filename: spirems-0.1.5.dist-info/top_level.txt
 Comment: 
 
-Filename: spirems-0.1.4.dist-info/RECORD
+Filename: spirems-0.1.5.dist-info/RECORD
 Comment: 
 
 Zip file comment:
```

## spirems/__init__.py

```diff
@@ -6,13 +6,13 @@
 from spirems.subscriber import Subscriber
 from spirems.publisher import Publisher
 from spirems.server import Server
 from spirems.image_io.adaptor import cvimg2sms, sms2cvimg
 from spirems.msg_helper import get_all_msg_types
 
 
-__version__ = "0.1.4"
+__version__ = "0.1.5"
 
 __all__ = [
     'a2rl_pub', 'a2rl_sub', 'cvimg2sms', 'cvimg2sms', 'get_all_msg_types',
     'Subscriber', 'Publisher', 'Server'
 ]
```

## spirems/publisher.py

```diff
@@ -220,14 +220,15 @@
 
 if __name__ == '__main__':
     pub = Publisher('/sensors/hello/a12', 'std_msgs::NumberMultiArray',
                     ip='127.0.0.1')
     # pub = Publisher('/hello1', 'std_msgs::NumberMultiArray')
     cnt = 0
     while True:
-        time.sleep(0.2)
+        time.sleep(0.1)
         tpc = get_all_msg_types()['std_msgs::NumberMultiArray'].copy()
-        tpc['data'] = [random.random() for i in range(2)]
+        tpc['data'] = [random.random() for i in range(20000)]
+        # print(len(encode_msg(tpc)) / 1024 / 1024)
         # if cnt == 0:
         #     tpc['type'] = 'std_msgs::Number'
         pub.publish(tpc)
         cnt += 1
```

## spirems/server.py

```diff
@@ -132,14 +132,15 @@
         threading.Thread.__init__(self)
         self.client_key = client_key
         self.client_socket = client_socket
         self._server = _server
         self.running = True
         self.pub_type = None
         self.sub_type = None
+        self.sub_url = None
         self._quit = False
         self.pub_suspended = False
         self.sub_suspended = False
         self.pass_id = 0
         self.passed_ids = dict()  # already passed IDs
         self.last_send_time = time.time()
         self.last_upload_time = 0.0
@@ -154,15 +155,15 @@
         package_loss_rate = 0.0
         package_len = len(self.passed_ids)
         invalid_keys = []
         for key, val in self.passed_ids.items():
             if val[1] >= 0:
                 delay += val[1]
                 delay_cnt += 1
-            if time.time() - val[0] > 3:  # keep 3 second for each msg
+            if time.time() - val[0] > 5:  # keep 5 second for each msg
                 invalid_keys.append(key)
                 package_loss_rate += 1
 
         for key in invalid_keys:
             del self.passed_ids[key]
 
         if delay_cnt > 0:
@@ -248,24 +249,28 @@
             elif '_sys_msgs::Subscriber' == msg['type']:
                 if 'topic_type' in msg and 'url' in msg:
                     error = check_subscribe_url_type(msg['url'], msg['topic_type'])
                     if self.pub_type is not None:
                         error = 209
                     if error == 0:
                         self.sub_type = msg['topic_type']
-                        update_subscriber(msg['url'], msg['topic_type'], self.client_key)
+                        self.sub_url = msg['url']
+                        if not self.sub_suspended:
+                            update_subscriber(self.sub_url, self.sub_type, self.client_key)
                     else:
                         response = ec2msg(error)
                 else:
                     response = ec2msg(206)
             elif '_sys_msgs::Suspend' == msg['type'] and self.sub_type is not None:
                 self.sub_suspended = True
+                remove_subscriber(self.client_key)
                 no_reply = True
             elif '_sys_msgs::Unsuspend' == msg['type'] and self.sub_type is not None:
                 self.sub_suspended = False
+                update_subscriber(self.sub_url, self.sub_type, self.client_key)
                 no_reply = True
             elif '_sys_msgs::SmsTopicList' == msg['type']:
                 response['error_code'] = 0
                 url_types = []
                 for key, val in get_public_topic()['from_topic'].items():
                     url_types.append(key + "," + val['type'] + "," + str(len(val['subs'])))
                 response['data'] = ";".join(url_types)
```

## spirems/subscriber.py

```diff
@@ -168,26 +168,34 @@
                     logger.error(e)
                 logger.info('Running={}, Wait ...'.format(self.running))
                 data = b''
                 last_data = b''
                 big_msg = 0
 
 
+max_dt = 0
+
+
 def callback_f(msg):
-    print(msg)
+    global max_dt
+    if time.time() - msg['timestamp'] > max_dt:
+        max_dt = time.time() - msg['timestamp']
+        print("Dt: {}".format(max_dt))
 
 
 if __name__ == '__main__':
     sub = Subscriber('/sensors/hello/a12', 'std_msgs::NumberMultiArray', callback_f,
                      ip='127.0.0.1')
+    # sub.wait_key()
+
     sus = False
     while True:
         if not sus:
             print("sub.suspend()")
             sub.suspend()
             sus = True
         else:
             print("sub.unsuspend()")
             sub.unsuspend()
             sus = False
         time.sleep(10)
-    # sub = Subscriber('/hello1', 'std_msgs::NumberMultiArray', callback_f)
+
```

## spirems/image_io/a2rl_gs.py

```diff
@@ -140,45 +140,53 @@
         cv2.imshow('img', img_show)
         c = cv2.waitKey(5)
         if c > 0:
             if c == 48:    # 0
                 print('press key: {}'.format(0))
                 img2_on = False
                 img = default_img
+                sub.suspend()
             elif c == 49:  # 1
                 print('press key: {}'.format(1))
                 num_tpc['data'] = 1
                 pub.publish(num_tpc)
+                sub.unsuspend()
                 img2_on = True
             elif c == 50:  # 2
                 print('press key: {}'.format(2))
                 num_tpc['data'] = 2
                 pub.publish(num_tpc)
+                sub.unsuspend()
                 img2_on = True
             elif c == 51:  # 3
                 print('press key: {}'.format(3))
                 num_tpc['data'] = 3
                 pub.publish(num_tpc)
+                sub.unsuspend()
                 img2_on = True
             elif c == 52:  # 4
                 print('press key: {}'.format(4))
                 num_tpc['data'] = 4
                 pub.publish(num_tpc)
+                sub.unsuspend()
                 img2_on = True
             elif c == 53:  # 5
                 print('press key: {}'.format(5))
                 num_tpc['data'] = 5
                 pub.publish(num_tpc)
+                sub.unsuspend()
                 img2_on = True
             elif c == 54:  # 6
                 print('press key: {}'.format(6))
                 num_tpc['data'] = 6
                 pub.publish(num_tpc)
+                sub.unsuspend()
                 img2_on = True
             elif c == 55:  # 7
                 print('press key: {}'.format(7))
                 num_tpc['data'] = 7
                 pub.publish(num_tpc)
+                sub.unsuspend()
                 img2_on = True
             else:
                 print(c)
     sub.wait_key()
```

## Comparing `spirems-0.1.4.data/scripts/sms.py` & `spirems-0.1.5.data/scripts/sms.py`

 * *Files identical despite different names*

## Comparing `spirems-0.1.4.dist-info/LICENSE` & `spirems-0.1.5.dist-info/LICENSE`

 * *Files identical despite different names*

## Comparing `spirems-0.1.4.dist-info/METADATA` & `spirems-0.1.5.dist-info/METADATA`

 * *Files 7% similar despite different names*

```diff
@@ -1,10 +1,10 @@
 Metadata-Version: 2.1
 Name: spirems
-Version: 0.1.4
+Version: 0.1.5
 Author: jin&team
 Author-email: renjin@bit.edu.cn
 Classifier: Programming Language :: Python :: 3
 Classifier: Operating System :: OS Independent
 Requires-Python: >=3.8
 Description-Content-Type: text/markdown
 License-File: LICENSE
```

## Comparing `spirems-0.1.4.dist-info/RECORD` & `spirems-0.1.5.dist-info/RECORD`

 * *Files 4% similar despite different names*

```diff
@@ -1,19 +1,21 @@
-spirems/__init__.py,sha256=LwFlIBDvJ0WvWlMoSJ37qNImeR6hvOdCeYecLU51ZDU,546
+spirems/__init__.py,sha256=8U0um0piR_BJYzE6vcLfO-bjRch_QOWNloNd6_LLacc,546
 spirems/error_code.py,sha256=CrFS5cLLLrLKRxGoTGoMeW4w9f8TjmVYZ-7FdHmZdp0,878
 spirems/log.py,sha256=JujtjV1_AQWNdkEmnooBG8zCzXwl6ykl4J5H_BkAtQ8,1009
 spirems/msg_helper.py,sha256=e6rNT3mjiQy_7VH6oSj6M2PQokPuNujiWBvN0MADiBI,4807
-spirems/publisher.py,sha256=6TsmzdFpRC9dQStxkpmmGBgKCHzuTbnEtPBUqv6vFx8,8809
-spirems/server.py,sha256=oeWs6lgsUZgskF5W4rJ0L3ulH-Xh7UA5BkIpwf4miQg,16136
+spirems/publisher.py,sha256=UyTv13f7G8vFgG4HFvroJSNoYqa03B1N7bC2eEBtaho,8866
+spirems/server.py,sha256=Mca5Is54ROrqFSi4_UiL5sNMWtP9E0whld7cPgvN5Q4,16403
 spirems/sms.py,sha256=4uAFAU8W-wDOTVs6UitoQfzUWkmJeU55mIcEgrUqAGs,5255
-spirems/subscriber.py,sha256=fB9Z7d4QyLasOK8KtEN4UMYj5reqU7s6lAWnC3pDZYk,6818
+spirems/subscriber.py,sha256=0xO7XD-ssXuxotgdDE-PVHfEdeJVLI8fVGRTP69HzR8,6924
 spirems/image_io/__init__.py,sha256=M11gWrr6dDI3LEeCVFCvvONgzfKA8qxwPtMNbnbW1AA,48
-spirems/image_io/a2rl_gs.py,sha256=4b8nQI1mhM8j2KDaQ7-rVKK5Vu4eC7GZ175jkFrwElw,6990
+spirems/image_io/a2rl_gs.py,sha256=MqpoKkdkVsDNdS0anxHyXdw6Xyw_yKtLroMnp8gh-gM,7252
+spirems/image_io/a2rl_live.py,sha256=Ic4iWnY5zu_GhAEqBGeYWk2EuqHZD2XIPHNZZ8peORM,3851
 spirems/image_io/adaptor.py,sha256=_SxU_0-tBj3SQhJikDsOrGrVEr1-6B_RWGWRF3Bxr_8,1440
 spirems/image_io/recv_testcase.py,sha256=Dfw9uYKAWDpHKAXOSDHnsp9YiWUwHJ1T4yHvju4vZsI,551
+spirems/image_io/visual_helper.py,sha256=3-1N_LMRlyChkmWKeF33634ejCzGxTsB-aHBxb7IhHQ,2257
 spirems/logs/README.md,sha256=-A-iurCwjSy1aV-LUkB1QZa3ORQifwKkclC3yMh2N9U,17
 spirems/msgs/_sys_msgs/HeartBeat.json,sha256=36MqpL_AjS3SDBzbCXGZf0vlGmqfqMnQWHnmjJLrKKs,54
 spirems/msgs/_sys_msgs/Publisher.json,sha256=6XQMxBGWvsey7j59eY7BEPHgtEsFA3LffQ57F4Z_gJw,99
 spirems/msgs/_sys_msgs/Result.json,sha256=JTP2tNy4NViIuG4R9db_fmYrTgxC3JK6CQtPUdn82Cs,92
 spirems/msgs/_sys_msgs/SmsTopicList.json,sha256=AKBGrqD5rnAaFKzA6zy9cW0V_JpQl8Q7oY4j_UBtX7E,57
 spirems/msgs/_sys_msgs/Subscriber.json,sha256=zzxyDaNmGnAbSwAvmEPHOkIB2mjy82OfhVQN8vaa-NA,100
 spirems/msgs/_sys_msgs/Suspend.json,sha256=OB-vSPGCh4zFZlUjco6RYX-G3fszRV-M231QdTxEfoM,52
@@ -30,13 +32,13 @@
 spirems/msgs/std_msgs/StringMultiArray.json,sha256=PN8fg_P5Zqa7BjBaptMQyoR_IuOppAetGOsg-Nvbpuk,75
 spirems/res/fradmcn.ttf,sha256=SrD02HmRy9qRpiU2nigExPuIlpzbHkvYO2vzfQfPnP0,116940
 spirems/res/msyh_boot.ttf,sha256=MlzgvMtO_ghMf56FP1XPkP_TMw7YOsLVRftCyGXWOYg,175292
 spirems/res/racecar.jpg,sha256=oUm4lHuO3iDcs5VgFIPXGn8AODd6tMEAoR5vg6HXUSo,353153
 spirems/sys_monit/__init__.py,sha256=M11gWrr6dDI3LEeCVFCvvONgzfKA8qxwPtMNbnbW1AA,48
 spirems/sys_monit/a2rl_sys_monit.py,sha256=KfP0Vd_D3oFX-ZACm6OmuWRI6tVl0vR-FisMW28A1BI,2271
 spirems/sys_monit/psutil_pub.py,sha256=PQWs5vAq916xPNyGIPtWDJ1MJZLzkFLqgsDHJ5pJKH4,3487
-spirems-0.1.4.data/scripts/sms.py,sha256=eaqngSfCzgPtkBXjw0nZ82o17pLHW2ZPDxXku6xkR94,5241
-spirems-0.1.4.dist-info/LICENSE,sha256=HrhfyXIkWY2tGFK11kg7vPCqhgh5DcxleloqdhrpyMY,11558
-spirems-0.1.4.dist-info/METADATA,sha256=bsxv6Nh1RwOTgLSTjhkx7FRh0FEQF506y1iYdXgEtdE,1248
-spirems-0.1.4.dist-info/WHEEL,sha256=GJ7t_kWBFywbagK5eo9IoUwLW6oyOeTKmQ-9iHFVNxQ,92
-spirems-0.1.4.dist-info/top_level.txt,sha256=ra9zu_vB-BRVXDwvqhouFCHIwnalKkMGq3JmTZijtmE,8
-spirems-0.1.4.dist-info/RECORD,,
+spirems-0.1.5.data/scripts/sms.py,sha256=eaqngSfCzgPtkBXjw0nZ82o17pLHW2ZPDxXku6xkR94,5241
+spirems-0.1.5.dist-info/LICENSE,sha256=HrhfyXIkWY2tGFK11kg7vPCqhgh5DcxleloqdhrpyMY,11558
+spirems-0.1.5.dist-info/METADATA,sha256=M-_sgYWMS7nuJy1esD3jV968xfZ5rElEQq3Nx3pH4xE,1248
+spirems-0.1.5.dist-info/WHEEL,sha256=GJ7t_kWBFywbagK5eo9IoUwLW6oyOeTKmQ-9iHFVNxQ,92
+spirems-0.1.5.dist-info/top_level.txt,sha256=ra9zu_vB-BRVXDwvqhouFCHIwnalKkMGq3JmTZijtmE,8
+spirems-0.1.5.dist-info/RECORD,,
```

